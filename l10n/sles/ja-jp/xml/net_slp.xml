<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="net_slp.xml" version="5.0" xml:id="cha-slp">
 <title>SLP</title>
 <info>
  <abstract>
   <para>
    ネットワーククライアントを設定するには、ネットワーク上で提供されるサービス(印刷やLDAPなど)に関する詳しい知識が必要です。ネットワーククライアントでこのようなサービスを容易に設定できるようにするため、<quote>サービスロケーションプロトコル</quote> (SLP)が開発されました。SLPは、ローカルネットワーク上にあるすべてのクライアントに対して、特定のサービスを利用できること、および設定データを通知します。このような通知情報を利用して、SLPをサポートする各種アプリケーションを自動的に設定することができます。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase>は、SLPによって提供されるインストールソースを使用するインストールをサポートしています。また、多くのシステムサービスは、統合SLPをサポートしています。ご利用のシステムでインストールサーバ、ファイルサーバ、プリントサーバなどのSLPを使用することにより、ネットワークに接続されたクライアントに一元的な管理機能を提供します。SLPサポートを提供するサービスには、cupsd、login、ntp、openldap2、postfix、rpasswd、rsyncd、saned、sshd (fish経由)、vnc、およびypservがあります。
 </para>
 <para>
  ネットワーククライアントでSLPサービスを使用するのに必要なすべてのパッケージは、デフォルトでインストールされます。<emphasis/>ただし、SLPによりサービスを「提供する」場合は、<systemitem>openslp-server</systemitem>パッケージがインストールされていることを確認します。
 </para>
 <sect1 xml:id="sec-slp-sl-fend">
  <title>SLPフロントエンド<command>slptool</command></title>

  <para>
   <command>slptool</command>は、SLPサービスを問い合わせて登録するコマンドラインツールです。このクエリ機能は、診断を行う場合に便利です。次に、<command>slptool</command>で最も重要なサブコマンドを示します。<command>slptool</command> <option>--help</option>を実行すると、使用可能なすべてのオプションと機能のリストが表示されます。
  </para>

  <variablelist>
   <varlistentry>
    <term>findsrvtypes</term>
    <listitem>
     <para>
      ネットワーク上で利用可能なすべてのサービスタイプのリストを表示します。
     </para>
<screen><prompt>tux &gt; </prompt>slptool findsrvtypes
service:install.suse:nfs
service:install.suse:ftp
service:install.suse:http
service:install.suse:smb
service:ssh
service:fish
service:YaST.installation.suse:vnc
service:smtp
service:domain
service:management-software.IBM:hardware-management-console
service:rsync
service:ntp
service:ypserv</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>findsrvs <replaceable>SERVICE_TYPE</replaceable>
    </term>
    <listitem>
     <para>
      <replaceable>SERVICE_TYPE</replaceable>を提供しているすべてのサーバのリストを表示します。
     </para>
<screen><prompt>tux &gt; </prompt>slptool findsrvs service:ntp
service:ntp://ntp.example.com:123,57810
service:ntp://ntp2.example.com:123,57810</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     findattrs <replaceable>SERVICE_TYPE</replaceable>//<replaceable>HOST</replaceable>
    </term>
    <listitem>
     <para>
      <replaceable>HOST</replaceable>上の<replaceable>SERVICE_TYPE</replaceable>の属性のリストを表示します。
     </para>
<screen><prompt>tux &gt; </prompt>slptool findattrs service:ntp://ntp.example.com
(owner=tux),(email=tux@example.com)</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     register <replaceable>SERVICE type</replaceable>//<replaceable>HOST</replaceable>:<replaceable>PORT</replaceable> "(<replaceable>ATTRIBUTE=VALUE</replaceable>),(<replaceable>ATTRIBUTE=VALUE</replaceable>)"
    </term>
    <listitem>
     <para>
      オプションの属性リストを使用して<replaceable>HOST</replaceable>上の<replaceable>SERVICE_TYPE</replaceable>を登録します。
     </para>
<screen>slptool register service:ntp://ntp.example.com:57810 \
"(owner=tux),(email=tux@example.com)"</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     deregister <replaceable>SERVICE_TYPE</replaceable>//<replaceable>host</replaceable>
    </term>
    <listitem>
     <para>
      <replaceable>HOST</replaceable>上の<replaceable>SERVICE_TYPE</replaceable>を登録解除します。
     </para>
<screen>slptool deregister service:ntp://ntp.example.com</screen>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   詳細については、<command>slptool --help</command>を実行してください。
  </para>
 </sect1>
 <sect1 xml:id="sec-slp-sl-reg">
  <title>SLPによるサービスの提供</title>

  <para>
   SLPサービスを提供するには、SLPデーモン(<systemitem class="daemon">slpd</systemitem>)が動作している必要があります。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のほとんどのシステムサービスと同様に、<systemitem class="daemon">slpd</systemitem>は別の起動スクリプトを使用して制御されます。インストール後に、このデーモンはデフォルトで非アクティブになります。現在のセッションでこのデーモンを有効にするには、<command>sudo systemctl start slpd</command>を実行します。システムの起動時に<systemitem class="daemon">slpd</systemitem>を有効にする必要がある場合は、<command>sudo systemctl enable slpd</command>を実行します。
  </para>

  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のアプリケーションの多くは<literal>libslp</literal>ライブラリを使用することで、SLPサポートを統合しています。サービスがSLPサポートでコンパイルされていない場合は、SLPを介して利用できるように次の方法のいずれかを使用してください。
  </para>

  <variablelist>
   <varlistentry>
    <term><filename>/etc/slp.reg.d</filename>による静的登録
    </term>
    <listitem>
     <para>
      新規サービスに個別の登録ファイルを作成します。次の例は、スキャナサービスを登録します。
     </para>
<screen>## Register a saned service on this system
## en means english language
## 65535 disables the timeout, so the service registration does
## not need refreshes
service:scanner.sane://$HOSTNAME:6566,en,65535
watch-port-tcp=6566
description=SANE scanner daemon</screen>
     <para>
      このファイルで最も重要な行は<emphasis>service:</emphasis>から開始する<literal>サービスURL</literal>です。このURLにはサービスタイプ(<literal>scanner.sane</literal>)および、サーバ上でサービスが使用可能になるアドレスが含まれます。<replaceable>$HOSTNAME</replaceable>は自動的に完全ホスト名で置き換えられます。その後ろにはサービスごとのTCPポートの名前がコロンで区切られる形で続きます。さらにサービスを表示する場合に使用される言語、登録の期間を秒単位で入力します。これらはコンマを使用してTービスURLと分けるようにします。<literal>0</literal>から<literal>65535</literal>で登録期間の値を設定します。<literal>0</literal>の場合は登録する必要がありません。<literal>65535</literal>はすべての制限を削除します。
     </para>
     <para>
      登録ファイルにはまた、2つの変数<systemitem>watch-port-tcp</systemitem>および<systemitem>description</systemitem>が含まれます。<systemitem>watch-port-tcp</systemitem>は、SLPサービスアナウンスとリンクして、<systemitem class="daemon">slpd</systemitem>にサービスのステータスをチェックさせることにより、関連サービスがアクティブかどうかを確認します。2つ目の変数には、サービスに関するさらに詳細な説明が含まれており、正しいブラウザを使用している場合に表示されます。
     </para>
     <tip>
      <title>YaSTとSLP</title>
      <para>
       インストールサーバ、YOUサーバなどのようにYaSTが処理を行うサービスの一部では、モジュールダイアログでSLPがアクティブになった時点で自動的にこの登録が実行されます。続いてYaSTはこれらのサービスの登録ファイルを作成します。
      </para>
     </tip>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/slp.reg</filename>による静的登録
    </term>
    <listitem>
     <para>
      この方法と、<filename>/etc/slp.reg.d</filename>による手続きの唯一の違いは、すべてのサービスが中央のファイルにグループ化されることです。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>slptool</command>による動的登録
    </term>
    <listitem>
     <para>
      設定ファイルなしでサービスを動的に登録する必要がある場合は、slptoolコマンドラインユーティリティを使用します。このユーティリティを使用すると、<systemitem class="daemon">slpd</systemitem>を再起動せずに既存の提供サービスを登録解除することもできます。詳細については、<xref linkend="sec-slp-sl-fend"/>を参照してください。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <sect2 xml:id="sec-slp-sl-reg-install">
   <title>SLPインストールサーバのセットアップ</title>
   <para>
    ネットワーク内でSLP経由でインストールデータをアナウンスすると、サーバのIPアドレスやインストールメディアのパスといったインストールデータがSLPクエリによって自動的に要求されるため、ネットワークインストールが大幅に容易になります。<phrase os="sles;sled">手順については、<xref linkend="cha-deployment-instserver"/>を参照してください。</phrase>
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-slp-info">
  <title>詳細情報</title>

  <variablelist>
   <varlistentry>
    <term>RFC 2608、2609、2610</term>
    <listitem>
     <para>
      一般的にRFC 2608はSLPの定義を取り扱います。RFC 2609は、使用されるサービスURLの構文を詳細に扱います。またRFC 2610ではSLPを使用したDHCPについて説明しています。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:href="http://www.openslp.org"/>
    </term>
    <listitem>
     <para>
      OpenSLPプロジェクトのホームページです。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/usr/share/doc/packages/openslp</filename>
    </term>
    <listitem>
     <para>
      このディレクトリには、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>の詳細を含む<filename>README.SUSE</filename>、RFC、および2つの入門的なHTMLドキュメントなど、<systemitem>openslp-server</systemitem>パッケージ付属のSLPのドキュメントが格納されています。SLP機能を使用するプログラマに役立つより詳しい情報については、<phrase os="sles;sled">SUSEソフトウェア開発キットに付属の</phrase><systemitem class="resource">openslp-devel</systemitem>パッケージに含まれる<emphasis/>『プログラマガイド』を参照してください。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
</chapter>
