sudo: required
language: bash
services:
  - docker

env:
  global:
    - ENCRYPTED_PRIVKEY_SECRET:
      - secure: "JOMuleF5/wvvZrRozDQ6KFp+Ep48xYveeIzenlRnEcw7sKD1XmLcwI8CRFM05bqPgIBy8E/lur69Ycmd29g8aXKUKsVr1EuFQDukyXSCGBFljM1FaF2sSq5Bi9Z4fvnbpVcyxMIrGp4IZJDyenJq1phViuRz8p7pGl1wTF7XJtUn+GI3rf85op24jIxKnlrXzsjYdpU43li42/2xUiSg7aeDsBnGSdV4FdAH7MwSww70SwgIrUmGVQXIf+FY+k7bUn5tvaBnsiUn2B5Xz2REx2uCdIRJoRXJr6Z8oRWTtHaFHR013aIJwJq1Zc152y51DlxSaa9oyWWyMHVZ6VXfcD69fnJiZxQ2leS4GO5RyT4/A5mGKPPeBOkEfZqZZdIbuTyPYVbwZeHSjM7juFMZZqi44IBaTfJhruUx/gUqirJBWZXrbY6YSGXnNqnayw5O5zVny+PLh5lEjxMsbIS1gggNXQ8MmuyA12WzaBwLQMXF0qiIEfCeKXo1zpSAtnQc+Cbs4SbU43rRKJiyxdKO4mULsWqWrYN9tRpnIZWF/qGilNZ5CiNHmNzv1Sq+R2oZK8qurP2QQNSskNKPm+QPoRTmkeC7o/5ZxceaA8t668O1u+sTz/P6QO1Ow3rSI1260DXETEYgOV/OkdBX28xy2Y77meeVotgbKsMV2ew22a4="
    COMMIT_AUTHOR_MAIL: "doc-team@suse.com"
before_install:
  - wget https://raw.githubusercontent.com/openSUSE/doc-ci/beta-builds/travis/travis.sh
  - docker build -t sle-doc-image .
  # list the installed packages (just for easier debugging)
  - docker run --rm -it sle-doc-image rpm -qa | sort

script:
  - echo 'TRAVIS_PULL_REQUEST=$TRAVIS_PULL_REQUEST' >> env.list
  - echo 'TRAVIS_BRANCH=$TRAVIS_BRANCH' >> env.list
  - echo 'SOURCE_BRANCH=$SOURCE_BRANCH' >> env.list
  - echo 'TRAVIS_REPO_SLUG=$TRAVIS_REPO_SLUG' >> env.list
  - echo 'ENCRYPTED_PRIVKEY_SECRET=$ENCRYPTED_PRIVKEY_SECRET' >> env.list
  - ls
  - docker run --env-file ./env.list --rm -it sle-doc-image /bin/bash -c '/bin/bash travis.sh'

notifications:
  email:
    on_success: change
    on_failure: always
