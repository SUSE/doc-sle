<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_aarch64_raspi.xml" version="5.0" xml:id="sec-aarch64-deprpi">
 <title>Raspberry Pi</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  SUSE® Linux Enterprise Server è la prima distribuzione di Linux Enterprise a supportare Raspberry Pi*, un computer a scheda singola poco dispendioso. <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase> supporta i seguenti modelli:
 </para>

 <itemizedlist>
  <listitem>
   <para>
    Raspberry Pi 3 modello A+
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 3 modello B
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 3 modello B+
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 4 modello B
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi Compute Module 3
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi Compute Module 3+
   </para>
  </listitem>
  
 </itemizedlist>

 <para>
  La linea di prodotti Raspberry Pi differisce dai server più convenzionali in vari modi. In primo luogo, non dispone di un boot loader in grado di caricare i sistemi operativi. Per ovviare al problema, <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> include quindi un software di boot loader.
 </para>

 <sect2 xml:id="sec-aarch64-deprpi-boot">
  <title>Processo di avvio</title>
  <para>
   Il processore primario nel sistema su circuito integrato (SoC, System-on-Chip) di Raspberry Pi è l&apos;unità di elaborazione grafica (GPU, Graphics Processing Unit) Broadcom VideoCore, non l&apos;unità di elaborazione centrale (CPU, Central Processing Unit) Arm. È la GPU che avvia l&apos;inizializzazione dell&apos;hardware da un boot loader della prima fase nel BootROM su chip. Solo alcune opzioni di configurazione possono influenzare il BootROM. Vedere la <xref linkend="sec-aarch64-deprpi-otp"/>.
  </para>
  <para>
   L&apos;hardware Raspberry Pi 3 non include un firmware integrato. Il firmware del boot loader della seconda fase <literal>bootcode.bin</literal> viene invece caricato dal supporto di avvio a ogni accensione del computer e, a sua volta, carica il boot loader della terza fase <literal>start.elf</literal>.
  </para>
  <para>
   L&apos;hardware Raspberry Pi 4 include una memoria di tipo EEPROM (Electrically Erasable Programmable Read-Only Memory) di dimensioni ridotte per il boot loader della seconda fase. Oltre a ciò, la sequenza di avvio è simile a quella di Raspberry Pi 3, che carica il boot loader della terza fase <literal>start4.elf</literal> dal supporto di avvio.
  </para>
  <warning>
   <title>aggiornamento EEPROM su Raspberry Pi 4</title>
   <para>
    È possibile aggiornare il boot loader della seconda fase eseguendo l&apos;avvio da una specifica scheda microSD.
   </para>
   <para>
    Inserire esclusivamente supporti di avvio attendibili e verificare che non sia accidentalmente presente alcun file <literal>recovery.bin</literal>.
   </para>
  </warning>
  <para>
   Se è presente un file <literal>armstub8.bin</literal>, verrà caricato come boot loader della quarta fase in AArch64 Exception Level 3 (EL3). In caso contrario, verrà utilizzato uno stub minimo integrato.
  </para>
  <note>
   <title>considerazioni di sicurezza EL3</title>
   <para>
    Il codice caricato per EL3 (spesso denominato BL31) si trova in memoria e Linux può tentare di effettuare hypercall in EL3 durante il runtime.
   </para>
   <para>
    Verificare che nel supporto di avvio non sia accidentalmente presente alcun file <literal>armstub8.bin</literal>. Non è incluso in <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase>.
   </para>
   <para>
    Tenere presente che il sistema SoC di Raspberry Pi non fornisce una memoria sicura TrustZone. Il sistema operativo sulla CPU ed eventuali software sulla GPU possono accedere alla RAM. Non è pertanto indicato per applicazioni EL0-s crittografiche. Per questo motivo, <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> non fornisce un ambiente Trusted Execution Environment (TEE) EL1-s.
   </para>
  </note>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> per Raspberry Pi è configurato per caricare un boot loader della quinta fase denominato <literal>Das U-Boot</literal>.
  </para>
  <sect3 xml:id="sec-aarch64-deprpi-configtxt">
   <title>Config.txt</title>
   <para>
    Non è presente una memoria non volatile per contenere le informazioni di configurazione. In altre parole, non esistono impostazioni convenzionali da regolare per l&apos;ordine dei dispositivi di avvio, la data e l&apos;ora e così via.
   </para>
   <para>
    Il boot loader legge invece un file di configurazione <literal>config.txt</literal> dal supporto di avvio. Non modificare il file <literal>config.txt</literal> fornito da SUSE. Il file consente all&apos;utente di fornire opzionalmente un file <literal>extraconfig.txt</literal>, che può ignorare eventuali impostazioni di <literal>config.txt</literal>, se necessario. In questo modo, <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> è in grado di aggiornare il file <literal>config.txt</literal> se necessario, senza sovrascrivere alcuna impostazione utente.
   </para>
  </sect3>
  <sect3 xml:id="sec-aarch64-deprpi-otp">
   <title>Memoria OTP</title>
   <para>
    Il sistema SoC include una quantità estremamente ridotta di memoria OTP (One-Time Programmable), che può essere utilizzata per configurare alcune impostazioni, ad esempio per tentare l&apos;avvio di BootROM dai dispositivi USB o su Ethernet.
   </para>
   <para>
    La memoria OTP è descritta nel sito Web di Raspberry Pi Foundation all&apos;indirizzo: <link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/otpbits.md"/>
   </para>
   <warning>
    <title>solo &quot;One-Time Programmable&quot;</title>
    <para>
     Le impostazioni di configurazione scritte nella memoria OTP sono irreversibili.
    </para>
   </warning>
   <para>
    Il caso d&apos;uso più comune per la memoria OTP è quello che consente l&apos;avvio USB su Raspberry Pi 3 modello B o Compute Module 3.
   </para>
  </sect3>
  <sect3>
   <title>Abilitazione della modalità di avvio USB per Raspberry Pi 3 modello B</title>
   <para>
    Per consentire in modo definitivo l&apos;avvio da dispositivi di memorizzazione di massa USB connessi in Raspberry Pi 3 modello B, e dalla relativa rete Ethernet USB integrata, preparare una scheda microSD come descritto nella <xref linkend="sec-aarch64-deprpi-img"/>. Prima di smontare o espellere la scheda, ed eseguire l&apos;avvio dalla scheda stessa, aggiungere alla relativa partizione FAT un file di testo <literal>extraconfig.txt</literal> (<xref linkend="sec-aarch64-deprpi-configtxt"/>) con la seguente impostazione:
   </para>
<screen>program_usb_boot_mode=1</screen>
   <para>
    Procedere quindi con l&apos;avvio dalla scheda microSD modificata come di consueto. Una volta visualizzato l&apos;output dai boot loader U-Boot o GRUB o dal kernel Linux, è possibile spegnere il dispositivo e rimuovere la scheda microSD. Dovrebbe ora essere possibile eseguire l&apos;avvio del dispositivo in modalità USB (<xref linkend="sec-aarch64-deprpi-usb"/>).
   </para>
   <para>
    Tenere presente che, una volta abilitata la modalità di avvio USB per Raspberry Pi 3 modello B, non può essere disabilitata (<xref linkend="sec-aarch64-deprpi-otp"/>).
   </para>
   <para>
    Per maggiori dettagli, fare riferimento al sito Web di Raspberry Pi Foundation all&apos;indirizzo <link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/msd.md"/>
   </para>
   <para>
    Per Raspberry Pi Compute Module 3 l&apos;impostazione richiesta è la stessa, ma la distribuzione dell&apos;immagine modificata è leggermente più complicata.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-rtc">
  <title>Orologio in tempo reale non disponibile</title>
  <para>
   Nel dispositivo Raspberry Pi non è disponibile un orologio in tempo reale a batteria.
  </para>
  <note>
   <title>sincronizzazione dell&apos;orario</title>
   <para>
    Per via dell&apos;assenza di un orologio in tempo reale, i dispositivi Raspberry Pi devono essere configurati in modo da recuperare l&apos;ora da un server NTP (Network Time Protocol) di rete.
   </para>
  </note>
  <para>
   Tuttavia le schede di base per i modelli Raspberry Pi Compute Module possono includere un orologio in tempo reale.
  </para>
  <para>
   È inoltre possibile connettere un orologio in tempo reale tramite il connettore GPIO, utilizzando Hardware Attached on Top (HAT) o altre schede di espansione.
  </para>
  <para>
   Verificare comunque se il rispettivo chipset dell&apos;orologio in tempo reale è supportato da <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. L&apos;orologio in tempo reale connesso dovrà essere descritto per il sistema operativo tramite un overlay dell&apos;albero dei dispositivi (<xref linkend="sec-aarch64-deprpi-configtxt"/>). Ad esempio, per la scheda di base MyPi potrebbe essere utilizzato quanto segue:
  </para>
<screen>dtparam=i2c1=on
dtoverlay=i2c-rtc,ds1307</screen>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-img">
  <title>Distribuzione di un&apos;immagine di appliance</title>
  <para>
   Il metodo più comune per distribuire un sistema operativo nell&apos;hardware Raspberry Pi consiste nel copiare un&apos;immagine del sistema preinstallata su un supporto di avvio, in genere una scheda microSD. Si tratta del metodo più facile e veloce.
  </para>
  <para>
   SUSE fornisce un&apos;immagine di avvio preconfigurata di <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> per l&apos;hardware Raspberry Pi. Include il file system Btrfs, con compressione abilitata per migliorare le prestazioni e ridurre l&apos;usura sui supporti microSD.
  </para>
  <para>
   È consigliata una scheda microSD con dimensioni minime di 8 GB. Schede più rapide garantiranno prestazioni di sistema superiori. Al primo avvio, il sistema operativo espande automaticamente il file system in base alle dimensioni della scheda. Il primo avvio sarà quindi sostanzialmente più lento rispetto ai successivi.
  </para>
  <para>
   Il processo di scrittura dell&apos;immagine della scheda su un supporto microSD è descritto nel <link xlink:href="https://documentation.suse.com/sles-15/html/SLES-rpi-quick/art-rpiquick.html"><citetitle>riferimento rapido per Raspberry PI</citetitle></link>.
  </para>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-usb">
  <title>Installazione da supporti USB</title>
  <para>
   Alcuni modelli Raspberry Pi consentono l&apos;avvio da dispositivi di memorizzazione di massa USB. In questo modo sarà possibile distribuire <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> in Raspberry Pi in modo analogo alle piattaforme server.
  </para>
  <para>
   L&apos;installazione può essere eseguita da un supporto USB rimovibile, come una chiavetta di memoria, su una scheda microSD nello slot interno del computer. In alternativa, può essere eseguita da un supporto USB rimovibile in un altro, ad esempio un disco rigido connesso tramite USB.
  </para>
  <note>
   <title>limitazioni di larghezza di banda USB</title>
   <para>
    Tenere presente che il controller Ethernet su Raspberry Pi 3 è connesso al bus USB 2.0 integrato nel dispositivo.
   </para>
   <para>
    Un sistema operativo in esecuzione da un disco collegato tramite USB deve pertanto condividere la larghezza di banda totale del controller USB 2.0, pari a 480 Mbps. Le prestazioni generali risulteranno limitate, con un impatto significativo su quelle di rete.
   </para>
   <para>
    Questa limitazione non si applica a Raspberry Pi 4.
   </para>
  </note>
  <para>
   I modelli più recenti di Raspberry Pi 3 con BCM2837 B0 in silicio (chip argento anziché nero), inclusi Raspberry Pi 3 modello B+ e Compute Module 3+, consentono l&apos;avvio di dispositivi di memorizzazione connessi tramite USB per impostazione predefinita.
  </para>
  <para>
   Nei modelli meno recenti, come Raspberry Pi 3 modello B o Compute Module 3, l&apos;avvio USB può essere abilitato eseguendolo una volta da una scheda microSD specifica. Per ulteriori istruzioni, vedere <xref linkend="sec-aarch64-deprpi-otp"/>.
  </para>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-net">
  <title>Installazione da rete</title>
  <para>
   Per via dell&apos;assenza di un firmware integrato nell&apos;hardware (<xref linkend="sec-aarch64-deprpi-boot"/>), l&apos;avvio da rete di Raspberry Pi mediante PXE è più complesso rispetto ai computer più convenzionali.
  </para>
  <para>
   Il processo di configurazione di un server di avvio PXE per x86 e Arm è descritto nel documento su <link xlink:href="https://documentation.suse.com/sbp/all/html/SBP-Multi-PXE-Install/index.html"><citetitle>come configurare un server di installazione multi-PXE</citetitle></link> della serie SUSE Best Practices.
  </para>
  <para>
   Raspberry Pi Foundation pubblica informazioni su come eseguire l&apos;avvio mediante PXE su un dispositivo Raspberry Pi da un altro dispositivo Raspberry Pi: <link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md"/>
  </para>
 </sect2>

 <sect2>
  <title>Ulteriori informazioni</title>
  <para>
   Per ulteriori informazioni, consultare le seguenti risorse:
  </para>
  <variablelist>
   <varlistentry>
    <term>Note di rilascio di SUSE Linux Enterprise Server 15 SP3</term>
    <listitem>
     <para>
      Per ulteriori informazioni sulla compatibilità hardware, sulle opzioni e sulle funzionalità supportate in caso di esecuzione su hardware Raspberry Pi, consultare la sezione relativa ad <citetitle>avvio e abilitazione dei driver per Raspberry Pi</citetitle> contenuta nel documento per le note di rilascio di SUSE Linux Enterprise Server:
     </para>
     <para>
      <link xlink:href="https://www.suse.com/releasenotes/aarch64/SUSE-SLES/15-SP3/#aarch64-rpi"/>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><citetitle>Riferimento rapido per Raspberry PI</citetitle></term>
    <listitem>
     <para>
      <link xlink:href="https://documentation.suse.com/sles-15/html/SLES-rpi-quick/art-rpiquick.html"/>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Elenco di compatibilità hardware openSUSE: Raspberry Pi 3</term>
    <listitem>
     <para>
      Anche il progetto openSUSE include informazioni sull&apos;installazione e sulla configurazione dell&apos;hardware Raspberry Pi. Gran parte di queste si applica anche a SUSE Linux Enterprise.
     </para>
     <para>
      Vedere <link xlink:href="https://en.opensuse.org/HCL:Raspberry_Pi3"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Das U-Boot</term>
    <listitem>
     <para>
      Ulteriori informazioni sul boot loader <literal>Das U-Boot</literal> sono disponibili nella pagina GitHub del progetto all&apos;indirizzo <link xlink:href="https://github.com/u-boot/u-boot"/>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>
</sect1>
