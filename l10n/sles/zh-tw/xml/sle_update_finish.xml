<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_finish.xml" version="5.0" xml:id="cha-upgrade-finish">
 <title>完成升級</title>
 <info>
  <abstract>
   <para>
    升級後，您需要執行一些額外的任務。下一章將引導您完成這些步驟。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 
 <sect1 xml:id="sec-upgrade-postupgrade-checks">
  <title>升級後檢查</title>
  <itemizedlist>
   <listitem>
    <para>
     檢查任何<quote>孤立的套件</quote>。執行升級程序期間可能會將套件重新命名、移除、合併或分割。因此，有些套件可能會變成孤立狀態，不再受支援。系統會自動移除孤立的套件。以下指令可以列出這些套件：
    </para>
<screen><prompt>&gt; </prompt><command>zypper packages --orphaned --unneeded</command></screen>
    <para>
     請使用該清單確定仍然需要的套件以及可以安全移除的套件。
    </para>
   </listitem>
   <listitem>
    <para>
     檢查所有 <filename>*.rpmnew</filename> 和 <filename>*.rpmsave</filename> 檔案，檢查其內容，並在可能的情況下合併適宜的變更。如果升級包含對某個預設組態檔案的變更，套件不會覆寫該組態檔案，而是建立上述其中一個檔案類型。其中，<filename>*.rpmnew</filename> 包含新的預設組態且將原始檔案保持原樣不變，而 <filename>*.rpmsave</filename> 是原始組態的副本且已由新的預設檔案取代。
    </para>
    <para>
     您無需搜尋整個檔案系統中的 <filename>*.rpmnew</filename> 和 <filename>*.rpmsave</filename> 檔案，最重要的檔案都已儲存在 <filename>/etc</filename> 目錄中。使用以下指令可以列出這些檔案：
    </para>
<screen><prompt>&gt; </prompt><command>find /etc/ -name "*.rpmnew" -o -name "*.rpmsave"</command></screen>
   </listitem>
  </itemizedlist>
 </sect1>

 
 <sect1 xml:id="sec-upgrade-finish-python3">
  <title>啟用 <literal>Python 3</literal> 模組</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 預設會使用 Python 3.6。<phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP3 中新增了更新的版本 Python 3.9 來替代 Python 3.6。自 <phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP4 起，不再支援此版本，而是透過 <literal>Python 3</literal> 模組來提供包含重要更新和安全性修復的最新 Python 版本。
  </para>
  <para>
   如果您在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 SP3 下安裝了 Python 3.9，請使用以下指令來啟用 <literal>Python 3</literal> 模組：
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>SUSEConnect -p sle-module-python3/15.4/<replaceable>x86_64</replaceable></command>&#x002E;</screen>
  <para>
   或者，您也可以使用 <command>zypper remove -u python39</command> 移除 3.9 版本，以恢復為預設的 Python 版本。
  </para>
 </sect1>

 <sect1 xml:id="sec-upgrade-finish-xfs4">
  <title>重新設定 XFS v4 裝置的格式</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 支援 XFS 檔案系統的<quote>磁碟上格式</quote> (v5)。這種格式的主要優點包括，自動獲取所有 XFS 中繼資料的檢查總數、檔案類型支援以及支援檔案更多數量的存取控制清單。
  </para>
  <para>
   請注意，早於 3.12 版的 SUSE Linux Enterprise 核心、早於 3.2.0 版的 <literal>xfsprogs</literal>，以及在 SUSE Linux Enterprise 12 之前發行的 GRUB 2 版本均不支援這種格式。
  </para>
  <important>
   <title>已棄用 V4</title>
   <para>
    XFS 已棄用採用 V4 格式的檔案系統。以前，透過以下指令可建立這種檔案系統格式：
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=0 <replaceable>DEVICE</replaceable></screen>
   <para>
    該格式用於 SLE 11 及更早版本中，現在此格式會導致 <command>dmesg</command> 發出警告訊息：
   </para>
<screen>Deprecated V4 format (crc=0) will not be supported after September 2030</screen>
   <para>
    如果您在 <command>dmesg</command> 指令的輸出中看到上述訊息，建議您將檔案系統更新為 V5 格式：
   </para>
   <procedure>
    <step>
     <para>
      將您的資料備份到另一部裝置中。
     </para>
    </step>
    <step>
     <para>
      在裝置上建立檔案系統。
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=1 <replaceable>DEVICE</replaceable></screen>
    </step>
    <step>
     <para>
      在更新後的裝置上使用備份還原資料。
     </para>
    </step>
   </procedure>
  </important>
 </sect1>
</chapter>
