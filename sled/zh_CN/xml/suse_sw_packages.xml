<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="suse_sw_packages.xml" version="5.0" xml:id="sec.suse.packages">
 <title>特殊软件包的相关信息</title>

 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker>
          </dm:bugtracker>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
    </info>
    <para>
  程序 <systemitem class="resource">bash</systemitem>、<systemitem class="resource">cron</systemitem>、<systemitem class="resource">logrotate</systemitem>、<systemitem class="resource">locate</systemitem>、<systemitem class="resource">ulimit</systemitem> 和 <systemitem class="resource">free</systemitem> 对于系统管理员和许多用户是非常重要的。手册页和信息页是命令相关信息的两个有用来源，但是它们并不是始终可用的。GNU Emacs 是一种流行的并且非常容易配置的文本编辑器。
 </para>

 <sect2 xml:id="sec.suse.packages.bash">
  <title><systemitem class="resource">bash</systemitem> 包和 <filename>/etc/profile</filename></title><indexterm> <primary>Bash</primary> <secondary>配置文件</secondary> </indexterm> <indexterm> <primary>配置文件</primary> <secondary>配置文件</secondary> </indexterm>
  <para>
   Bash 是默认的系统外壳。在用作登录外壳时，它将读取几个初始化文件。Bash 按照这些文件在列表中出现的顺序处理它们：
  </para>
  <orderedlist spacing="normal">
   <listitem>
    <para>
     <filename>/etc/profile</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>~/.profile</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>/etc/bash.bashrc</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>~/.bashrc</filename>
    </para>
   </listitem>
  </orderedlist><indexterm> <primary>Bash</primary> <secondary>.bashrc</secondary> </indexterm> <indexterm> <primary>Bash</primary> <secondary>.profile</secondary> </indexterm> <indexterm> <primary>配置文件</primary> <secondary>.bashrc</secondary> </indexterm> <indexterm> <primary>配置文件</primary> <secondary>.profile</secondary> </indexterm>
  <para>
   在 <filename>~/.profile</filename> 或 <filename>~/.bashrc</filename> 中进行自定义设置。要确保正确处理这些文件，需要将基本设置从 <filename>/etc/skel/.profile</filename> 或 <filename>/etc/skel/.bashrc</filename> 复制到用户的主目录中。建议在更新后从 <filename>/etc/skel</filename> 复制这些设置。执行以下外壳命令可防止个人调整的损失：
  </para>
<screen>mv ~/.bashrc ~/.bashrc.old
cp /etc/skel/.bashrc ~/.bashrc
mv ~/.profile ~/.profile.old
cp /etc/skel/.profile ~/.profile</screen>
  <para>
   然后从 <literal>*.old</literal> 文件将个人调整复制过来。
  </para>
 </sect2>

 <sect2 xml:id="sec.suse.packages.cron">
  <title>cron 包</title><indexterm> <primary>cron</primary> </indexterm> <indexterm> <primary>配置文件</primary> <secondary>crontab</secondary> </indexterm>
  <para>
   如果要在预定义的时间在后台定期自动运行命令，请使用 cron 工具。cron 是由特殊格式的时间表驱动的。这些表有一部分是系统附带的，但如有需要，用户可以自行编写表。
  </para>
  <para>
   cron 表位于 <filename>/var/spool/cron/tabs</filename> 中。<filename>/etc/crontab</filename> 用作系统范围的 cron 表。输入在时间表之后且在此命令之前运行此命令的用户名。在<xref linkend="ex.suse.packages.cron"/> 中，输入的是 <systemitem class="username">root</systemitem>。位于 <filename>/etc/cron.d</filename> 中的包特定的表具有相同的格式。请参见 <command>cron</command> 手册页 (<command>man cron</command>)。
  </para>
  <example xml:id="ex.suse.packages.cron">
   <title>/etc/crontab 中的项</title>
<screen>1-59/5 * * * *   root   test -x /usr/sbin/atrun &amp;&amp; /usr/sbin/atrun</screen>
  </example>
  <para>
   不能通过调用命令 <filename>crontab -e</filename> 来编辑 <command>/etc/crontab</command>。必须直接将此文件装载到编辑器中，然后对其进行修改并保存。
  </para>
  <para>
   许多包将外壳脚本安装到目录 <filename>/etc/cron.hourly</filename>、<filename>/etc/cron.daily</filename>、<filename>/etc/cron.weekly</filename> 和 <filename>/etc/cron.monthly</filename>，它们的执行是由 <filename>/usr/lib/cron/run-crons</filename> 控制的。<filename>/usr/lib/cron/run-crons</filename> 每隔 15 分钟在主表 (<filename>/etc/crontab</filename>) 中运行一次。这样可以确保在适当的时间运行可能被忽略的进程。
  </para>
  <para>
   要运行 <filename>hourly</filename>、<filename>daily</filename> 或在自定义时间运行其他周期性维护脚本，请删除通常使用 <filename>/etc/crontab</filename> 项的时戳文件（请参见<xref linkend="ex.suse.packages.cron.time"/>，它删除了每个整点之前的 <filename>hourly</filename> 和每天凌晨 2:14 的 <filename>daily</filename> 等）。
  </para>
  <example xml:id="ex.suse.packages.cron.time">
   <title>/etc/crontab：删除时戳文件</title>
<screen>59 *  * * *     root  rm -f /var/spool/cron/lastrun/cron.hourly
14 2  * * *     root  rm -f /var/spool/cron/lastrun/cron.daily
29 2  * * 6     root  rm -f /var/spool/cron/lastrun/cron.weekly
44 2  1 * *     root  rm -f /var/spool/cron/lastrun/cron.monthly</screen>
  </example>
  <para>
   或者，在 <filename>/etc/sysconfig/cron</filename> 中将 <literal>DAILY_TIME</literal>设置为应启动 <filename>cron.daily</filename> 的时间。<literal>MAX_NOT_RUN</literal> 的设置确保日常任务被触发运行，即使用户在很长时间里没有在指定的 <literal>DAILY_TIME</literal> 打开计算机。<literal>MAX_NOT_RUN</literal> 的最大值为 14 天。
  </para>
  <para>
   为了清楚起见，将日常系统维护任务分布在多个脚本中。这些脚本包含在包 <systemitem class="resource">aaa_base</systemitem> 中。例如，<filename>/etc/cron.daily</filename> 包含组件 <filename>suse.de-backup-rpmdb</filename>、<filename>suse.de-clean-tmp</filename> 或 <filename>suse.de-cron-local</filename>。 <remark role="trans">"suse.de" is just a prefix to avoid naming clashes with
   third party provided scripts; read it as: these are scripts provided by
   SUSE.  They are not German packages and you must not localize these filename
   in any way.</remark>
  </para>
 </sect2>

 <sect2 xml:id="sec.suse.packages.cronstatus">
  <title>停止 Cron 状态讯息</title>
  <para>
   要避免 cron 状态讯息导致的邮件泛滥，请将新安装产品的 <filename>/etc/sysconfig/cron</filename> 中 <literal>SEND_MAIL_ON_NO_ERROR</literal> 的默认值设为“<literal>no</literal>”。即使将此设置设为“<literal>no</literal>”，cron 数据输出仍然会发送到 <literal>MAILTO</literal> 地址，如 cron 手册页中所述。
  </para>
  <para>
   在更新时，建议根据需要设置这些值。
  </para>
 </sect2>

 <xi:include href="suse_logfiles.xml"/>

 <sect2 xml:id="sec.suse.locate">
  <title>locate 命令</title><indexterm> <primary>文件</primary> <secondary>查找</secondary> </indexterm> <indexterm> <primary>查找</primary> </indexterm>

  <para>
   <command>locate</command> 是一个用于查找文件的命令，它不包括在已安装软件的标准范围内。如果需要，请安装 <systemitem>mlocate</systemitem> 包，它是 <systemitem>findutils-locate</systemitem> 包的后继者。updatedb 进程将在每天晚上或引导系统约 15 分钟后自动启动。
  </para>
 </sect2>

 <sect2 xml:id="sec.suse.ulimit">
  <title>ulimit 命令</title><indexterm> <primary>ulimit</primary> </indexterm> <indexterm> <primary>核心文件</primary> </indexterm> <indexterm> <primary>系统</primary> <secondary>限制资源使用</secondary> </indexterm>
  <para>
   使用 <command>ulimit</command>（<emphasis>用户限制</emphasis>）命令可以为系统资源的使用设置限制并使其显示出来。<command>ulimit</command> 对于限制应用程序的可用内存尤其有用。设置可用内存限制后，可以防止应用程序占用过多系统资源，而导致操作系统变慢甚至挂起。
  </para>
  <para>
   <command>可以对 </command>ulimit 使用多个选项。要限制使用内存，请使用<xref linkend="tab.suse.packages.ulimit"/> 中列出的选项。
  </para><indexterm> <primary>ulimit</primary> <secondary>选项</secondary> </indexterm>
  <table xml:id="tab.suse.packages.ulimit">
   <title><command>ulimit</command>：为用户设置资源</title>

   <tgroup cols="2">
    <tbody>
     <row>
      <entry>
       <para>
        <option>-m</option>
       </para>
      </entry>
      <entry>
       <para>
        最大驻留集大小
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-v</option>
       </para>
      </entry>
      <entry>
       <para>
        外壳可用虚拟内存的最大量
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-s</option>
       </para>
      </entry>
      <entry>
       <para>
        堆栈的最大大小
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-c</option>
       </para>
      </entry>
      <entry>
       <para>
        创建的核心文件的最大大小
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-a</option>
       </para>
      </entry>
      <entry>
       <para>
        所有当前限制均已报告
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table><indexterm> <primary>配置文件</primary> <secondary>配置文件</secondary> </indexterm>
  <para>
   系统范围的默认项在 <filename>/etc/profile</filename> 中设置。建议不要直接编辑此文件，因为系统升级期间会覆盖所做的更改。要自定义系统范围的配置文件设置，请使用 <filename>/etc/profile.local</filename>。各用户的设置应该在 <filename>~<replaceable>USER</replaceable>/.bashrc</filename> 中配置。
  </para><indexterm> <primary>配置文件</primary> <secondary>.bashrc</secondary> </indexterm>
  <example xml:id="ex.u.ulimit.bashrc">
   <title>ulimit：~/.bashrc 中的设置</title>
<screen># Limits maximum resident set size (physical memory):
ulimit -m 98304
 
# Limits of virtual memory:
ulimit -v 98304</screen>
  </example>
  <para>
   必须以 KB 为单位指定内存分配。有关详细信息，请参见 <command>man bash</command>。
  </para>
  <important>
   <title><command>ulimit</command> 支持</title>
   <para>
    并非所有外壳都支持 <command>ulimit</command> 指令。PAM（例如 <literal>pam_limits</literal>）提供全面的调整功能，做为 <command>ulimit</command> 的替代方法。
   </para>
  </important>
 </sect2>

 <sect2 xml:id="sec.suse.free">
  <title>free 命令</title><indexterm> <primary>内存</primary> <secondary>RAM</secondary> </indexterm> <indexterm> <primary>命令</primary> <secondary>free</secondary> </indexterm>
  <para>
   <command>free</command> 命令显示系统中的可用内存总量、已用物理内存和交换空间，以及内核占用的缓冲区和缓存。<emphasis>可用 RAM </emphasis>的概念可追溯到统一内存管理之前。可用内存不是好的内存<emphasis>这种说法非常适用于 Linux。</emphasis> 因此，Linux 一直在平衡缓存方面下功夫，不允许实际上存在可用或未使用的内存。
  </para>
  <para>
   内核对任何应用程序或用户数据都没有直接的了解。而是在一个<emphasis>页缓存</emphasis>中管理应用程序和用户数据。如果内存不足，它的某些部分会被写入交换分区或文件中，借助于 <command>mmap</command> 命令，可以最先从这些交换分区或文件中读取这些部分（请参见 <command>man mmap</command>）。
  </para><indexterm> <primary>内核</primary> <secondary>缓存</secondary> </indexterm>
  <para>
   此外，内核中还包含其他缓存，如 <emphasis>slab 缓存</emphasis>，其中储存着用于网络访问的缓存。这也许能够解释 <filename>/proc/meminfo</filename> 中计数器之间的差异。通过 <filename>/proc/slabinfo</filename> 可以访问大多数（但并非全部）上述缓存。
  </para>
  <para>
   但是如果您的目的是找出当前所用的 RAM 量，则在 <filename>/proc/meminfo</filename> 中查找此信息。
  </para>
 </sect2>

 <sect2 xml:id="sec.suse.manpages">
  <title>手册页和信息页</title><indexterm> <primary>手册页</primary> </indexterm> <indexterm> <primary>信息页</primary> </indexterm> <indexterm> <primary>帮助</primary> <secondary>手册页</secondary> </indexterm> <indexterm> <primary>帮助</primary> <secondary>信息页</secondary> </indexterm>
  <para>
   对于某些 GNU 应用程序（如 tar），已不再保留手册页。对于这些命令，可使用 <option>--help</option> 选项快速查看信息页，其中提供更多深入的描述。info 是 GNU 的超文本系统。通过输入 <command>info</command><option>info</option> 可以看到此系统的介绍。通过输入 <command>emacs</command><option> -f Info</option> 可使用 Emacs 查看信息页，也可以在控制台中使用 <command>info</command> 直接查看信息页。还可以使用 tkinfo、xinfo 或帮助系统来查看信息页。
  </para>
 </sect2>



 <sect2 xml:id="sec.suse.packages.man">
  <title>使用 <command>man</command> 命令选择手册页</title>
  <para>
   要阅读手册页，请输入 <command>man </command><replaceable>手册页</replaceable>。如果不同章节存在同名手册页，所有手册页都会带相应部分编号列出。选择要显示的一个手册页。如果在数秒内未输入部分编号，将显示第一个手册页。
  </para>
  <para>
   如果要将此更改为默认系统行为，请在外壳初始化文件（如 <filename>~/.bashrc</filename>）中设置 <literal>MAN_POSIXLY_CORRECT=1</literal>。
  </para>
 </sect2>

 <xi:include href="suse_emacs.xml"/>
</sect1>
