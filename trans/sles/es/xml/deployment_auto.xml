<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="deployment_auto.xml" id="cha.deployment.autoinst">
 <title>Instalación automatizada</title>
 <para>
  AutoYaST permite instalar SUSE® Linux Enterprise de forma paralela en un gran número de equipos. La tecnología AutoYaST ofrece una gran flexibilidad para ajustar las distribuciones a hardware de diversa índole. Este capítulo describe cómo se prepara una instalación sencilla automatizada y cómo se diseña una instalación avanzada que incluya distintos tipos de hardware y de propósitos de instalación.
 </para>
 <sect1 id="sec.deployment.autoinst.simple">
  <title>Instalación masiva sencilla</title>

  <important>
   <title>hardware idéntico</title>
   <para>
    En este ejemplo se considera que se va a distribuir SUSE Linux Enterprise a un conjunto de equipos que tengan exactamente la misma configuración de hardware.
   </para>
  </important>

  <para>
   Para preparar una instalación masiva de AutoYaST, siga este procedimiento:
  </para>

  <procedure>
   <step performance="required">
    <para>
     Cree un perfil de AutoYaST que incluya los detalles de instalación necesarios para la distribución, tal y como se describe en la <xref linkend="sec.deployment.autoinst.simple.profile"/>.
    </para>
   </step>
   <step performance="required">
    <para>
     Determine el origen del perfil de AutoYaST y los parámetros que se deben pasar a las rutinas de instalación, según se indica en la <xref linkend="sec.deployment.autoinst.simple.dist"/>.
    </para>
   </step>
   <step performance="required">
    <para>
     Determine el origen de los datos de instalación de SUSE Linux Enterprise según se describe en la <xref linkend="sec.deployment.autoinst.simple.source"/>.
    </para>
   </step>
   <step performance="required">
    <para>
     Determine y configure el entorno de arranque para la instalación automatizada, según se especifica en la <xref linkend="sec.deployment.autoinst.simple.boot"/>.
    </para>
   </step>
   <step performance="required">
    <para>
     Pase la línea de comandos a las rutinas de instalación añadiendo los parámetros manualmente o creando un archivo <filename>info</filename>, tal como se especifica en la <xref linkend="sec.deployment.autoinst.simple.info"/>.
    </para>
   </step>
   <step performance="required">
    <para>
     Inicie el proceso de instalación automatizada de la forma descrita en la <xref linkend="sec.deployment.autoinst.simple.install"/>.
    </para>
   </step>
  </procedure>

  <sect2 id="sec.deployment.autoinst.simple.profile">
   <title>Creación de un perfil de AutoYaST</title>
   <para>
    Los perfiles de AutoYaST indican a AutoYaST qué debe instalar y cómo debe configurar el sistema instalado para obtener en última instancia un sistema listo para su uso. Se pueden crear de distintas formas:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Clonar una instalación nueva desde un equipo de referencia en un conjunto de equipos idénticos
     </para>
    </listitem>
    <listitem>
     <para>
      Usar la interfaz gráfica de AutoYaST para crear y modificar un perfil con objeto de satisfacer los requisitos
     </para>
    </listitem>
    <listitem>
     <para>
      Usar un editor XML y crear un perfil desde cero
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Para clonar una instalación nueva de referencia, proceda de esta forma:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Inicie una instalación normal como se describe en <xref linkend="cha.inst"/> y configure el sistema según sus necesidades. En la pantalla <guimenu>Configuración de la instalación</guimenu> (<xref linkend="sec.i.yast2.proposal"/>), seleccione <guimenu>Clonar configuración del sistema</guimenu> y active <guimenu>Escribir perfil de AutoYaST en /root/autoinst.xml</guimenu>.
     </para>
    </step>
    <step performance="required">
     <para>
      Se creará un perfil listo para usar en <filename>/root/autoinst.xml</filename>. Se puede usar para crear duplicados de esta instalación concreta.
     </para>
    </step>
   </procedure>
   <para>
    Para usar la interfaz gráfica de AutoYaST con objeto de crear un perfil a partir de una configuración de sistema existente y ajustarlo a sus necesidades, proceda de la siguiente forma:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Inicie YaST como <systemitem class="username">Root</systemitem>.
     </para>
    </step>
    <step performance="required">
     <para>
      Seleccione<menuchoice><guimenu>Miscelánea</guimenu><guimenu>Autoinstalación</guimenu></menuchoice> para iniciar la interfaz gráfica de usuario de AutoYaST.
     </para>
    </step>
    <step performance="required">
     <para>
      Seleccione <menuchoice> <guimenu>Herramientas</guimenu> <guimenu>Crear perfil de referencia</guimenu> </menuchoice> para preparar AutoYaST a fin de que duplique la configuración del sistema actual en un perfil de AutoYaST.
     </para>
    </step>
    <step performance="required">
     <para>
      Además de los recursos por defecto (como el cargador de arranque o los recursos para particiones o selección de software), puede añadir otros aspectos del sistema al perfil activando los elementos oportunos en la lista <guimenu>Crear un archivo de control de referencia.</guimenu>
     </para>
    </step>
    <step performance="required">
     <para>
      Haga clic en <guimenu>Crear</guimenu> para que YaST recopile toda la información del sistema y la escriba en un perfil nuevo.
     </para>
    </step>
    <step performance="required">
     <para>
      Para ello, elija una de las siguientes opciones:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Si el perfil está completo y se ajusta a sus necesidades, seleccione <menuchoice> <guimenu>Archivo</guimenu> <guimenu>Guardar como</guimenu> </menuchoice> y escriba el nombre de archivo para el perfil, por ejemplo, <filename>autoinst.xml</filename>.
       </para>
      </listitem>
      <listitem>
       <para>
        Modifique el perfil de referencia seleccionando los aspectos de configuración pertinentes (como, por ejemplo, <quote>Hardware/Impresora</quote>) en la vista de árbol de la izquierda. Haga clic en <guimenu>Configurar</guimenu>. Se inicia el módulo de YaST correspondiente, pero la configuración se escribe en el perfil de AutoYaST en lugar de aplicarse al sistema. A continuación, seleccione <menuchoice> <guimenu>Archivo</guimenu> <guimenu>Guardar como</guimenu> </menuchoice> y escriba un nombre adecuado para el perfil.
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step performance="required">
     <para>
      Salga del módulo de AutoYaST con <menuchoice><guimenu>Archivo</guimenu><guimenu>Salir</guimenu> </menuchoice>.
     </para>
    </step>
   </procedure>
   <figure>
    <title>Edición de un perfil de AutoYaST con la interfaz de usuario de AutoYaST</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast_gui.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="autoyast_gui.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 id="sec.deployment.autoinst.simple.dist">
   <title>Distribución de perfiles y configuración del parámetro AutoYaST</title>
   <para>
    Un perfil de AutoYaST se puede distribuir de distintas formas. En función del protocolo usado para distribuir los datos del perfil, se utilizan distintos parámetros de AutoYaST para que las rutinas de instalación del cliente conozcan la ubicación del perfil. La ubicación del perfil se pasa a las rutinas de instalación a través del indicador de arranque o del archivo <filename>info</filename> que se carga al arrancar. Están disponibles las siguientes opciones:
   </para>
   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>
         Ubicación del perfil
        </para>
       </entry>
       <entry>
        <para>
         Parámetro
        </para>
       </entry>
       <entry>
        <para>
         Descripción
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Archivo
        </para>
       </entry>
       <entry>
        <para>
         <filename>autoyast=file://<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que deben buscar el archivo de control en la vía especificada (relativa al directorio raíz de origen, <filename>file:///autoinst.xml</filename>, si se encuentra en el directorio de nivel superior de un CD-ROM).
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Dispositivo
        </para>
       </entry>
       <entry>
        <para>
         <filename>autoyast=device://<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que deben buscar el archivo de control en un dispositivo de almacenamiento. Solo se necesita el nombre del dispositivo (<filename>/dev/sda1</filename> no es correcto, use <filename>sda1</filename> en su lugar).
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         NFS
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=nfs://<replaceable>servidor</replaceable>/<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que recuperen el archivo de control desde un servidor NFS.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         HTTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=http://<replaceable>servidor</replaceable>/<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que recuperen el archivo de control desde un servidor HTTP.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         HTTPS
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=https://<replaceable>servidor</replaceable>/<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que recuperen el archivo de control desde un servidor HTTPS.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         TFTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=tftp://<replaceable>servidor</replaceable>/<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que recuperen el archivo de control desde un servidor TFTP.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         FTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=ftp://<replaceable>servidor</replaceable>/<replaceable>vía</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Indica a las rutinas de instalación que recuperen el archivo de control desde un servidor FTP.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
   <para>
    Sustituya los marcadores de posición <replaceable>servidor</replaceable> y <replaceable>vía</replaceable> por los valores adecuados según su configuración.
   </para>
   <para>
    AutoYaST incluye una función que permite vincular ciertos perfiles a la dirección MAC del cliente. Sin tener que alterar el parámetro <option>autoyast=</option>, puede lograr que la misma configuración instale varias instancias distintas usando perfiles diferentes.
   </para>
   <para>
    Para ello, siga este procedimiento:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Cree perfiles independientes con la dirección MAC del cliente como nombre de archivo y colóquelos en el servidor HTTP donde se guardan los perfiles de AutoYaST.
     </para>
    </step>
    <step performance="required">
     <para>
      Omita la vía exacta, incluido el nombre de archivo cuando cree el parámetro <option>autoyast=</option>, por ejemplo:
     </para>
<screen>autoyast=tftp://192.168.1.115/</screen>
    </step>
    <step performance="required">
     <para>
      Inicie la instalación automatizada.
     </para>
    </step>
   </procedure>
   <para>
    YaST intenta determinar la ubicación del perfil de la siguiente forma:
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      YaST busca el perfil usando su propia dirección IP en valor hexadecimal en mayúsculas, por ejemplo, <literal>192.0.2.91</literal> es <literal>C000025B</literal>.
     </para>
    </listitem>
    <listitem>
     <para>
      Si no se encuentra este archivo, YaST elimina un dígito hexadecimal y lo intenta de nuevo. Esta acción se repite ocho veces hasta que se encuentra el archivo con el nombre correcto.
     </para>
    </listitem>
    <listitem>
     <para>
      Si se siguen produciendo fallos, intenta buscar un archivo que tenga la dirección MAC del cliente como nombre de archivo. La dirección MAC del cliente de ejemplo es <literal>0080C8F6484C</literal>.
     </para>
    </listitem>
    <listitem>
     <para>
      Si no se encuentra el archivo cuyo nombre es la dirección MAC, YaST buscará un archivo llamado <filename>default</filename> (en minúscula). A continuación figura una secuencia de ejemplo de las direcciones en las que YaST busca el perfil de AutoYaST:
     </para>
<screen>
C000025B 
C000025 
C00002 
C0000 
C000 
C00 
C0 
C 
0080C8F6484C 
default
     </screen>
    </listitem>
   </orderedlist>
  </sect2>

  <sect2 id="sec.deployment.autoinst.simple.source">
   <title>Especificación de los datos de instalación</title>
   <para>
    Los datos de instalación se pueden proporcionar a través del CD o el DVD del producto o bien usando un origen de instalación de red. Si se utilizan los CD del producto como origen de la instalación, se necesitará acceso físico al cliente para poder instalar, ya que el proceso de arranque debe iniciarse manualmente y es necesario cambiar los CD.
   </para>
   <para>
    Para proporcionar los orígenes de instalación a través de la red, configure un servidor de instalación en red (HTTP, NFS o FTP), tal y como se describe en la <xref linkend="sec.deployment.remoteinst.instserver.sles9"/>. Use un archivo <filename>info</filename> para pasar la ubicación del servidor a las rutinas de instalación.
   </para>
  </sect2>

  <sect2 id="sec.deployment.autoinst.simple.boot">
   <title>Configuración del entorno de arranque</title>
   <para>
    El cliente se puede arrancar de distintas formas:
   </para>
   <variablelist>
    <varlistentry>
     <term>Arranque en red</term>
     <listitem>
      <para>
       Al igual que la instalación remota normal, la instalación automatizada puede iniciarse con Wake on LAN y PXE, la imagen de arranque y el archivo de control se pueden obtener mediante TFTP y los orígenes de instalación desde cualquier servidor de instalación en red.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>CD-ROM arrancable</term>
     <listitem>
      <para>
       Puede usar el medio original de SUSE Linux Enterprise para arrancar el sistema para la instalación automatizada y obtener el archivo de control desde una ubicación de red o un medio extraíble. Otra forma de proceder consiste en crear su propio CD-ROM personalizado que incluya tanto los orígenes de instalación como el perfil de AutoYaST.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    En las siguientes secciones se proporciona una descripción básica de los procedimientos para arrancar en red o para arrancar desde el CD-ROM.
   </para>
   <sect3 id="sec.deployment.autoinst.simple.boot.pxe">
    <title>Preparación del arranque en red</title>
    <para>
     Los procedimientos para arrancar en red a través de Wake on LAN, PXE y TFTP se describen en la <xref linkend="sec.deployment.remoteinst.scenario.vncpxe"/>. Para que la configuración introducida funcione para la instalación automatizada, modifique el archivo de configuración de PXE Linux (<filename>/srv/tftp/pxelinux.cfg/default</filename>) para que incluya el parámetro <literal>autoyast</literal> haciendo referencia a la ubicación del perfil de AutoYaST. Una entrada de ejemplo para una instalación estándar tiene este aspecto:
    </para>
<screen>
default linux 

# default label linux 
    kernel linux
    append initrd=initrd install=http://192.168.1.115/install/suse-enterprise/ 
	  
	</screen>
    <para>
     El mismo ejemplo para una instalación automatizada tiene este aspecto:
    </para>
<screen>
default linux 

# default label linux 
    kernel linux
    append initrd=initrd install=http://192.168.1.115/install/suse-enterprise/ \
           autoyast=nfs://192.168.1.110/profiles/autoinst.xml
	</screen>
    <para>
     Sustituya las direcciones IP de ejemplo y las vías por los datos usados realmente en la configuración.
    </para>
   </sect3>
   <sect3 id="sec.deployment.autoinst.simple.boot.cd">
    <title>Preparación del arranque desde un CD-ROM</title>
    <para>
     Hay varias formas mediante las que se puede utilizar un arranque desde un CD-ROM en las instalaciones de AutoYaST. Seleccione una de las opciones siguientes:
    </para>
    <variablelist>
     <varlistentry>
      <term>Arranque desde el medio de SUSE Linux Enterprise: obtención del perfil a través de la red</term>
      <listitem>
       <para>
        Use este enfoque si no es posible realizar una instalación totalmente basada en red (por ejemplo, si el hardware no es compatible con PXE) y dispone de acceso físico al sistema que se va a instalar durante la mayor parte del proceso.
       </para>
       <para>
        Se requiere:
       </para>
       <itemizedlist mark="bullet" spacing="normal">
        <listitem>
         <para>
          El medio de SUSE Linux Enterprise.
         </para>
        </listitem>
        <listitem>
         <para>
          Un servidor de red que proporcione los datos del perfil (consulte la <xref linkend="sec.deployment.autoinst.simple.dist"/> para obtener detalles).
         </para>
        </listitem>
        <listitem>
         <para>
          Un medio extraíble que incluya el archivo <filename>info</filename> que indique a las rutinas de instalación dónde se encuentra el perfil.
         </para>
         <para>
          <emphasis>o</emphasis>
         </para>
         <para>
          Acceda al indicador de arranque del sistema que se va a instalar donde puede escribir manualmente el parámetro <literal>autoyast=</literal>
         </para>
        </listitem>
       </itemizedlist>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term> Arranque e instalación desde el medio de SUSE Linux Enterprise: obtención del perfil de un medio extraíble</term>
      <listitem>
       <para>
        Use este enfoque si no se puede usar una instalación totalmente basada en red. Se requiere acceso físico al sistema que se va a instalar para encender el equipo de destino o, en el segundo caso, para introducir la ubicación del perfil en el indicador de arranque. En ambos casos, también puede que necesite cambiar el medio en función del ámbito de la instalación.
       </para>
       <para>
        Se requiere:
       </para>
       <itemizedlist mark="bullet" spacing="normal">
        <listitem>
         <para>
          El medio de SUSE Linux Enterprise.
         </para>
        </listitem>
        <listitem>
         <para>
          Un medio extraíble que incluya el perfil y el archivo <filename>info</filename>.
         </para>
         <para>
          <emphasis>o</emphasis>
         </para>
         <para>
          Acceda al indicador de arranque del destino y escriba el parámetro <option>autoyast=</option>.
         </para>
        </listitem>
       </itemizedlist>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Arranque e instalación desde un medio personalizado: obtención del perfil desde el medio</term>
      <listitem>
       <para>
        Si necesita instalar un número limitado de paquetes de software y la cantidad de destinos es relativamente baja, puede resultar adecuado crear su propio CD personalizado que incluya tanto los datos de instalación como el perfil, especialmente si no dispone de una red en la configuración.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 id="sec.deployment.autoinst.simple.info">
   <title>Creación del archivo <filename>info</filename></title>
   <para>
    Las rutinas de instalación en el destino deben conocer los diversos componentes de la estructura de AutoYaST. Esto se logra creando una línea de comandos que incluya todos los parámetros necesarios para localizar los componentes de AutoYaST, los orígenes de instalación y los parámetros necesarios para controlar el proceso de instalación.
   </para>
   <para>
    Realice este procedimiento pasando manualmente estos parámetros al indicador de arranque de la instalación o indicando un archivo llamado <filename>info</filename> para que lo lean las rutinas de instalación (linuxrc). El primer método requiere acceso físico a cualquier cliente que vaya a instalar, lo que hace que este enfoque no sea adecuado para las distribuciones grandes. El segundo le permite proporcionar el archivo <filename>info</filename> en algún medio que esté preparado e insertado en las unidades de los clientes antes de comenzar la instalación automatizada. Alternativamente, use el arranque PXE e incluya los parámetros linuxrc en el archivo <filename>pxelinux.cfg/default</filename>, tal y como se especifica en la <xref linkend="sec.deployment.autoinst.simple.boot.pxe"/>.
   </para>
   <para>
    Los siguientes parámetros se utilizan habitualmente para linuxrc. Para obtener más información, consulte la documentación del paquete de AutoYaST, en <filename>/usr/share/doc/packages/autoyast</filename>.
   </para>
   <important>
    <title>separación de parámetros y valores</title>
    <para>
     A la hora de pasar parámetros a linuxrc en el indicador de arranque, use <literal>=</literal> para separar los parámetros de los valores. Cuando use un archivo <filename>info</filename>, separe los parámetros de los valores con <literal>:</literal>.
    </para>
   </important>
   <informaltable>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>
        <para>
         Palabra clave
        </para>
       </entry>
       <entry>
        <para>
         Valor
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         <literal>netdevice</literal>
        </para>
       </entry>
       <entry>
        <para>
         El dispositivo de red que se usa para la configuración de red (para peticiones BOOTP/DHCP). Solo se necesita si hay disponibles varios dispositivos de red.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>hostip</literal>
        </para>
       </entry>
       <entry>
        <para>
         Cuando está vacío, el cliente envía una petición BOOTP. De lo contrario, el cliente se configura usando los datos especificados.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netmask</literal>
        </para>
       </entry>
       <entry>
        <para>
         Máscara de la red seleccionada.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>gateway</literal>
        </para>
       </entry>
       <entry>
        <para>
         Gateway por defecto.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>nameserver</literal>
        </para>
       </entry>
       <entry>
        <para>
         Servidor de nombres
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>autoyast</literal>
        </para>
       </entry>
       <entry>
        <para>
         Ubicación del archivo de control que se debe usar para la instalación automática, por ejemplo, <literal>autoyast=nfs//192.168.1.110/profiles/</literal>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>install</literal>
        </para>
       </entry>
       <entry>
        <para>
         Ubicación del origen de la instalación, por ejemplo, <literal>install=nfs://192.168.1.110/CDs/</literal>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>vnc</literal>
        </para>
       </entry>
       <entry>
        <para>
         Si se establece en <literal>1</literal>, se usará una instalación controlada de forma remota con VNC.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>vncpassword</literal>
        </para>
       </entry>
       <entry>
        <para>
         La contraseña para VNC
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>usessh</literal>
        </para>
       </entry>
       <entry>
        <para>
         Si se establece en <literal>1</literal>, se usará una instalación controlada de forma remota con SSH.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netsetup</literal>
        </para>
       </entry>
       <entry>
        <para>
         El valor <literal>1</literal> configura la red. Normalmente, esto se realiza automáticamente, pero es necesario configurar <literal>netsetup=1</literal> en caso de que el repositorio de instalación se proporcione localmente (por ejemplo, mediante un DVD o una imagen ISO local) y el archivo <filename>info</filename> se cargue desde la red.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
   <para>
    Si el entorno de instalación automatizada incluye la configuración del cliente mediante DHCP y un origen de instalación en red y desea supervisar el proceso de instalación usando VNC, el archivo <filename>info</filename> tendrá este aspecto:
   </para>
<screen>autoyast:<replaceable>profile_source</replaceable> install:<replaceable>install_source</replaceable> vnc:1 vncpassword:<replaceable>some_password</replaceable></screen>
   <para>
    Si prefiere una configuración de red estática en el momento de la instalación, el archivo <filename>info</filename> será como el siguiente:
   </para>
<screen>
autoyast:<replaceable>profile_source</replaceable> \
install:<replaceable>install_source</replaceable> \ 
hostip:<replaceable>some_ip</replaceable> \ 
netmask:<replaceable>some_netmask</replaceable> \ 
gateway:<replaceable>some_gateway</replaceable></screen>
   <para>
    El símbolo <literal>\</literal> indica que los saltos de línea solo se han añadido en beneficio de la legibilidad. Todas las opciones deben introducirse como una cadena continua.
   </para>
   <para>
    Los datos <filename>info</filename> pueden ponerse a disposición de linuxrc de distintas formas:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Como un archivo de un medio extraíble disponible en el cliente durante la instalación. Añada el parámetro correspondiente con la forma <systemitem>info=cd:/info</systemitem>. 
     </para>
    </listitem>
    <listitem>
     <para>
      Como archivo en el directorio raíz del disco RAM inicial usado para arrancar el sistema y proporcionado desde el medio de instalación personalizado o a través del arranque PXE.
     </para>
    </listitem>
    <listitem>
     <para>
      Como parte del perfil de AutoYaST. En este caso, el archivo de AutoYaST debe llamarse <filename>info</filename> para que linuxrc pueda analizarlo. A continuación se muestra un ejemplo de este enfoque.
     </para>
    </listitem>
    <listitem>
     <para>
      Por medio de una URL que dirija a la ubicación del archivo info. La sintaxis en este caso debe ser <systemitem>info=http://www.example.com/info</systemitem>.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    linuxrc busca una cadena (<option>start_linuxrc_conf</option>) en el perfil que representa el inicio del archivo. Si la encuentra, analiza el contenido comenzando por dicha cadena y termina el análisis cuando encuentra la cadena <option>end_linuxrc_conf. </option> Las opciones se almacenan en perfiles de la siguiente forma:
   </para>
<screen>....
  &lt;install&gt;
....
    &lt;init&gt;
      &lt;info_file&gt;
&lt;![CDATA[
#
# Don't remove the following line:
# start_linuxrc_conf
#
install: nfs:<replaceable>server</replaceable>/<replaceable>path</replaceable>
vnc: 1
vncpassword: test
autoyast: file:///info

# end_linuxrc_conf
# Do not remove the above comment
#
]]&gt;

      &lt;/info_file&gt;
    &lt;/init&gt;
......
  &lt;/install&gt;
....
</screen>
   <para>
    linuxrc carga el perfil que contiene los parámetros de arranque en lugar del archivo <filename>info</filename> tradicional. El parámetro <option>install:</option> señala a la ubicación de los orígenes de instalación. <option>vnc</option> y <option>vncpassword</option> indican que se debe utilizar VNC para supervisar la instalación. El parámetro <option>autoyast</option> indica a linuxrc que debe considerar <filename>info</filename> como un perfil de AutoYaST.
   </para>
  </sect2>

  <sect2 id="sec.deployment.autoinst.simple.install">
   <title>Inicio y supervisión de la instalación automatizada</title>
   <para>
    Después de proporcionar todos los datos indicados hasta el momento (el perfil, el origen de la instalación y el archivo <filename>info</filename>), puede continuar e iniciar la instalación automatizada. En función del entorno elegido para arrancar y supervisar el proceso, es posible que se requiera la interacción física con el cliente:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Si el sistema cliente arranca desde cualquier tipo de medio físico (ya sea un medio del producto o un CD personalizado), será necesario insertar el medio en cuestión en las unidades del cliente.
     </para>
    </listitem>
    <listitem>
     <para>
      Si el cliente no se enciende mediante Wake on LAN, deberá, como mínimo, encender el equipo cliente.
     </para>
    </listitem>
    <listitem>
     <para>
      Si no ha optado por una instalación automatizada controlada de forma remota, la respuesta gráfica de AutoYaST se envía a un monitor conectado al cliente o a la consola de serie (en caso de que use un cliente desatendido).
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Para habilitar la instalación automatizada controlada remotamente, use los parámetros VNC o SSH que se describen en la <xref linkend="sec.deployment.autoinst.simple.info"/> y conéctese al cliente desde otro equipo, tal y como se indica en la <xref linkend="sec.deployment.remoteinst.monitor"/>.
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec.deployment.autoinst.advanced">
  <title>Instalación automática basada en reglas</title>

  <para>
   En la siguiente sección se presentan los conceptos básicos de la instalación basada en reglas usando AutoYaST y se proporciona un ejemplo de entorno que le permite crear su propia configuración de instalación automatizada personalizada.
  </para>

  <sect2 id="sec.deployment.autoinst.advanced.expl">
   <title>Descripción de la instalación automatizada basada en reglas</title>
   <para>
    La instalación de AutoYaST basada en reglas permite hacer frente a entornos de hardware heterogéneos:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      ¿Contiene su ubicación hardware de distintos proveedores?
     </para>
    </listitem>
    <listitem>
     <para>
      ¿Tienen los equipos de la ubicación tienen distintas configuraciones de hardware? Por ejemplo, ¿usan dispositivos diferentes o distintos tamaños de disco o memoria?
     </para>
    </listitem>
    <listitem>
     <para>
      ¿Tiene previsto instalar en dominios diferentes y necesita distinguir entre ellos?
     </para>
    </listitem>
   </itemizedlist>
   <para>
    La instalación automática basada en reglas genera un perfil personalizado que se ajusta a la diversidad de los entornos combinando varios perfiles en uno. Cada regla describe una función distintiva concreta de la configuración (como, por ejemplo, el tamaño del disco) e indica a AutoYaST qué perfil debe usar cuando se cumpla una regla. Varias reglas que describen funciones distintas de la configuración se combinan en un archivo <filename>rules.xml</filename> de AutoYaST. El stack de reglas se procesa entonces y AutoYaST genera el perfil final combinando en un único perfil los distintos perfiles que se ajustan a las reglas de AutoYaST. Para ver un ejemplo de este procedimiento, consulte la <xref linkend="sec.deployment.autoinst.advanced.example"/>.
   </para>
   <para>
    AutoYaST basado en reglas ofrece una gran flexibilidad a la hora de planificar y ejecutar una distribución de SUSE Linux Enterprise. Puede:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Crear reglas que se ajusten a cualquiera de los atributos de sistema predefinidos en AutoYaST
     </para>
    </listitem>
    <listitem>
     <para>
      Combinar varios atributos de sistema (como, por ejemplo, el tamaño del disco y la arquitectura del núcleo) en una regla usando operadores lógicos
     </para>
    </listitem>
    <listitem>
     <para>
      Crear reglas personalizadas ejecutando guiones de shell y pasando sus resultados a la estructura de AutoYaST. El número de reglas personalizadas se limita a cinco.
     </para>
    </listitem>
   </itemizedlist>
   <note>
    <para>
     Para obtener más información sobre la creación de reglas y su uso con AutoYaST, consulte la documentación de los paquetes en <filename>/usr/share/doc/packages/autoyast2/html/index.html</filename>, en el capítulo sobre las reglas y las clases.<guimenu/>
    </para>
   </note>
   <para>
    Para preparar una instalación masiva de AutoYaST basada en reglas, siga este procedimiento:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Cree varios perfiles de AutoYaST que incluyan los detalles de instalación necesarios para la configuración heterogénea, tal y como se describe en la <xref linkend="sec.deployment.autoinst.simple.profile"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Defina las reglas para que coincidan con los atributos de sistema de la configuración de hardware, tal y como se muestra en la <xref linkend="sec.deployment.autoinst.advanced.example"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Determine el origen del perfil de AutoYaST y los parámetros que se deben pasar a las rutinas de instalación, según se indica en la <xref linkend="sec.deployment.autoinst.simple.dist"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Determine el origen de los datos de instalación de SUSE Linux Enterprise según se describe en la <xref linkend="sec.deployment.autoinst.simple.source"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Pase la línea de comandos a las rutinas de instalación añadiendo los parámetros manualmente o creando un archivo <filename>info</filename>, tal como se especifica en la <xref linkend="sec.deployment.autoinst.simple.info"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Determine y configure el entorno de arranque para la instalación automatizada, según se especifica en la <xref linkend="sec.deployment.autoinst.simple.boot"/>.
     </para>
    </step>
    <step performance="required">
     <para>
      Inicie el proceso de instalación automatizada de la forma descrita en la <xref linkend="sec.deployment.autoinst.simple.install"/>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 id="sec.deployment.autoinst.advanced.example">
   <title>Situación de ejemplo para una instalación automatizada basada en reglas</title>
   <para>
    Para conseguir unos conocimientos básicos sobre cómo se crean las reglas, piense en el siguiente ejemplo, que aparece en la <xref linkend="fig.autoyast.rules"/>. Una ejecución de AutoYaST instala la siguiente configuración:
   </para>
   <variablelist>
    <varlistentry>
     <term>Un servidor de impresión</term>
     <listitem>
      <para>
       Este equipo solo necesita una instalación mínima sin un entorno de escritorio y un conjunto limitado de paquetes de software.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Estaciones de trabajo del departamento de ingeniería</term>
     <listitem>
      <para>
       Estos equipos necesitan un entorno de escritorio y un conjunto amplio de software de desarrollo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Equipos portátiles del departamento de ventas</term>
     <listitem>
      <para>
       Estos equipos necesitan un entorno de escritorio y un conjunto limitado de aplicaciones especializadas como, por ejemplo, software de oficina y de agenda.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <figure id="fig.autoyast.rules">
    <title>Reglas de AutoYaST</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast_rules.svg" width="90%" format="SVG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="autoyast_rules.png" width="80%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    En el primer paso, use uno de los métodos descritos en la <xref linkend="sec.deployment.autoinst.simple.profile"/> para crear perfiles para cada ejemplo de uso. En este ejemplo, va a crear <filename>print.xml</filename>, <filename>engineering.xml</filename> y <filename>sales.xml</filename>.
   </para>
   <para>
    En el segundo paso, se crean las reglas para distinguir los tres tipos de hardware e indicar a AutoYaST qué perfil debe usar. Use un algoritmo similar al siguiente para configurar las reglas:
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      ¿La IP del equipo es <guimenu>192.168.2.253</guimenu>? Entonces, conviértalo en el servidor de impresión.
     </para>
    </listitem>
    <listitem>
     <para>
      ¿Incluye el equipo hardware PCMCIA y cuenta con un chipset de Intel? Entonces considérelo como un equipo portátil Intel e instale la selección de software del departamento de ventas.
     </para>
    </listitem>
    <listitem>
     <para>
      Si no se cumple ninguna de las circunstancias anteriores, considere el equipo como una estación de trabajo para desarrolladores y realice las instalaciones oportunas.
     </para>
    </listitem>
   </orderedlist>
   <para>
    En líneas generales, esto se convierte en un archivo <filename>rules.xml</filename> con el siguiente contenido:
   </para>
<screen>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall SYSTEM "/usr/share/autoinstall/dtd/rules.dtd"&gt; 
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;hostaddress&gt;
	    &lt;match&gt;192.168.2.253&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/hostaddress&gt;
       &lt;result&gt;
            &lt;profile&gt;print.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;haspcmcia&gt;
            &lt;match&gt;1&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/haspcmcia&gt;
       &lt;custom1&gt;
           &lt;script&gt;
if grep -i intel /proc/cpuinfo &gt; /dev/null; then
echo -n "intel"
else
echo -n "non_intel"
fi;
           &lt;/script&gt;
           &lt;match&gt;*&lt;/match&gt;
           &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/custom1&gt;
       &lt;result&gt;
            &lt;profile&gt;sales.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
        &lt;operator&gt;and&lt;/operator&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
        &lt;haspcmcia&gt;
            &lt;match&gt;0&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
        &lt;/haspcmcia&gt;
 	&lt;result&gt;
            &lt;profile&gt;engineering.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;
</screen>
   <para>
    Cuando distribuya el archivo de reglas, asegúrese de que el directorio <filename>rules</filename> se encuentre en el directorio <filename>profiles</filename> especificado en la dirección URL <filename>autoyast=<replaceable>protocolo</replaceable>:<replaceable>IPservidor</replaceable>/profiles/</filename>. AutoYaST busca un subdirectorio <filename>rules</filename> que incluya un archivo llamado <filename>rules.xml</filename> en primer lugar y, a continuación, carga y combina los perfiles especificados en el archivo de reglas.
   </para>
   <para>
    El resto del procedimiento de instalación automatizada se lleva a cabo de la forma habitual.
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec.deployment.autoinst.moreinfo">
  <title>Información adicional</title>

  <para>

   Para obtener información más detallada acerca de la tecnología de AutoYaST, consulte <phrase os="sles"><xref linkend="book.autoyast"/> o </phrase> la documentación instalada con el software (<filename>/usr/share/doc/packages/autoyast2</filename>).
  </para>
 </sect1>
</chapter>
