<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec.zseries.prep">
 <title>准备安装</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  在本节，您将了解如何使安装进程能够访问数据、如何用不同方法安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，以及如何准备和使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统的 IPL。以及怎样进行网络配置和安装。
 </para>

 <sect2 xml:id="sec.prep.makeavail">
  <title>使安装数据可用</title>
  <para>
   本节详细说明如何使安装进程能够访问 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> IBM z Systems 安装数据。根据您的计算机环境和系统环境，选择 NFS 或 FTP 安装。如果您的环境中运行的是 Microsoft Windows 工作站，您也可以使用 Windows 网络（包括 SMB 协议）在 IBM z Systems 系统上安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。
  </para>
  <tip>
   <title>从 DVD 进行 IPL 操作</title>
   <para>
    从 SUSE Linux Enterprise Server V10 的 Service Pack 1 起，即可以从 DVD 进行 IPL 操作并使用该 DVD 作为安装媒体。如果在设置通过网络提供安装媒体的安装服务器方面有限制，这会非常方便。前提是 FCP 挂接式 SCSI DVD 驱动器。
   </para>
  </tip>
  <note>
   <title>不能<quote>从硬盘</quote>安装</title>
   <para>
    不能通过将 DVD 内容拖至 DASD 上的分区来从硬盘执行安装。
   </para>
  </note>
  <sect3 xml:id="sec.prep.makeavail.linuxws">
   <title>使用 Linux 工作站或 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> DVD</title>
   <para>
    如果您的计算机环境中正在运行 Linux 工作站，请使用该工作站通过 NFS 或 FTP 将安装数据提供给 IBM z Systems 安装进程。如果 Linux 工作站在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 下运行，您可以使用<xref linkend="sec.deployment.instserver.sles9"/>中所述的 YaST <guimenu>安装服务器</guimenu>模块设置安装服务器（NFS 或 FTP）。
   </para>
   <sect4 xml:id="sec.prep.makeavail.linuxws.nfs">
    <title>通过 NFS</title>
    <para>
     通过使用 NFS（网络文件系统）使安装媒体可用。
    </para>
    <important>
     <title>通过 NFS 导出已装入设备。</title>
     <para>
      导出文件系统 root (<filename>/</filename>) 并不意味着导出已装入设备（如 DVD）。在 <filename>/etc/exports</filename> 中为安装点明确命名：
     </para>
<screen>/media/dvd  *(ro)</screen>
     <para>
      更改此文件后，使用 <command>sudo systemctl restart nfsserver</command> 命令重启动 NFS 服务器。
     </para>
    </important>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.ftp">
    <title>通过 FTP</title>
    <para>
     在 Linux 系统上设置 FTP 服务器需要安装服务器软件本身（例如
     <package>pure-ftpd</package>
     或者
     <package>vsftpd</package>
     ）以及执行其他可能的配置任务。如果要使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，请参见<xref linkend="cha.ftp"/>获取安装指导。不支持通过匿名登录方式下载安装数据，因此您需要配置 FTP 服务器以支持用户身份验证。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.oncd">
    <title>DVD 中的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
    <para>
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM z Systems 的 DVD1 包含用于基于 Intel 的工作站的可引导 Linux 映像以及用于 z Systems 的映像。
    </para>
    <para>
     对于基于 Intel 的工作站，从此 DVD 引导，回答关于语言和键盘布局的问题，然后选择<guimenu>启动救援系统</guimenu>。这个操作至少需要 64 MB RAM。不需要任何磁盘空间，因为整个救援系统驻留在工作站 RAM 中。这个操作需要一定的 Linux 和 网络经验，因为您需要手动设置工作站网络。
    </para>
    <para>
     对于 z Systems，按<xref linkend="sec.prep.ipling.lpar.dvd"/>中所述从此 DVD 对 LPAR/VM Guest 执行 IPL 操作。输入网络参数之后，安装系统会将 DVD 视为安装数据的来源。由于 z Systems 不能直接挂接支持 X11 的终端，因此请选择 VNC 或 SSH 安装。SSH 还提供一种图形安装，方式是使用 <command>ssh -X</command> 通过 SSH 为 X 连接提供隧道。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.windowsws">
   <title>使用“ Microsoft Windows 工作站”</title>
   <para>
    如果您网络中有 Microsoft Windows 工作站，则使用该计算机提供安装媒体。完成此操作最简单的方法是使用 Windows 操作系统中已经包含的 SMB 协议。一定要激活 <guimenu>SMB over TCP/IP</guimenu> 这样才能使 SMB 包封装到 TCP/IP 包中。有关详细信息，请参见 Windows 联机帮助或其他有关 Windows 并含网络内容的文档。另外，可以选择使用 FTP。此操作中，Windows 仍然需要一些第三方软件。
   </para>
   <sect4 xml:id="sec.prep.makeavail.windowsws.smb">
    <title>通过 SMB</title>
    <para>
     要通过 SMB 提供安装媒体，只需将 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的 DVD 1 插入 Windows 工作站的 DVD 驱动器。然后，使用 DVD-ROM 驱动器盘符创建一个新的共享，并使其可用于网络中的每个人。
    </para>

    <para>
     YaST 中的安装路径可以是：
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     其中占位符指：
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable>
      </term>
      <listitem>
       <para>
        可选工作组或活动的目录域。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable>
      </term>
      <term><replaceable>PW</replaceable>
      </term>
      <listitem>
       <para>
        可以访问此服务器及其共享的用户的可选用户名和口令。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>服务器名称</replaceable>
      </term>
      <listitem>
       <para>
        共享内容所在的服务器的名称。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>共享路径</replaceable>
      </term>
      <listitem>
       <para>
        共享内容的路径。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>


    <para/>

   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.nfs">
    <title>通过 NFS</title>
    <para>
     参见为 Windows 工作站激活 NFS 服务器服务的第三方产品的文档。包含 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> DVD 的 DVD-ROM 驱动器必须在可用的 NFS 路径中。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.ftp">
    <title>通过 FTP</title>
    <para>
     参考为 Windows 工作站激活 FTP 服务器服务的第三方产品的文档。包含 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> DVD 的 DVD-ROM 驱动器必须在可用的 FTP 路径中。
    </para>
    <para>
     与一些 Microsoft Windows 版本捆绑的 FTP 服务器只实施了 FTP 命令集的一个子集，不适于用来提供安装数据。如果这适用于您的 Windows 工作站，请使用第三方 FTP 服务器来提供所需的功能。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.scsi">
    <title>使用 FCP 挂接式 SCSI DVD 驱动器</title>
    <para>
     如<xref linkend="sec.info.iplopt.dvd"/>所述从 SCSI DVD 进行 IPL 操作之后，安装系统即使用 DVD 作为安装媒体。在这种情况下，FTP、NFS 或 SMB 服务器上不需要安装媒体。但需要 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的网络配置数据，因为在安装期间必须设置网络以通过 VNC 或 X 执行图形安装。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.zpxe_cobbler">
   <title>针对 zPXE 使用 Cobbler 服务器</title>
   <para>
    若要从网络实现 IPL 操作，则要求 Cobbler 服务器提供内核、initrd 和安装数据。Cobbler 服务器的准备工作分为四个步骤：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      导入安装数据
     </para>
    </listitem>
    <listitem>
     <para>
      添加分发包
     </para>
    </listitem>
    <listitem>
     <para>
      添加配置文件
     </para>
    </listitem>
    <listitem>
     <para>
      添加系统
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.import">
    <title>导入安装数据</title>
    <para>
     要导入媒体，在 Cobbler 服务器上必须可以使用安装源 — 可以来自于 DVD 或网络来源。运行以下命令以导入数据：
    </para>
<screen>cobbler import --path=<replaceable>PATH</replaceable><co xml:id="cobbler.import.path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.import.dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="cobbler.import.path">
      <para>
       安装数据的安装点。
      </para>
     </callout>
     <callout arearefs="cobbler.import.dirname">
      <para>
       用于标识已导入产品的字符串，例如 <quote>sles12_s390x</quote>。该字符串用作安装数据所复制到的子目录的名称。在运行于 SUSE Linux Enterprise 上的 Cobbler 服务器中，此目录为 <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>。如果 Cobbler 运行在其他操作系统上，此路径可能会稍有不同。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.add_distro">
    <title>添加分发包</title>
    <para>
     您可以通过添加分发包告知 Cobbler 提供借助 zPXE 实现 IPL 所需的内核及 initrd。在 Cobbler 服务器上运行以下命令，以添加 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM z Systems：
    </para>
<screen>cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.identifier"/> \
  --os-version=sles12<co xml:id="cobbler.add.os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="cobbler.add.initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="cobbler.add.kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.server"/>
    </screen>
    <calloutlist>
     <callout arearefs="cobbler.add.identifier">
      <para>
       该发行套件的自定义标识符，例如<quote>SLES <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP2</phrase></phrase> z Systems</quote>。必须是唯一的。
      </para>
     </callout>
     <callout arearefs="cobbler.add.os">
      <para>
       操作系统标识符。使用 <literal>sles12</literal>。
      </para>
     </callout>
     <callout arearefs="cobbler.add.initrd">
      <para>
       initrd 的路径。该路径的第一部分（<filename>/srv/www/cobbler/ks_mirror/<replaceable>标识符</replaceable>/</filename>）取决于 Cobbler 导入数据的位置以及您在导入安装数据时选择的子目录名称。
      </para>
     </callout>
     <callout arearefs="cobbler.add.kernel">
      <para>
       内核的路径。该路径的第一部分（<filename>/srv/www/cobbler/ks_mirror/<replaceable>标识符</replaceable>/</filename>）取决于 Cobbler 导入数据的位置以及您在导入安装数据时选择的子目录名称。
      </para>
     </callout>
     <callout arearefs="cobbler.add.server">
      <para>
       指向 Cobbler 服务器上的安装目录的 URI。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.profile">
    <title>调整配置文件</title>
    <para>
     添加发行套件（请参见<xref linkend="sec.prep.makeavail.zpxe_cobbler.add_distro"/>）时，系统会自动生成一个包含相应<replaceable>标识符</replaceable>的配置文件。使用以下命令可以进行一些必要的调整：
    </para>
<screen>cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.profile.name"/> --os-version=sles10<co xml:id="cobbler.profile.os"/> --ksmeta=""<co xml:id="cobbler.profile.meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.profile.opts"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.profile.name">
      <para>
       配置文件的标识符。使用添加发行套件时指定的同一字符串。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.os">
      <para>
       操作系统版本. 配置文件应该应用到的分发包。您必须使用此处导入步骤中的 <option>--name=<replaceable>标识符</replaceable></option>指定的字符串。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.meta">
      <para>
       创建 Kickstart 文件的模板所需的选项。它不适用于 SUSE，因此请按示例中所示将其设置为空值。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.opts">
      <para>
       内核参数的空格分隔列表。至少应包含 <literal>install</literal> 参数，如示例中所示。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.system">
    <title>添加系统</title>
    <para>
     所需执行的最后一步是将系统添加到 Cobbler 服务器。需要针对应该通过 zPXE 引导的每个 z Systems Guest 完成系统添加。各 guest 通过其 z/VM 用户 ID 来标识（在下面的示例中，假设 ID 为 <quote>linux01</quote>）。请注意，此 ID 需是小写字母组成的字符串。要添加一个系统，请运行以下命令：
    </para>
<screen>cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     通过 <option>--kopts</option> 选项，您可以指定在 parmfile 中将经常指定的内核和安装参数。这些参数通过以空格分隔的列表进行输入，采用的方式为 <replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>。安装程序会提示您缺少的参数。要实现完全自动化的安装，您需要为联网设备和 DASD 指定所有参数，并提供一个 AutoYaST 文件。下文提供了一个 guest 示例，该 guest 具备 OSA 接口，采用的网络参数与上文相同。
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.dvd_usb_hmc">
   <title>从 HMC 的 DVD 或闪存盘安装</title>
   <para>
    要在 IBM z Systems 服务器上安装 SUSE Linux Enterprise Server，通常需要有网络安装源。不过，在某些环境下，此要求可能无法满足。对于 SUSE Linux Enterprise Server 11 SP2，您可以使用现有的硬件管理控制台 (HMC) DVD 或闪存盘作为安装源，将其安装到 LPAR 上。
   </para>
   <para>
    要从 HMC 的 DVD 或闪存盘中的媒体安装，请执行以下步骤：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      将
     </para>
     <para>
      <option>install=hmc:/</option>
     </para>
     <para>
      添加到 <filename>parmfile</filename>（请参见<xref linkend="sec.appdendix.parm"/>）或内核选项中。
     </para>
     <para/>
    </listitem>
    <listitem>
     <para>
      或者在手动模式下，在 <filename>linuxrc</filename> 中依次选择：
     </para>
     <para>
      <emphasis role="italic">开始安装</emphasis>、
     </para>
     <para>
      <emphasis role="italic">安装</emphasis>和
     </para>
     <para>
      <emphasis role="italic">硬件管理控制台</emphasis>。
     </para>
     <para>
      安装媒体必须插入到 HMC 中。
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>配置网络</title>
    <para>
     在开始安装之前，请记得先在 <filename>linuxrc</filename> 中配置网络。之后将无法传递引导参数，而您很可能需要访问网络。在 <filename>linuxrc</filename> 中，转到<emphasis role="italic">开始安装</emphasis>，然后选择<emphasis role="italic">网络设置</emphasis>。
    </para>
   </important>
   <important>
    <title>Linux 系统必须先引导</title>
    <para>
     请先等到 Linux 系统开始引导，再授予对 HMC 的 DVD 或闪存盘中媒体的访问权限。IPL 操作可能会中断 HMC 与 LPAR 之间的连接。如果第一次尝试使用所述方法失败，您可以授予访问权限，然后再重试 <option>HMC</option> 选项。
    </para>
   </important>
   <note>
    <title>安装存储库</title>
    <para>
     由于指派的暂时性，DVD 或闪存盘文件不会一直作为安装的储存库。如果您需要安装储存库，请注册并使用联机储存库。
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.inst_types">
  <title>安装类型</title>
  <para>
   本节提供以每种安装模式安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 所需执行的步骤的信息，并说明可在何处找到相应的信息。完成前面章节所述的准备工作后，遵循所需安装模式的安装概述，在您的系统上安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。
  </para>
  <para>
   如<xref linkend="sec.prep.makeavail"/>中所述，可使用三种不同的安装模式来安装 Linux on IBM z Systems：
  </para>
  <itemizedlist>
   <listitem>
    <para>
     LPAR 安装
    </para>
   </listitem>
   <listitem>
    <para>
     z/VM 安装
    </para>
   </listitem>
   <listitem>
    <para>
     KVM Guest 安装
    </para>
   </listitem>
  </itemizedlist>
  <procedure xml:id="pro.prep.inst_types.lpar">
   <title>LPAR 安装概述</title>
   <step>
    <para>
     准备安装所需设备。请参见<xref linkend="sec.prep.prep_ipl.natlpar"/>。
    </para>
   </step>
   <step>
    <para>
     对安装系统进行 IPL 操作。请参见<xref linkend="sec.prep.ipling.lpar"/>。
    </para>
   </step>
   <step>
    <para>
     配置网络。请参见<xref linkend="sec.prep.netcfg"/>。
    </para>
   </step>
   <step>
    <para>
     连接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统。请参见 <xref linkend="sec.prep.connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 开始安装，然后对安装好的系统执行 IPL。请参见 <xref linkend="cha.inst"/>。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.vm">
   <title>z/VM 安装的“安装预览”</title>
   <step>
    <para>
     准备安装所需设备。请参见<xref linkend="sec.prep.prep_ipl.vm"/>。
    </para>
   </step>
   <step>
    <para>
     对安装系统进行 IPL 操作。请参见<xref linkend="sec.prep.ipling.vm"/>。
    </para>
   </step>
   <step>
    <para>
     配置网络。请参见<xref linkend="sec.prep.netcfg"/>。
    </para>
   </step>
   <step>
    <para>
     连接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统。请参见 <xref linkend="sec.prep.connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 开始安装，然后对安装好的系统执行 IPL。请参见 <xref linkend="cha.inst"/>。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.kvm">
   <title>KVM Guest 安装概述</title>
   <step>
    <para>
     创建虚拟磁盘映像并写入域 XML 文件。请参见<xref linkend="sec.prep.prep_ipl.kvm"/>。
    </para>
   </step>
   <step>
    <para>
     准备安装目标并对 VM Guest 执行 IPL。请参见<xref linkend="sec.prep.ipling.kvm"/>。
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec.prep.netcfg.data"/>。
    </para>
   </step>
   <step>
    <para>
     连接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统。请参见 <xref linkend="sec.prep.connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 开始安装，然后对安装好的系统执行 IPL。请参见 <xref linkend="cha.inst"/>。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.prep.prep_ipl">
  <title>准备对 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统执行 IPL</title>
  <para/>
  <sect3 xml:id="sec.prep.prep_ipl.natlpar">
   <title>LPAR 安装的 IPL 准备工作</title>
   <para>
    通过相应的激活配置文件和 IOCDS，将 IBM z Systems 系统配置为以 ESA/S390 模式或仅限 Linux 模式启动。有关操作方法的更多信息，请参考 IBM 文档。继续执行 <xref linkend="sec.prep.ipling.lpar"/>。
   </para>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.vm">
   <title>z/VM 安装的 IPL 准备工作</title>
   <para/>
   <sect4 xml:id="sec.prep.prep_ipl.vm.linux_guest">
    <title>添加 Linux Guest</title>
    <para>
     第一步是在系统中挂接和格式化一个或多个要由 z/VM 中 Linux guest 系统使用的 DASD。下一步，在 z/VM 中创建一个新用户。该示例展示了具有以下配置的 <literal>LINUX1</literal> 用户（口令为 <literal>LINPWD</literal>）的目录：1 MB 内存（可扩展到 2 MB），32 MB 已扩展 RAM (XSTORE)，一些小型磁盘 (MDISK)，两个 CPU 及一个 OSA QDIO 设备。
    </para>
    <tip>
     <title>为 z/VM guest 分配内存</title>
     <para>
      为 z/VM guest 系统分配内存时，确保内存大小适合所想要安装类型的需要。请参见<xref linkend="sec.info_sysreq.sysreq.hw.mem"/>。要将内存大小设置为 1 GB，请使用命令 <command>CP DEFINE STORAGE 1G</command>。完成安装之后，将内存大小重设置为所需值。
     </para>
    </tip>
    <example xml:id="ex.prep.prep_ipl.vm.linux_guest.config">
     <title>z/VM 目录的配置</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     此示例使用了 201 迷你磁盘作为 guest 系统主盘。有 200 个柱面的 150 迷你磁盘是 Linux 交换设备。有 2800 柱面的 151 磁盘保存 Linux 安装。
    </para>
    <para>
     使用 <command>DIRM FOR LINUX1 ADD</command>，（作为 <systemitem class="username">MAINT</systemitem> 用 ）将 guest 系统添加到用户目录。输入 guest 名称 (<literal>LINUX1</literal>)，然后按 <keycap>F5</keycap>。设置用户环境的方法：
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     最后一个命令返回一个读者文件编号。此号码用于下一步命令：
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     现在可以作为用户 <systemitem class="username">LINUX1</systemitem> 登录 guest 系统了。
    </para>
    <para>
     如果没有 <literal>dirmaint</literal> 选项，请参见 IBM 文档以设置此用户。
    </para>
    <para>
     进行<xref linkend="sec.prep.ipling.vm"/>。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.kvm">
   <title>KVM Guest 安装的 IPL 准备工作</title>
   <para>
    KVM Guest 安装的先决条件为定义虚拟机的域 XML 文件，以及至少一个用于安装的虚拟磁盘映像。
   </para>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.disk">
    <title>创建虚拟磁盘映像</title>
    <para>
     默认情况下，libvirt 会在 VM 主机服务器的 <filename>/var/lib/libvirt/images/</filename> 中搜索磁盘映像。映像还可以储存在文件系统以外的其他位置，但建议您将所有映像储存在一个位置以便于维护。下面的示例会在 <filename>/var/lib/libvirt/images/</filename> 中创建一个大小为  10 GB 的 qcow2 映像。有关详细信息，请参见<xref linkend="cha.qemu.guest_inst.qemu-img"/>。
    </para>
    <procedure>
     <step>
      <para>
       登录 KVM 主机服务器。
      </para>
     </step>
     <step>
      <para>
       运行以下命令以创建映像：
      </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.domain">
    <title>写入域 XML 文件</title>
    <para>
     域 XML 文件用于定义 VM Guest。要创建域 XML 文件，请使用编辑器打开空文件 <filename>s12-1.xml</filename>，并创建如下例所示的文件。
    </para>
    <example>
     <title>域 XML 文件示例</title>
     <para>
      下面的示例会创建一个采用单一 CPU、1 GB RAM 和上一节（<xref linkend="sec.prep.prep_ipl.kvm.disk"/>）中创建的虚拟磁盘映像的 VM Guest。它假设虚拟服务器所挂接的主机网络接口为 <literal>bond0</literal>。将源设备元素更改为与您的网络设置相匹配。
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s12-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE Sles12&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s12-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s12-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s12lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.ipling">
  <title>对 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统执行 IPL</title>
  <para/>
  <sect3 xml:id="sec.prep.ipling.lpar">
   <title>对 LPAR 安装执行 IPL</title>
   <para>
    可通过不同的方法对 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 执行 IPL，以将其装载到 LPAR 中。最好使用 SE 或 HMC 的<guimenu>从 CD-ROM 或服务器装载</guimenu>功能。
   </para>
   <sect4 xml:id="sec.prep.ipling.lpar.cdrom">
    <title>从 DVD-ROM 进行 IPL 操作</title>
    <para>
     标记要安装的 LPAR，然后选择<guimenu>从 CD-ROM 或服务器装载</guimenu>。将文件位置字段保留为空，或输入第一张 DVD-ROM root 目录的路径，然后选择继续。在显示的选项列表中选择默认选项。此时，<guimenu>操作系统消息</guimenu>应该显示内核引导消息。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.lpar.dvd">
    <title>从 FCP 挂接式 SCSI DVD 进行 IPL 操作</title>
    <para>
     您可以选择 <guimenu>SCSI</guimenu> 作为<guimenu>装载类型</guimenu>使用<guimenu>装载</guimenu>过程，以从 SCSI 进行 IPL。输入 SCSI 网桥或储存提供的 WWPN（全球端口名称）和 LUN 逻辑单元号（16 位数，不要省略尾部的 0）。必须选择 2 作为引导程序。使用 FCP 适配器作为<guimenu>装载地址</guimenu>并执行 IPL。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.vm">
   <title>对 z/VM 安装执行 IPL</title>
   <para>
    本节介绍如何对安装系统执行 IPL，以便在 z/VM 系统上安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM z Systems。
   </para>
   <sect4 xml:id="sec.prep.ipling.vm.reader">
    <title>从 z/VM 阅读器进行 IPL 操作</title>
    <para>
     在新定义的 z/VM Guest 中需要有效的 TCP/IP 连接和 FTP 客户端程序，以通过 FTP 传送安装系统。为 z/VM 设置 TCP/IP 不在本手册的讨论范围内。请参考相关的 IBM 文档。
    </para>
    <para>
     作为 z/VM Linux guest 系统登录并 IPL。使 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM z Systems DVD  1 中 <filename>/boot/s390x</filename> 目录的内容可在网络中通过 FTP 访问。从此目录中获取文件 <filename>linux</filename>、<filename>initrd</filename>、<filename>parmfile</filename> 以及 <filename>sles12.exec</filename>。用固定的 80 字符的块大小来传送文件。用 FTP 命令 <command>locsite fix 80</command> 来指定它。<filename>linux</filename>（Linux 内核）和 <filename>initrd</filename>（安装映像）必须以二进制文件格式复制，因此请使用 <literal>binary</literal> 传输模式。<filename>parmfile</filename> 和 <filename>sles12.exec</filename> 需要在 ASCII 模式下传送。
    </para>
    <para>
     该示例展示了所需步骤。在此示例中，需要的文件可以通过 FTP 服务器从 IP 地址 <literal>192.168.0.3</literal> 访问，登录名为 <systemitem class="username">lininst</systemitem>。可能与您的网络不一致。
    </para>
    <example xml:id="ex.prep.ipling.vm.reader.ftp.ftptrans">
     <title>通过 FTP 传送二进制文件。</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles12.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles12.exec sles12.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles12.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     使用下载的 REXX 脚本 sles12.exec 对 Linux 安装系统执行 IPL。此脚本装载用于 IPL 的内核、parmfile 及 初始 RAM 磁盘到阅读器。
    </para>
    <example xml:id="sex.prep.ipling.vm.reader.startscript.slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     使用此脚本，您可以通过命令 <command>sles12</command> 对 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统执行 IPL。Linux 便会开启并打印其引导信息。
    </para>
    <para>
     要继续安装，请转至<xref linkend="sec.prep.netcfg"/>。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.dvd">
    <title>从 FCP 挂接式 SCSI DVD 进行 IPL 操作</title>
    <para>
     要在 z/VM 中进行 IPL 操作，请通过使用 SET LOADDEV 参数准备 SCSI IPL 过程。
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     用相应值设置 LOADDEV 参数后，对您的 FCP 适配器进行 IPL 操作，例如：
    </para>
<screen>IPL FC00</screen>
    <para>
     要继续安装，请转至<xref linkend="sec.prep.netcfg"/>。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.zpxe">
    <title>使用 zPXE 从 Cobbler 服务器实现 IPL</title>
    <para>
     要使用 zPXE 从 Cobbler 服务器实现 IPL，您需要通过 FTP 将 <filename>zpxe.rexx</filename> 脚本从 Cobbler 服务器传送至您的 z/VM Guest。z/VM guest 需要使用正在运行的 TCP/IP 连接和 FTP 客户端程序。
    </para>
    <para>
     以 z/VM Linux guest 的身份登录，并将脚本以 ASCII 模式固定在 80 个字符的大小内进行 IPL 和传送（相关示例请参见<xref linkend="ex.prep.ipling.vm.reader.ftp.ftptrans"/>）。<filename>Zpxe.rexx</filename> 脚本可在 Cobbler 服务器上的 <filename>/usr/share/doc/packages/s390-tools/</filename> 中获得。
    </para>
    <para>
     <filename>Zpxe.rexx</filename> 用来替换您 Guest 中的 <filename>PROFILE EXEC</filename>。为现有的 <filename>PROFILE EXEC</filename> 创建备份，并将 <filename>ZPXE REXX</filename> 重命名为 <filename>PROFILE EXEC</filename>。或者，在现有的 <filename>PROFILE EXEC</filename> 中另起一行输入 <literal>'ZPXE REXX'</literal>，以调用 <filename>ZPXE EXEC</filename>。
    </para>
    <para>
     最后一步是创建配置文件 <filename>ZPXE CONF</filename>，告知 <filename>ZPXE REXX</filename> 要联系哪个 Cobbler 服务器，以及对哪个磁盘执行 IPL。运行 <command>xedit zpxe conf a</command> 并使用以下内容（请根据实际情况替换示例数据）创建 <filename>ZPXE CONF</filename>。
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     下次登录到您的 z/VM Guest 时，系统将连接 Cobbler 服务器。如果在 Cobbler 服务器上安排了安装计划，则会按计划执行。若要安排安装计划，请在 Cobbler 服务器上运行以下命令。
    </para>
<screen>cobbler system edit --name <replaceable>ID</replaceable><co xml:id="cobbler.sysedit.id"/> --netboot-enabled 1<co xml:id="cobbler.sysedit.netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="cobbler.sysedit.profile"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.sysedit.id">
      <para>
       z/VM 用户 ID。
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.netboot">
      <para>
       启用从网络实现 IPL 的功能。
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.profile">
      <para>
       现有的配置文件名称，请参见<xref linkend="sec.prep.makeavail.zpxe_cobbler.profile"/>。
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.kvm">
   <title>对 KVM Guest 安装执行 IPL</title>
   <para>
    要启动 Guest 安装，需要先启动<xref linkend="sec.prep.prep_ipl.kvm.disk"/>中定义的 VM Guest。进行此安装的先决条件是首先使执行 IPL 所需的内核和 initrd 可用。
   </para>
   <sect4 xml:id="sec.prep.ipling.kvm.prep">
    <title>准备安装源</title>
    <para>
     安装系统的内核和 initrd 需要复制到 VM 主机服务器，才能将 VM Guest IPL 到安装系统。
    </para>
    <procedure>
     <step>
      <para>
       登录 KVM 主机，并确保您可以连接到提供安装源的远程主机或设备。
      </para>
     </step>
     <step>
      <para>
       将以下两份文件从安装源复制到 <filename>/var/lib/libvirt/images/</filename>。如果数据由远程主机提供，请使用 <command>ftp</command>、<command>sftp</command> 或 <command>scp</command> 传送文件：
      </para>
      <simplelist>
       <member><filename>/boot/s390x/initrd</filename> </member> <member><filename>/boot/s390x/cd.ikr</filename> </member>
      </simplelist>
     </step>
     <step>
      <para>
       重命名 KVM 主机上的文件：
      </para>
<screen>cd /var/lib/libvirt/images/
mv initrd s12-initrd.boot
 mv cd.ikr s12-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.kvm.">
    <title>对 VM Guest 执行 IPL</title>
    <para>
     要对 VM Guest 执行 IPL，请登录 KVM 主机并运行以下命令：
    </para>
<screen>virsh  create s12-1.xml --console</screen>
    <para>
     VM Guest 启动完成后，安装系统便会启动，您将看到以下讯息：
    </para>
<screen>Domain s12-1 started
Connected to domain s12-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     回答 <guimenu>2) 否</guimenu>并在下一步中选择<guimenu>安装</guimenu>。操作过程，参见 <xref linkend="sec.prep.netcfg.data"/>。
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.netcfg">
  <title>网络配置</title>
  <para>
   耐心等待，直到内核已经完成其启动例程。如果您以基础模式或在 LPAR 中安装，则在 HMC 或 SE 上打开<guimenu>操作系统消息</guimenu>。
  </para>
  <para>
   首先，请在 Linuxrc 主菜单中选择<guimenu>开始安装</guimenu>，然后选择<guimenu>启动安装或更新</guimenu>以启动安装过程。选择<guimenu>网络</guimenu>作为安装媒体，然后选择要用于安装的网络协议类型。<xref linkend="sec.prep.makeavail"/>描述了如何为各种网络连接类型提供安装数据。目前支持 <guimenu>FTP</guimenu>、 <guimenu>HTTP</guimenu>、<guimenu>NFS</guimenu> 和 <guimenu>SMB/CIFS</guimenu>（Windows 文件共享）。
  </para>
  <para>
   现在，从可用设备列表中选择用于接收安装数据的 OSA 或 HiperSockets 网络设备。该列表可能也包含 CTC、ESCON 或 IUCV 设备，但 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 不再支持这些设备。
  </para>
  <sect3 xml:id="sec.prep.netcfg.hypersockets">
   <title>配置 HiperSockets 接口</title>
   <para>
    从网络设备列表中选择 Hipersocket 设备。然后，输入读取、写入和数据通道的编号：
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.types">
    <title>支持的网络连接类型和驱动程序参数</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.800]&gt; 0.0.800

Device address for write channel. (Enter '+++' to abort).
[0.0.801]&gt; 0.0.801

Device address for data channel. (Enter '+++' to abort).
[0.0.802]&gt; 0.0.802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.osa">
   <title>配置 OSA Express 设备</title>
   <para>
    从网络设备列表中选择一个 OSA Express 设备，并提供端口号。然后，输入读取、写入和数据通道的编号及端口号（如果适用）。选择是否启用 OSI Layer 2 支持。
   </para>
   <para>
    添加端口号是为了支持新的双端口 OSA Express 3 网络设备。如果不使用 OSA Express 3 设备，请输入 <literal>0</literal>。OSA Express 网卡具有以 <quote>OSI 第 2 层支持</quote>模式运行或使用较旧的更常见的<quote>第 3 层</quote>模式运行的选项。网卡模式影响共享该设备的所有系统，包括其他 LPAR 上的系统。如果不确定，请指定 <literal>2</literal> 以与其他操作系统（例如 z/VM 和 z/OS）使用的默认模式兼容。有关这些选项的更多信息，请咨询硬件管理员。
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.gigabit.param">
    <title>网络设备驱动器参数</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.data">
   <title>设置网络并选择安装源</title>
   <para>
    输入所有网络设备参数后，相关的驱动程序即会安装到系统中，而您将会看到相应的内核讯息。
   </para>
   <para>
    然后，决定是否使用 DHCP 自动配置来设置网络接口的参数。因为 DHCP 只能在少数设备上工作，并且需要特殊的硬盘配置设置，您可能会想在此选<guimenu>否</guimenu>。如果执行此操作，系统会提示您输入以下网络参数：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      要安装的系统的 IP 地址
     </para>
    </listitem>
    <listitem>
     <para>
      相应的网络掩码（如果未随 IP 地址指定）
     </para>
    </listitem>
    <listitem>
     <para>
      用于连接服务器的网关的 IP 地址
     </para>
    </listitem>
    <listitem>
     <para>
      域名服务器 (DNS) 涵盖的搜索域列表
     </para>
    </listitem>
    <listitem>
     <para>
      域名服务器的 IP 地址
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex.prep.netcfg.vm.network_setup">
    <title>网络参数</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    最后，系统会提示您输入有关安装服务器的细节，例如 IP 地址、包含安装数据的目录，以及登录身份凭证。输入所有必需的数据后，即会装载安装系统。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.connect">
  <title>连接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统</title>
  <para>
   装载安装系统后，Linuxrc 需要知道您想要用来控制安装过程的显示类型。可能的选择有 <literal>X11</literal>（X Window 系统）、<literal>VNC</literal>（虚拟网络计算协议）、<literal>SSH</literal>（文本模式或通过安全外壳的 X11 安装）或 <literal>ASCII 控制台</literal>。建议选择 <literal>VNC</literal> 或 <literal>SSH</literal>。
  </para>
  <para>
   如果您选择最后一个选项（<literal>ASCII 控制台</literal>），YaST 将以文本模式启动，并且您可以直接在终端内执行安装。有关如何在文本模式下使用 YaST 的说明，请参见<xref linkend="cha.yast.text"/>。仅当在 LPAR 中安装时，<literal>ASCII 控制台</literal>才有用。
  </para>
  <note>
   <title>ASCII 控制台的终端仿真</title>
   <para>
    要在文本模式下使用 YaST，需要在具有 VT220/Linux 仿真功能（也称为 <literal>ASCII 控制台</literal>）的终端中运行该程序。举例而言，您无法在 3270 终端中使用 YaST。
   </para>
  </note>
  <sect3 xml:id="sec.inst.connect.vnc_inst">
   <title>初始化 VNC 安装</title>
   <procedure>
    <step>
     <para>
      选择 <literal>VNC</literal> 安装选项后，VNC 服务器会启动。控制台显示的简短信息提供与 vncviewer 连接所需的 IP 地址和显示编号。或者，显示要填入您支持 Java 的浏览器的 URL来连接到安装系统。
     </para>
    </step>
    <step>
     <para>
      启动客户端系统上的 VNC 客户端应用程序。请使用 vncviewer 或 VNC Java 客户端和一个支持 Java 的 Web 浏览器。
     </para>
    </step>
    <step>
     <para>
      出现提示后，输入 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装系统的 IP 地址和显示编号。
     </para>
     <para>
      如果通过支持 Java 的浏览器连接, 输入包含 IP 地址的安装系统的 URL 和正确的端口名，以下面的格式：
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      建立连接后，使用 YaST 开始安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.x">
   <title>初始化 X Window 系统的安装</title>
   <important>
    <title>X 身份验证机制</title>
    <para>
     在 Window 系统直接安装依赖于一个基于主机名的 原始鉴定机制。此机制在当前的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 版本上已禁用。最好以 SSH 或 VNC 安装。
    </para>
   </important>
   <procedure>
    <step>
     <para>
      确保 X 服务器允许客户端（已安装的系统）连接。在文件 <filename>/etc/sysconfig/displaymanager</filename> 中设置变量 <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command>。然后重启动 X 服务器，使用 <command>xhost &lt;client IP address&gt;</command> 允许客户端绑定到服务器。
     </para>
    </step>
    <step>
     <para>
      如果安装系统提示，则输入运行 X 服务器的计算机的 IP 地址。
     </para>
    </step>
    <step>
     <para>
      等到 YaST 打开，然后开始安装。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.ssh">
   <title>初始化 SSH 安装</title>
   <para>
    要使用 SSH 连接到名为 <literal>earth</literal> 的安装系统，请执行 <command>ssh -X earth</command>。如果您的工作站在 Microsoft Windows 上运行，请使用 SSH 和 telnet 客户端以及终端仿真器 Putty（可从 <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/> 获取）。在 Putty 中的<menuchoice><guimenu>连接</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu></menuchoice> 下设置<guimenu>启用 X11 转发</guimenu>。如果使用另一个操作系统，请执行 <command>ssh -X earth</command> 以连接到名为 <systemitem>earth</systemitem> 的安装系统。如果您有可用的本地 X 服务器，则支持通过 SSH 的 X-Forwarding。否则，YaST 会通过 ncurses 提供一个文本接口。
   </para>
   <para>
    出现一个登录提示。输入 <literal>root</literal> 然后使用您的口令登录。输入 <command>yast.ssh</command> 启动 YaST。然后，YaST 将引导您完成安装。
   </para>
   <para>
    转至<xref linkend="cha.inst"/>了解安装过程的详细描述。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.boot_procedure">
  <title>IBM z Systems 上的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 引导过程</title>
  <para>
   SLES 10 和 11 的引导过程遵循下面提供的模式。有关更深入的信息，请参见 <link xlink:href="http://www.ibm.com/developerworks/linux/linux390/documentation_suse.html"/> 上提供的文档。
  </para>
  <orderedlist>
   <listitem>
    <para>
     提供内核。
    </para>
   </listitem>
   <listitem>
    <para>
     为给定的内核提供或创建 initrd。
    </para>
   </listitem>
   <listitem>
    <para>
     在 <filename>/etc/zipl.conf</filename> 中为 initrd 和内核提供正确的路径。
    </para>
   </listitem>
   <listitem>
    <para>
     将 <filename>/etc/zipl.conf</filename> 提供的配置安装到系统中。
    </para>
   </listitem>
  </orderedlist>
  <para>
   在 SLES 12 中，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 在 IBM z Systems 上的引导方式已发生变化。这种变化是以下多方面的原因造成的：
  </para>
  <itemizedlist>
   <listitem>
    <para>
     与其他体系结构相一致：从管理的立场来看，系统的行为在所有体系结构上应该保持一致。
    </para>
   </listitem>
   <listitem>
    <para>
     Btrfs：zipl 引导加载程序在技术上与 SLES 的新默认根文件系统 Btrfs 不兼容（有关细节，请参见<xref linkend="sec.filesystems.major.btrfs"/>）。
    </para>
   </listitem>
   <listitem>
    <para>
     支持使用 Snapper 进行系统回滚：Snapper 与 Btrfs 相结合能够提供可引导的系统快照，使用这些快照便可进行系统回滚（有关细节，请参见<xref linkend="cha.snapper"/>）。
    </para>
   </listitem>
  </itemizedlist>
  <para>
   出于这些原因，从 SLES 12 开始，GRUB 2 将取代 IBM <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for z Systems 上的 zipl。AMD64/Intel 64 体系结构上的 GRUB 2 包含固件级别上的设备驱动程序，以用于访问文件系统。大型机上没有固件，将 <literal>ccw</literal> 添加到 GRUB 2 不仅是一个繁重的任务，而且还相当于在 GRUB 2 中重新实施 zipl。因此，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 使用两阶段方案：
  </para>
  <variablelist>
   <varlistentry>
    <term>阶段一：</term>
    <listitem>
     <para>
      将包含内核和 initrd 的独立分区装入 <filename>/boot/zipl</filename>（有点类似于 UEFI 平台上的 <filename>/boot/efi</filename>）。使用 <filename>/boot/zipl/config</filename> 中的配置通过 zipl 装载此内核和 initrd。
     </para>
     <para>
      此配置会将关键字 <literal>initgrub</literal> 添加到内核命令行。内核与 initrd 装载好后，initrd 将激活装入根文件系统所需的设备（请参见 <filename>/boot/zipl/active_devices.txt</filename>）。然后，GRUB 2 用户空间程序将会启动，读取 <filename>/boot/grub2/grub.cfg</filename>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>阶段二：</term>
    <listitem>
     <para>
      通过 <command>kexec</command> 启动 <filename>/boot/grub2/grub.cfg</filename> 中指定的内核与 initrd。<filename>/boot/zipl/active_devices.txt</filename> 中列出的所有设备都将激活，然后装入根文件系统，之后引导过程将会像在其他体系结构上一样继续。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>
</sect1>
