<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
<!ENTITY % entities SYSTEM "entity-decl.ent">
%entities;
]>
<chapter xml:id="cha-docker-overview" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.0"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Product Overview</title>
 <remark>toms 2019-02-04: add here some sentence</remark>
 <sect1 xml:id="Docker-Used-Drivers">
  <title>&docker; Drivers</title>
  <remark>toms 2019-02-04: add here some sentence</remark>
  <sect2 xml:id="Container_Drivers">
   <title>Container Drivers</title>
   <para>
    &deng; uses
    <link xlink:href="https://github.com/docker/libcontainer">libcontainer</link>
    as the back-end driver to handle containers.
   </para>
  </sect2>

  <sect2 xml:id="sec-docker-storaged">
   <title>Storage Drivers</title>
   <para>
    &deng; supports different storage drivers:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <systemitem class="resource">vfs</systemitem>: this driver is
      automatically used when the &docker; host file system does not support
      copy-on-write. This is a simple driver which does not offer some
      advantages of &deng; (like sharing layers, more on that in the next
      sections). It is highly reliable but also slow.
     </para>
    </listitem>
    <listitem>
     <para>
      <systemitem class="resource">devicemapper</systemitem>: this driver
      relies on the device-mapper thin provisioning module. It supports
      copy-on-write, hence it offers all the advantages of &deng;.
     </para>
    </listitem>
    <listitem>
     <para>
      <systemitem class="resource">btrfs</systemitem>: this driver relies on
      Btrfs to provide all the features required by &deng;. To use this driver
      the <filename>/var/lib/docker</filename> directory must be on a Btrfs
      file system.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Since &productname;&nbsp;12, the Btrfs file system is used by default, which leads &deng; to
    use the <systemitem class="resource">btrfs</systemitem> driver.
   </para>
   <para>
    It is possible to specify which driver to use by changing the value of the
    <envar>DOCKER_OPTS</envar> variable defined inside of the
    <filename>/etc/sysconfig/docker</filename> file. This can be done either
   manually or using &yast; by browsing to <menuchoice>
    <guimenu>System</guimenu> <guimenu>/etc/sysconfig Editor</guimenu>
    <guimenu>System</guimenu> <guimenu>Management</guimenu>
    <guimenu>DOCKER_OPTS</guimenu> </menuchoice> menu and entering the
    <systemitem class="library">-s storage_driver</systemitem> string.
   </para>
   <para>
    For example, to force the usage of the
    <systemitem class="resource">devicemapper</systemitem> driver enter the
    following text:
   </para>
   <screen>DOCKER_OPTS="-s devicemapper"</screen>
   <important>
    <title>Mounting <filename>/var/lib/docker</filename></title>
    <para>
     It is recommended to have <filename>/var/lib/docker</filename> mounted on
     a separate partition or volume to not affect the operating system that
     &deng; runs on in case of a file system corruption.
    </para>
    <remark condition="clarity">
     2017-03-13 - fs: For SLE 12 SP3, check whether this still applies. Maybe a
     subvolume will be created by default, see bsc#1020298.
    </remark>
    <para>
     In case you choose the Btrfs file system for
     <filename>/var/lib/docker</filename>, it is strongly recommended to create
     a subvolume for it. This ensures that the directory is excluded from file
     system snapshots. If not excluding <filename>/var/lib/docker</filename>
     from snapshots, the file system will likely run out of disk space soon
     after you start deploying containers. In addition, a rollback to a
     previous snapshot will also reset the &docker; database and images.
     For more information, see
     <xref linkend="sec-snapper-setup-customizing-new-subvolume"/>.
    </para>
   </important>
  </sect2>
 </sect1>
</chapter>
