<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="zseries_rescue_initrd.xml" version="5.0" xml:id="sec-zseries-rescue"> <title>IBM Z: initrdのレスキューシステムとしての使用</title>

 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker/>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
    </info>
    <para>
  SUSE® Linux Enterprise Server for IBM Zのカーネルをアップグレードまたは変更した場合、何らかの原因でシステムが不整合な状態で再起動されると、インストールされているシステムのIPL標準処理が失敗する可能性があります。このような場合は、インストールシステムをレスキューのために使用できます。
 </para>

 <para>
  SUSE Linux Enterprise Server for IBM ZのインストールシステムをIPL(再起動)します(<xref linkend="sec-zseries-prep"/>を参照)。<guimenu>Start Installation (インストールの開始)</guimenu>を選択し、必要なパラメータをすべて入力します。インストールシステムがロードされて、インストールの制御にどの表示タイプを使用するか尋ねられたら、［<literal>SSH</literal>］を選択します。これで、パスワードを使用せずに、<systemitem class="username">root</systemitem>としてSSHを使用してシステムにログインできるようになります。
 </para>

 <para>
  この状態では、設定されているディスクはありません。作業を続行する前に、ディスクを設定する必要があります。
 </para>

 <procedure>
  <title>DASDの設定</title>
  <step>
   <para>
    DASDを設定するには、以下のコ\'83\'7dンドを使用します。
   </para>
<screen>dasd_configure 0.0.0150 1 0</screen>
   <para>
    ここで、「0.0.0150」は、DASDが接続されているチャネルを表します。<literal>1</literal>は、ディスクをアクティブにすることを表しています(ここに<literal>0</literal>を指定すると、ディスクが無効になる)。<literal>0</literal>は、ディスクに<quote>DIAGモード</quote>でアクセスしないことを表します(ここに<literal>1</literal>を指定すると、ディスクへのDAIGアクセスが有効になります)。
   </para>
  </step>
  <step>
   <para>
    DASDがオンラインになり(<command>cat /proc/partitions</command>で確認)、コマンドを使用できるようになります。
   </para>
  </step>
 </procedure>

 <procedure>
  <title>zFCPディスクの設定</title>
  <step>
   <para>
    zFCPディスクを設定するには、まずzFCPアダプタを設定する必要があります。そのためには次のコマンドを使用します。
   </para>
<screen>zfcp_host_configure 0.0.4000 1</screen>
   <para>
    <literal>0.0.4000</literal>はアダプタが接続されているチャネルを、<literal>1</literal>(ここに<literal>0</literal>を指定するとアダプタが無効になる)はアクティブにすることを示します。
   </para>
  </step>
  <step>
   <para>
    アダプタをアクティブにしたら、ディスクを設定することができます。そのためには次のコマンドを使用します。
   </para>
<screen>zfcp_disk_configure 0.0.4000 1234567887654321 8765432100000000  1</screen>
   <para>
    <literal>0.0.4000</literal>は前に使われていたチャネルIDを、<literal>1234567887654321</literal>はWWPN(World wide Port Number)を、そして<literal>8765432100000000</literal>はLUN(論理ユニット番号)を表しています。<literal>1</literal>(ここに<literal>0</literal>を指定するとディスクが無効になる)は、ディスクをアクティブにすることを表しています。
   </para>
  </step>
  <step>
   <para>
    zFCPディスクがオンラインになり(<command>cat /proc/partitions</command>で確認)、コマンドを使用できるようになります。
   </para>
  </step>
 </procedure>

 <para>
  これで、レスキューシステムが完全に設定され、インストールされたシステムの修復を開始できます。最も一般的な問題の修復方法については、<xref linkend="sec-trouble-data-recover-rescue"/>を参照してください。
 </para>
</sect1>
