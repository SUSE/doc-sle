<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="update_split_brain.xml" id="sec.update.split-brain">
 <title>Aggiornamento atomico</title>

 <para>
  L'aggiornamento atomico si basa su strumenti che gestiscono due copie del sistema, consentendo così un semplice recupero dopo un aggiornamento non riuscito. Gli strumenti forniti richiedono una configurazione della partizione del disco particolare. Ogni copia del sistema si trova in una propria partizione primaria. Nel caso in cui un aggiornamento non riuscisse, è comunque possibile tornare allo stato precendente del sistema, disponibile sull'altra partizione.
 </para>



 <sect2 id="cha.update.split-brain.setup">
  <title>Configurazione</title>
  <warning>
   <title>requisiti di partizionamento obbligatori</title>
   <para>
    L'implementazione ha dei requisiti precisi per la partizione del disco: la prima partizione radice è <filename>/dev/sda1</filename> ed è necessario che occupi meno della metà del disco. Per la seconda partizione radice del sistema, gli strumenti creeranno <filename>/dev/sda2</filename>. Altre eventuali partizioni vengono condivise su entrambe le partizioni radice: considerare le dimensioni e ridurre conseguentemente le dimensioni della prima partizione; questo è un calcolo di esempio:
   </para>
   <para>
    le dimensioni del disco interno meno le dimensioni di <systemitem>sda1</systemitem> meno <systemitem>sda2</systemitem> indicano lo spazio disponibile per le partizioni aggiuntive.
   </para>
  </warning>
  <procedure>
   <step performance="required">
    <para>
     Installare il sistema con <filename>/dev/sda1</filename> come partizione radice singola e con meno della metà dello spazio su disco.
    </para>
   </step>
   <step performance="required">
    <para>
     Personalizzare il sistema installato. Verificare che il pacchetto <systemitem>multi-update-tools</systemitem> sia installato.
    </para>
   </step>
   <step performance="required">
    <para>
     Eseguire <command>multi-update-setup --partition</command>, in questo modo viene creata la seconda partizione radice del sistema (<filename>/dev/sda2</filename>) di dimensioni simili.
    </para>
   </step>
   <step performance="required">
    <para>
     Eseguire la partizione del resto del disco secondo le proprie esigenze e proseguire con la personalizzazione (*).
    </para>
   </step>
   <step performance="required">
    <para>
     Per copiare il sistema in un'altra partizione, eseguire <command>multi-update-setup --clone</command>. Utilizzando questo comando è inoltre possibile modificare l'<filename>/</filename>elemento (radice) in <filename>/etc/fstab</filename> del sistema di destinazione.
    </para>
   </step>
   <step performance="required">
    <para>
     Se necessario, procedere con la personalizzazione (*).
    </para>
   </step>
   <step performance="required">
    <para>
     Per inizializzare la configurazione di boot loader eseguire <command>multi-update-setup --bootloader</command>. Il menu di boot loader in questo modo conterrà un elemento per avviare l'altro sistema.
    </para>
    <warning>
     <title>Boot Loader GRUB 2 obbligatorio</title>
     <para>
      L'installazione del boot loader GRUB 2 è obbligatoria. Gli strumenti non sono compatibili con altri boot loader.
     </para>
    </warning>
   </step>
   <step performance="required">
    <para>
     Se non sono necessarie personalizzazioni alle voci contrassegnate con (*), eseguire il comando <command>multi-update-setup --complete</command> che consente di eseguire tutti e tre i passaggi.
    </para>
   </step>
  </procedure>
 </sect2>



 <sect2 id="cha.update.split-brain.updating">
  <title>Aggiornamento dell'altro sistema</title>
  <para>
   Eseguire <command>multi-update</command>. Questo comando esegue <command>zypper</command> in un ambiente <systemitem>chroot</systemitem> e aggiorna l'altro sistema: non importa quale sia attivo. Per default, al momento dell'avvio viene visualizzato il menu di avvio.
  </para>
 </sect2>



 <sect2 id="cha.update.split-brain.touble">
  <title>Soluzione dei problemi</title>
  <para>
   Se il sistema, dopo essere aggiornato, ha un boot loader danneggiato, è necessario modificare il flag <quote>Attivo</quote> e impostarlo per la partizione radice dell'altro sistema per avviarlo.
  </para>
  <para>
   Se il sistema aggiornato non si avvia, per selezionare l'altro sistema è necessario accedere al menu di boot loader.
  </para>
  <para>
   Per ulteriori informazioni su GRUB 2, vedere <xref linkend="cha.grub2"/>.
  </para>
 </sect2>

 <sect2 id="cha.update.split-brain.limitation">
  <title>Limitazione</title>
  <para>
   La partizione radice deve essere montata in base al nome della partizione, all'ID o in un altro modo. Il montaggio in base all'UUID della partizione o all'etichetta non è supportato.
  </para>
 </sect2>



 <sect2 id="cha.update.split-brain.info">
  <title>Ulteriori informazioni</title>
  <para>
   Per ulteriori informazioni, consultare <filename>/usr/share/doc/packages/multi-update-tools/README</filename> in dotazione con il pacchetto <systemitem>multi-update-tools</systemitem>.
  </para>
 </sect2>
</sect1>
