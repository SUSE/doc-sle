<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ay_partitioning.xml" version="5.0" xml:id="CreateProfile-Partitioning">
  <title>分区</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>是</dm:translation>
  </dm:docmanager>
 </info>

  <para>
    在涉及到分区时，我们可以将 AutoYaST 用例分为三个不同的级别：
   </para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      自动分区。用户不关心分区，并信任 AutoYaST 会采取适当的做法。
     </para>
    </listitem>
    <listitem>
     <para>
      引导式分区。用户想要设置一些基本设置。例如，某个用户想要使用 LVM，但不知道如何配置分区、卷组等。
     </para>
    </listitem>
    <listitem>
     <para>
      专家分区。用户指定如何布局。但是，他们不需要指定完整的定义，AutoYaST 应为缺少的部分建议合理的默认值。
     </para>
    </listitem>
   </itemizedlist>

   <para>
    在一定程度上，这类似于使用常规安装程序。您可以跳过分区屏幕并信任 YaST、使用<guimenu>引导式建议</guimenu>，或通过<guimenu>专家分区程序</guimenu>定义分区布局。
   </para>

   <sect2 xml:id="CreateProfile-Automatic-Partitioning">
    <title>自动分区</title>

    <para>
     无需任何用户指示，AutoYaST 可提供合理的分区布局。尽管分区布局取决于选择安装的产品，但 AutoYaST 通常会建议使用 Btrfs 根文件系统、一个使用 XFS 的独立 <literal>/home</literal>，以及一个交换分区。此外，根据体系结构，它还会添加可能需要引导的任何分区（例如 BIOS GRUB 分区）。
    </para>

    <para>
     但是，这些默认值可能会由于各种因素（例如可用磁盘空间）而发生变化。例如，是否具有独立的 <literal>/home</literal> 取决于可用磁盘空间量。
    </para>

    <para>
     如果您想要影响这些默认值，可以使用<xref linkend="CreateProfile-Guided-Partitioning"/>中所述的方法。
    </para>
   </sect2>

   <sect2 xml:id="CreateProfile-Guided-Partitioning">
       
    <title>引导式分区</title>

    <para>
     虽然 AutoYaST 可以在没有任何用户指示的情况下提供分区布局，但有时设置一些通用参数并让 AutoYaST 来完成其余设置是很有用的。例如，您可能想要使用 LVM 或加密文件系统，但同时又不想要处理细节。这种情况类似于在常规安装中使用引导式建议时的做法。
    </para>

    <para>
     <xref linkend="example-lvm-guided"/>中的 <literal>storage</literal> 部分指示 AutoYaST 使用 LVM 设置一个分区布局，并删除所有 Windows 分区，不管是否需要这些分区。
    </para>

    <example xml:id="example-lvm-guided">
     <title>基于 LVM 的引导式分区</title>
     <screen>&lt;general&gt;
   &lt;storage&gt;
     &lt;proposal&gt;
       &lt;lvm config:type="boolean"&gt;true&lt;lvm&gt;
       &lt;windows_delete_mode config:type="symbol"&gt;all&lt;windows_delete_mode&gt;
     &lt;/proposal&gt;
   &lt;storage&gt;
&lt;general&gt;</screen>
    </example>

    <variablelist>
      <title/>
     <varlistentry>
      <term>lvm</term>
      <listitem>
       <para>
        创建基于 LVM 的建议。默认设置为 <literal>false</literal>。
       </para>
       <screen>&lt;lvm config:type="boolean"&gt;true&lt;/lvm&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>resize_windows</term>
      <listitem>
       <para>
        设置为 <literal>true</literal> 时，如果需要为安装腾出空间，AutoYaST 将调整 Windows 分区的大小。
       </para>
       <screen>&lt;resize_windows config:type="boolean"&gt;false&lt;/resize_windows&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>windows_delete_mode</term>
      <listitem>
        <itemizedlist mark="bullet" spacing="normal">
         <listitem>
          <para>
           如果设置为 <literal>none</literal>，将不会去除 Windows 分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>ondemand</literal>，将在需要时去除 Windows 分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>all</literal>，将去除所有 Windows 分区。
          </para>
         </listitem>
        </itemizedlist>
       <screen>&lt;windows_delete_mode config:type="symbol"&gt;ondemand&lt;/windows_delete_mode&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>linux_delete_mode</term>
      <listitem>

        <itemizedlist mark="bullet" spacing="normal">
         <listitem>
          <para>
           如果设置为 <literal>none</literal>，将不会去除 Linux 分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>ondemand</literal>，将在需要时去除 Linux 分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>all</literal>，将去除所有 Linux 分区。
          </para>
         </listitem>
        </itemizedlist>
       <screen>&lt;linux_delete_mode config:type="symbol"&gt;ondemand&lt;/linux_delete_mode&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>other_delete_mode</term>
      <listitem>
        <itemizedlist mark="bullet" spacing="normal">
         <listitem>
          <para>
           如果设置为 <literal>none</literal>，将不会去除其他分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>ondemand</literal>，将在需要时去除其他分区。
          </para>
         </listitem>
         <listitem>
          <para>
           如果设置为 <literal>all</literal>，将去除所有其他分区。
          </para>
         </listitem>
        </itemizedlist>
       <screen>&lt;other_delete_mode config:type="symbol"&gt;ondemand&lt;/other_delete_mode&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>encryption_password</term>
      <listitem>
       <para>
        启用使用指定的口令进行加密。默认为禁用加密。
       </para>
       <screen>&lt;encryption_password&gt;some-secret&lt;/encryption_password&gt;</screen>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect2>

   <sect2 xml:id="CreateProfile-Expert-Partitioning">
    <title>专家分区</title>

    <para>
     作为引导式分区的替代方案，AutoYaST 允许通过 <literal>partitioning</literal> 部分描述分区布局。但是，AutoYaST 无需知道每一项细节就能基于一个不太完整的规范构建合理的布局。
    </para>

    <para>
     <literal>partitioning</literal> 部分是 <literal>drive</literal> 元素的列表。其中的每个部分描述分区布局的一个元素，例如磁盘、LVM 卷组、RAID、多设备 Btrfs 文件系统等。
    </para>

    <para>
     <xref linkend="example-partitioning"/>要求 AutoYaST 使用整个磁盘创建 <literal>/</literal>、<literal>/home</literal> 和 <literal>swap</literal> 分区。请注意，其中缺少了一些信息，例如每个分区应使用的文件系统。但这不是一个问题，因为 AutoYaST 将为缺少的项建议合理的值。
    </para>

    <example xml:id="example-partitioning">
     <title>创建 <literal>/</literal>、<literal>/home</literal> 和 <literal>swap</literal> 分区</title>
     <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;20GiB&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;size&gt;1GiB&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;</screen>
    </example>

    <tip xml:id="ay-boot-partition">
     <title>建议引导分区</title>
     <para>
      AutoYaST 会检查配置文件中描述的布局是否可引导。如果不可引导，它会添加缺少的分区。因此，如果您不确定需要引导哪些分区，可以依赖 AutoYaST 做出适当的决策。
     </para>
    </tip>

    <sect3 xml:id="CreateProfile-Partitioning-config">
     <title>驱动器配置</title>
     <para>
      下面列出的元素必须放在以下 XML 结构中：
     </para>

     <screen>&lt;profile&gt;
  &lt;partitioning config:type="list"&gt;
    &lt;drive&gt;
     ...
    &lt;/drive&gt;
  &lt;/partitioning&gt;
&lt;/profile&gt;</screen>

<variablelist>
  <title>属性、值、描述</title>
    <varlistentry>
        <term>device</term>
        <listitem>
          <para>
           可选，要配置的设备。如果留空，AutoYaST 将尝试猜测设备。有关如何影响猜测，请参见<xref linkend="ay-partitioning-skip-devices"/>。
          </para>
          <para>
           如果设置为 <literal>ask</literal>，AutoYaST 将在安装期间询问用户要使用哪个设备。
          </para>
          <para>
            可以通过 ID 使用持久设备名称（例如 <filename>/dev/disk/by-id/<replaceable>ata-WDC_WD3200AAKS-75L9</replaceable></filename>），或者通过 <emphasis>by-path</emphasis> 使用持久设备名称（例如 <filename>/dev/disk/by-path/<replaceable>pci-0001:00:03.0-scsi-0:0:0:0</replaceable></filename>）。
          </para>
          <screen>&lt;device&gt;/dev/sda&lt;/device&gt;</screen>
          <para>
           对于卷组、软件 RAID 或 <systemitem class="resource">bcache</systemitem> 设备，已安装系统中的名称可以不同（目的是避免与现有设备相冲突）。
          </para>
          <para>
           有关处理多路径设备的更多信息，请参见<xref linkend="ay-partition-multipath"/>。
          </para>
      </listitem>      
  </varlistentry>
  
  <varlistentry>
      <term>initialize</term>
      <listitem>
          <para>
              可选，默认值为 <literal>false</literal>。如果设为 <literal>true</literal>，在 AutoYaST 启动分区计算之前将擦除分区表。
          </para>
          <screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
      </listitem>
  </varlistentry>
  
  <varlistentry>
      <term>partitions</term>
      <listitem>
          <para>可选，<literal>&lt;partition&gt;</literal> 项的列表（请参见<xref linkend="ay-partition-configuration"/>）。
          </para>
          <screen>&lt;partitions config:type="list"&gt;
          &lt;partition&gt;...&lt;/partition&gt;
          ...
          &lt;/partitions&gt;</screen>
          <para>
          如果未指定任何分区，AutoYaST 将创建合理的分区布局（请参见<xref linkend="ay-auto-partitioning"/>）。
          </para>
      </listitem>
  </varlistentry>  
  <varlistentry>
      <term>pesize</term>
      <listitem>
          <para>
              可选，仅适用于 LVM。对于 LVM 卷组，默认值为 4M。
          </para>
          <screen>&lt;pesize&gt;8M&lt;/pesize&gt;</screen>
      </listitem>
  </varlistentry>
  
  <varlistentry>
      <term>use</term>
      <listitem>
          <para>
           建议使用，指定 AutoYaST 将用于对硬盘分区的策略。可选的值：
          </para>
          <para>
             <literal>all</literal>，计算新分区时使用整个设备。
          </para>
          <para>
             <literal>linux</literal>，仅使用现有的 Linux 分区。
          </para>
          <para>
             <literal>free</literal>，仅使用设备上未用的空间，现有分区保留原样。
          </para>
          <para>
             <replaceable>1,2,3</replaceable>，要使用的分区编号的逗号分隔列表。
          </para>
      </listitem>
  </varlistentry>
  
  <varlistentry>
      <term>type</term>
      <listitem>
          <para>
              可选，指定 <literal>drive</literal> 的类型。默认值为 <literal>CT_DISK</literal>，表示普通的物理硬盘。所有选项如下：
          </para>
          <para>
            <literal>CT_DISK</literal>，表示物理硬盘（默认值）。
           </para>
           <para>
            <literal>CT_LVM</literal>，表示 LVM 卷组。
           </para>
           <para>
            <literal>CT_MD</literal>，表示软件 RAID 设备。
           </para>
           <para>
            <literal>CT_BCACHE</literal>，表示软件 <systemitem class="resource">bcache</systemitem> 设备。
           </para>
           <para>
            <literal>CT_BTRFS</literal>，表示多设备 Btrfs 文件系统。
           </para>
           <para>
            <literal>CT_NFS</literal>，表示 NFS。
           </para>
           <para>
            <literal>CT_TMPFS</literal>，表示 <literal>tmpfs</literal> 文件系统。
           </para>
          <screen>&lt;type config:type="symbol"&gt;CT_LVM&lt;/type&gt;</screen>
      </listitem>
  </varlistentry>
  
  <varlistentry>
      <term>disklabel</term>
      <listitem>
          <para>
              可选。默认情况下，YaST 会确定有意义的值。如果已存在其他类型的分区表，仅当该分区表不包含任何应该保留或重复使用的分区时，才会重新创建给定类型的分区表。要使用磁盘而不创建任何分区，请将此元素设置为 <literal>none</literal>。所有选项如下：
          </para>
          <para>
             <literal>msdos</literal>
            </para>
            <para>
             <literal>gpt</literal>
            </para>
            <para>
             <literal>none</literal>
            </para>
          <screen>&lt;disklabel&gt;gpt&lt;/disklabel&gt;</screen>
      </listitem>
  </varlistentry>
  
  <varlistentry>
      <term>keep_unknown_lv</term>
      <listitem>
          <para>
           可选，默认值为 <literal>false</literal>。
          </para>
          <para>
           此值仅对 type=CT_LVM 驱动器有意义。如果您正在重复使用某个逻辑卷组并将此项设置为 <literal>true</literal>，该组中的所有现有逻辑卷将保留原样，除非在 &lt;partitioning&gt; 部分指定了这些卷。因此，您可保留现有逻辑卷而无需进行指定。
          </para>
          <screen>&lt;keep_unknown_lv config:type="boolean"&gt;false&lt;/keep_unknown_lv&gt;</screen>          
      </listitem>
  </varlistentry> 
  
  <varlistentry>
      <term>enable_snapshots</term>
      <listitem>
          <para>
           可选，默认值为 <literal>true</literal>。
          </para>
          <para>
           在装入到 <literal>/</literal> 的 Btrfs 文件系统上启用快照（不适用于其他文件系统，或未装入到 <literal>/</literal> 的 Btrfs 文件系统）。
          </para>
          <screen>&lt;enable_snapshots config:type="boolean"&gt;false&lt;/enable_snapshots&gt;</screen>          
      </listitem>
  </varlistentry>
  <varlistentry>
      <term>quotas</term>
      <listitem>
          <para>
           可选，默认值为 <literal>false</literal>。
          </para>
          <para>
           启用 Btrfs 子卷定额支持。将此元素设为 <literal>true</literal> 会对文件系统启用定额支持。不过，您需要为每个子卷设置限额。请查看<xref linkend="ay-btrfs-subvolumes"/>了解更多信息。 
          </para>
          <screen>&lt;quotas config:type="boolean"&gt;true&lt;/quotas&gt;</screen>          
      </listitem>
  </varlistentry>
</variablelist>

     <important>
      <title>当心数据丢失</title>
      <para>
       <literal>use</literal> 属性中提供的值确定如何处理现有数据和分区。值 <literal>all</literal> 表示将擦除整个磁盘。如果您需要保留某些包含重要数据的分区，请创建备份并使用 <literal>confirm</literal> 属性。否则，不会出现任何弹出窗口来通知您将要删除分区。
      </para>
     </important>

     <tip xml:id="ay-partitioning-skip-devices">
      <title>跳过设备</title>
      <para>
       在您未自行指定 &lt;device&gt; 项的情况下，可以影响 AutoYaST 的设备猜测。AutoYaST 通常会使用它能够找到的且看上去合理的第一个设备，但您可以将它配置为跳过某些设备，如下所示：
      </para>
      <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;
    &lt;skip_list config:type="list"&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that use the usb-storage driver --&gt;
        &lt;skip_key&gt;driver&lt;/skip_key&gt;
        &lt;skip_value&gt;usb-storage&lt;/skip_value&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that are smaller than 1GB --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;1048576&lt;/skip_value&gt;
        &lt;skip_if_less_than config:type="boolean"&gt;true&lt;/skip_if_less_than&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that are larger than 100GB --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;104857600&lt;/skip_value&gt;
        &lt;skip_if_more_than config:type="boolean"&gt;true&lt;/skip_if_more_than&gt;
      &lt;/listentry&gt;
    &lt;/skip_list&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
      <para>
       如需所有 &lt;skip_key&gt; 可能值列表，请在已安装的系统上运行 <command>yast2 ayast_probe</command>。
      </para>
     </tip>
    </sect3>

    <sect3 xml:id="ay-partition-configuration">
     <title>分区配置</title>
     <para>
      下面列出的元素必须放在以下 XML 结构中：
     </para>
     <screen>&lt;drive&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      ...
    &lt;/partition&gt;
  &lt;/partitions&gt;
&lt;/drive&gt;</screen>
     <variablelist>
         <varlistentry>
             <term>create</term>
             <listitem>
                 <para>
                     指定是否必须创建此分区或逻辑卷，或者此分区或逻辑卷是否已存在。如果设为 <literal>false</literal>，您还需要设置 <literal>partition_nr</literal>、<literal>lv_name</literal>、<literal>label</literal> 或 <literal>uuid</literal> 其中之一，以告知 AutoYaST 要使用哪个设备。
                 </para>
<screen>&lt;create config:type="boolean"&gt;false&lt;/create&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>crypt_method</term>
             <listitem>
                 <para>
                     可选，将使用以下其中一种方法加密分区：
                 </para>
                     <itemizedlist mark="bullet" spacing="normal">
           <listitem>
            <para>
             <literal>luks1</literal>：常规 LUKS1 加密。
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>pervasive_luks2</literal>：普遍加密。
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>protected_swap</literal>：使用非永久保护的密钥进行加密。
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>secure_swap</literal>：使用非永久的安全密钥进行加密。
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>random_swap</literal>：使用非永久的随机密钥进行加密。
            </para>
           </listitem>
          </itemizedlist>
          <screen>&lt;crypt_method config:type="symbol"&gt;luks1&lt;/crypt_method&gt;</screen>
          <para os="sles;sled,osuse"> 
          加密方法选择是在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>
           <phrase os="sles;sled">15 SP2</phrase> 中引入的。要模仿先前版本的行为，请使用 <literal>luks1</literal>。
          </para>
          <para>
           如果需要，请查看 <literal>crypt_key</literal> 元素了解如何指定加密口令。
          </para>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>crypt_fs</term>
             <listitem>
                 <para>
                     将会加密分区，默认值为 <literal>false</literal>。此元素已弃用。请改用 <literal>crypt_method</literal>。
                 </para>
<screen>&lt;crypt_fs config:type="boolean"&gt;true&lt;/crypt_fs&gt;</screen>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>crypt_key</term>
             <listitem>
                 <para>
                     如果已将 <literal>crypt_method</literal> 设为需要口令的方法（例如 <literal>luks1</literal> 或 <literal>pervasive_luks2</literal>），则此为必要元素。
                 </para>
<screen>&lt;crypt_key&gt;xxxxxxxx&lt;/crypt_key&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>mount</term>
             <listitem>
                 <para>
                     至少应有一个根分区 (/) 和一个交换分区。
                 </para>
 <screen>&lt;mount&gt;/&lt;/mount&gt;&lt;mount&gt;swap&lt;/mount&gt;</screen>                
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>fstopt</term>
             <listitem>
                 <para>
                     此分区的装入选项，请参见 <command>man mount</command> 了解可用的装入选项。
                 </para>
<screen>&lt;fstopt&gt;ro,noatime,user,data=ordered,acl,user_xattr&lt;/fstopt&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>label</term>
             <listitem>
                 <para>
                     分区的标签。格式化设备时很有用（尤其是 <literal>mountby</literal> 参数设置为 <literal>label</literal> 时），并可用于标识已存在的设备（请参见前面所述的 <literal>create</literal>）。有关示例，请参见 <command>man e2label</command>。
                 </para>
<screen>&lt;label&gt;mydata&lt;/label&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>uuid</term>
             <listitem>
                 <para>
                      分区的 UUID。仅可用于标识现有设备（请参见前面所述的 <literal>create</literal>）。不能对新设备强制使用 UUID（请参见 <command>man uuidgen</command>）。
                 </para>
<screen>&lt;uuid&gt;1b4e28ba-2fa1-11d2-883f-b9a761bde3fb&lt;/uuid&gt;</screen>                
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>size</term>
             <listitem>
                 <para>
                      分区的大小，例如 4G、4500M 等。/boot 分区和交换分区可以使用 <literal>auto</literal> 作为大小。然后，AutoYaST 将计算合理的大小。一个分区可以通过设置值 <literal>max</literal> 来使用所有剩余空间。
                 </para>
                 <para>
                      您也可以按百分比指定大小。即指定 10% 将使用 10% 的硬盘或卷组大小。如果需要，您可以混用 <literal>auto</literal>、<literal>max</literal>、<literal>size</literal> 和百分比。
                 </para>
<screen>&lt;size&gt;10G&lt;/size&gt;</screen>                    
                 <para>
                     从 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 开始，所有值（包括 <literal>auto</literal> 和 <literal>max</literal>）也都可用于调整分区大小。
                 </para>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>format</term>
             <listitem>
                 <para>
                     指定 AutoYaST 是否应格式化分区。如果您将 <literal>create</literal> 设置为 <literal>true</literal>，则也可能想要将此选项设置为 <literal>true</literal>。 
                 </para>
<screen>&lt;format config:type="boolean"&gt;false&lt;/format&gt;</screen>                
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>file system</term>
             <listitem>
                 <para>
                     可选。对于根分区 (<filename>/</filename>)，默认值为 <literal>btrfs</literal>；对于数据分区，默认值为 <literal>xfs</literal>。指定要在此分区上使用的文件系统：
                 </para>
         <itemizedlist mark="bullet" spacing="normal">
           <listitem>
            <para>
             <literal>btrfs</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>ext2</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>ext3</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>ext4</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>fat</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>xfs</literal>
            </para>
           </listitem>
           <listitem>
            <para>
             <literal>SWAP</literal>
            </para>
<screen>&lt;filesystem config:type="symbol"&gt;ext3&lt;/filesystem&gt;</screen>            
           </listitem>
          </itemizedlist>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>mkfs_options</term>
             <listitem>
                 <para>
                     可选，指定 <command>mkfs</command> 的选项字符串。请仅在您完全清楚自己所执行的操作时，才使用此元素。（请参见相关 mkfs 手册页以了解您要使用的文件系统。）
                 </para>
<screen>&lt;mkfs_options&gt;-I 128&lt;/mkfs_options&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>partition_nr</term>
             <listitem>
                 <para>
                     此分区的编号。如果您已设置 <literal>create=false</literal> 或者要使用 LVM，则您可以通过 <literal>partition_nr</literal> 指定分区。
                 </para>
<screen>&lt;partition_nr config:type="integer"&gt;2&lt;/partition_nr&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>partition_id</term>
             <listitem>
                 <para>
                     <literal>partition_id</literal> 用于设置分区的 ID。如果您要为 Linux 分区指定 131 以外的标识符，或者要为交换分区指定 130 以外的标识符，请使用 <literal>partition_id</literal> 配置标识符。Linux 分区的默认 ID 为 <literal>131</literal>，交换分区的默认 ID 为 <literal>130</literal>。
                 </para>
<screen>&lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;</screen>                 
<simplelist>
 <member>交换分区：<literal>130</literal></member>
 <member>Linux：<literal>131</literal></member>
 <member>LVM：<literal>142</literal></member>
 <member>MD RAID：<literal>253</literal></member>
 <member>EFI 分区：<literal>259</literal></member>
</simplelist>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>partition_type</term>
             <listitem>
                 <para>
                     可选。可用的值为 <literal>primary</literal>（默认值）和 <literal>logical</literal>。使用 <literal>msdos</literal> 分区表时，此元素可设置分区类型。值可以是 <literal>primary</literal> 或 <literal>logical</literal>。使用 <literal>gpt</literal> 分区表时会忽略此值，因为在此情况下不存在这种差别。
                 </para>
<screen>&lt;partition_type&gt;primary&lt;/partition_type&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>mountby</term>
             <listitem>
                 <para>
                     如果不使用分区编号，您可以告知 AutoYaST 按 <literal>device</literal>、<literal>label</literal>、<literal>uuid</literal>、<literal>path</literal> 或 <literal>id</literal>（udev 路径和 udev ID）装入分区（请参见 <filename>/dev/disk/...</filename>）。
                 </para>
                 <para>
                     请参见上文有关 <literal>label</literal> 和 <literal>uuid</literal> 的说明。默认值取决于 YaST，通常是 <literal>id</literal>。
                 </para>
<screen>&lt;mountby config:type="symbol"&gt;label&lt;/mountby&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>subvolumes</term>
             <listitem>
                 <para>
                     要为 Btrfs 类型的文件系统创建的子卷列表。此键仅对 Btrfs 类型的文件系统有意义。（有关详细信息，请参见<xref linkend="ay-btrfs-subvolumes"/>。）
                 </para>
                 <para>
                     如果未为分区描述定义 <tag>subvolumes</tag> 部分，AutoYaST 将为给定的安装点创建一组预定义的子卷。
                 </para>
<screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var&lt;/path&gt;
  ...
&lt;/subvolumes&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>create_subvolumes</term>
             <listitem>
                 <para>
                     确定是否应创建 Btrfs 子卷。默认设置为 <literal>true</literal>。如果设置为 <literal>false</literal>，则不创建子卷。
                 </para>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>subvolumes_prefix</term>
             <listitem>
                 <para>
                     设置 Btrfs 子卷前缀名称。如果不需要前缀，则必须将此元素设置为空值：
                 </para>
<screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen>
                 <para>默认设置为 <literal>@</literal>。
                 </para>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>lv_name</term>
             <listitem>
                 <para>
                     如果此分区位于卷组中的某个逻辑卷上，请在此处指定该逻辑卷的名称（请查看驱动器配置中的 <literal>type</literal> 参数）。
                 </para>
<screen>&lt;lv_name&gt;opt_lv&lt;/lv_name&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>stripes</term>
             <listitem>
                 <para>
                     用于配置 LVM 分段的整数。指定您要分段到多少个设备（分散数据）。
                 </para>
<screen>&lt;stripes config:type="integer"&gt;2&lt;/stripes&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>stripesize</term>
             <listitem>
                 <para>
                     指定每个块的大小，以 KB 为单位。
                 </para>
<screen>&lt;stripesize config:type="integer"&gt;4&lt;/stripesize&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>lvm_group</term>
             <listitem>
                 <para>
                     如果这是（部分）卷组 (LVM) 使用的物理分区，则您需要在此处指定该卷组的名称。
                 </para>
<screen>&lt;lvm_group&gt;system&lt;/lvm_group&gt;</screen>                 
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>pool</term>
             <listitem>
                 <para>
                     如果 LVM 逻辑卷应是 LVM 精简池，则 <literal>pool</literal> 必须设置为 <literal>true</literal>。
                 </para>
<screen>&lt;pool config:type="boolean"&gt;true&lt;/pool&gt;</screen>              
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>used_pool</term>
             <listitem>
                 <para>
                      用作此精简逻辑卷的数据储存的 LVM 精简池名称。如果设置为非空值，则表示该卷是所谓的精简逻辑卷。 
                 </para>
<screen>&lt;used_pool&gt;my_thin_pool&lt;/used_pool&gt;</screen>              
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>raid_name</term>
             <listitem>
                 <para>
                     如果此物理卷是 RAID 阵列的一部分，请指定该 RAID 阵列的名称。
                 </para>
<screen>&lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>raid_options</term>
             <listitem>
                 <para>
                     指定 RAID 选项。在 <literal>partition</literal> 级别设置 RAID 选项的功能已弃用。请参见<xref linkend="ay-partition-sw-raid"/>。
                 </para>
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>bcache_backing_for</term>
             <listitem>
                 <para>
                     如果此设备用作 <emphasis><systemitem class="resource">bcache</systemitem> 后端设备</emphasis>，请指定 <systemitem class="resource">bcache</systemitem> 设备的名称。有关更多详细信息，请参见<xref linkend="ay-partition-bcache"/>。
                 </para>
<screen>&lt;bcache_backing_for&gt;/dev/bcache0&lt;/bcache_backing_for&gt;</screen>              
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>bcache_caching_for</term>
             <listitem>
                 <para>
                     如果此设备用作 <emphasis><systemitem class="resource">bcache</systemitem> 缓存设备</emphasis>，请指定 <systemitem class="resource">bcache</systemitem> 设备的名称。有关更多详细信息，请参见<xref linkend="ay-partition-bcache"/>。
                 </para>
  <screen>&lt;bcache_caching_for config:type="list"&gt;&lt;listentry&gt;/dev/bcache0&lt;/listentry&gt;&lt;/bcache_caching_for&gt;</screen>               
             </listitem>
         </varlistentry>

         <varlistentry>
             <term>resize</term>
             <listitem>
                 <para os="sles;sled;osuse">
                     从 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 开始，调整大小功能适用于物理磁盘分区和 LVM 卷
                 </para>
                 
 <screen>&lt;resize config:type="boolean"&gt;false&lt;/resize&gt;</screen>                
             </listitem>
         </varlistentry>
     </variablelist>     
    </sect3>

    <sect3 xml:id="ay-btrfs-subvolumes">
     <title>Btrfs 子卷</title>
     <para>
      如<xref linkend="ay-partition-configuration"/>中所述，可为每个 Btrfs 文件系统定义一组子卷。最简单的指定方式是使用路径列表：
     </para>

<screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;usr/local&lt;/path&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var&lt;/path&gt;
&lt;/subvolumes&gt;</screen>

     <para>
      不过，您可以为每个子卷指定更多设置。例如，我们可能需要设置定额，或禁用写入时复制机制。为此，可以扩展下例所示列表中的任何元素：
     </para>

<screen>&lt;subvolumes config:type="list"&gt;
  &lt;listentry&gt;usr/local&lt;/listentry&gt;
  &lt;listentry&gt;
    &lt;path&gt;tmp&lt;/path&gt;
    &lt;referenced_limit&gt;1 GiB&lt;/referenced_limit&gt;
  &lt;/listentry&gt;
  &lt;listentry&gt;opt&lt;/listentry&gt;
  &lt;listentry&gt;srv&lt;/listentry&gt;
  &lt;listentry&gt;
    &lt;path&gt;var/lib/pgsql&lt;/path&gt;
    &lt;copy_on_write config:type="boolean"&gt;false&lt;/copy_on_write&gt;
  &lt;/listentry&gt;
&lt;/subvolumes&gt;</screen>

     <para>

     </para>

<variablelist xml:id="foofoo">
  <varlistentry>
    <term>
      <literal>path</literal>
    </term>
    <listitem>
      <para> 子卷的安装点。 </para>
      <screen>&lt;path&gt;tmp&lt;/tmp&gt;</screen>
      <para> 必要。如果未指定 <literal>path</literal>，AutoYaST 将忽略该子卷。 </para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>
      <literal>copy-on-write</literal>
    </term>
    <listitem>
      <para> 是否应对该子卷启用写入时复制选项。 </para>
      <screen>&lt;copy-on-write config:type="boolean"&gt;false&lt;/copy-on-write&gt;</screen>
      <para> 可选。默认值为 <literal>false</literal>。
          </para>
    </listitem>
  </varlistentry>
  <varlistentry>
    <term>
      <literal>referenced_limit</literal>
    </term>
    <listitem>
      <para> 为子卷设置定额。 </para>
      <screen>&lt;referenced_limit&gt;1 GiB&lt;/referenced_limit&gt;</screen>
      <para> 可选。默认值为 <literal>unlimited</literal>。Btrfs 支持两种限制：<literal>referenced</literal> 和 <literal>exclusive</literal>。目前仅支持前一种限制。 </para>
    </listitem>
  </varlistentry>
</variablelist>


     <para>
      如果对发行套件使用默认子卷（例如 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 中的 <filename>@</filename>），则会自动在所定义子卷的名称前面加上此默认子卷的名称。可以通过在<xref linkend="CreateProfile-Partitioning-config"/>中设置 <literal>subvolumes_prefix</literal> 来禁用此行为。
     </para>

     <screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen>
    </sect3>

    <sect3 xml:id="ay-use-whole-disk">
     <title>使用整个磁盘</title>

     <para>
      AutoYaST 允许通过将 <literal>disklabel</literal> 设置为 <literal>none</literal>（请参见<xref linkend="CreateProfile-Partitioning-config"/>）来使用整个磁盘而不创建任何分区。在这种情况下，<literal>drive</literal> 中第一个 <literal>partition</literal> 中的配置将应用到整个磁盘。
     </para>

     <para>
      在以下示例中，我们将使用第二个磁盘 (<literal>/dev/sdb</literal>) 作为 <literal>/home</literal> 文件系统。
     </para>

     <example>
      <title>使用整个磁盘作为文件系统</title>
      <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;</screen>
     </example>

     <para>
      此外，还可将整个磁盘用作 LVM 物理卷或软件 RAID 成员。有关设置 LVM 或软件 RAID 的更多细节，请参见<xref linkend="ay-partition-lvm"/>和<xref linkend="ay-partition-sw-raid"/>。
     </para>

     <para os="sles;sled;osuse">
      出于向后兼容的原因，可以通过将 <literal>&lt;partition_nr&gt;</literal> 元素设置为 <literal>0</literal> 来实现相同的效果。但是，从 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 开始，已弃用 <literal>&lt;partition_nr&gt;</literal> 元素的这种用法。
     </para>
    </sect3>

    <sect3 xml:id="ay-auto-partitioning">
     <title>填补缺失</title>
     <para>
      使用<guimenu>专家分区程序</guimenu>方法时，AutoYaST 可以基于一个不太完整的配置文件创建分区计划。以下配置文件演示了如何描述分区布局的一些细节，然后让 AutoYaST 完成余下的操作。
     </para>
     <example>
      <title>在选定的驱动器上自动分区</title>
      <para>
       下面是单个驱动器系统的示例，该驱动器未预先分区，应根据描述的预定义分区计划进行自动分区。如果您未指定设备，系统将自动检测设备。
      </para>
      <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
     </example>
     <para>
      有一个更详细的示例演示了如何处理现有分区和多个驱动器。
     </para>
     <example>
      <title>在多个驱动器上安装</title>
      <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;size&gt;1G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;use&gt;free&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;mount&gt;/data1&lt;/mount&gt;
        &lt;size&gt;15G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;mount&gt;/data2&lt;/mount&gt;
        &lt;size&gt;auto&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
     </example>
    </sect3>
   </sect2>

   <sect2 xml:id="ay-partition-advanced">
    <title>高级分区功能</title>
    <para>
     <remark role="fixme">Add a short description</remark>
    </para>
    <sect3 xml:id="ay-partition-advanced-wipe">
     <title>擦除分区表</title>
     <para>
      通常不需要执行此操作，因为 AutoYaST 可以自动地逐个删除分区。但是，您需要使用相应的选项来让 AutoYaST 清除分区表，而不是逐个删除分区。
     </para>
     <para>
      转到 <literal>drive</literal> 部分并添加：
     </para>
<screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
     <para>
      指定此设置后，AutoYaST 会先删除分区表，然后再开始分析实际分区并计算其分区计划。当然，这也意味着您无法保留任何现有分区。
     </para>
    </sect3>
    <sect3 xml:id="ay-partition-advanced-mount">
     <title>装入选项</title>
     <para>
      默认情况下，要装入的文件系统在 <filename>/etc/fstab</filename> 中按设备名称标识。可以更改此标识，以便通过搜索 UUID 或卷标来查找文件系统。请注意，并非所有文件系统都可按 UUID 或卷标装入。要指定如何装入分区，请使用具有 <literal>symbol</literal> 类型的 <literal>mountby</literal> 属性。可能的选项为：
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <literal>device</literal>（默认值）
       </para>
      </listitem>
      <listitem>
       <para>
        <literal>label</literal>
       </para>
      </listitem>
      <listitem>
       <para>
        <literal>UUID</literal>
       </para>
      </listitem>
     </itemizedlist>
     <para>
      如果您选择使用标签装入新分区，请使用 <literal>label</literal> 属性指定其值。
     </para>
     <para>
      在 <filename>/etc/fstab</filename> 的第四个字段中添加任何有效装入选项。用逗号分隔多个选项。可能的 fstab 选项：
     </para>
     <variablelist>
      <varlistentry>
       <term>只读装入 (<literal>ro</literal>)</term>
       <listitem>
        <para>
         对文件系统没有写入访问权限。默认为 <literal>false</literal>。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>不更新访问时间 (<literal>noatime</literal>)</term>
       <listitem>
        <para>
         读取文件时不更新访问时间。默认为 <literal>false</literal>。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>可由用户装入 (<literal>user</literal>)</term>
       <listitem>
        <para>
         文件系统可由普通用户装入。默认为 <literal>false</literal>。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>
        数据日记模式（<literal>ordered</literal>、<literal>journal</literal>、<literal>writeback</literal>）
       </term>
       <listitem>
        <variablelist>
         <varlistentry>
          <term><literal>journal</literal>
          </term>
          <listitem>
           <para>
            在将所有数据写入主文件系统之前将其提交到日记。
           </para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>ordered</literal>
          </term>
          <listitem>
           <para>
            在将所有数据的元数据提交到日记之前，将所有数据直接写入主文件系统。
           </para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>writeback</literal>
          </term>
          <listitem>
           <para>
            不保留数据顺序。
           </para>
          </listitem>
         </varlistentry>
        </variablelist>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>访问控制列表 (<literal>acl</literal>)</term>
       <listitem>
        <para>
         在文件系统上启用访问控制列表。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>扩展用户属性 (<literal>user_xattr</literal>)</term>
       <listitem>
        <para>
         在文件系统上允许扩展用户属性。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <example>
      <title>装入选项</title>
<screen>&lt;partitions config:type="list"&gt;
  &lt;partition&gt;
    &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
    &lt;format config:type="boolean"&gt;true&lt;/format&gt;
    &lt;fstopt&gt;ro,noatime,user,data=ordered,acl,user_xattr&lt;/fstopt&gt;
    &lt;mount&gt;/local&lt;/mount&gt;
    &lt;mountby config:type="symbol"&gt;uuid&lt;/mountby&gt;
    &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
    &lt;size&gt;10G&lt;/size&gt;
  &lt;/partition&gt;
&lt;/partitions&gt;
</screen>
     </example>

    <note>
     <title>
      查看支持的文件系统选项
     </title>
     <para>
      不同的文件系统类型支持不同的选项。请在设置选项之前，请仔细查看相关文档。
     </para>
    </note>
    </sect3>
    <sect3 xml:id="ay-partition-advanced-keep">
     <title>保留特定的分区</title>
     <para>
      在某些情况下，您应该将分区保留原样，仅格式化特定的目标分区，而不要从头开始创建分区。例如，如果有不同的 Linux 安装共存，或者您安装了另一个操作系统，则您可能不想要擦除这些分区。您还可能想要将数据分区保留原样。
     </para>
     <para>
      此类方案要求对目标系统和硬盘有专门的了解。根据具体的方案，您可能需要知道目标硬盘的确切分区表及其分区 ID、大小和编号。有了这些数据，您便可以告知 AutoYaST 保留特定的分区、格式化其他分区，并根据需要创建新分区。
     </para>
     <para>
      以下示例将保留分区 1、2、5，并删除分区 6 以创建两个新分区。所有剩余分区只会格式化。<remark>emap 2011-11-05: Not the best example for the scenarios two paras up with coexisting operating systems or data partitions. Who'd want to format those?</remark>
     </para>
     <example>
      <title>保留分区</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdc&lt;/device&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/&lt;/mount&gt;
          &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;false&lt;/format&gt;
          &lt;partition_nr config:type="integer"&gt;2&lt;/partition_nr&gt;
          &lt;mount&gt;/space&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
          &lt;partition_nr config:type="integer"&gt;5&lt;/partition_nr&gt;
          &lt;mount&gt;swap&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space2&lt;/mount&gt;
          &lt;size&gt;5G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space3&lt;/mount&gt;
          &lt;size&gt;max&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
    &lt;use&gt;6&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>
     <para>
      最后一个示例要求确切地了解应保留的分区的现有分区表和分区编号。但在某些情况下，可能不提供此类数据，尤其是在使用不同硬盘类型和配置的混合硬件环境中。以下方案适用于采用非 Linux 操作系统并可提供指定的区域进行 Linux 安装的系统。
     </para>
     <figure xml:id="partitioning-keep1">
      <title>保留分区</title>
      <mediaobject>
       <imageobject role="html">
        <imagedata fileref="partitioning-keep1.png"/>
       </imageobject>
       <imageobject role="fo">
        <imagedata fileref="partitioning-keep1.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      在此方案中，如<xref linkend="partitioning-keep1"/>所示，AutoYaST 不会创建新分区，而是在系统上搜索特定的分区类型，并根据控制文件中的分区计划使用这些分区类型。在本例中未指定分区编号，而仅指定了安装点和分区类型（可以提供其他配置数据，例如文件系统选项、加密和文件系统类型）。
     </para>
     <example>
      <title>自动检测要保留的分区。</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;partition_id config:type="integer"&gt;130&lt;/partition_id&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>

     <note>
      <title>保留加密的设备</title>
      <para>
       当 AutoYaST 探测储存设备时，尚未分析配置文件中的 partitioning 部分。在某些方案中，无法清楚地知道要使用哪个密钥来解锁设备。例如，定义了多个加密密钥时，就可能会发生这种情况。为了解决此问题，AutoYaST 会尝试所有已加密设备上定义的所有密钥，直到找到有效的密钥。
      </para>
     </note>
    </sect3>
   </sect2>

   <sect2 xml:id="ay-partition-lvm">
    <title>逻辑卷管理器 (LVM)</title>
    <para>
     要配置 LVM，请先使用前面所述的常规分区方法创建一个物理卷。
    </para>
    <example>
     <title>创建 LVM 物理卷</title>
     <para>
      以下示例演示如何在 <literal>partitioning</literal> 资源中准备 LVM。将在类型为 <literal>LVM</literal> 并包含卷组 <literal>system</literal> 的设备 <filename>/dev/sda1</filename> 上创建一个未格式化的分区。此分区将使用驱动器上的所有可用空间。
     </para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;partition_id config:type="integer"&gt;142&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
    <example>
     <title>LVM 逻辑卷</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/system&lt;/device&gt;
      &lt;type config:type="symbol"&gt;CT_LVM&lt;/type&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;user_lv&lt;/lv_name&gt;
          &lt;mount&gt;/usr&lt;/mount&gt;
          &lt;size&gt;15G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;opt_lv&lt;/lv_name&gt;
          &lt;mount&gt;/opt&lt;/mount&gt;
          &lt;size&gt;10G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;var_lv&lt;/lv_name&gt;
          &lt;mount&gt;/var&lt;/mount&gt;
          &lt;size&gt;1G&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
      &lt;pesize&gt;4M&lt;/pesize&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
    <para>
     对于逻辑卷，可将 <literal>size</literal> 设置为 <literal>max</literal>。当然，只能为一个逻辑卷使用 <literal>max</literal>。无法将一个卷组中的两个逻辑卷都设置为 <literal>max</literal>。
    </para>
   </sect2>

   <sect2 xml:id="ay-partition-sw-raid">
    <title>软件 RAID</title>
    <para os="sles;sled;osuse">
     对软件 RAID 设备的支持在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase os="sles;sled">15 SP2</phrase> 中已得到很大改进。
    </para>
     <para os="sles;sled;osuse">
      如果需要，请参见<xref linkend="ay-partition-sw-raid-deprecated"/>来了解有关指定软件 RAID 的旧方法的更多细节，出于向后兼容考虑，这种旧方法仍受支持。
     </para>
     <para>
     使用 AutoYaST 可以创建和组装软件 RAID 设备。支持的 RAID 级别如下：
    </para>
    <variablelist>
     <varlistentry>
      <term>RAID 0</term>
      <listitem>
       <para>
        此级别可提高磁盘性能。此模式<emphasis>不提供</emphasis>冗余。如果某个驱动器崩溃，将无法恢复数据。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 1</term>
      <listitem>
       <para>
        此模式提供最佳冗余。在两个或更多个磁盘上可使用此模式。在所有磁盘上保留所有数据的精确副本。只要至少有一个磁盘仍可正常工作，就不会丢失数据。用于此 RAID 类型的分区大小应大致相同。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 5</term>
      <listitem>
       <para>
        此模式结合了更多磁盘的管理功能，同时仍可保持一定程度的冗余。在三个或更多个磁盘上可使用此模式。如果有一个磁盘发生故障，所有数据仍将保持不变。如果两个磁盘同时发生故障，所有数据都会丢失。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>多路径</term>
      <listitem>
       <para>
        此模式允许通过多个控制器访问同一物理设备，以提供冗余来防止控制器卡故障。在至少两个设备上可使用此模式。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>
     类似于 LVM，AutoYaST 配置文件中的软件 RAID 定义由两个不同的部分构成：
    </para>

    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       确定要将哪些磁盘或分区用作 RAID 成员。为此，您需要在此类设备中设置 <literal>raid_name</literal> 元素。
      </para>
     </listitem>
     <listitem>
      <para>
       使用专用的 <literal>drive</literal> 部分定义 RAID 本身。
      </para>
     </listitem>
    </itemizedlist>

    <para>
     以下示例演示了一种 RAID1 配置，该配置使用第一和第二个磁盘中的各一个分区作为 RAID 成员：
    </para>
    <example>
     <title>RAID1 配置</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;20G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md/0&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
        &lt;size&gt;40G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;/srv&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;raid_options&gt;
      &lt;chunk_size&gt;4&lt;/chunk_size&gt;
      &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
      &lt;raid_type&gt;raid1&lt;/raid_type&gt;
    &lt;/raid_options&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>

    <para>
     如果您不想在软件 RAID 中创建分区，请将 <literal>disklabel</literal> 设置为 <literal>none</literal>，就像对常规磁盘所做那样。在以下示例中，为简洁起见，仅显示了 RAID <literal>drive</literal> 部分：
    </para>

    <example>
     <title>不包含分区的 RAID1</title>
<screen>&lt;drive&gt;
  &lt;device&gt;/dev/md/0&lt;/device&gt;
  &lt;disklabel&gt;none&lt;/disklabel&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      &lt;mount&gt;/home&lt;/mount&gt;
      &lt;size&gt;40G&lt;/size&gt;
    &lt;/partition&gt;
  &lt;/partitions&gt;
  &lt;raid_options&gt;
    &lt;chunk_size&gt;4&lt;/chunk_size&gt;
    &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
    &lt;raid_type&gt;raid1&lt;/raid_type&gt;
  &lt;/raid_options&gt;
  &lt;use&gt;all&lt;/use&gt;
&lt;/drive&gt;</screen>
    </example>

   <sect3 os="sles;sled;osuse" xml:id="ay-partition-sw-raid-deprecated">
    <title>使用已弃用的语法</title>
    <para>
     如果启用了安装程序自我更新功能，则可以将 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 的软件 RAID 分区。但是，该方案在以前的版本中不受支持，因此定义软件 RAID 的方法略有不同。
    </para>

    <para>
     本节定义了旧式配置的样式，出于向后兼容的原因，仍然支持这种配置。
    </para>

    <para>
     使用这种已弃用的语法配置 RAID 时请注意以下几点：
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       RAID 的设备始终是 <filename>/dev/md</filename>。
      </para>
     </listitem>
     <listitem>
      <para>
       属性 <literal>partition_nr</literal> 用于确定 MD 设备编号。如果 <literal>partition_nr</literal> 等于 0，则配置 <filename>/dev/md/0</filename>。添加多个 <literal>partition</literal> 部分表示您想要配置多个软件 RAID（<filename>/dev/md/0</filename>、<filename>/dev/md/1</filename> 等）。
      </para>
     </listitem>
     <listitem>
      <para>
       所有特定于 RAID 的选项都包含在 <literal>raid_options</literal> 资源中。
      </para>
     </listitem>
    </itemizedlist>

    <example>
     <title>旧式 RAID1 配置</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;raid_type&gt;raid1&lt;/raid_type&gt;
        &lt;size&gt;4G&lt;/size&gt;
      &lt;/partition&gt;

        &lt;!-- Insert a configuration for the regular partitions located on
                /dev/sda here (for example / and swap) --&gt;

    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;size&gt;4gb&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/space&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;0&lt;/partition_nr&gt;
        &lt;raid_options&gt;
          &lt;chunk_size&gt;4&lt;/chunk_size&gt;
          &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
        &lt;/raid_options&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
   </sect3>

   <sect3 xml:id="ay-raid-configuration">
    <title>RAID 选项</title>
    <para>
     以下元素必须放在以下 XML 结构中：
    </para>
<screen>&lt;partition&gt;
     &lt;raid_options&gt;
     ...
     &lt;/raid_options&gt;
     &lt;/partition&gt;</screen>
    
    <variablelist>
     <varlistentry>
      <term>chunk_size</term>
      <listitem>
<screen>&lt;chunk_size&gt;4&lt;/chunk_size&gt;</screen>
      </listitem>
     </varlistentry>
     
     <varlistentry>
      <term>parity_algorithm</term>
      <listitem>
       <para>
        可能的值为：
       </para>
       <para>
        <literal>left_asymmetric</literal>、<literal>left_symmetric</literal>、<literal>right_asymmetric</literal> 或 <literal>right_symmetric</literal>。
       </para>
       
       <para>
        对于 RAID6 和 RAID10，可使用以下值：
       </para>
       <para>
        <literal>parity_first</literal>、<literal>parity_last</literal>、<literal>left_asymmetric_6</literal>、<literal>left_symmetric_6</literal>、​
        <literal>right_asymmetric_6</literal>、<literal>right_symmetric_6</literal>、<literal>parity_first_6</literal>、<literal>n2</literal>、<literal>o2</literal>、​
        <literal>f2</literal>、<literal>n3</literal>、<literal>o3</literal> 或 <literal>f3</literal>。
       </para>
<screen>&lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;</screen>
      </listitem>
     </varlistentry>
     
     <varlistentry>
      <term>raid_type</term>
      <listitem>
       <para>
        可能的值为：<literal>raid0</literal>、<literal>raid1</literal>、<literal>raid5</literal>、<literal>raid6</literal> 和 <literal>raid10</literal>。
       </para>
<screen>&lt;raid_type&gt;raid1&lt;/raid_type&gt;</screen>
       <para>
        默认值为 <literal>raid1</literal>。
       </para>
      </listitem>
     </varlistentry>
     
     <varlistentry>
      <term>device_order</term>
      <listitem>
       <para>
        此列表包含物理设备的顺序：
       </para>
<screen>&lt;device_order config:type="list"&gt;&lt;device&gt;/dev/sdb2&lt;/device&gt;&lt;device&gt;/dev/sda1&lt;/device&gt;...&lt;/device_order&gt;</screen>
       <para>
        这是可选元素，默认采用字母顺序。
       </para>
      </listitem>
     </varlistentry>
     
    </variablelist>
    
   </sect3>
  </sect2>

  <sect2 xml:id="ay-partition-multipath">
      
   <title>多路径支持</title>
   <para>
    AutoYaST 可以处理多路径设备。要利用此类设备，您需要按照<xref linkend="multipath-example"/>中所示启用多路径支持。或者，可以在内核命令行上使用以下参数：<literal>LIBSTORAGE_MULTIPATH_AUTOSTART=ON</literal>。
   </para>

   <para os="sles;sled">
    与 SUSE Linux Enterprise 12 不同，无需将 drive 部分类型设置为 <literal>CT_DMMULTIPATH</literal>。而应使用 <literal>CT_DISK</literal>，不过出于历史原因，这两个值是等效的。
   </para>

    <example xml:id="multipath-example">
     <title>使用多路径设备</title>
     <screen>&lt;general&gt;
  &lt;storage&gt;
    &lt;start_multipath config:type="boolean"&gt;true&lt;/start_multipath&gt;
  &lt;storage&gt;
&lt;/general&gt;
&lt;partitioning&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;size&gt;20G&lt;/size&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;size&gt;auto&lt;/size&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>

    <para>
     如果您要指定设备，可以使用全球标识符 (WWID)、其设备名称（例如 <literal>/dev/dm-0</literal>）、<literal>/dev/disk</literal> 下表示多路径设备的任何其他路径，或者其任何路径。
    </para>

    <para>
     以<xref linkend="multipath-ll-output"/>中的 <literal>multipath</literal> 列表为例，您可以使用 <literal>/dev/mapper/14945540000000000f86756dce9286158be4c6e3567e75ba5</literal>、<literal>/dev/dm-3</literal>、<literal>/dev/disk</literal> 下的任何其他对应路径（如<xref linkend="multipath-wwid-example"/>中所示），或设备的任何路径（<literal>/dev/sda</literal> 或 <literal>/dev/sdb</literal>）。
    </para>

    <example xml:id="multipath-ll-output">
     <title>列出多路径设备</title>
     <screen># multipath -l
14945540000000000f86756dce9286158be4c6e3567e75ba5 dm-3 ATA,VIRTUAL-DISK
size=40G features='0' hwhandler='0' wp=rw
|-+- policy='service-time 0' prio=1 status=active
| `- 2:0:0:0 sda 8:0  active ready running
`-+- policy='service-time 0' prio=1 status=enabled
  `- 3:0:0:0 sdb 8:16 active ready running</screen>
    </example>

    <example xml:id="multipath-wwid-example">
     <title>使用 WWID 标识多路径设备</title>
     <screen>&lt;drive&gt;
  &lt;partitions config:type="list"&gt;
    &lt;device&gt;/dev/mapper/14945540000000000f86756dce9286158be4c6e3567e75ba5&lt;/device&gt;
    &lt;partition&gt;
      &lt;size&gt;20G&lt;/size&gt;
      &lt;mount&gt;/&lt;/mount&gt;
      &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
    &lt;/partition&gt;
  &lt;/partitions&gt;
  &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
  &lt;use&gt;all&lt;/use&gt;
&lt;/drive&gt;</screen>
    </example>
  </sect2>

  <sect2 xml:id="ay-partition-bcache">
   <title><systemitem class="resource">bcache</systemitem> 配置</title>
   <para>
    <systemitem class="resource">bcache</systemitem> 是允许使用多个快速驱动器来加速访问一个或多个慢速驱动器的缓存系统。例如，您可以使用一个快速驱动器作为缓存，来改善一个较大（但较慢）驱动器的性能。
   </para>

   <para>
    有关 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 上的 bcache 的详细信息，另请参见 <link xlink:href="https://www.suse.com/c/combine-the-performance-of-solid-state-drive-with-the-capacity-of-a-hard-drive-with-bcache-and-yast/"/> 上的博客文章。
   </para>

   <para>
    要设置 <systemitem class="resource">bcache</systemitem> 设备，AutoYaST 需要一个指定了以下设置的配置文件：
   </para>

   <itemizedlist>
    <listitem>
     <para>
      要将某个（慢速）块设备设置为<emphasis>后端设备</emphasis>，请使用 <literal>bcache_backing_for</literal> 元素。
     </para>
    </listitem>
    <listitem>
     <para>
      要将某个（快速）块设备设置为<emphasis>缓存设备</emphasis>，请使用 <literal>bcache_caching_for</literal> 元素。您可以使用同一设备来加速访问多个驱动器。
     </para>
    </listitem>
    <listitem>
     <para>
      要指定 <systemitem class="resource">bcache</systemitem> 设备的布局，请使用 <literal>drive</literal> 部分，并将 <literal>type</literal> 元素设置为 <literal>CT_BCACHE</literal>。<systemitem class="resource">bcache</systemitem> 设备的布局可以包含分区。
     </para>
    </listitem>
   </itemizedlist>

   <example>
    <title><systemitem class="resource">bcache</systemitem> 定义</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;enable_snapshots config:type="boolean"&gt;true&lt;/enable_snapshots&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;size&gt;2GiB&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;msdos&lt;/disklabel&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;!-- It can serve as caching device for several bcaches --&gt;
        &lt;bcache_caching_for config:type="list"&gt;
          &lt;listentry&gt;/dev/bcache0&lt;/listentry&gt;
        &lt;/bcache_caching_for&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;device&gt;/dev/sdc&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;disklabel&gt;msdos&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;!-- It can serve as backing device for one bcache --&gt;
        &lt;bcache_backing_for&gt;/dev/bcache0&lt;/bcache_backing_for&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_BCACHE&lt;/type&gt;
    &lt;device&gt;/dev/bcache0&lt;/device&gt;
    &lt;bcache_options&gt;
      &lt;cache_mode&gt;writethrough&lt;/cache_mode&gt;
    &lt;/bcache_options&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/data&lt;/mount&gt;
        &lt;size&gt;20GiB&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;size&gt;1GiB&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
</example>

   <para>
    目前，<literal>bcache_options</literal> 部分中唯一支持的选项是下面所述的 <literal>cache_mode</literal>。
   </para>
   <variablelist>
    <varlistentry>
     <term>cache_mode</term>
     <listitem>
      <para>
       <systemitem class="resource">bcache</systemitem> 的缓存模式。可能的值为：
      </para>
      <itemizedlist>
       <listitem>
        <para>
        <literal>writethrough</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>writeback</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>writearound</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>none</literal>
        </para>
       </listitem>
      </itemizedlist>
<screen>&lt;cache_mode&gt;writethrough&lt;/cache_mode&gt;</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="ay-multidevice-btrfs">
   <title>多设备 Btrfs 配置</title>

   <para>
    Btrfs 支持创建跨越多个储存设备的单个卷，提供与软件 RAID 实现类似的功能，例如 Linux 内核的内置 <command>mdraid</command> 子系统。<emphasis>多设备 Btrfs</emphasis> 比其他某些 RAID 实现更具优势。例如，可将多设备 Btrfs 卷从一个 RAID 级别动态迁移到另一个 RAID 级别、可按文件设置 RAID 级别等。但是，并非所有这些功能在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 SP 3 中仍受到完全支持。
   </para>
    
   <para>使用 AutoYaST 时，可以通过指定 <literal>CT_BTRFS</literal> 类型的驱动器来配置多设备 Btrfs。<literal>device</literal> 属性用作标识每个多设备 Btrfs 的任意名称。
   </para>

   <para>
    与使用 RAID 时一样，需要先创建所有块设备（例如分区、LVM 逻辑卷等），并将其指派到您要通过此类块设备创建的 Btrfs 文件系统。
   </para>

   <para>
    以下示例演示了一种简单的多设备 Btrfs 配置：
   </para>

   <example>
    <title>多设备 Btrfs 配置</title>
      <screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions&gt;
      &lt;partition&gt;
        &lt;btrfs_name&gt;root_fs&lt;/btrfs_name&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;gpt&lt;/disklabel&gt;
    &lt;partitions&gt;
      &lt;partition&gt;
        &lt;partition_nr&gt;1&lt;/partition_nr&gt;
        &lt;size&gt;4gb&lt;/size&gt;
        &lt;filesystem&gt;ext4&lt;/filesystem&gt;
        &lt;btrfs_name&gt;root_fs&lt;/btrfs_name&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;root_fs&lt;/device&gt;
    &lt;type config:type="symbol"&gt;CT_BTRFS&lt;/type&gt;
    &lt;partitions&gt;
      &lt;partition config:type="list&gt;
        &lt;mount&gt;/&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;btrfs_options&gt;
      &lt;raid_leve&gt;raid1&lt;/raid_level&gt;
      &lt;metadata_raid_leve&gt;raid1&lt;/metadata_raid_level&gt;
    &lt;/btrfs_options&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
   </example>

   <para>
    支持的数据和元数据 RAID 级别为：<literal>default</literal>、<literal>single</literal>、<literal>dup</literal>、<literal>raid0</literal>、<literal>raid1</literal> 和 <literal>raid10</literal>。默认情况下，文件系统元数据会在两个设备中镜像，而数据会在所有设备间分条。如果只存在一个设备，则在这一个设备上复制元数据。
   </para>
   

 
   <para>
    配置多设备 Btrfs 文件系统时请记住以下几点：
   </para>

   <itemizedlist>
    <listitem>
     <para>
      设备需要指明 <literal>btrfs_name</literal> 属性才能包含到多设备 Btrfs 文件系统中。
     </para>
    </listitem>
    <listitem>
     <para>
      所有 Btrfs 特定的选项都包含在 <literal>CT_BTRFS</literal> 驱动器的 <literal>btrfs_options</literal> 资源中。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>


  <sect2 xml:id="ay-partition-nfs">
   <title>NFS 配置</title>

   <para>
    AutoYaST 允许将 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装到<emphasis>网络文件系统</emphasis> (NFS) 共享中。为此，您必须创建 <literal>CT_NFS</literal> 类型的驱动器，并提供 NFS 共享名 (<replaceable>SERVER:PATH</replaceable>) 作为设备名称。与安装点相关的信息包含在其第一个 partition 部分中。请注意，对于 NFS 驱动器，只会考虑第一个分区。
   </para>
   <para>
    有关安装系统后如何配置 NFS 客户端和服务器的详细信息，请参见<xref linkend="ay-partition-nfs"/>。
   </para>

   <example>
    <title>NFS 共享定义</title>
      <screen>
        &lt;partitioning config:type="list"&gt;
          &lt;drive&gt;
            &lt;device&gt;192.168.1.1:/exports/root_fs&lt;/device&gt;
            &lt;type config:type="symbol"&gt;CT_NFS&lt;/type&gt;
            &lt;use&gt;all&lt;/use&gt;
            &lt;partitions config:type="list"&gt;
              &lt;partition&gt;
                &lt;mount&gt;/&lt;/mount&gt;
                &lt;fstopt&gt;nolock&lt;/fstopt&gt;
              &lt;/partition&gt;
            &lt;/partitions&gt;
          &lt;/drive&gt;
        &lt;/partitioning&gt;
      </screen>
    </example>
  </sect2>

  <sect2 xml:id="ay-partition-tmpfs">
   <title><literal>tmpfs</literal> 配置</title>

   <para>
    如果将 <literal>type</literal> 元素设为 <literal>CT_TMPFS</literal>，AutoYaST 将可支持 <literal>tmpfs</literal> 虚拟文件系统定义。每个 <literal>partition</literal> 部分都代表一个 <literal>tmpfs</literal> 文件系统。
   </para>

   <example>
    <title><literal>tmpfs</literal> 定义</title>
    <screen>
      &lt;partitioning config:type="list"&gt;
        &lt;drive&gt;
          &lt;type config:type="symbol"&gt;CT_TMPFS&lt;/type&gt;
          &lt;partitions config:type="list"&gt;
            &lt;partition&gt;
              &lt;mount&gt;/srv&lt;/mount&gt;
              &lt;fstopt&gt;size=512M&lt;/fstopt&gt;
            &lt;/partition&gt;
            &lt;partition&gt;
              &lt;mount&gt;/temp&lt;/mount&gt;
            &lt;/partition&gt;
          &lt;/partitions&gt;
        &lt;drive&gt;
      &lt;partitioning&gt;
     </screen>
   </example>

   <para>
     <literal>tmpfs</literal> 设备与普通文件系统（如 Ext4 或 Btrfs）不同。因此，仅有的相关元素是 <literal>mount</literal>（必要）和 <literal>fstopt</literal>。后者用于设置文件系统属性，例如其大小限制、模式等。<literal>tmpfs</literal> 手册页中提供了有关已知选项的更多信息。
   </para>
  </sect2>

   <sect2 os="sles" xml:id="ay-partition-s390">
    <title>特定于 IBM Z 的配置</title>
    <para/>
    <sect3 xml:id="ay-partition-s390-dasd">
     <title>配置 DASD 磁盘</title>
     <para>
      下面列出的元素必须放在以下 XML 结构中：
     </para>
<screen>&lt;dasd&gt;
 &lt;devices config:type="list"&gt;
  &lt;listentry&gt;
   ...
  &lt;/listentry&gt;
 &lt;/devices&gt;
&lt;/dasd&gt;</screen>
     <para>
      &lt;profile&gt; 部分中的标记。需在单独的 &lt;listentry&gt; ... &lt;/listentry&gt; 部分配置每个磁盘。
     </para>

     <variablelist>
      <title>DASD 配置</title>
      
      <varlistentry>
       <term>device</term>
       <listitem>
        <para>
         <literal>DASD</literal> 是唯一允许的值
        </para>
<screen>&lt;device&gt;DASD&lt;/dev_name&gt;</screen>
       </listitem>
      </varlistentry>
      
      <varlistentry>
       <term>dev_name</term>
       <listitem>
        <para>
         您要在此部分配置的设备 (<literal>dasd<replaceable>N</replaceable></literal>)。
        </para>
<screen>&lt;dev_name&gt;/dev/dasda&lt;/dev_name&gt;</screen>
        <para>
         可选，但建议指定。如果留空，AutoYaST 将尝试猜测设备。
        </para>
       </listitem>
      </varlistentry>
      
      <varlistentry>
       <term>channel</term>
       <listitem>
        <para>
         用于访问磁盘的通道。
        </para>
<screen>&lt;channel&gt;0.0.0150&lt;/channel&gt;</screen>
        <para>
         必需。
        </para>
       </listitem>
      </varlistentry>
      
      <varlistentry>
       <term>diag</term>
       <listitem>
        <para>
         启用或禁用 <literal>DIAG</literal>。可能的值为 <literal>true</literal>（启用）或 <literal>false</literal>（禁用）。
        </para>
<screen>&lt;diagconfig:type="boolean"&gt;true&lt;/diag&gt;</screen>
         <para>
          可选。
         </para>
       </listitem>
      </varlistentry>
      
     </variablelist>
    </sect3>
    
    <sect3 xml:id="ay-partition-s390-zfcp">
     <title>配置 zFCP 磁盘</title>
     <para>
      以下元素必须放在以下 XML 结构中：
     </para>
<screen>&lt;profile&gt;
  &lt;zfcp&gt;
    &lt;devices config:type="list"&gt;
      &lt;listentry&gt;
        ...
      &lt;/listentry&gt;
    &lt;/devices&gt;
  &lt;/zfcp&gt;
&lt;profile&gt;</screen>
     <para>
      需在单独的 <literal>listentry</literal> 部分配置每个磁盘。
     </para>

     <variablelist>
      <varlistentry>
       <term>controller_id</term>
       <listitem>
       <para>
        通道编号
       </para>
<screen>&lt;controller_id&gt;0.0.fc00&lt;/controller_id&gt;</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     
     <para>
       <literal>controller_id</literal> 元素是必要元素。
     </para>
     <para>
       可选元素有两个，分别是 <literal>wwpn</literal>（全球端口号，用于挂接 SCSI 设备的目标端口）和 <literal>fcp_lun</literal>（SCSI 设备的逻辑单元号）。对于在 NPIV（节点端口 ID 虚拟化）模式下运行的 FCP 设备，以及 zfcp 模块参数 <literal>allow_lun_scan</literal> 设为 1（默认设置，可让 zfcp 设备驱动程序自动进行 LUN 扫描）的情况，不需要指定这些选项。
     </para>
     <para>
       如果自动 LUN 扫描功能不可用，请手动设置 <literal>wwpn</literal> 和 <literal>fcp_lun</literal> 选项。
     </para>

     <variablelist>
      <varlistentry>
        <term>wwpn</term>
       <listitem>
       <para>
        全球端口号
       </para>
<screen>&lt;wwpn&gt;0x500507630300c562&lt;/wwpn&gt;</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
        <term>fcp_lun</term>
       <listitem>
       <para>
        逻辑单元号
       </para>
<screen>&lt;fcp_lun&gt;0x4010403200000000&lt;/fcp_lun&gt;</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     
     <para>
       有关详细信息，请参见相应 IBM 文档：<link xlink:href=" https://www.ibm.com/docs/en/linux-on-systems?topic=wsd-configuring-devices"/>。
     </para>
    </sect3>
   </sect2>
  </sect1>
