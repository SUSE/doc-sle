<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec-zseries-prep">
 <title>Vorbereitung der Installation</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  In diesem Abschnitt erfahren Sie, wie Sie die Daten zur Installation bereitstellen, <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> mit verschiedenen Methoden installieren und den IPL-Vorgang des <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystems vorbereiten und ausführen. Das Kapitel enthält auch Informationen zur Netzwerkkonfiguration und Netzwerkinstallation.
 </para>

 <sect2 xml:id="sec-prep-makeavail">
  <title>Bereitstellen der Installationsdaten</title>
  <para>
   In diesem Abschnitt finden Sie ausführliche Informationen dazu, wie Sie die Installationsdaten für <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf IBM Z zur Installation bereitstellen. Je nach Computer- und Systemumgebung treffen Sie eine Auswahl zwischen der NFS- oder FTP-Installation. Wenn Sie in Ihrer Umgebung Microsoft Windows-Arbeitsstationen betreiben, können Sie das Windows-Netzwerk einschließlich des SMB-Protokolls für die Installation von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf dem System mit IBM Z verwenden.
  </para>
  <tip>
   <title>IPL von DVD</title>
   <para>
    Der IPL-Vorgang kann von DVD ausgeführt werden und die DVD kann als Installationsmedium herangezogen werden. Dies ist besonders praktisch, wenn Beschränkungen für das Einrichten eines Installationsservers bestehen, der Installationsmedien über das Netzwerk bereitstellt. Voraussetzung ist ein per FCP angeschlossenes SCSI-DVD-Laufwerk.
   </para>
  </tip>
  <note>
   <title>Keine Installation von einer Festplatte</title>
   <para>
    Es ist nicht möglich, von einer Festplatte zu installieren, indem der Inhalt der DVD auf eine Partition auf einem DASD kopiert wird.
   </para>
  </note>
  <sect3 xml:id="sec-prep-makeavail-linuxws">
   <title>Verwenden einer DVD für Linux Workstation oder <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase></title>
   <para>
    Sie können einen Linux-Arbeitsplatzrechner in Ihrer Rechnerumgebung ausführen, um die Installationsdaten dem IBM Z-Installationsvorgang mit NFS oder FTP bereitzustellen.
   </para>
   <important>
    <title>Export eingehängter Geräte über NFS</title>
    <para>
     Durch das Exportieren des Dateisystem-root (<filename>/</filename>) werden eingehängte Geräte (z. B. DVD) nicht automatisch exportiert. Daher müssen Sie den Einhängepunkt unter <filename>/etc/exports</filename> explizit benennen:
    </para>
<screen>/media/dvd  *(ro)</screen>
    <para>
     Führen Sie nach der Änderung dieser Datei den Neustart des NFS-Servers mit dem Befehl  <command>sudo systemctl restart nfsserver</command>   durch.
    </para>
   </important>
   <para>
    Die Einrichtung eines FTP-Servers auf einem Linux-System umfasst die Installation und Konfiguration der Serversoftware, beispielsweise <package>vsftpd</package>. Da ein Download der Installationsdaten über eine anonyme Anmeldung nicht unterstützt wird, müssen Sie den FTP-Server für die Unterstützung der Benutzerauthentifizierung konfigurieren.
   </para>
   <sect4 xml:id="sec-prep-makeavail-linuxws-oncd">
    <title><phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf DVD</title>
    <para>
     Das erste Installationsmedium des <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> für IBM Z enthält ein bootfähiges Linux-Image für Intel-gestützte Arbeitsplatzrechner sowie ein Image für IBM Z.
    </para>
    <para>
     Booten Sie bei Intel-basierten Arbeitsplatzrechnern von diesem Medium. Wählen Sie bei Aufforderung die gewünschte Antwortsprache und Tastaturbelegung und wählen Sie <guimenu>Rettungssystem starten</guimenu> aus. Hierfür sind mindestens 64 MB RAM erforderlich. Festplattenspeicher wird nicht benötigt, da sich das gesamte Rettungssystem im RAM des Arbeitsplatzrechners befindet. Für diesen Ansatz muss das Networking des Arbeitsplatzrechners manuell eingerichtet werden.
    </para>
    <para>
     Führen Sie für IBM Z für Ihre LPAR/Ihren VM-Gast IPL von diesem Medium aus, wie in <xref linkend="sec-prep-ipling-lpar-dvd"/> beschrieben. Nach Eingabe Ihrer Netzwerkparameter behandelt das Installationssystem das Medium als Quelle der Installationsdaten. Da an IBM Z kein X11-fähiges Terminal direkt angeschlossen werden kann, wählen Sie zwischen VNC- und SSH-Installation. SSH bietet auch eine grafische Installation durch Tunneling der X-Verbindung über SSH mit <command>ssh -X</command>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-windowsws">
   <title>Mit einer Microsoft Windows-Arbeitsstation</title>
   <para>
    Sie können die Installationsmedien auf einer Microsoft Windows-Arbeitsstation in Ihrem Netzwerk zur Verfügung stellen. Am einfachsten gelingt dies mit dem SMB-Protokoll. Aktivieren Sie in jedem Fall <guimenu>SMB über TCP/IP</guimenu>, da hierdurch die Verkapselung von SMB-Paketen in TCP/IP-Pakete ermöglicht wird. Detaillierte Informationen finden Sie in der Windows-Online-Hilfe bzw. in anderen Windows-Dokumentationen, die sich auf Netzwerke beziehen.
   </para>
   <sect4 xml:id="sec-prep-makeavail-windowsws-smb">
    <title>Verwenden von SMB</title>
    <para>
     Sie stellen die Installationsmedien mit SMB zur Verfügung, indem Sie das USB-Flash-Laufwerk mit SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.iso am USB-Port der Windows-Arbeitsstation anschließen. Erstellen Sie dann unter Verwendung des Laufwerkbuchstabens des USB-Flash-Laufwerks eine neue Freigabe und stellen Sie sie für sämtliche Benutzer im Netzwerk bereit.
    </para>
    
    <para>
     Der Installationspfad in YaST kann wie folgt lauten:
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     Die Platzhalter bedeuten dabei Folgendes:
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable></term>
      <listitem>
       <para>
        Optionale Arbeitsgruppe oder Active Directory-Domäne.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable></term>
      <term><replaceable>PW</replaceable></term>
      <listitem>
       <para>
        Optionaler Benutzername und Passwort eines Benutzers, der auf diesen Server und seine Freigabe zugreifen kann.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable></term>
      <listitem>
       <para>
        Name des Servers, auf dem sich die Freigabe(n) befinden.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable></term>
      <listitem>
       <para>
        Pfad für die Freigabe(n).
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para/>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-nfs">
    <title>Mit NFS</title>
    <para>
     Ziehen Sie die im Lieferumfang des Drittanbieter-Produkts enthaltene Dokumentation zurate, mit dem NFS-Serverdienste für Ihre Windows-Arbeitsstation aktiviert werden. Das USB-Flash-Laufwerk mit dem Medium SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.iso muss sich im verfügbaren NFS-Pfad befinden.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-ftp">
    <title>FTP verwenden</title>
    <para>
     Ziehen Sie die im Lieferumfang des Drittanbieter-Produkts enthaltene Dokumentation zurate, mit dem FTP-Serverdienste auf Ihrer Windows-Arbeitsstation aktiviert werden. Das USB-Flash-Laufwerk mit dem Medium SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.iso muss sich im verfügbaren FTP-Pfad befinden.
    </para>
    <para>
     Der in bestimmten Versionen von Microsoft Windows enthaltene FTP-Server implementiert lediglich eine Teilmenge des FTP-Kommandosatzes und ist für die Bereitstellung der Installationsdaten nicht geeignet. Verwenden Sie in diesem Fall einen FTP-Server eines Drittanbieters, der die erforderliche Funktionalität bietet.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-scsi">
    <title>Verwenden eines per FCP angeschlossenen SCSI-DVD-Laufwerks</title>
    <para>
     Nachdem Sie den IPL-Vorgang, wie in <xref linkend="sec-prep-ipling-lpar-dvd"/> beschrieben, durchgeführt haben, verwendet das Installationssystem die DVD als Installationsmedium. In diesem Fall benötigen Sie die Installationsmedien nicht auf einem FTP-, NFS- oder SMB-Server. Sie benötigen jedoch die Netzwerkkonfigurationsdaten für Ihren <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>, da Sie das Netzwerk während der Installation zur Ausführung einer grafischen Installation über VNC oder X-Tunneling durch SSH einrichten müssen.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-zpxe-cobbler">
   <title>Verwenden eines Cobbler-Servers für zPXE</title>
   <para>
    Zur Ausführung von IPL vom Netzwerk ist ein Cobbler-Server mit Kernel, initrd und Installationsdaten erforderlich. Der Cobbler-Server wird in den folgenden Schritten vorbereitet:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-import"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-system"/>
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-import">
    <title>Importieren der Installationsdaten</title>
    <para>
     Zum Importieren der Medien muss die Installationsquelle auf dem Cobbler-Server verfügbar sein – wahlweise als USB-Flash-Laufwerk oder als Netzwerkquelle. Führen Sie den folgenden Befehl aus, um die Daten zu importieren:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler import --path=<replaceable>PATH</replaceable><co xml:id="co-cobbler-import-path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-import-dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="co-cobbler-import-path">
      <para>
       Einhängepunkt der Installationsdaten.
      </para>
     </callout>
     <callout arearefs="co-cobbler-import-dirname">
      <para>
       Eine Zeichenkette, die das importierte Produkt bezeichnet, z. B. <quote>sles15_s390x</quote>. Diese Zeichenkette wird als Name für das Unterverzeichnis verwendet, in das die Installationsdaten kopiert werden. Auf einem Cobbler-Server unter SUSE Linux Enterprise ist dies: <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>. Wenn Cobbler unter einem anderen Betriebssystem ausgeführt wird, gilt ggf. ein anderer Pfad.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-add-distro">
    <title>Hinzufügen einer Distribution</title>
    <para>
     Durch das Hinzufügen einer Distribution kann Cobbler die für IPL erforderlichen Bestandteile (Kernel und initrd) über zPXE bereitstellen. Zum Hinzufügen von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> für IBM Z führen Sie das folgende Kommando auf dem Cobbler-Server aus:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-identifier"/> \
  --os-version=<phrase os="slemicro">slemicro5.2</phrase><co xml:id="co-cobbler-add-os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="co-cobbler-add-initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="co-cobbler-add-kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-server"/>
    </screen>    
    <calloutlist>
     <callout arearefs="co-cobbler-add-identifier">
      
      <para os="slemicro">
       Eindeutige Kennung für die Distribution, beispielsweise <quote>SLE Micro <phrase role="productnumber"><phrase os="slemicro">5.5</phrase></phrase> IBM Z</quote>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-os">
      <para>
       Kennung für das Betriebssystem. Verwenden Sie <literal>sles15</literal>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-initrd">
      <para>
       Path für initrd. Der erste Teil des Pfads (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) ist abhängig vom Speicherort der importierten Daten und dem Namen des Unterverzeichnisses, den Sie beim Importieren der Installationsdaten ausgewählt haben.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-kernel">
      <para>
       Pfad des Kernels. Der erste Teil des Pfads (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) ist abhängig vom Speicherort der importierten Daten und dem Namen des Unterverzeichnisses, den Sie beim Importieren der Installationsdaten ausgewählt haben.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-server">
      <para>
       URL des Installationsverzeichnisses auf dem Cobbler-Server.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-profile">
    <title>Anpassen des Profils</title>
    <para>
     Durch Hinzufügen einer Distribution (weitere Informationen finden Sie in <xref linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>) wird automatisch ein Profil mit dem entsprechenden <replaceable>IDENTIFIER</replaceable> generiert. Mit dem folgenden Befehl nehmen Sie einige erforderliche Anpassungen vor:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-profile-name"/> --os-version=sles10<co xml:id="co-cobbler-profile-os"/> --ksmeta=""<co xml:id="co-cobbler-profile-meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-profile-opts"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-profile-name">
      <para>
       Kennung für das Profil. Verwenden Sie die Zeichenkette, die Sie beim Hinzufügen der Distribution angegeben haben.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-os">
      <para>
       Version des Betriebssystems. Distribution, für die das Profil gelten soll. Verwenden Sie die Zeichenkette, die Sie mit <option>--name=<replaceable>IDENTIFIER</replaceable></option> beim Importieren festgelegt haben.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-meta">
      <para>
       Erforderliche Option zum Erstellen von Vorlagen für Kickstart-Dateien. Lassen Sie das Feld für diese Option leer, da sie für SUSE nicht verwendet wird.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-opts">
      <para>
       Durch Komma getrennte Liste der Kernel-Parameter. Sie muss mindestens den Parameter <literal>install</literal> enthalten.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-system">
    <title>Hinzufügen von Systemen</title>
    <para>
     Als letzten Schritt fügen Sie Systeme zum Cobbler-Server hinzu. Dieser Schritt muss für jeden IBM Z-Gast ausgeführt werden, der über zPXE booten sollte. Gäste werden durch ihre z/VM-Benutzer-ID gekennzeichnet (im folgenden Beispiel die ID <quote>linux01</quote>). Beachten Sie, dass die ID in Kleinbuchstaben geschrieben werden muss. Führen Sie den folgenden Befehl aus, um ein System hinzuzufügen:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     Mit der Option <option>--kopts</option> geben Sie den Kernel und die Installationsparameter an, die normalerweise in der Parameterdatei angegeben sind. Geben Sie die Parameter in folgendem Format an: <replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>. Das Installationsprogramm fordert Sie zur Eingabe der fehlenden Parameter auf. Für eine vollständig automatisierte Installation müssen Sie alle Parameter für Netzwerke und DASDs angeben und eine AutoYaST-Datei bereitstellen. Nachfolgend sehen Sie ein Beispiel für einen Gast mit einer OSA-Schnittstelle, der die obigen Netzwerkparameter nutzt.
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-dvd-usb-hmc">
   <title>Installieren von einem USB-Flash-Laufwerk der HMC</title>
   <para>
    Für die Installation von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf IBM Z-Servern ist normalerweise eine Netzwerkinstallationsquelle erforderlich. Ist diese Anforderung nicht erfüllt, lässt SUSE Linux Enterprise Server das USB-Flash-Laufwerk der Hardware Management Console (HMC) als Installationsquelle für die Installation auf einer LPAR zu.
   </para>
   <para>
    Gehen Sie folgendermaßen vor, um die Installation vom USB-Flash-Laufwerk der HMC durchzuführen:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Fügen Sie <option>install=hmc:/</option> zu <filename>parmfile</filename> hinzu (siehe <xref linkend="sec-appdendix-parm"/>) oder fügen Sie Kerneloptionen hinzu.
     </para>
    </listitem>
    <listitem>
     <para>
      Verwenden Sie <filename>linuxrc</filename> für die Installation im manuellen Modus, wählen Sie <emphasis role="italic">Installation starten</emphasis>, dann <emphasis role="italic">Installation</emphasis> und schließlich <emphasis role="italic">Hardware Management Console</emphasis>. Das Installationsmedium muss sich in der HMC befinden.
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>Konfigurieren des Netzwerks</title>
    <para>
     Geben Sie vor der Installation eine Netzwerkkonfiguration in <filename>linuxrc</filename> an. Dies ist nicht über Boot-Parameter möglich und Sie benötigen dazu sehr wahrscheinlich einen Netzwerkzugriff. Rufen Sie in <filename>linuxrc</filename> die Option <emphasis role="italic">Installation starten</emphasis> auf und wählen Sie dann <emphasis role="italic">Netzwerkkonfiguration</emphasis> aus.
    </para>
   </important>
   <important>
    <title>Das Linux-System muss zuerst gebootet werden</title>
    <para>
     Erteilen Sie den Zugriff auf die Medien auf dem USB-Flash-Laufwerk der HMC erst nach dem Booten des Linux-Systems. Der IPL-Vorgang kann die Verbindung zwischen der HMC und der LPAR stören. Falls beim ersten Versuch mit der beschriebenen Methode ein Fehler auftritt, können Sie den Zugriff erteilen und die Option <option>HMC</option> wiederholen.
    </para>
   </important>
   <note>
    <title>Installations-Repository</title>
    <para>
     Das USB-Flash-Laufwerk wird nicht als Installations-Repository beibehalten, weil die Installation ein einmaliger Vorgang ist. Falls Sie ein Installations-Repository benötigen, müssen Sie das Online-Repository registrieren und verwenden.
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-inst-types">
  <title>Installationsarten</title>
  <para>
   In diesem Abschnitt werden die Installationsschritte von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> für jeden einzelnen Installationsmodus beschrieben. Folgen Sei nach Abschluss der in den vorigen Kapiteln beschriebenen Vorbereitungsschritte dem Überblick des gewünschten Installationsmodus.
  </para>
  <para>
   Wie in <xref linkend="sec-prep-makeavail"/> beschrieben gibt es drei verschiedene Installationsmodi für Linux auf IBM Z: LPAR, z/VM und die Installation eines KVM-Gasts.
  </para>
  <procedure xml:id="pro-prep-inst-types-lpar">
   <title>Überblick über eine LPAR-Installation</title>
   <step>
    <para>
     Bereiten Sie die für die Installation benötigten Geräte vor. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-prep-ipl-natlpar"/>.
    </para>
   </step>
   <step>
    <para>
     Führen Sie den IPL-(Initial Program Load-)Vorgang für das Installationssystem durch. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-ipling-lpar"/>.
    </para>
   </step>
   <step>
    <para>
     Konfigurieren Sie das Netzwerk. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Stellen Sie eine Verbindung zum <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem her. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Starten Sie die Installation mit YaST, und führen Sie den IPL-Vorgang für das installierte System durch. Weitere Informationen hierzu finden Sie unter <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-vm">
   <title>Installationsüberblick über die z/VM-Installation</title>
   <step>
    <para>
     Bereiten Sie die für die Installation benötigten Geräte vor. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-prep-ipl-vm-linux-guest"/>.
    </para>
   </step>
   <step>
    <para>
     Führen Sie den IPL-(Initial Program Load-)Vorgang für das Installationssystem durch. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-ipling-vm"/>.
    </para>
   </step>
   <step>
    <para>
     Konfigurieren Sie das Netzwerk. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Stellen Sie eine Verbindung zum <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem her. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Starten Sie die Installation mit YaST, und führen Sie den IPL-Vorgang für das installierte System durch. Weitere Informationen hierzu finden Sie unter <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-kvm">
   <title>Überblick über die Installation eines KVM-Gasts</title>
   <step>
    <para>
     Erstellen Sie ein Image des virtuellen Datenträgers und schreiben Sie eine XML-Domänendatei. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-prep-ipl-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     Bereiten Sie das Installationsziel vor und führen Sie einen IPL-Vorgang für den VM-Gast (VM Guest) aus. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-ipling-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec-prep-netcfg-data"/>.
    </para>
   </step>
   <step>
    <para>
     Stellen Sie eine Verbindung zum <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem her. Weitere Informationen hierzu finden Sie unter <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Starten Sie die Installation mit YaST, und führen Sie den IPL-Vorgang für das installierte System durch. Weitere Informationen hierzu finden Sie unter <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-prep-prep-ipl">
  <title>Vorbereiten des IPL-Vorgangs für das <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem</title>
  <para/>
  <sect3 xml:id="sec-prep-prep-ipl-natlpar">
   <title>IPL-Vorbereitung einer LPAR-Installation</title>
   <para>
    Konfigurieren Sie Ihr IBM Z-System so, dass der Start im ESA/S390- oder Nur-Linux-Modus erfolgt (mit entsprechendem Aktivierungsprofil und IOCDS). Weitere Informationen finden Sie in der IBM-Dokumentation. Fahren Sie fort wie in <xref linkend="sec-prep-ipling-lpar"/> beschrieben.
   </para>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-vm">
   <title>IPL-Vorbereitung einer z/VM-Installation</title>
   <para/>
   <sect4 xml:id="sec-prep-prep-ipl-vm-linux-guest">
    <title>Hinzufügen eines Linux-Gasts mit dirMaint</title>
    <para>
     Zunächst werden ein oder mehrere DASDs im System hinzugefügt, zur Verwendung durch den Linux-Gast-Benutzer in z/VM. Dann wird ein neuer Benutzer in z/VM erstellt. Das Beispiel zeigt das Verzeichnis für einen Benutzer <literal>LINUX1</literal> mit Passwort <literal>LINPWD</literal>, 1 GB Speicher (auf maximal 2 GB erweiterbar), mehreren Minidisks (MDISK), zwei CPUs und einem OSA-QDIO-Gerät.
    </para>
    <tip>
     <title>Zuweisen von Speicher für z/VM-Gast-Benutzer</title>
     <para>
      Wenn Sie einem z/VM-Gast Speicher zuweisen, vergewissern Sie sich, dass die Speichergröße auf den bevorzugten Installationstyp abgestimmt ist, wie in <xref linkend="sec-zseries-requirements-hw-mem"/> beschrieben. Um die Arbeitsspeichergröße auf  GB einzustellen, verwenden Sie den Befehl <command>CP DEFINE STORAGE 1G</command> 1. Setzen Sie nach dem Abschluss der Installation die Arbeitsspeichergröße auf den gewünschten Wert zurück.
     </para>
    </tip>
    <example xml:id="ex-prep-prep-ipl-vm-linux-guest-config">
     <title>Konfiguration eines z/VM-Verzeichnisses</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     In diesem Beispiel wird Minidisk 201 als Home-Disk des Gast-Benutzers verwendet. Minidisk 150 mit 200 Zylindern ist das Linux-Auslagerungsgerät. Auf Disk 151 mit 2800 Zylindern wird die Linux-Installation verwaltet.
    </para>
    <para>
     Fügen Sie nun als Benutzer <systemitem class="username">MAINT</systemitem> den Gast mit <command>DIRM FOR LINUX1 ADD</command> dem Benutzerverzeichnis hinzu. Geben Sie den Namen des Gasts ein (<literal>LINUX1</literal>) und drücken Sie <keycap>F5</keycap>. Verwenden Sie zur Einrichtung der Umgebung des Benutzers Folgendes:
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     Das letzte Kommando gibt eine Reader-Dateinummer zurück Diese Nummer wird für den nächsten Befehl benötigt:
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     Sie können sich nun als Gast-Benutzer <systemitem class="username">LINUX1</systemitem> anmelden.
    </para>
    <para>
     Wenn die Option <literal>dirmaint</literal> nicht verfügbar ist, konsultieren Sie die IBM-Dokumentation dazu, wie dieser Benutzer eingerichtet wird.
    </para>
    <para>
     Fahren Sie mit <xref linkend="sec-prep-ipling-vm"/> fort.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-kvm">
   <title>IPL-Vorbereitung der Installation eines KVM-Gasts</title>
   <para>
    Für die Installation eines KVM-Gasts sind eine XML-Domänendatei, in der die virtuelle Maschine definiert ist, und mindestens ein Image des virtuellen Datenträgers für die Installation erforderlich. 
   </para>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-disk">
    <title>Erstellen eines Image des virtuellen Datenträgers</title>
    <para>
     Standardmäßig sucht libvirt in <filename>/var/lib/libvirt/images/</filename> auf dem VM-Hostserver nach Datenträger-Images. Images können auch an einer anderen Stelle im Dateisystem gespeichert werden, allerdings wird empfohlen, zur einfacheren Verwaltung alle Images zentral an einem Ort zu speichern. Melden Sie sich zum Erstellen eines Image beim KVM-Hostserver an und führen Sie folgendes Kommando aus:
    </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
    <para>
     Dadurch wird ein qcow2-Image mit einer Größe von 10 GB in <filename>/var/lib/libvirt/images/</filename> erstellt.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-domain">
    <title>Schreiben einer XML-Domänendatei</title>
    <para>
     Der VM-Gast wird in einer XML-Domänendatei definiert. Öffnen Sie zum Erstellen der XML-Domänendatei eine leere Datei (<filename>s15-1.xml</filename>) mit einem Editor und erstellen Sie eine Datei wie im folgenden Beispiel.
    </para>
    <example>
     <title>Beispiel einer XML-Domänendatei</title>
     <para>
      Im folgenden Beispiel wird ein VM-Gast mit einer einzelnen CPU, 1 GB RAM und dem Image des virtuellen Datenträgers aus dem vorherigen Abschnitt (<xref linkend="sec-prep-prep-ipl-kvm-disk"/>) erstellt. Es wird angenommen, dass der virtuelle Server an der Host-Netzwerkschnittstelle <literal>bond0</literal> angeschlossen ist. Ändern Sie das Element für Ursprungsgeräte und passen Sie es an Ihre Netzwerkkonfiguration an.
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s15-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE SLES15&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successful installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s15-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s15-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s15lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-ipling">
  <title>Ausführen des IPL-Vorgangs für das <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem</title>
  <para/>
  <sect3 xml:id="sec-prep-ipling-lpar">
   <title>Ausführen eines IPL-Vorgangs bei einer LPAR-Installation</title>
   <para>
    Für das Ausführen des IPL-Vorgangs für <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> in einer LPAR stehen mehrere Methoden zur Auswahl. Die bevorzugte Vorgehensweise ist die Funktion <guimenu>Load from CD-ROM or server</guimenu> von SE bzw. HMC.
   </para>
   <sect4 xml:id="sec-prep-ipling-lpar-cdrom">
    <title>IPL von DVD-ROM</title>
    <para>
     Markieren Sie die LPAR für die Installation und wählen Sie <guimenu>Load from CD-ROM or server</guimenu> aus. Lassen Sie das Feld für den Dateispeicherort frei oder geben Sie den Pfad zum Stammverzeichnis der ersten DVD-ROM ein und wählen Sie <guimenu>Fortfahren</guimenu> aus. Behalten Sie die Standardauswahl in der angezeigten Liste der Optionen bei. In den Kernel-Boot-Meldungen sollte nun <guimenu>Operating system messages</guimenu> angezeigt werden.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-lpar-dvd">
    <title>IPL von per FCP angeschlossener SCSI-DVD</title>
    <para>
     Sie können den <guimenu>Load</guimenu>-Vorgang verwenden, indem Sie <guimenu>SCSI</guimenu> als <guimenu>Ladetyp</guimenu> für IPL von SCSI auswählen. Geben Sie den WWPN (Worldwide Port Name) und die LUN (Logical unit number) ein, die Ihre SCSI-Bridge oder Ihr SCSI-Speicher bereitstellt (16 Stellen – unterdrücken Sie auf keinen Fall die angehängten Nullen). Die Bootprogrammauswahl muss auf 2 stehen. Verwenden Sie Ihren FCP-Adapter als <guimenu>Ladeadresse</guimenu> und führen Sie einen IPL-Vorgang durch.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-vm">
   <title>Ausführen eines IPL-Vorgangs bei einer z/VM-Installation</title>
   <para>
    In diesem Abschnitt wird der IPL-Vorgang für das Installationssystem zur Installation von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> für IBM Z auf einem z/VM-System beschrieben.
   </para>
   <sect4 xml:id="sec-prep-ipling-vm-reader">
    <title>IPL vom z/VM-Reader</title>
    <para>
     Sie benötigen eine funktionierende TCP/IP-Verbindung und ein FTP-Clientprogramm in Ihrem neu definierten z/VM-Gast, um das Installationssystem über FTP zu übertragen. Die TCP/IP-Einrichtung für z/VM würde den Rahmen dieses Handbuchs sprengen. Ziehen Sie die entsprechende IBM-Dokumentation zurate.
    </para>
    <para>
     Melden Sie sich für den IPL-Vorgang als z/VM-Linux-Gast-Benutzer an. Stellen Sie den Inhalt von Verzeichnis <filename>/boot/s390x</filename> des Unified Installer (Medium 1) in Ihrem Netzwerk über FTP bereit. Rufen Sie die Dateien <filename>linux</filename>, <filename>initrd</filename>, <filename>parmfile</filename> und <filename>sles.exec</filename> aus diesem Verzeichnis ab. Übertragen Sie die Dateien mit einer festen Blockgröße von 80 Zeichen. Geben Sie die Größe mithilfe des FTP-Kommandos <command>locsite fix 80</command> an. <filename>linux</filename> (der Linux-Kernel) und <filename>initrd</filename> (das Installations-Image) müssen in jedem Fall als Binärdateien kopiert werden, Sie sollten folglich den <literal>binary</literal>-Übertragungsmodus verwenden. <filename>parmfile</filename> und <filename>sles.exec</filename> müssen im ASCII-Modus übertragen werden.
    </para>
    <para>
     Im folgenden Beispiel werden die erforderlichen Schritte gezeigt. In diesem speziellen Szenario wird angenommen, dass der Zugriff auf die erforderlichen Dateien von einem FTP-Server mit IP-Adresse <literal>192.168.0.3</literal> möglich ist. Die Anmeldung erfolgt mit <systemitem class="username">lininst</systemitem>.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-ftp-ftptrans">
     <title>Übertragen der Binärdateien über FTP</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles.exec sles.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     Verwenden Sie das heruntergeladene REXX-Skript, sles.exec, um den IPL-Vorgang für das Linux-Installationssystem auszuführen. Mit diesem Skript werden Kernel, parmfile sowie der anfängliche RAM-Datenträger für den IPL-Vorgang in den Reader geladen.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-startscript-slesexec">
     <title>sles.exec</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES LINUX A (NOH'
'PUNCH SLES PARMFILE A (NOH'
'PUNCH SLES INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     Mithilfe dieses Skripts führen Sie den IPL-Vorgang für das <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem mit dem Kommando <command>sles</command> aus. Daraufhin wird der Linux-Kernel gestartet und gibt Boot-Meldungen aus.
    </para>
    <para>
     Fahren Sie zur weiteren Installation mit <xref linkend="sec-prep-netcfg"/> fort.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-dvd">
    <title>IPL von per FCP angeschlossener SCSI-DVD</title>
    <para>
     Bereiten Sie für die Ausführung des IPL-Vorgangs in z/VM den SCSI-IPL-Vorgang mithilfe des Parameters SET LOADDEV vor:
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     Führen Sie nach der Festlegung des LOADDEV-Parameters mit den entsprechenden Werten den IPL-Vorgang Ihres FCP-Parameters durch, z. B.:
    </para>
<screen>IPL FC00</screen>
    <para>
     Fahren Sie zur weiteren Installation mit <xref linkend="sec-prep-netcfg"/> fort.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-zpxe">
    <title>IPL von einem Cobbler-Server mit zPXE</title>
    <para>
     Zur Ausführung von IPL über einen Cobbler-Server mit zPXE übertragen Sie das Skript <filename>zpxe.rexx</filename> per FTP vom Cobbler-Server an den z/VM-Gast. Der z/VM-Gast benötigt dazu eine funktionsfähige TCP/IP-Verbindung und ein FTP-Client-Programm.
    </para>
    <para>
     Melden Sie sich als z/VM Linux-Gast bei IPL an, und übertragen Sie das Skript mit einer festen Größe von 80 Zeichen im ASCII-Modus (ein Beispiel finden Sie im <xref linkend="ex-prep-ipling-vm-reader-ftp-ftptrans"/>). Das Skript <filename>zpxe.rexx</filename> finden Sie auf der Unified Installer-DVD unter <filename>/boot/s390x/zpxe.rexx</filename> oder auf einem SLE Cobbler-Server unter <filename>/usr/share/doc/packages/s390-tools/zpxe.rexx</filename>.
    </para>
    <para>
     <filename>zpxe.rexx</filename> soll <filename>PROFILE EXEC</filename> Ihres Gasts ersetzen. Erstellen Sie eine Sicherungskopie des vorhandenen <filename>PROFILE EXEC</filename> und benennen Sie <filename>ZPXE
     REXX</filename> in <filename>PROFILE EXEC</filename> um. Rufen Sie alternativ <filename>ZPXE REXX</filename> aus dem vorhandenen <filename>PROFILE
     EXEC</filename> ab, indem Sie die Zeile <literal>'ZPXE REXX'</literal> hinzufügen.
    </para>
    <para>
     Im letzten Schritt erstellen Sie eine Konfigurationsdatei (<filename>ZPXE
     CONF</filename>), in der <filename>ZPXE REXX</filename> angewiesen wird, welcher Cobbler-Server kontaktiert und für welchen Datenträger der IPL-Vorgang ausgeführt werden soll. Führen Sie <command>xedit zpxe
     conf a</command> aus und erstellen Sie <filename>ZPXE CONF</filename> mit dem folgenden Inhalt (Beispieldaten entsprechend ersetzen):
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     Damit wird der Cobbler-Server bei der nächsten Anmeldung als z/VM-Gast verbunden. Wenn eine Installation auf dem Cobbler-Server geplant ist, so wird sie gestartet. Zum Planen der Installation führen Sie den folgenden Befehl auf dem Cobbler-Server aus:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system edit --name <replaceable>ID</replaceable><co xml:id="co-cobbler-sysedit-id"/> --netboot-enabled 1<co xml:id="co-cobbler-sysedit-netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="co-cobbler-sysedit-profile"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-sysedit-id">
      <para>
       z/VM-Benutzer-ID.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-netboot">
      <para>
       Aktivieren der IPL-Ausführung vom Netzwerk.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-profile">
      <para>
       Name eines vorhandenen Profils (siehe <xref linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>).
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-kvm">
   <title>Ausführen eines IPL-Vorgangs bei der Installation eines KVM-Gasts</title>
   <para>
    Um mit der Installation des Gasts zu beginnen, müssen Sie zunächst den in <xref linkend="sec-prep-prep-ipl-kvm-disk"/> definierten VM-Gast starten. Stellen Sie vor Beginn sicher, dass der Kernel und initrd für IPL verfügbar sind.
   </para>
   <sect4 xml:id="sec-prep-ipling-kvm-prep">
    <title>Vorbereiten der Installationsquelle</title>
    <para>
     Der Kernel und die initrd des Installationssystems müssen auf den VM-Hostserver kopiert werden, damit der IPL-Vorgang für den VM-Gast im Installationssystem möglich ist.
    </para>
    <procedure>
     <step>
      <para>
       Melden Sie sich am KVM-Host an und vergewissern Sie sich, dass Sie eine Verbindung zum Remote-Host oder dem Gerät herstellen können, der bzw. das die Installationsquelle bereitstellt.
      </para>
     </step>
     <step>
      <para>
       Kopieren Sie die folgenden beiden Dateien aus der Installationsquelle nach <filename>/var/lib/libvirt/images/</filename>. Wenn die Daten von einem Remote-Host bereitgestellt werden, übertragen Sie diese mit <command>ftp</command>, <command>sftp</command> oder <command>scp</command>:
      </para>
      <simplelist><member><filename>/boot/s390x/initrd</filename></member><member><filename>/boot/s390x/cd.ikr</filename></member>
      </simplelist>
     </step>
     <step>
      <para>
       Benennen Sie die Dateien auf dem KVM-Host um:
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cd /var/lib/libvirt/images/
<prompt>&gt; </prompt><command>sudo</command> mv initrd s15-initrd.boot
<prompt>&gt; </prompt><command>sudo</command> mv cd.ikr s15-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-kvm-guest">
    <title>IPL-Vorgang für den VM-Gast</title>
    <para>
     Zur Ausführung des IPL-Vorgangs für den VM-Gast müssen Sie sich am KVM-Host anmelden und den folgenden Befehl ausführen:
    </para>
<screen><prompt>&gt; </prompt>virsh  create s15-1.xml --console</screen>
    <para>
     Der Installationsvorgang startet, sobald der VM-Gast aktiv ist und ausgeführt wird. Sie sollten dann folgende Meldung sehen:
    </para>
<screen>Domain s15-1 started
Connected to domain s15-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     Beantworten Sie die Frage mit <guimenu>2) No</guimenu> (Nein) und wählen Sie im nächsten Schritt <guimenu>Installation</guimenu> aus. Fahren Sie entsprechend den Anweisungen in <xref linkend="sec-prep-netcfg-data"/> fort.
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-netcfg">
  <title>Netzwerkkonfiguration</title>
  <para>
   Warten Sie, bis der Kernel seine Startroutinen abgeschlossen hat. Wenn Sie die Installation im Basismodus oder in einer LPAR vornehmen, rufen Sie an der HMC bzw. in SE <guimenu>Operating System Messages</guimenu> auf.
  </para>
  <para>
   Wählen Sie zunächst <guimenu>Installation starten</guimenu> im Hauptmenü von <filename>linuxrc</filename>. Wählen Sie dann <guimenu>Installation oder Aktualisierung starten</guimenu>, um den Installationsvorgang zu starten. Wählen Sie <guimenu>Netzwerk</guimenu> als Installationsmedium und danach den Netzwerkprotokolltyp aus, den Sie zur Installation verwenden möchten. <xref linkend="sec-prep-makeavail"/> beschreibt, wie die Installationsdaten für die unterschiedlichen Arten von Netzwerkverbindungen bereitgestellt werden. Zurzeit werden <guimenu>FTP</guimenu>, <guimenu>HTTP</guimenu>, <guimenu>NFS</guimenu> und <guimenu>SMB/CIFS</guimenu> (Windows-Dateifreigabe) unterstützt.
  </para>
  <para>
   Wählen Sie aus der Liste der verfügbaren Geräte ein OSA- oder HiperSockets-Netzwerkgerät für den Empfang der Installationsdaten. Obwohl die Liste möglicherweise auch CTC-, ESCON- oder IUCV-Geräte enthält, werden diese jedoch unter <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> nicht mehr unterstützt.
  </para>
  <sect3 xml:id="sec-prep-netcfg-hypersockets">
   <title>Konfigurieren einer HiperSockets-Schnittstelle</title>
   <para>
    Wählen Sie ein HiperSocket-Gerät aus der Liste der Netzwerkgeräte aus. Geben Sie dann die Werte für den Lese-, Schreib- und Datenkanal ein:
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-types">
    <title>Unterstützte Netzwerkverbindungstypen und Treiberparameter</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.0800]&gt; 0.0.0800

Device address for write channel. (Enter '+++' to abort).
[0.0.0801]&gt; 0.0.0801

Device address for data channel. (Enter '+++' to abort).
[0.0.0802]&gt; 0.0.0802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-osa">
   <title>Konfigurieren eines OSA Express-Geräts</title>
   <para>
    Wählen Sie ein OSA Express-Gerät aus der Liste der Netzwerkgeräte aus, und geben Sie eine Portnummer an. Geben Sie die Nummer für den Lese-, Schreib- und Datenkanal ein. Wählen Sie, ob die Unterstützung von OSI-Schicht 2 aktiviert werden soll.
   </para>
   <para>
    Die Portnummer ist für die neuen OSA Express 3-Netzwerkgeräte mit 2 Ports erforderlich. Wenn Sie kein OSA Express 3-Gerät verwenden, geben Sie <literal>0</literal> ein. OSA Express-Karten können auch im <quote>OSI layer 2 support</quote>-Modus oder dem älteren und üblicheren <quote>layer 3</quote>-Modus ausgeführt werden. Der Kartenmodus beeinflusst alle Systeme, die das Gerät gemeinsam nutzen, einschließlich Systeme auf anderen LPARs. Geben Sie im Zweifelsfall <literal>2</literal> an, um Kompatibilität mit dem Standardmodus zu erreichen, den andere Betriebssysteme wie z/VM und z/OS verwenden. Erfragen Sie weitere Informationen zu diesen Optionen bei Ihrem Hardware-Administrator.
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-gigabit-param">
    <title>Treiberparameter für das Netzwerkgerät</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-data">
   <title>Einrichten des Netzwerks und Auswählen der Installationsquelle</title>
   <para>
    Nachdem Sie alle Parameter für das Netzwerkgerät eingegeben haben, wird der zugehörige Treiber installiert und die entsprechenden Kernel-Meldungen werden angezeigt.
   </para>
   <para>
    Als Nächstes müssen Sie angeben, ob die automatische DHCP-Konfiguration für die Einrichtung der Netzwerkschnittstellenparameter verwendet werden soll. Wählen Sie <guimenu>NEIN</guimenu>, da DHCP nur auf wenigen Geräten ausgeführt wird und spezielle Einstellungen für die Hardwarekonfiguration erfordert. Daraufhin werden Sie aufgefordert, die folgenden Netzwerkparameter anzugeben:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      IP-Adresse des zu installierenden Systems
     </para>
    </listitem>
    <listitem>
     <para>
      Entsprechende Netzmaske (falls nicht über IP-Adresse angegeben)
     </para>
    </listitem>
    <listitem>
     <para>
      IP-Adresse eines Gateways zur Verbindung mit dem Server
     </para>
    </listitem>
    <listitem>
     <para>
      Liste der Suchdomänen, die vom Domain Name Server (DNS) abgedeckt sind
     </para>
    </listitem>
    <listitem>
     <para>
      IP-Adresse Ihres Domain Name Server
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex-prep-netcfg-vm-network-setup">
    <title>Netzwerkparameter</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    Geben Sie abschließend die erforderlichen Informationen zum Installationsserver an, beispielsweise die IP-Adresse, das Verzeichnis, in dem sich die Installationsdaten befinden, sowie den Berechtigungsnachweis. Das Installationssystem wird geladen, sobald die erforderlichen Informationen angegeben wurden.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-connect">
  <title>Herstellen einer Verbindung zum <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystem</title>
  <para>
   Nach dem Laden des Installationssystems fordert linuxrc Sie auf, den Anzeigetyp zur Steuerung des Installationsverfahrens zu wählen. Zu den verfügbaren Optionen gehören <literal>Remote X11</literal> (X Window System), <literal>VNC</literal> (Virtual Network Computing-Protokoll), <literal>SSH</literal> (Textmodus- oder X11-Installation über Secure Shell) <literal>Text-based UI</literal> und <literal>Graphical UI</literal>. Letztere startet YaST im Grafikmodus auf einem lokalen Grafikdisplay, sofern vorhanden. Für die s390x-Architektur kann ein lokales Grafikdisplay mithilfe von QEMU und dem <systemitem>virtio-gpu</systemitem>-Treiber implementiert werden.
   </para>
   <para>
   Die empfohlenen Optionen sind <literal>VNC</literal> oder <literal>SSH</literal>.
   </para>
  <para>
   Wenn die Option <literal>Text-based UI</literal> ausgewählt wird, startet YaST im Textmodus und Sie können die Installation direkt am Terminal durchführen. Die Option <literal>Text-based UI</literal> ist nur bei der Installation im LPAR von Nutzen.
  </para>
  <note>
   <title>Terminalemulation für eine textbasierte Benutzeroberfläche</title>
   <para>
    Für die Arbeit mit YaST im Textmodus ist die Ausführung in einem Terminal mit VT220/Linux-Emulation (auch als <literal>Text-based UI</literal> bezeichnet) erforderlich.
   </para>
  </note>
  <sect3 xml:id="sec-inst-connect-vnc-inst">
   <title>Initiieren der Installation für VNC</title>
   <para>
    So steuern Sie eine Installation über VNC fern:
   </para>
   <procedure>
    <step>
     <para>
      Durch Auswahl der Option <literal>VNC</literal> wird der VNC-Server gestartet. Ein kurzer Hinweis an der Konsole zeigt die IP-Adresse und Anzeigenummer zur Herstellung einer Verbindung mit vncviewer an.
     </para>
    </step>
    <step>
     <para>
      Geben Sie die IP-Adresse sowie die Display-Nummer des <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystems ein, wenn Sie dazu aufgefordert werden.
     </para>
    </step>
    <step>
     <para>
      Geben Sie nach Aufforderung die IP-Adresse und die Anzeigenummer des <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>-Installationssystems ein.
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      Sobald die Verbindung hergestellt wurde, installieren Sie <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> mit YaST.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-x">
   <title>Initiieren der Installation für das X Window-System</title>
   <important>
    <title>X-Authentifizierungsmechanismus</title>
    <para>
     Die direkte Installation über das X Window System beruht auf einem auf Hostnamen basierenden Authentifizierungsmechanismus. Dieser Mechanismus ist in den aktuellen Versionen von <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> deaktiviert. Wir empfehlen die Installation über SSH oder VNC.
    </para>
   </important>
   <para>
    So steuern Sie eine Installation über X-Forwarding fern:
   </para>
   <procedure>
    <step>
     <para>
      Vergewissern Sie sich, dass der X-Server dem Client (dem installierten System) den Verbindungsaufbau ermöglicht. Legen Sie die Variable <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command> in der Datei <filename>/etc/sysconfig/displaymanager</filename> fest. Starten Sie den X-Server erneut und ermöglichen Sie dem Client die Verbindung mit dem Server über <command>xhost
      <replaceable>CLIENT_IP_ADDRESS</replaceable></command>.
     </para>
    </step>
    <step>
     <para>
      Wenn Sie auf dem Installationssystem dazu aufgefordert werden, geben Sie die IP-Adresse des Rechners ein, auf dem der X-Server ausgeführt wird.
     </para>
    </step>
    <step>
     <para>
      Warten Sie, bis YaST geöffnet wird, und starten Sie dann die Installation.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-ssh">
   <title>Initiieren der Installation für SSH</title>
   <para>
    Zum Verbinden des Installationssystems mit dem Namen <literal>earth</literal> über SSH führen Sie den Befehl <command>ssh -X
    earth</command> aus. Verwenden Sie das unter <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/> verfügbare Putty-Tool, wenn Ihre Arbeitsstation unter Microsoft Windows ausgeführt wird. Aktivieren Sie <guimenu>Enable X11 forwarding</guimenu> (X11-Forwarding aktivieren) in PuTTy unter <menuchoice>
    <guimenu>Connection</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu>
    </menuchoice> (Verbindung &gt; SSH &gt; X11). 
   </para>
   <para>
    Falls Sie ein anderes Betriebssystem verwenden, führen Sie <command>ssh -X
    earth</command> aus, um sich mit einem Installationssystem namens <systemitem>earth</systemitem> zu verbinden. Wenn ein lokaler X-Server verfügbar ist, wird X-Forwarding über SSH unterstützt. Andernfalls stellt YaST über ncurses eine Textschnittstelle zur Verfügung.
   </para>
   <para>
    Geben Sie nach Aufforderung den <literal>root</literal>-Benutzernamen ein und melden Sie sich mit Ihrem Passwort an. Geben Sie <command>yast.ssh</command> ein, um YaST zu starten. Anschließend werden Sie von YaST durch den Installationsvorgang geführt.
   </para>
   <important>
    <title>Beheben eines YaST-über-SSH-Problems</title>
    <para>
     In bestimmten Situationen kann die Ausführung der GUI-Version von YaST über SSH mit X-Weiterleitung mit der folgenden Fehlermeldung fehlschlagen:
    </para>
<screen>XIO: fatal IO error 11 (Resource temporarily unavailable) on X server "localhost:11.0"</screen>
    <para>
     In diesem Fall haben Sie zwei Möglichkeiten.
    </para>
    <itemizedlist>
     <listitem>
      <para>
       Führen Sie YaST mit der Option <option>QT_XCB_GL_INTEGRATION=none</option> aus, beispielsweise:
      </para>
<screen>QT_XCB_GL_INTEGRATION=none yast.ssh
QT_XCB_GL_INTEGRATION=none yast2 disk</screen>
     </listitem>
     <listitem>
      <para>
       Führen Sie die ncurses-Version der YaST-Anwendung aus, indem Sie die X-Weiterleitung deaktivieren oder ncurses als die gewünschte Benutzeroberfläche angeben. Für Letzteres verwenden Sie den Befehl <command>yast2 disk --ncurses</command> oder <command>YUI_PREFERED_BACKEND=ncurses yast2 disk</command>.
      </para>
     </listitem>
    </itemizedlist>
   </important>
   <para>
    Setzen Sie den Installationsvorgang wie in <xref linkend="cha-install"/> beschrieben fort.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-boot-procedure">
  <title>Bootverfahren für <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf IBM Z</title>
  <para>
   Unter SLES 10 und 11 wurde der Bootvorgang vom zipl-Bootloader durchgeführt. Zur Aktivierung des Bootvorgangs von Btrfs-Partitionen und der Unterstützung von System-Rollbacks mit Snapper wurde die Bootmethode für <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> auf IBM Z geändert.
  </para>
  <para>
   GRUB 2 ersetzt zipl in <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> für IBM Z. GRUB 2 auf der AMD64/Intel 64-Architektur enthält Gerätetreiber auf Firmware-Ebene für den Zugriff auf das Dateisystem. Mainframes arbeiten ohne Firmware. Die Einbindung von <literal>ccw</literal> in GRUB 2 wäre nicht nur ein immenser Arbeitsaufwand, sondern würde eine Neuimplementierung von zipl in GRUB 2 erfordern. In <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> gilt daher ein zweiphasiges Verfahren:
  </para>
  <variablelist>
   <varlistentry>
    <term>1. Phase:</term>
    <listitem>
     <para>
      Eine separate Partition mit dem Kernel und einer initrd ist in <filename>/boot/zipl</filename> eingehängt. Dieser Kernel und die initrd werden über zipl mit der Konfiguration aus <filename>/boot/zipl/config</filename> geladen.
     </para>
     <para>
      Diese Konfiguration fügt das Schlüsselwort <literal>initgrub</literal> in die Kernel-Befehlszeile ein. Sobald der Kernel und die initrd geladen sind, aktiviert die initrd die erforderlichen Geräte, mit denen das root-Dateisystem eingehängt wird (siehe <filename>/boot/zipl/active_devices.txt</filename>). Anschließend wird ein GRUB 2-Userspace-Programm gestartet, mit dem die Datei <filename>/boot/grub2/grub.cfg</filename> gelesen wird.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>2. Phase:</term>
    <listitem>
     <para>
      Der Kernel und die in <filename>/boot/grub2/grub.cfg</filename> angegebene initrd werden über <command>kexec</command> gestartet. In <filename>/boot/zipl/active_devices.txt</filename> aufgeführte und zum Starten des Systems auf dem Datenträger benötigte Geräte werden dann aktiviert. Sonstige Geräte auf dieser Liste werden zwar in die Whitelist gestellt, doch ignoriert. Das root-Dateisystem wird eingehängt und der Bootvorgang wird wie auf den anderen Architekturen fortgesetzt.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  
 </sect2>
</sect1>
