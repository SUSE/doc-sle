<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="vt_tools.xml" version="5.0" xml:id="cha-tools-intro">
 <title>虚拟化工具</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker>
   </dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
   <para>
    <systemitem class="library">libvirt</systemitem> 是一个库，提供用于管理 KVM、Xen 等流行虚拟化解决方案的通用 API。该库为这些虚拟化解决方案提供规范化管理 API，以便为更高层级的管理工具提供一个跨超级管理程序的稳定接口。该库还提供用于管理 VM 主机服务器上的虚拟网络和储存的 API。每个 VM Guest 的配置都储存在 XML 文件中。
   </para>
   <para>
    您还可以使用 <systemitem class="library">libvirt</systemitem> 来远程管理 VM Guest。它支持 TLS 加密、x509 证书和 SASL 身份验证。这样，您便可以通过单个工作站集中管理 VM 主机服务器，无需再单独访问每台 VM 主机服务器。
   </para>
   <para>
    建议您使用基于 <systemitem class="library">libvirt</systemitem> 的工具来管理 VM Guest。<systemitem class="library">libvirt</systemitem> 与基于 <systemitem class="library">libvirt</systemitem> 的应用程序之间的互操作性已经过测试，SUSE 的支持原则将其视为不可或缺的一部分。
   </para>
  </abstract>
 </info>

 <sect1 xml:id="sec-tools-intro-console">
  <title>虚拟化控制台工具</title>

  <para>
   <systemitem class="library">libvirt</systemitem> 包含多个用于管理虚拟机的命令行实用程序。最重要的选项如下：
  </para>

  <variablelist>
   <varlistentry>
    <term><command>virsh</command>（软件包：<package>libvirt-client</package>）</term>
    <listitem>
     <para>
      用于管理 VM Guest 的命令行工具，其功能与虚拟机管理器类似。可让您更改 VM Guest 的状态（启动、停止、暂停等）、设置新的 Guest 和设备，或编辑现有配置。<command>virsh</command> 还可用于编写 VM Guest 管理操作的脚本。
     </para>
     <para>
      <command>virsh</command> 将第一个参数作为命令，将后续参数作为此命令的选项：
     </para>
     <screen>virsh [-c <replaceable>URI</replaceable>] <replaceable>COMMAND</replaceable> <replaceable>DOMAIN-ID</replaceable> [OPTIONS]</screen>
     <para>
      与 <command>zypper</command> 一样，您也可以调用不带命令的 <command>virsh</command>。在此情况下，virsh 会启动一个外壳并等待您发出命令。此模式非常适合必须运行后续命令的情形：
     </para>
     <screen>~&gt; virsh -c qemu+ssh://wilber@mercury.example.com/system
Enter passphrase for key '/home/wilber/.ssh/id_rsa':
Welcome to virsh, the virtualization interactive terminal.

Type:  'help' for help with commands
       'quit' to quit

virsh # hostname
mercury.example.com</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>virt-install</command>（软件包：<package>virt-install</package>）</term>
    <listitem>
     <para>
      用于通过 <systemitem class="library">libvirt</systemitem> 库创建新 VM Guest 的命令行工具。它支持通过 VNC 或 <xref linkend="gloss-vt-acronym-spice"/> 协议进行图形安装。如果指定了适当的命令行参数，<command>virt-install</command> 能够以完全无人照管的方式运行。这样便可以轻松自动完成 Guest 安装。<command>virt-install</command> 是虚拟机管理器使用的默认安装工具。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>virt-viewer</command>（软件包：<package>virt-viewer</package>）</term>
    <listitem>
     <para>
      一个简单的远程桌面查看器。它支持 SPICE 和 VNC 协议。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>virt-clone</command>（软件包：<package>virt-install</package>）</term>
    <listitem>
     <para>
      一个用于通过 <systemitem class="library">libvirt</systemitem> 超级管理程序管理库克隆现有虚拟机映像的工具。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>virt-host-validate</command>（软件包：<package>libvirt-client</package>）</term>
    <listitem>
     <para>
      该工具用于验证主机是否经过适当的配置，可以运行 <systemitem class="library">libvirt</systemitem> 超级管理程序驱动程序。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="sec-tools-intro-gui">
  <title>虚拟化 GUI 工具</title>

  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 提供了以下基于 libvirt 的图形工具。所有工具由带有相应工具名称的软件包提供。
  </para>

  <variablelist>
   <varlistentry>
    <term>虚拟机管理器（软件包：<package>virt-manager</package>）</term>
    <listitem>
     <para>
      虚拟机管理器是用于管理 VM Guest 的桌面工具。此工具提供控制现有计算机生命周期（启动/关机、暂停/继续、保存/恢复）以及创建新 VM Guest 的功能。它可用于管理各种类型的储存设备和虚拟网络。使用它可以通过内置 VNC 查看器访问 VM Guest 的图形控制台，以及查看性能统计信息。<command>virt-manager</command> 支持连接到本地 <systemitem class="daemon">libvirtd</systemitem> 来管理本地 VM 主机服务器，或连接到远程 <systemitem class="daemon">libvirtd</systemitem> 来管理远程 VM 主机服务器。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="virt_virt-manager.png" width="80%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="virt_virt-manager.png" width="80%"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <para>
      要启动虚拟机管理器，请在命令提示符处输入 <command>virt-manager</command>。
     </para>
     <note>
      <para>
       要禁用通过 spice 对 VM Guest 自动进行 USB 设备重定向的功能，请结合 <option>--spice-disable-auto-usbredir</option> 参数启动 <command>virt-manager</command>，或运行以下命令来永久更改默认行为：
      </para>
      <screen><prompt>&gt; </prompt>dconf write /org/virt-manager/virt-manager/console/auto-redirect false</screen>
     </note>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>virt-viewer</command>（软件包：<package>virt-viewer</package>）</term>
    <listitem>
     <para>
      VM Guest 图形控制器的查看器。它使用 SPICE（默认已在 VM Guest 上配置）或 VNC 协议，并支持 TLS 和 x509 证书。可按名称、ID 或 UUID 访问 VM Guest。如果 Guest 尚未运行，可以告知该查看器先等待 Guest 启动，然后再尝试连接到控制台。<command>virt-viewer</command> 默认未安装，安装软件包 <systemitem class="resource">virt-viewer</systemitem> 后即可使用它。
     </para>
     <note>
      <para>
       要禁用通过 spice 对 VM Guest 自动进行 USB 设备重定向的功能，请使用 <option>--spice-usbredir-auto-redirect-filter=&apos;&apos;</option> 参数添加一个空过滤器。
      </para>
     </note>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>yast2 vm</command>（软件包：<package>yast2-vm</package>）</term>
    <listitem>
     <para>
      一个 YaST 模块，可简化虚拟化工具的安装并可设置网桥：
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2_vm.png" width="56%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2_vm.png" width="56%"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
</chapter>
