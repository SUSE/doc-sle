<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec-zseries-prep">
 <title>Préparation de l'installation</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>oui</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  Ce chapitre explique les procédures pour rendre les données accessibles pour l'installation, installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> selon différentes méthodes, et préparer et utiliser l'IPL du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Il fournit également des informations sur la configuration et l'installation réseau.
 </para>

 <sect2 xml:id="sec-prep-makeavail">
  <title>Mise à disposition des données d'installation</title>
  <para>
   Cette section fournit des informations détaillées pour rendre accessibles les données d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z. Selon l'ordinateur que vous utilisez et l'environnement système, choisissez une installation NFS ou FTP. Si vous exécutez des postes de travail Microsoft Windows dans votre environnement, vous pouvez utiliser le réseau Windows (y compris le protocole SMB) pour installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur votre système IBM Z.
  </para>
  <tip>
   <title>exécution d'un IPL à partir d'un DVD</title>
   <para>
    Il est possible d'exécuter un IPL depuis un DVD et d'utiliser celui-ci comme support d'installation. Cela peut s'avérer très pratique si vous êtes confronté à des restrictions concernant la configuration d'un serveur d'installation fournissant un support d'installation sur votre réseau. Vous devez disposer d'un lecteur de DVD SCSI associé à un protocole FCP.
   </para>
  </tip>
  <note>
   <title>aucune installation à partir du disque dur</title>
   <para>
    Il est impossible de procéder à une installation depuis le disque dur en plaçant le contenu du DVD sur une partition sur un DASD.
   </para>
  </note>
  <sect3 xml:id="sec-prep-makeavail-linuxws">
   <title>Utilisation d'un poste de travail Linux ou d'un DVD <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
   <para>
    Vous pouvez utiliser un poste de travail Linux de votre environnement informatique pour fournir les données d'installation au processus d'installation IBM Z via NFS ou FTP. Si le poste de travail Linux exécute <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, vous pouvez configurer un serveur d'installation (NFS ou FTP) à l'aide du module YaST <guimenu>Installation Server</guimenu> (Serveur d'installation), comme décrit à la <xref linkend="sec-deployment-instserver-sles9"/>.
   </para>
    <important>
     <title>exportation de périphériques montés avec NFS</title>
     <para>
      Exporter la racine du système de fichiers (<filename>/</filename>) n'exporte pas automatiquement les périphériques montés, comme un DVD. Par conséquent, vous devez nommer explicitement le point de montage dans <filename>/etc/exports</filename> :
     </para>
<screen>/media/dvd  *(ro)</screen>
     <para>
      Une fois ce fichier modifié, redémarrez le serveur NFS en exécutant la commande <command>sudo systemctl restart nfsserver</command>.
     </para>
    </important>
    <para>
     La configuration d'un serveur FTP sur un système Linux implique d'installer et de configurer un logiciel serveur, tel que
     <package>vsftpd</package>. Si vous utilisez <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, reportez-vous au <xref linkend="cha-ftp"/> (Guide d'administration, Chapitre 39 « Configuration d'un serveur FTP avec YaST ») pour obtenir des instructions d'installation. Le téléchargement des données d'installation via une connexion anonyme n'est pas pris en charge. Par conséquent, vous devez configurer le serveur FTP pour assurer l'authentification utilisateur.
    </para>
   <sect4 xml:id="sec-prep-makeavail-linuxws-oncd">
    <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur DVD</title>
    <para>
     Le premier support d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z contient une image Linux de démarrage pour les postes de travail Intel et une image pour IBM Z.
    </para>
    <para>
     Pour les postes de travail Intel, démarrez à partir de ce support. À l'invite, choisissez la langue de réponse et la disposition de clavier souhaitées, et sélectionnez l'option <guimenu>Start rescue system</guimenu> (Démarrer le système de secours). Pour cette opération, 64 Mo minimum de mémoire vive sont requis. Aucun espace disque n'est requis, car tout le système de secours réside dans la mémoire vive du poste de travail. Cette approche nécessite la configuration manuelle de la mise en réseau du poste de travail.
    </para>
    <para>
     Pour IBM Z, exécutez l'IPL de votre invité LPAR/VM depuis ce support, comme décrit à la <xref linkend="sec-prep-ipling-lpar-dvd"/>. Après avoir entré les paramètres de votre réseau, le système d'installation considère le support comme la source des données d'installation. Dans la mesure où IBM Z ne peut pas être associé directement à un terminal compatible X11, choisissez entre une installation VNC ou SSH. SSH fournit également une installation graphique par le tunnelage de la connexion x via SSH grâce à <command>ssh -X</command>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-windowsws">
   <title>Utilisation d'un poste travail Microsoft Windows</title>
   <para>
    Vous pouvez utiliser un poste de travail Microsoft Windows sur votre réseau pour mettre à disposition le support d'installation. Le moyen le plus simple pour ce faire consiste à utiliser le protocole SMB. Assurez-vous de cocher la case <guimenu>SMB over TCP/IP</guimenu> (SMB sur TCP/IP) pour activer l'encapsulation de paquetages SMB dans les paquetages TCP/IP. Pour plus d'informations, reportez-vous à l'aide en ligne de Windows ou à la documentation Windows traitant de la mise en réseau.
   </para>
   <sect4 xml:id="sec-prep-makeavail-windowsws-smb">
    <title>Utilisation de SMB</title>
    <para>
     Pour mettre à disposition le support d'installation avec le protocole SMB, insérez la clé USB à mémoire flash contenant le fichier SLE-15-SP3-Online-<replaceable>ARCH</replaceable>-GM-media1.iso dans le port USB du poste de travail Windows. Créez ensuite un partage utilisant la lettre de l'unité de clé USB à mémoire flash et rendez-le accessible à tous les utilisateurs sur le réseau.
    </para>

    <para>
     Dans YaST, le chemin d'installation peut se présenter comme suit :
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     Où les marques de réservation ont la signification suivante :
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable>
      </term>
      <listitem>
       <para>
        Domaine de répertoire actif ou groupe de travail facultatif.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable>
      </term>
      <term><replaceable>PW</replaceable>
      </term>
      <listitem>
       <para>
        Nom d'utilisateur et mot de passe facultatifs d'un utilisateur habilité à accéder à ce serveur et à son partage.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable>
      </term>
      <listitem>
       <para>
        Nom du serveur qui héberge le ou les partages.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable>
      </term>
      <listitem>
       <para>
        Chemin d'accès aux partages.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para/>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-nfs">
    <title>Avec un serveur NFS</title>
    <para>
     Reportez-vous à la documentation fournie avec le produit tiers qui active les services du serveur NFS pour votre poste de travail Windows. La clé USB à mémoire flash contenant le support SLE-15-SP3-Online-<replaceable>ARCH</replaceable>-GM-media1.iso doit se trouver dans le chemin NFS disponible.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-ftp">
    <title>Utilisation de FTP</title>
    <para>
     Reportez-vous à la documentation fournie avec le produit tiers qui active les services du serveur FTP sur votre poste de travail Windows. La clé USB à mémoire flash contenant le support SLE-15-SP3-Online-<replaceable>ARCH</replaceable>-GM-media1.iso doit se trouver dans le chemin FTP disponible.
    </para>
    <para>
     Le serveur FTP fourni avec certaines versions de Microsoft Windows implémente uniquement un sous-ensemble des commandes FTP et n'est pas adapté pour fournir les données d'installation. Dans ce cas, utilisez un serveur FTP tiers qui offre les fonctionnalités requises.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-scsi">
    <title>Utilisation d'un lecteur de DVD SCSI associé à FCP</title>
    <para>
     Après avoir exécuté un IPL depuis le DVD SCSI, comme décrit à la <xref linkend="sec-prep-ipling-lpar-dvd"/>, le système d'installation utilise le DVD comme support d'installation. Dans ce cas, vous n'avez pas besoin des supports d'installation sur un serveur FTP, NFS ou SMB. Cependant, vous avez besoin des données de configuration réseau de votre instance <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, car vous devez configurer le réseau au cours de l'installation afin d'effectuer une installation graphique via VNC ou X.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-zpxe-cobbler">
   <title>Utilisation d'un serveur Cobbler pour zPXE</title>
   <para>
    Pour effectuer un chargement IPL à partir du réseau, un serveur Cobbler est nécessaire afin de fournir le kernel, le fichier initrd et les données d'installation. La préparation du serveur Cobbler implique les étapes suivantes :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-import"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-system"/>
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-import">
    <title>Importation des données d'installation</title>
    <para>
     L'importation du support exige que la source d'installation soit disponible sur le serveur Cobbler, à partir d'une clé USB à mémoire flash ou d'une source réseau. Exécutez la commande suivante pour importer les données :
    </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cobbler import --path=<replaceable>PATH</replaceable><co xml:id="co-cobbler-import-path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-import-dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="co-cobbler-import-path">
      <para>
       Point de montage des données d'installation.
      </para>
     </callout>
     <callout arearefs="co-cobbler-import-dirname">
      <para>
       Chaîne identifiant le produit importé ; <quote>sles15_s390x</quote>, par exemple. Cette chaîne est utilisée comme nom du sous-répertoire dans lequel sont copiées les données d'installation. Sur un serveur Cobbler qui s'exécute sous SUSE Linux Enterprise, il s'agit de <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>. Ce chemin peut être différent si le serveur Cobbler s'exécute sous un autre système d'exploitation.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-add-distro">
    <title>Ajout d'une distribution</title>
    <para>
     L'ajout d'une distribution permet à Cobbler de fournir le kernel et le fichier initrd requis pour un chargement IPL via zPXE. Exécutez la commande suivante sur le serveur Cobbler afin d'ajouter <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z :
    </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-identifier"/> \
  --os-version=sles15<co xml:id="co-cobbler-add-os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="co-cobbler-add-initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="co-cobbler-add-kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-server"/>
    </screen>
    <calloutlist>
     <callout arearefs="co-cobbler-add-identifier">
      <para>
       Identificateur unique pour la distribution, par exemple <quote>SLES <phrase role="productnumber"><phrase os="sles;sled">15 SP3</phrase></phrase> IBM Z</quote>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-os">
      <para>
       Identificateur du système d'exploitation. Utilisez <literal>sles15</literal>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-initrd">
      <para>
       Chemin d'accès au fichier initrd. La première partie du chemin d'accès (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) dépend de l'emplacement des données importées et du nom du sous-répertoire choisi lors de l'importation des données d'installation.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-kernel">
      <para>
       Chemin d'accès au kernel. La première partie du chemin d'accès (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) dépend de l'emplacement des données importées et du nom du sous-répertoire choisi lors de l'importation des données d'installation.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-server">
      <para>
       URL vers le répertoire d'installation sur le serveur Cobbler.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-profile">
    <title>Réglage du profil</title>
    <para>
     L'ajout d'une distribution (voir <xref linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>) génère automatiquement un profil avec l'élément <replaceable>IDENTIFIER</replaceable> correspondant. Utilisez la commande suivante pour effectuer quelques adaptations nécessaires :
    </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-profile-name"/> --os-version=sles10<co xml:id="co-cobbler-profile-os"/> --ksmeta=""<co xml:id="co-cobbler-profile-meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-profile-opts"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-profile-name">
      <para>
       Identificateur du profil. Utilisez la chaîne spécifiée lors de l'ajout de la distribution.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-os">
      <para>
       Version du système d'exploitation. Distribution à laquelle le profil doit être appliqué. Utilisez la chaîne spécifiée avec <option>--name=<replaceable>IDENTIFIER</replaceable></option> dans l'étape d'importation.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-meta">
      <para>
       Option nécessaire pour la création des modèles des fichiers kickstart. Étant donné qu'elle n'est pas utilisée pour SUSE, laissez cette option vide.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-opts">
      <para>
       Liste des paramètres kernel séparés par des espaces. Elle doit inclure au moins le paramètre <literal>install</literal>.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-system">
    <title>Ajout de systèmes</title>
    <para>
     La dernière étape consiste à ajouter des systèmes au serveur Cobbler. Cette étape doit être effectuée pour chaque invité IBM Z qui doit démarrer via zPXE. Les invités sont identifiés au moyen de leur ID utilisateur z/VM (l'exemple suivant utilise l'ID <quote>linux01</quote>). Notez que l'ID doit être en minuscules. Pour ajouter un système, exécutez la commande suivante :
    </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     L'option <option>--kopts</option> vous permet de spécifier les paramètres de kernel et d'installation que vous indiquez normalement dans le fichier parmfile. Spécifiez les paramètres selon le format suivant : <replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>. Le programme d'installation vous invite à saisir les paramètres manquants. Pour bénéficier d'une installation entièrement automatisée, vous devez indiquer tous les paramètres de mise en réseau et des DASD, et fournir un fichier AutoYaST. Vous trouverez, ci-après, un exemple d'invité équipé d'une interface OSA utilisant les mêmes paramètres réseau que ci-dessus.
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-dvd-usb-hmc">
   <title>Installation à partir d'une clé USB à mémoire flash de la console HMC</title>
   <para>
    L'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur des serveurs IBM Z requiert généralement une source d'installation réseau. Si cette condition ne peut pas être remplie, SUSE Linux Enterprise Server vous permet d'utiliser la clé USB à mémoire flash de la console de gestion du matériel (HMC) en tant que source pour l'installation sur une partition LPAR.
   </para>
   <para>
    Pour effectuer l'installation à partir de la clé USB à mémoire flash de la console HMC, procédez comme suit :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Ajoutez <option>install=hmc:/</option> aux options de kernel ou du fichier <filename>parmfile</filename> (voir <xref linkend="sec-appdendix-parm"/>).
     </para>
    </listitem>
    <listitem>
     <para>
      En mode d'installation manuel à l'aide de <filename>linuxrc</filename>, sélectionnez <emphasis role="italic">Start Installation</emphasis> (Démarrer l'installation), puis sélectionnez <emphasis role="italic">Installation</emphasis> et ensuite <emphasis role="italic">Hardware Management Console</emphasis> (Console de gestion du matériel). Le support d'installation doit être dans la console HMC.
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>configuration du réseau</title>
    <para>
     Avant de commencer l'installation, spécifiez une configuration réseau dans <filename>linuxrc</filename>. Vous ne pouvez pas effectuer cette opération à l'aide des paramètres de démarrage ; il est fort probable que vous ayez besoin d'un accès réseau. Dans <filename>linuxrc</filename>, accédez à <emphasis role="italic">Start Installation</emphasis> (Démarrer l'installation), puis sélectionnez <emphasis role="italic">Network Setup</emphasis> (Configuration du réseau).
    </para>
   </important>
   <important>
    <title>le système Linux doit d'abord démarrer</title>
    <para>
     Avant d'accorder l'accès au contenu sur la clé USB à mémoire flash de la console HMC, attendez que le système Linux ait démarré. L'exécution d'un IPL peut interrompre la connexion entre la console HMC et la partition LPAR. Si la première tentative d'utilisation de la méthode décrite échoue, vous pouvez accorder l'accès et réessayer l'option <option>HMC</option>.
    </para>
   </important>
   <note>
    <title>dépôt d'installation</title>
    <para>
     La clé USB à mémoire flash n'est pas conservée en tant que dépôt d'installation, étant donné que l'installation est une procédure unique. Si vous avez besoin d'un dépôt d'installation, enregistrez et utilisez le dépôt en ligne.
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-inst-types">
  <title>Types d'installation</title>
  <para>
   Cette section décrit la procédure d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour chaque mode d'installation. Une fois que vous avez effectué les étapes de préparation décrites dans les chapitres précédents, suivez la présentation du mode d'installation souhaité.
  </para>
  <para>
   Comme le décrit la <xref linkend="sec-prep-makeavail"/>, il existe trois modes différents d'installation pour Linux sur IBM Z : LPAR, z/VM et invité KVM.
  </para>
  <procedure xml:id="pro-prep-inst-types-lpar">
   <title>Présentation d'une installation LPAR</title>
   <step>
    <para>
     Préparez les périphériques requis pour l'installation. Reportez-vous à la <xref linkend="sec-prep-prep-ipl-natlpar"/>.
    </para>
   </step>
   <step>
    <para>
     Exécutez un IPL sur le système d'installation. Reportez-vous à la <xref linkend="sec-prep-ipling-lpar"/>.
    </para>
   </step>
   <step>
    <para>
     Configurez le réseau. Reportez-vous à la <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-vm">
   <title>Présentation de l'installation z/VM</title>
   <step>
    <para>
     Préparez les périphériques requis pour l'installation. Reportez-vous à la <xref linkend="sec-prep-prep-ipl-vm-linux-guest"/>.
    </para>
   </step>
   <step>
    <para>
     Exécutez un IPL sur le système d'installation. Reportez-vous à la <xref linkend="sec-prep-ipling-vm"/>.
    </para>
   </step>
   <step>
    <para>
     Configurez le réseau. Reportez-vous à la <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-kvm">
   <title>Présentation d'une installation invité KVM</title>
   <step>
    <para>
     Créez une image de disque virtuel et écrivez un fichier XML de domaine. Reportez-vous à la <xref linkend="sec-prep-prep-ipl-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     Préparez la cible d'installation et exécutez un IPL sur l'invité de machine virtuelle. Reportez-vous à la <xref linkend="sec-prep-ipling-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec-prep-netcfg-data"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la section <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-prep-prep-ipl">
  <title>Préparation de l'IPL du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec-prep-prep-ipl-natlpar">
   <title>Préparation de l'IPL d'une installation LPAR</title>
   <para>
    Configurez votre système IBM Z pour qu'il démarre en mode ESA/S390 ou Linux seul avec un profil d'activation approprié et IOCDS. Pour plus d'informations, reportez-vous à la documentation IBM. Poursuivez comme décrit à la <xref linkend="sec-prep-ipling-lpar"/>.
   </para>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-vm">
   <title>Préparation de l'IPL d'une installation z/VM</title>
   <para/>
   <sect4 xml:id="sec-prep-prep-ipl-vm-linux-guest">
    <title>Ajout d'un invité Linux à l'aide de DirMaint</title>
    <para>
     Pour commencer, connectez et formatez un ou plusieurs DASD sur le système que l'invité Linux doit utiliser dans z/VM. Créez ensuite un nouvel utilisateur dans z/VM. Cet exemple illustre le répertoire pour un utilisateur <literal>LINUX1</literal> avec le mot de passe <literal>LINPWD</literal>, une mémoire de 1 Go (pouvant atteindre 2 Go), plusieurs minidisques (MDISK), deux unités centrales et un périphérique OSA QDIO.
    </para>
    <tip>
     <title>affectation de mémoire aux invités z/VM</title>
     <para>
      Lorsque vous assignez de la mémoire à un invité z/VM, assurez-vous que la taille de la mémoire est adaptée aux besoins de votre type d'installation préférée. Reportez-vous à la <xref linkend="sec-info-sysreq-sysreq-hw-mem"/>. Pour définir la taille de la mémoire sur 1 Go, utilisez la commande <command>CP DEFINE STORAGE 1G</command>. À la fin de l'installation, réinitialisez la taille de la mémoire vers la valeur souhaitée.
     </para>
    </tip>
    <example xml:id="ex-prep-prep-ipl-vm-linux-guest-config">
     <title>Configuration d'un répertoire z/VM</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
   </example>
    <para>
     Cet exemple utilise un minidisque 201 comme disque d'un invité. Le minidisque 150 avec 200 cylindres est le périphérique de commutation Linux. Le disque 151 avec 2 800 cylindres contient l'installation Linux.
    </para>
    <para>
     En tant qu'utilisateur <systemitem class="username">MAINT</systemitem>, ajoutez l'invité au répertoire utilisateur avec la commande <command>DIRM FOR LINUX1 ADD</command>. Saisissez le nom de l'invité (<literal>LINUX1</literal>) et appuyez sur la touche <keycap>F5</keycap>. Configurez l'environnement de l'utilisateur avec :
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     La dernière commande renvoie un numéro de fichier du lecteur. Ce numéro est requis pour exécuter la commande suivante :
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     Vous pouvez désormais vous connecter sur Invité en tant qu'utilisateur <systemitem class="username">Linux1</systemitem>.
    </para>
    <para>
     Si l'option <literal>dirmaint</literal> n'est pas disponible, reportez-vous à la documentation IBM relative à la configuration de cet utilisateur.
    </para>
    <para>
     Reportez-vous à la <xref linkend="sec-prep-ipling-vm"/>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-kvm">
   <title>Préparation de l'IPL d'une installation invité KVM</title>
   <para>
    Une installation d'invité KVM nécessite un fichier XML de domaine qui spécifie la machine virtuelle et au moins une image de disque virtuel pour l'installation.
   </para>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-disk">
    <title>Création d'une image de disque virtuel</title>
    <para>
     Par défaut, libvirt recherche des images de disque dans le dossier <filename>/var/lib/libvirt/images/</filename> sur le serveur hôte de machine virtuelle. Bien que les images puissent aussi être stockées n'importe où ailleurs sur le système de fichiers, il est recommandé de les enregistrer toutes à un emplacement unique pour faciliter leur maintenance. Pour créer une image, connectez-vous au serveur hôte KVM et exécutez la commande suivante :
    </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
    <para>
     Celle-ci crée une image qcow2 avec une taille de 10 Go dans le dossier <filename>/var/lib/libvirt/images/</filename>. Pour plus d'informations, reportez-vous au <xref linkend="cha-qemu-guest-inst-qemu-img"/> (Guide de virtualisation, Chapitre 29 « Installation d'invité », Section 29.2 « Gestion des images de disque avec qemu-img ».
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-domain">
    <title>Écriture d'un fichier XML de domaine</title>
    <para>
     Un fichier XML de domaine est utilisé pour définir l'invité de machine virtuelle. Pour créer le fichier XML de domaine, ouvrez un fichier vide <filename>s15-1.xml</filename> dans un éditeur et créez un fichier comme dans l'exemple suivant.
    </para>
    <example>
     <title>Exemple de fichier XML de domaine</title>
     <para>
      L'exemple suivant crée un invité de machine virtuelle avec un seul processeur, 1 Go de RAM et l'image de disque virtuel créée à la section précédente (<xref linkend="sec-prep-prep-ipl-kvm-disk"/>). Il part du principe que le serveur virtuel est attaché à l'interface réseau hôte <literal>bond0</literal>. Modifiez l'élément de périphériques source pour qu'il corresponde à votre configuration réseau.
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s15-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE SLES15&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s15-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s15-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s15lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-ipling">
  <title>Exécution d'un IPL sur le système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec-prep-ipling-lpar">
   <title>Exécution d'un IPL sur une installation LPAR</title>
   <para>
    Il existe différentes façons d'exécuter un IPL sur <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> au sein d'une partition LPAR. La méthode recommandée est d'utiliser la fonction <guimenu>Load from CD-ROM or server (Charger depuis un CD-ROM ou un serveur)</guimenu> de SE ou HMC.
   </para>
   <sect4 xml:id="sec-prep-ipling-lpar-cdrom">
    <title>Exécution d'un IPL à partir d'un DVD-ROM</title>
    <para>
     Cochez le LPAR à installer, puis sélectionnez <guimenu>Load from CD-ROM or server (Charger depuis un CD-ROM ou un serveur)</guimenu>. Ne remplissez pas le champ relatif à l'emplacement du fichier ou saisissez le chemin du répertoire racine du premier DVD-ROM, puis sélectionnez <guimenu>Continue</guimenu> (Continuer). Conservez la sélection par défaut dans la liste des options qui s'affiche. <guimenu>Operating system messages (Messages du système d'exploitation)</guimenu> doit afficher les messages de démarrage du kernel.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-lpar-dvd">
    <title>Exécution d'un IPL à partir d'un DVD SCSI associé FCP</title>
    <para>
     Vous pouvez utiliser la procédure <guimenu>LOAD</guimenu> en sélectionnant <guimenu>SCSI</guimenu> comme <guimenu>Type de chargement</guimenu> pour exécuter un IPL à partir de SCSI. Entrez le WWPN (Worldwide port name, Identifiant unique de port) et le LUN (Logical unit number, Identifiant d'unité logique) fournis par votre pont ou stockage SCSI (16 chiffres ; ne pas oublier les 0 à droite). Le sélecteur du programme de démarrage doit être réglé sur 2. Utilisez votre adaptateur FCP comme <guimenu>Adresse de chargement</guimenu> et exécutez un IPL.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-vm">
   <title>Exécution d'un IPL sur une installation z/VM</title>
   <para>
    Cette section décrit l'exécution d'un IPL sur le système d'installation afin d'installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z sur un système z/VM.
   </para>
   <sect4 xml:id="sec-prep-ipling-vm-reader">
    <title>Exécution d'un IPL à partir du lecteur z/VM</title>
    <para>
     Vous avez besoin d'une bonne connexion TCP/IP et d'un programme client FTP dans votre invité z/VM récemment défini pour transférer le système d'installation via FTP. La configuration de TCP/IP pour z/VM ne sera pas abordée dans ce manuel. À ce propos, reportez-vous à la documentation IBM appropriée.
    </para>
    <para>
     Connectez-vous en tant qu'invité Linux z/VM pour exécuter un IPL. Rendez le contenu du répertoire <filename>/boot/s390x</filename> du programme d'installation unifié (support 1) disponible via FTP sur votre réseau. Récupérez les fichiers <filename>linux</filename>, <filename>initrd</filename>, <filename>parmfile</filename> et <filename>sles.exec</filename> à partir de ce répertoire. Transférez les fichiers avec une taille de blocs fixe de 80 caractères. Spécifiez la taille en exécutant la commande FTP <command>locsite fix 80</command>. Il est important de copier les fichiers <filename>linux</filename> (kernel Linux) et <filename>initrd</filename> (image d'installation) comme fichiers binaires. Pour ce faire, utilisez le mode de transfert <literal>binary</literal>. Les fichiers <filename>parmfile</filename> et <filename>sles.exec</filename> doivent être transférés en mode ASCII.
    </para>
    <para>
     L'exemple suivant illustre les étapes requises. Ce scénario particulier part du principe que les fichiers requis sont accessibles sur un serveur FTP à l'adresse IP <literal>192.168.0.3</literal>, avec l'ID de connexion <systemitem class="username">lininst</systemitem>.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-ftp-ftptrans">
     <title>Transfert de fichiers binaires via le serveur FTP</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles15.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles.exec sles.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     Utilisez le fichier sles.exec de script REXX que vous avez téléchargé pour exécuter un IPL sur le système d'installation Linux. Ce script charge le kernel, le fichier parmfile et le disque virtuel initial dans le lecteur pour exécuter un IPL.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-startscript-slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     Ce script permet d'exécuter un IPL sur le système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> avec la commande <command>sles12</command>. Le kernel Linux démarre alors et génère ses messages de démarrage.
    </para>
    <para>
     Pour continuer l'installation, passez à la <xref linkend="sec-prep-netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-dvd">
    <title>Exécution d'un IPL à partir d'un DVD SCSI associé FCP</title>
    <para>
     Pour exécuter un IPL dans z/VM, préparez le processus IPL de SCSI en utilisant le paramètre SET LOADDEV :
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     Une fois le paramètre LOADDEV configuré avec les valeurs appropriées, exécutez un IPL sur votre adaptateur FCP, par exemple :
    </para>
<screen>IPL FC00</screen>
    <para>
     Pour continuer l'installation, passez à la <xref linkend="sec-prep-netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-zpxe">
    <title>IPL à partir d'un serveur Cobbler avec zPXE</title>
    <para>
     Pour exécuter un IPL à partir d'un serveur Cobbler avec zPXE, vous devez transférer le script <filename>zpxe.rexx</filename> via FTP du serveur Cobbler vers votre invité z/VM. Pour ce faire, l'invité z/VM a besoin d'une connexion TCP/IP opérationnelle et d'un programme client FTP.
    </para>
    <para>
     Connectez-vous en tant qu'invité z/VM Linux pour effectuer un chargement IPL et transférer le script avec une taille fixe de 80 caractères en mode ASCII (voir <xref linkend="ex-prep-ipling-vm-reader-ftp-ftptrans"/>, par exemple). Le script <filename>zpxe.rexx</filename> est disponible dans <filename>/boot/s390x/zpxe.rexx</filename> sur le DVD du programme d'installation unifié ou dans <filename>/usr/share/doc/packages/s390-tools/zpxe.rexx</filename> sur un serveur Cobbler SLE.
    </para>
    <para>
     <filename>zpxe.rexx</filename> est censé remplacer le fichier <filename>PROFILE EXEC</filename> de votre invité. Effectuez une copie de sauvegarde du fichier <filename>PROFILE EXEC</filename> et renommez <filename>ZPXE REXX</filename> en <filename>PROFILE EXEC</filename>. Vous pouvez également appeler <filename>ZPXE REXX</filename> à partir du fichier <filename>PROFILE EXEC</filename> existant en lui ajoutant la ligne « <literal>ZPXE REXX</literal> ».
    </para>
    <para>
     La dernière étape consiste à créer un fichier de configuration <filename>ZPXE CONF</filename> qui indique à <filename>ZPXE REXX</filename> le serveur Cobbler à contacter et le disque à charger par IPL. Exécutez <command>xedit zpxe conf a</command> et créez <filename>ZPXE CONF</filename> avec le contenu suivant (remplacez les données d'exemple en conséquence) :
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     Cela permet de connecter le serveur Cobbler la prochaine fois que vous vous connectez à l'invité z/VM. Si une installation est programmée sur le serveur Cobbler, elle est exécutée. Pour programmer l'installation, exécutez la commande suivante sur le serveur Cobbler :
    </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cobbler system edit --name <replaceable>ID</replaceable><co xml:id="co-cobbler-sysedit-id"/> --netboot-enabled 1<co xml:id="co-cobbler-sysedit-netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="co-cobbler-sysedit-profile"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-sysedit-id">
      <para>
       ID utilisateur z/VM.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-netboot">
      <para>
       Activez le chargement IPL à partir du réseau.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-profile">
      <para>
       Nom du profil existant, voir <xref linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>.
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-kvm">
   <title>Exécution d'un IPL sur une installation invité KVM</title>
   <para>
    Pour démarrer l'installation de l'invité, vous devez tout d'abord démarrer l'invité de machine virtuelle défini à la <xref linkend="sec-prep-prep-ipl-kvm-disk"/>. Avant de commencer, assurez-vous que le kernel et le fichier initrd sont disponibles pour l'IPL.
   </para>
   <sect4 xml:id="sec-prep-ipling-kvm-prep">
    <title>Préparation de la source d'installation</title>
    <para>
     Le kernel et l'image initrd du système d'installation doivent être copiés sur le serveur hôte de machine virtuelle pour que l'exécution d'un IPL ait lieu sur l'invité de machine virtuelle sur le système d'installation.
    </para>
    <procedure>
     <step>
      <para>
       Connectez-vous à l'hôte KVM et assurez-vous que vous pouvez vous connecter à l'hôte distant ou au périphérique qui fournit la source d'installation.
      </para>
     </step>
     <step>
      <para>
       Copiez les deux fichiers suivants de la source d'installation vers l'emplacement <filename>/var/lib/libvirt/images/</filename>. Si les données sont fournies à partir d'un hôte distant, utilisez <command>ftp</command>, <command>sftp</command> ou <command>scp</command> pour transférer les fichiers :
      </para>
      <simplelist>
       <member><filename>/boot/s390x/initrd</filename>
       </member>
       <member><filename>/boot/s390x/cd.ikr</filename>
       </member>
      </simplelist>
     </step>
     <step>
      <para>
       Renommez les fichiers sur l'hôte KVM :
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> cd /var/lib/libvirt/images/
<prompt>tux &gt; </prompt><command>sudo</command> mv initrd s15-initrd.boot
<prompt>tux &gt; </prompt><command>sudo</command> mv cd.ikr s15-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-kvm-guest">
    <title>Exécution d'un IPL sur l'invité de machine virtuelle</title>
    <para>
     Pour exécuter un IPL sur l'invité de machine virtuelle, connectez-vous à l'hôte KVM et exécutez la commande suivante :
    </para>
<screen><prompt>tux &gt; </prompt>virsh  create s15-1.xml --console</screen>
    <para>
     Le processus d'installation démarre lorsque l'invité de machine virtuelle est opérationnel et en cours d'exécution. Les message suivants doivent apparaître :
    </para>
<screen>Domain s15-1 started
Connected to domain s15-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     Répondez <guimenu>2) No</guimenu> (Non) et choisissez <guimenu>Installation</guimenu> à l'étape suivante. Procédez comme décrit à la <xref linkend="sec-prep-netcfg-data"/>.
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-netcfg">
  <title>Configuration réseau</title>
  <para>
   Patientez jusqu'à ce que le kernel ait terminé ses routines de démarrage. Si vous effectuez l'installation en mode basique ou dans une partition LPAR, ouvrez le menu <guimenu>Operating System Messages</guimenu> (Messages du système d'exploitation) sur la console HMC ou SE.
  </para>
  <para>
   Tout d'abord, choisissez <guimenu>Start Installation</guimenu> (Démarrer l'installation) dans le menu principal <filename>linuxrc</filename>. Sélectionnez ensuite <guimenu>Start Installation or Update</guimenu> (Démarrer l'installation ou mettre à jour) pour lancer le processus d'installation. Sélectionnez <guimenu>Network</guimenu> (Réseau) comme support d'installation, puis choisissez le type de protocole réseau qui sera utilisé pour l'installation. La <xref linkend="sec-prep-makeavail"/> décrit comment mettre à disposition les données d'installation pour différents types de connexions réseau. Actuellement, <guimenu>FTP</guimenu>, <guimenu>HTTP</guimenu>, <guimenu>NFS</guimenu> et <guimenu>SMB/CIFS</guimenu> (partage de fichiers Windows) sont pris en charge.
  </para>
  <para>
   Dans la liste des périphériques disponibles, choisissez un périphérique réseau OSA ou HiperSockets pour recevoir les données d'installation. Bien que la liste puisse contenir des périphériques CTC, ESCON ou IUCV, ces derniers ne sont plus pris en charge sous <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
  </para>
  <sect3 xml:id="sec-prep-netcfg-hypersockets">
   <title>Configuration d'une interface HiperSockets</title>
   <para>
    Sélectionnez un périphérique HiperSockets dans la liste des périphériques réseau. Saisissez ensuite les valeurs des canaux de lecture, d'écriture et de données :
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-types">
    <title>Types de connexion réseau pris en charge et paramètres des pilotes</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.0800]&gt; 0.0.0800

Device address for write channel. (Enter '+++' to abort).
[0.0.0801]&gt; 0.0.0801

Device address for data channel. (Enter '+++' to abort).
[0.0.0802]&gt; 0.0.0802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-osa">
   <title>Configuration d'un périphérique OSA Express</title>
   <para>
    Sélectionnez un périphérique OSA Express dans la liste des périphériques réseau, puis indiquez un numéro de port. Saisissez les valeurs des canaux de lecture, d'écriture et de données. Choisissez si vous souhaitez activer la prise en charge de la couche OSI de niveau 2.
   </para>
   <para>
    Le numéro de port est requis pour les nouveaux périphériques réseau OSA Express 3 à 2 ports. Si vous n'utilisez pas de périphérique OSA Express 3, veuillez saisir <literal>0</literal>. Les cartes OSA Express peuvent aussi s'exécuter dans le mode de <quote>prise en charge de la couche OSI de niveau 2</quote> ou utiliser un mode commun plus ancien <quote>couche de niveau 3</quote>. Le mode de la carte affecte tous les systèmes qui partagent le périphérique, y compris les systèmes sur d'autres LPAR. Si vous avez un doute, indiquez <literal>2</literal> pour assurer une compatibilité avec le mode par défaut utilisé par les autres systèmes d'exploitation, comme z/VM et z/OS. Consultez votre administrateur de matériel pour obtenir plus d'informations sur ces options.
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-gigabit-param">
    <title>Paramètres du pilote de périphérique réseau</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-data">
   <title>Configuration du réseau et sélection de la source d'installation</title>
   <para>
    Après avoir saisi tous les paramètres de périphérique réseau, le pilote approprié est installé et les messages de kernel correspondants sont affichés.
   </para>
   <para>
    Ensuite, vous devez spécifier si vous souhaitez utiliser ou non la configuration automatique DHCP pour configurer les paramètres de l'interface réseau. Étant donné que DHCP fonctionne uniquement sur quelques périphériques et qu'il requiert des paramètres de configuration matérielle spécifiques, choisissez <guimenu>NO</guimenu> (Non). De cette façon, vous êtes invité à indiquer les paramètres réseau suivants :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      L'adresse IP du système à installer
     </para>
    </listitem>
    <listitem>
     <para>
      Le masque de réseau correspondant (s'il n'a pas été spécifié avec l'adresse IP).
     </para>
    </listitem>
    <listitem>
     <para>
      L'adresse IP d'une passerelle pour accéder au serveur
     </para>
    </listitem>
    <listitem>
     <para>
      La liste des domaines de recherche couverts par le serveur DNS
     </para>
    </listitem>
    <listitem>
     <para>
      L'adresse IP du serveur de noms de domaine
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex-prep-netcfg-vm-network-setup">
    <title>Paramètres réseau</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    Pour terminer, fournissez les informations requises concernant le serveur d'installation, telles que l'adresse IP, le répertoire contenant les données d'installation et les information d'identification de connexion. Le système d'installation se charge une fois les informations requises spécifiées.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-connect">
  <title>Connexion au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para>
   Après avoir chargé le système d'installation, linuxrc vous invite à choisir le type d'affichage à utiliser pour contrôler la procédure d'installation. Les options disponibles sont les suivantes : <literal>X11</literal> (système X Window), <literal>VNC</literal> (protocole Virtual Network Computing), <literal>SSH</literal> (mode texte ou installation X11 via un shell sécurisé) ou la <literal>ASCII Console</literal> (Console ASCII). Les options recommandées sont <literal>VNC</literal> ou <literal>SSH</literal>.
  </para>
  <para>
   Si vous sélectionnez l'option <literal>ASCII Console</literal> (Console ASCII), YaST démarre en mode texte et vous pouvez effectuer l'installation directement sur votre terminal. Pour plus d'informations sur l'utilisation de YaST en mode texte, reportez-vous au <xref linkend="cha-yast-text"/> (Guide d'administration, Chapitre 4 « YaST en mode texte »). L'utilisation de la <literal>console ASCII</literal> ne s'avère utile qu'en cas d'installation dans une partition logique.
  </para>
  <note>
   <title>émulation de terminal pour la console ASCII</title>
   <para>
    Pour permettre le fonctionnement avec YaST en mode texte, il est nécessaire de procéder à l'exécution sur un terminal avec une émulation Linux/VT220 (également appelée <literal>console ASCII</literal>).
   </para>
  </note>
  <sect3 xml:id="sec-inst-connect-vnc-inst">
   <title>Lancement de l'installation pour VNC</title>
   <para>
    Pour contrôler à distance une installation via VNC, procédez comme suit :
   </para>
   <procedure>
    <step>
     <para>
      La sélection de l'option <literal>VNC</literal> lance le serveur VNC. Une brève note dans la console indique l'adresse IP et le numéro d'affichage de la connexion à vncviewer.
     </para>
    </step>
    <step>
     <para>
      Saisissez l'adresse IP et le numéro d'affichage du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> lorsque vous y êtes invité.
     </para>
    </step>
    <step>
     <para>
      À l'invite, saisissez l'adresse IP et le numéro d'affichage du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      Une fois la connexion établie, installez <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> avec YaST.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-x">
   <title>Lancement de l'installation pour le système X Window</title>
   <important>
    <title>mécanisme d'authentification X</title>
    <para>
     L'installation directe avec le système X Window repose sur un mécanisme d'authentification basé sur des noms d'hôte. Ce mécanisme est désactivé dans les versions actuelles de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Nous vous recommandons d'effectuer l'installation à l'aide de SSH ou de VNC.
    </para>
   </important>
   <para>
    Pour contrôler à distance une installation par le biais de la redirection X, procédez comme suit :
   </para>
   <procedure>
    <step>
     <para>
      Assurez-vous que le serveur X permet au client (le système installé) de se connecter. Définissez la variable <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command> dans le fichier <filename>/etc/sysconfig/displaymanager</filename>. Redémarrez le serveur X et permettez la connexion du client au serveur à l'aide de <command>xhost <replaceable>ADRESSE_IP_CLIENT</replaceable></command>.
     </para>
    </step>
    <step>
     <para>
      À l'invite du système d'installation, saisissez l'adresse IP de la machine exécutant le serveur X.
     </para>
    </step>
    <step>
     <para>
      Patientez jusqu'à ce que YaST s'ouvre, puis démarrez l'installation.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-ssh">
   <title>Lancement de l'installation pour SSH</title>
   <para>
    Pour se connecter à un système d'installation avec le nom <literal>earth</literal> via SSH, utilisez la commande <command>ssh -X earth</command>. Si votre poste de travail s'exécute sous Microsoft Windows, utilisez l'outil Putty disponible à l'adresse <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/>. Définissez l'option <guimenu>Enable X11 forwarding </guimenu> (Activer le transfert X11) dans Putty sous <menuchoice>
    <guimenu>Connexion</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu>
    </menuchoice>.
   </para>
   <para>
    Si vous utilisez un autre système d'exploitation, exécutez <command>ssh -X earth</command> pour vous connecter à un système d'installation avec le nom <systemitem>Earth</systemitem>. Le transfert X via SSH est pris en charge, pour autant que vous disposiez d'un serveur X local. Dans le cas contraire, YaST fournit une interface texte via ncurses.
   </para>
   <para>
    À l'invite, entrez le nom de l'utilisateur <literal>root</literal> et connectez-vous à l'aide de votre mot de passe. Saisissez la commande <command>yast.ssh</command> pour démarrer YaST. YaST vous guide ensuite tout au long du processus d'installation. 
   </para>
   
   <important>
     <title>résolution du problème de YaST sur SSH</title>
     <para>
       Dans certaines situations, l'exécution de la version GUI de YaST sur SSH avec le transfert X peut échouer et renvoyer le message d'erreur suivant :
     </para>
<screen>XIO: fatal IO error 11 (Resource temporarily unavailable) on X server "localhost:11.0"</screen>
     <para>
       Dans ce cas, vous avez deux options.
     </para>
       <itemizedlist>
       <listitem>
	 <para>
	   Exécutez YaST avec l'option <option>QT_XCB_GL_INTEGRATION=none</option>, par exemple :
	 </para>
<screen>QT_XCB_GL_INTEGRATION=none yast.ssh
QT_XCB_GL_INTEGRATION=none yast2 disk</screen>
       </listitem>
       <listitem>
	 <para>
	   Exécutez la version ncurses de l'application YaST en désactivant le transfert X ou en spécifiant ncurses comme interface utilisateur souhaitée. Pour ce faire, utilisez la commande <command>yast2 disk --ncurses</command> ou <command>YUI_PREFERED_BACKEND=ncurses yast2 disk</command>.
	 </para>
	 </listitem>
       </itemizedlist>
     </important>
   <para>
    Effectuez l'installation comme décrit dans le <xref linkend="cha-install"/>.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-boot-procedure">
  <title>Procédure de démarrage de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur IBM Z</title>
  <para>
   Sous SLES 10 et 11, le processus de démarrage était géré par le chargeur de démarrage zipl. Pour activer le démarrage à partir des partitions Btrfs et la prise en charge des restaurations système avec Snapper, le démarrage de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur IBM Z a été modifié.
  </para>
  <para>
   GRUB 2 remplace zipl sur <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z. GRUB 2 sur l'architecture AMD64/Intel 64 comprend des pilotes de périphérique au niveau du microprogramme pour accéder au système de fichiers. Le macroordinateur ne contient pas de microprogramme et l'ajout de <literal>ccw</literal> à GRUB 2 représenterait une tâche considérable, mais nécessiterait aussi la réimplémentation de zipl dans GRUB 2. Par conséquent, <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> utilise une approche en deux étapes :
  </para>
  <variablelist>
   <varlistentry>
    <term>Première étape :</term>
    <listitem>
     <para>
      Une partition distincte contenant le kernel et un fichier initrd est montée dans le répertoire <filename>/boot/zipl</filename>. Ce kernel et le fichier initrd sont chargés via la commande zipl et utilisent la configuration mentionnée dans le fichier <filename>/boot/zipl/config</filename>.
     </para>
     <para>
      Cette configuration ajoute le mot clé <literal>initgrub</literal> à la ligne de commande du kernel. Une fois que le kernel et le fichier initrd sont chargés, le fichier initrd active les périphériques requis pour monter le système de fichiers racine (voir le fichier <filename>/boot/zipl/active_devices.txt</filename>). Ensuite, un programme d'espace utilisateur GRUB 2 est lancé afin de lire le fichier <filename>/boot/grub2/grub.cfg</filename>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Deuxième étape :</term>
    <listitem>
     <para>
      Le kernel et le fichier initrd dans le fichier <filename>/boot/grub2/grub.cfg</filename> sont démarrés à l'aide de la commande <command>kexec</command>. Les périphériques répertoriés dans <filename>/boot/zipl/active_devices.txt</filename> qui sont nécessaires pour démarrer le système sur le disque sont alors activés. Les autres périphériques de cette liste seront autorisés, mais ignorés si non requis. Le système de fichiers racine est monté et la procédure de démarrage se poursuit comme sur les autres architectures.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Pour plus de détails sur le processus de démarrage, reportez-vous au <xref linkend="cha-boot"/> (Guide d'administration, Chapitre 12 « Introduction au processus de démarrage »).
  </para>
 </sect2>
</sect1>
