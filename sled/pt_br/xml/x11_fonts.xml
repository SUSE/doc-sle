<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="x11_fonts.xml" version="5.0" xml:id="sec.x11.fontsys">
 <title>Instalando e configurando fontes</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes (sim)</dm:translation>
  </dm:docmanager>
 </info><indexterm> <primary>X</primary> <secondary>Fontes TrueType</secondary> </indexterm> <indexterm> <primary>fontes</primary> <secondary>TrueType</secondary> </indexterm> <indexterm> <primary>X</primary> <secondary>fontes</secondary> </indexterm> <indexterm> <primary>X</primary> <secondary>xft</secondary> </indexterm> <indexterm> <primary>X</primary> <secondary>conjuntos de caracteres</secondary> </indexterm>

 <para>
  É possível categorizar as fontes no Linux em duas partes:
 </para>

 <variablelist>
  <varlistentry>
   <term>Fontes geométricas ou vetoriais</term>
   <listitem>
    <para>
     Apresenta uma descrição matemática; por exemplo, instruções sobre como desenhar a forma de um glifo. Dessa forma, cada glifo pode ser dimensionado a tamanhos arbitrários sem perder a qualidade. Antes de usar a fonte (ou glifo), as descrições matemáticas devem ser transformadas em raster (grade). Este processo é denominado <emphasis>rasterização de fonte</emphasis>. As <emphasis>dicas de fonte</emphasis> (embutidas na fonte) melhoram e otimizam o resultado da renderização de determinado tamanho. A rasterização e as dicas são feitas com a biblioteca FreeType.
    </para>
    <para>
     Os formatos comuns no Linux são PostScript Type 1 e Type 2, TrueType e OpenType.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>Fontes de bitmap ou raster</term>
   <listitem>
    <para>
     Compostas por uma matriz de pixels designados para um tamanho de fonte específico. As fontes de bitmap são extremamente rápidas e simples de se renderizar. Porém, em comparação com as fontes vetoriais, as fontes de bitmap não podem ser dimensionadas sem perda de qualidade. Sendo assim, essas fontes são normalmente distribuídas em tamanhos diferentes. Atualmente, as fontes de bitmap ainda são usadas no console do Linux e, algumas vezes, em terminais.
    </para>
    <para>
     No Linux, o Portable Compiled Format (PCF) ou Glyph Bitmap Distribution Format (BDF) são os formatos mais comuns.
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <para>
  A aparência dessas fontes pode ser influenciada por dois aspectos principais:
 </para>

 <itemizedlist mark="bullet" spacing="normal">
  <listitem>
   <para>
    a escolha de uma família de fontes adequada e
   </para>
  </listitem>
  <listitem>
   <para>
    a renderização da fonte com um algoritmo que atinja resultados agradáveis aos olhos do receptor.
   </para>
  </listitem>
 </itemizedlist>

 <para>
  O último ponto só será relevante no caso de fontes vetoriais. Embora os dois pontos acima sejam altamente subjetivos, alguns padrões devem ser criados.
 </para>

 <para>
  Os sistemas de renderização de fonte do Linux são compostos por várias bibliotecas com relações diferentes. A biblioteca básica de renderização de fonte é a <link xlink:href="http://www.freetype.org/">FreeType</link>, que converte glifos de fonte de formatos suportados em glifos de bitmap otimizados. O processo de renderização é controlado por um algoritmo e seus parâmetros (que podem estar sujeitos a questões de patente).
 </para>

 <para>
  Cada programa ou biblioteca que usa FreeType deve consultar a biblioteca <link xlink:href="http://www.fontconfig.org/">Fontconfig</link>. Essa biblioteca combina a configuração da fonte dos usuários e do sistema. Quando um usuário altera a configuração de Fontconfig, essa alteração resulta em aplicativos compatíveis com Fontconfig.
 </para>

 <para>
  A forma OpenType mais sofisticada, necessária para scripts como Arabic, Han ou Phags-Pa e outro tipo de processamento de texto de nível mais elevado, fica sob a responsabilidade de <link xlink:href="http://www.harfbuzz.org/">Harfbuzz</link> ou <link xlink:href="http://www.pango.org/">Pango</link>, para citar alguns exemplos.
 </para>

 <sect2 xml:id="sec.x11.fontsys.showing.fonts">
  <title>Mostrando as fontes instaladas</title>
  <para>
   Para ter uma visão geral sobre as fontes que estão instaladas no sistema, execute os comandos <command>rpm</command> ou <command>fc-list</command>. Os dois apresentam uma boa resposta, mas podem retornar uma lista diferente, dependendo do sistema e da  configuração do usuário:
  </para>
  <variablelist>
   <varlistentry>
    <term><command>rpm</command>
    </term>
    <listitem>
     <para>
      Chame <command>rpm</command> para ver quais pacotes de software com fontes estão instalados no sistema:
     </para>
<screen>rpm -qa '*fonts*'</screen>
     <para>
      Cada pacote de fontes deve satisfazer essa expressão. No entanto, o comando pode retornar alguns falsos positivos, como <literal>fonts-config</literal> (que não é uma fonte e nem inclui fontes).
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>fc-list</command>
    </term>
    <listitem>
     <para>
      Chame <command>fc-list</command> para ter uma visão geral sobre as famílias de fontes que podem ser acessadas e saber se elas estão instaladas no sistema ou no diretório pessoal:
     </para>
<screen>fc-list ':' family</screen>
     <note>
      <title>Comando <command>fc-list</command></title>
      <para>
       O comando <command>fc-list</command> é um agrupador da biblioteca Fontconfig. É possível consultar uma variedade de informações interessantes do Fontconfig ou, para ser mais preciso, de seu cache. Consulte <command>man 1 fc-list</command> para obter mais detalhes.
      </para>
     </note>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>

 <sect2 xml:id="sec.x11.fontsys.viewing">
  <title>Vendo fontes informações sobre </title><indexterm><primary>fontes</primary><secondary>, consulte fontinfo.opensuse.org</secondary></indexterm>
  <para>
   Para saber a aparência de uma família de fontes instalada, use o comando <command>ftview</command> (pacote <systemitem>ft2demos</systemitem>) ou visite <link xlink:href="http://fontinfo.opensuse.org/"/>. Por exemplo, para exibir a fonte FreeMono no ponto 14, use <command>ftview</command> da seguinte forma:
  </para>
<screen>ftview 14 /usr/share/fonts/truetype/FreeMono.ttf</screen>
  <para>
   Se precisar de mais informações, acesse <link xlink:href="http://fontinfo.opensuse.org/"/> para saber quais estilos (regular, negrito, itálico, etc.) e linguagens são suportados.
  </para>
 </sect2>

 <sect2 xml:id="sec.x11.fontsys.querying">
  <title>Consultando fontes</title>
  <para>
   Para consultar a fonte que será usada quando determinado padrão for especificado, use o comando <command>fc-match</command>.
  </para>
  <para>
   Por exemplo, se o padrão já tiver uma fonte instalada, o <command>fc-match</command> retornará o nome do arquivo, a família de fontes e o estilo:
  </para>
<screen><prompt>tux &gt; </prompt>fc-match 'Liberation Serif'
LiberationSerif-Regular.ttf: "Liberation Serif" "Regular"</screen>
  <para>
   Se a fonte desejada não existir no sistema, as regras de correspondência da Fontconfig serão aplicadas para tentar encontrar as fontes disponíveis mais parecidas. Ou seja, a sua solicitação é substituída:
  </para>
<screen><prompt>tux &gt; </prompt>fc-match 'Foo Family'
DejaVuSans.ttf: "DejaVu Sans" "Book"</screen>
  <para>
   A Fontconfig suporta <emphasis>áliases</emphasis>: um nome é substituído por outro nome de família. Um exemplo comum é com nomes genéricos, como <quote>sans-serif</quote>, <quote>serif</quote> e <quote>monospace</quote>. Esses nomes de álias podem ser substituídos por nomes reais de família ou até mesmo por uma lista preferencial de nomes de família:
  </para>
<screen><prompt>tux &gt; </prompt>for font in serif sans mono; do fc-match "$font" ; done
DejaVuSerif.ttf: "DejaVu Serif" "Book"
DejaVuSans.ttf: "DejaVu Sans" "Book"
DejaVuSansMono.ttf: "DejaVu Sans Mono" "Book"</screen>
  <para>
   O resultado pode variar no sistema de acordo com as fontes que estão instaladas.
  </para>
  <note>
   <title>Regras de similaridade segundo a Fontconfig</title>
   <para>
    A Fontconfig <emphasis>sempre</emphasis> retorna uma família real (se pelo menos uma estiver instalada) de acordo com a solicitação especificada, a mais parecida possível. A <quote>similaridade</quote> depende das métricas internas da Fontconfig e das configurações de usuário ou administrador da Fontconfig.
   </para>
  </note>
 </sect2>

 <sect2 xml:id="sec.x11.fontsys.install">
  <title>Instalando fontes</title><indexterm> <primary>X</primary> <secondary>instalar fontes</secondary></indexterm><indexterm> <primary>fontes</primary> <secondary>instalar</secondary></indexterm>
  <para>
   Para instalar uma nova fonte, os seguintes métodos principais estão disponíveis:
  </para>
  <orderedlist spacing="normal">
   <listitem>
    <para>
     Instalar manualmente os arquivos de fonte, como <filename>*.ttf</filename> ou <filename>*.otf</filename>, em um diretório de fontes conhecido. Se precisar ser um diretório de todo o sistema, use o padrão <filename>/usr/share/fonts</filename>. Para instalação em seu diretório pessoal, use <filename>~/.config/fonts</filename>.
    </para>
    <para>
     Para sair dos padrões, a Fontconfig permite escolher um diretório diferente. Informe a Fontconfig usando o elemento <literal>&lt;dir&gt;</literal>. Consulte a <xref linkend="sec.x11.fontsys.config.fontconfig"/> para obter os detalhes.
    </para>
   </listitem>
   <listitem>
    <para>
     Instalar as fontes usando o <command>zypper</command>. Muitas fontes já estão disponíveis como um pacote, seja em sua distribuição do SUSE ou no repositório <link xlink:href="http://download.opensuse.org/repositories/M17N:/fonts/">M17N:fonts</link>. Adicione o repositório à sua lista usando o seguinte comando. Por exemplo, para adicionar um repositório para o SLE 12:
    </para>
<screen>sudo zypper ar
     http://download.opensuse.org/repositories/M17N:/fonts/SLE_12/M17N:fonts.repo</screen>
    <para>
     Para procurar o <replaceable>NOME_DA_FAMÍLIA_DE_FONTES</replaceable> use este comando:
    </para>
<screen>sudo zypper se '<replaceable>FONT_FAMILY_NAME</replaceable>*fonts'</screen>
   </listitem>


  </orderedlist>
 </sect2>

 <sect2 xml:id="sec.x11.fontsys.config">
  <title>Configurando a aparência das fontes</title><indexterm> <primary>fonte</primary> <secondary>configuração</secondary></indexterm><indexterm> <primary>família de fontes</primary> <secondary>substituições</secondary></indexterm>
  <para>
   Dependendo do meio de renderização e do tamanho da fonte, o resultado pode não ser satisfatório. Por exemplo, um monitor médio atual possui resolução de 100 dpi que torna os pixels grandes demais e os glifos pesados.
  </para>
  <para>
   Há diversos algoritmos disponíveis para lidar com resoluções baixas, como suavização (atenuação da escala de cinzas), dicas (ajuste à grade) ou renderização de subpixel (triplicação da resolução em uma direção). Esses algoritmos também podem ser diferentes entre um formato de fonte e outro.
  </para>
  <important>
   <title>Questões de patentes com a renderização de subpixel</title>
   <para>
    <indexterm> <primary>fonte</primary> <secondary>patente de subpixel</secondary> </indexterm> A renderização de subpixel não é usada em distribuições do SUSE. Embora a FreeType2 suporte esse algoritmo, ele envolve várias patentes que vencem no fim do ano de 2019. Portanto, a configuração das opções de renderização de subpixel na Fontconfig não terá nenhum efeito, exceto se o sistema tiver a biblioteca FreeType2 com a renderização de subpixel compilada.
   </para>
  </important>
  <para>
   Pela Fontconfig, é possível selecionar um algoritmo de renderização para cada fonte separadamente ou para um conjunto de fontes.
  </para>
  <sect3 xml:id="sec.x11.fontsys.config.sysconfig">
   <title>Configurando fontes pelo <literal>sysconfig</literal></title>
   <para>
    O <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> vem com uma camada do <literal>sysconfig</literal> acima do Fontconfig. Este é um ótimo ponto de partida para testar a configuração da fonte. Para mudar as configurações padrão, edite o arquivo de configuração <filename>/etc/sysconfig/fonts-config</filename>. (ou use o módulo sysconfig do YaST). Após editar o arquivo, execute <command>fonts-config</command>:
   </para>
<screen>sudo /usr/sbin/fonts-config</screen>
   <para>
    Reinicie o aplicativo para tornar o efeito visível. Lembre-se das seguintes questões:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Alguns aplicativos precisam ser reiniciados. Por exemplo, o Firefox sempre lê a configuração de Fontconfig de tempos em tempos. As guias recém-criadas ou recarregadas acessam as novas configurações de fontes posteriormente.
     </para>
    </listitem>
    <listitem>
     <para>
      O script <command>fonts-config</command> é chamado automaticamente após cada instalação ou remoção de pacote (do contrário, trata-se de um bug do pacote de software de fontes).
     </para>
    </listitem>
    <listitem>
     <para>
      É possível substituir temporariamente cada variável sysconfig pela opção de linha de comando <command>fonts-config</command>. Consulte <command>fonts-config --help</command> para obter os detalhes.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Há diversas variáveis sysconfig que podem ser alteradas. Consulte <command>man 1 fonts-config</command> ou a página de ajuda do módulo sysconfig do YaST. As seguintes variáveis são alguns exemplos:
   </para>
   <variablelist>
    <varlistentry>
     <term>Uso de algoritmos de renderização</term>
     <listitem>
      <para>
       Considere <varname>FORCE_HINTSTYLE</varname>, <varname>FORCE_AUTOHINT</varname>, <varname>FORCE_BW</varname>, <varname>FORCE_BW_MONOSPACE</varname>, <varname>USE_EMBEDDED_BITMAPS</varname> e <varname>EMBEDDED_BITMAP_LANGAGES</varname>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Listas preferenciais de áliases genéricos</term>
     <listitem>
      <para>
       Use <varname>PREFER_SANS_FAMILIES</varname>, <varname>PREFER_SERIF_FAMILIES</varname>, <varname>PREFER_MONO_FAMILIES</varname> e <varname>SEARCH_METRIC_COMPATIBLE</varname>
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    A lista a seguir mostra alguns exemplos de configuração, começando das fontes <quote>mais legíveis</quote> (mais contraste) até as fontes <quote>mais bonitas</quote> (mais suavizadas).
   </para>
   <variablelist>
    <varlistentry xml:id="vle.x11.fontsys.sysconfig.bitmap">
     <term>Fontes de bitmap</term>
     <listitem>
      <para>
       Dê preferência às fontes de bitmap por meio das variáveis <varname>PREFER_*_FAMILIES</varname>. Siga o exemplo na seção de Ajuda dessas variáveis. Observe que essas fontes são renderizadas em preto e branco, e não suavizadas, e que as fontes de bitmap estão disponíveis em vários tamanhos. Considere usar
      </para>
<screen>SEARCH_METRIC_COMPATIBLE="no"</screen>
      <para>
       para desabilitar as substituições de nome de família orientadas por compatibilidade de métrica.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry xml:id="vle.x11.fontsys.sysconfig.bw">
     <term>Fontes escaláveis renderizadas em preto e branco</term>
     <listitem>
      <para>
       As fontes escaláveis renderizadas sem suavização podem produzir resultados parecidos com as fontes de bitmap, enquanto mantêm a escalabilidade da fonte. Use fontes com dicas bem elaboradas, como as famílias Liberation. Não há muitas opções de fontes com dicas bem elaboradas. Defina a seguinte variável para forçar este método:
      </para>
<screen>FORCE_BW="yes"</screen>
     </listitem>
    </varlistentry>
    <varlistentry xml:id="vle.x11.fontsys.sysconfig.bw_monospace">
     <term>Fontes monoespaçadas renderizadas em preto e branco</term>
     <listitem>
      <para>
       Somente renderize fontes monoespaçadas sem suavização, do contrário, use as configurações padrão:
      </para>
<screen>FORCE_BW_MONOSPACE="yes"</screen>
     </listitem>
    </varlistentry>
    <varlistentry xml:id="vle.x11.fontsys.sysconfig.default">
     <term>Configurações Padrão</term>
     <listitem>
      <para>
       Todas as fontes são renderizadas com suavização. As fontes com dicas bem elaboradas serão renderizadas com o BCI (<emphasis>byte code interpreter</emphasis> — intérprete de código de byte), e o restante com o autohinter (<literal>hintstyle=hintslight</literal>). Deixe todas as variáveis sysconfig relevantes com a configuração padrão.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry xml:id="vle.x11.fontsys.sysconfig.cff">
     <term>Fontes CFF</term>
     <listitem>
      <para>
       Use as fontes no formato CFF. Elas também podem ser consideradas mais legíveis do que as fontes TrueType padrão, por causa das atuais melhorias na FreeType2. Faça um teste com elas seguindo o exemplo de <literal>PREFER_*_FAMILIES</literal>. É possível torná-las mais escuras e colocá-las em negrito com:
      </para>
<screen>SEARCH_METRIC_COMPATIBLE="no"</screen>
      <para>
       já que são renderizadas por <literal>hintstyle=hintslight</literal>, por padrão. Considere usar também:
      </para>
<screen>SEARCH_METRIC_COMPATIBLE="no"</screen>
     </listitem>
    </varlistentry>
    <varlistentry xml:id="ex.x11.fontsys.sysconfig.autohint">
     <term>Autohinter exclusivamente</term>
     <listitem>
      <para>
       Mesmo para uma fonte com dicas bem elaboradas, use o autohinter da FreeType2. Isso pode gerar formas de letras mais grossas, às vezes mais confusas, com contraste menor. Defina a seguinte variável para ativá-lo:
      </para>
<screen>FORCE_AUTOHINTER="yes"</screen>
      <para>
       Use <literal>FORCE_HINTSTYLE</literal> para controlar o nível de dicas.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="sec.x11.fontsys.config.fontconfig">
   <title>Conhecendo o XML da Fontconfig</title>
   <para>
    O formato de configuração da Fontconfig é o <emphasis>eXtensible Markup Language</emphasis> (XML). Estes exemplos não são uma referência completa, e sim uma visão geral. Você encontra detalhes e outras inspirações no <command>man 5 fonts-conf</command> ou em <filename>/etc/fonts/conf.d/</filename>.
   </para>
   <para>
    O arquivo de configuração central do Fontconfig é <filename>/etc/fonts/fonts.conf</filename>, que, além de outras coisas, inclui todo o diretório <filename>/etc/fonts/conf.d/</filename>. Para personalizar a Fontconfig, há dois lugares para você fazer as mudanças:
   </para>
   <orderedlist xml:id="ol.x11.fontsys.configfiles" spacing="normal">
    <title>Arquivos de configuração da Fontconfig</title>
    <listitem>
     <formalpara>
      <title>Mudanças de todo o sistema</title>
      <para>
       Edite o arquivo <filename>/etc/fonts/local.conf</filename> (por padrão, ele inclui um elemento <literal>fontconfig</literal> vazio).
      </para>
     </formalpara>
    </listitem>
    <listitem>
     <formalpara>
      <title>Mudanças específicas do usuário</title>
      <para>
       Edite o arquivo <filename>~/.config/fontconfig/fonts.conf</filename>. Coloque os arquivos de configuração da Fontconfig no diretório <filename>~/.config/fontconfig/conf.d/</filename>.
      </para>
     </formalpara>
    </listitem>
   </orderedlist>
   <para>
    As mudanças específicas do usuário sobregravam qualquer configuração de todo o sistema.
   </para>
   <note>
    <title>Arquivo de configuração do usuário descontinuado</title>
    <para>
     O arquivo <filename>~/.fonts.conf</filename> está marcado como descontinuado e não deve mais ser usado. Use agora o <filename>~/.config/fontconfig/fonts.conf</filename>.
    </para>
   </note>
   <para>
    Cada arquivo de configuração precisa ter um elemento <literal>fontconfig</literal>. Dessa forma, o arquivo mínimo terá a seguinte aparência:
   </para>
<screen>&lt;?xml version="1.0"?&gt;
   &lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
   &lt;fontconfig&gt;
   &lt;!-- Insert your changes here --&gt;
   &lt;/fontconfig&gt;</screen>
   <para>
    Se os diretórios padrão não forem suficientes, insira o elemento <literal>dir</literal> com o respectivo diretório:
   </para>
<screen>&lt;dir&gt;/usr/share/fonts2&lt;/dir&gt;</screen>
   <para>
    A Fontconfig procura as fontes <emphasis>repetidamente</emphasis>.
   </para>
   <para>
    É possível escolher os algoritmos de renderização de fonte com o seguinte trecho da Fontconfig (consulte o <xref linkend="ex.x11.fontsys.fontconfig.rendering_algorithms"/>):
   </para>
   <example xml:id="ex.x11.fontsys.fontconfig.rendering_algorithms">
    <title>Especificando algoritmos de renderização</title>
<screen>&lt;match target="font"&gt;
 &lt;test name="family"&gt;
  &lt;string&gt;<replaceable>FAMILY_NAME</replaceable>&lt;/string&gt;
 &lt;/test&gt;
 &lt;edit name="antialias" mode="assign"&gt;
  &lt;bool&gt;true&lt;/bool&gt;
 &lt;/edit&gt;
 &lt;edit name="hinting" mode="assign"&gt;
  &lt;bool&gt;true&lt;/bool&gt;
 &lt;/edit&gt;
 &lt;edit name="autohint" mode="assign"&gt;
  &lt;bool&gt;false&lt;/bool&gt;
 &lt;/edit&gt;
 &lt;edit name="hintstyle" mode="assign"&gt;
  &lt;const&gt;hintfull&lt;/const&gt;
 &lt;/edit&gt;
&lt;/match&gt;</screen>
   </example>
   <para>
    É possível testar várias propriedades de fontes. Por exemplo, o elemento <literal>&lt;test&gt;</literal> pode testar a família de fontes (conforme mostrado no exemplo), o intervalo de tamanhos, o espaçamento, o formato da fonte, etc. Quando <literal>&lt;test&gt;</literal> é completamente abandonado, todos os elementos <literal>&lt;edit&gt;</literal> são aplicados a cada fonte (mudança global).
   </para>
   <example xml:id="ex.x11.fontsys.fontconfig.aliases1">
    <title>Substituições de álias e nome de família</title>
    <variablelist>
     <varlistentry xml:id="vle.x11.fontsys.example.alias.default">
      <term>Regra 1</term>
      <listitem>
<screen>&lt;alias&gt;
 &lt;family&gt;Alegreya SC&lt;/family&gt;
 &lt;default&gt;
  &lt;family&gt;serif&lt;/family&gt;
 &lt;/default&gt;
&lt;/alias&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry xml:id="vle.x11.fontsys.example.alias.prefer">
      <term>Regra 2</term>
      <listitem>
<screen>&lt;alias&gt;
 &lt;family&gt;serif&lt;/family&gt;
 &lt;prefer&gt;
  &lt;family&gt;Droid Serif&lt;/family&gt;
 &lt;/prefer&gt;
&lt;/alias&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry xml:id="vle.x11.fontsys.example.alias.accept">
      <term>Regra 3</term>
      <listitem>
<screen>&lt;alias&gt;
 &lt;family&gt;serif&lt;/family&gt;
 &lt;accept&gt;
  &lt;family&gt;STIXGeneral&lt;/family&gt;
 &lt;/accept&gt;
&lt;/alias&gt;</screen>
      </listitem>
     </varlistentry>
    </variablelist>
   </example>
   <para>
    As regras do <xref linkend="ex.x11.fontsys.fontconfig.aliases1"/> criam uma PFL (<emphasis>prioritized family list</emphasis> — lista prioritária de famílias). Dependendo do elemento, são executadas ações diferentes:
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>&lt;default&gt;</literal> da <xref linkend="vle.x11.fontsys.example.alias.default"/>
     </term>
     <listitem>
      <para>
       Esta regra adiciona um nome da família <literal>serif</literal> <emphasis>ao fim</emphasis> da PFL.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>&lt;prefer&gt;</literal> da <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
     </term>
     <listitem>
      <para>
       Esta regra adiciona <quote>Droid Serif</quote> <emphasis>logo antes da</emphasis> primeira ocorrência de <literal>serif</literal> na PFL, sempre que <literal>Alegreya SC</literal> estiver presente na PFL.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>&lt;accept&gt;</literal> da <xref linkend="vle.x11.fontsys.example.alias.accept"/>
     </term>
     <listitem>
      <para>
       Esta regra adiciona o nome da família <quote>STIXGeneral</quote> <emphasis>logo depois da</emphasis> primeira ocorrência do nome da família <literal>serif</literal> na PFL.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Juntando tudo isso, quando os trechos ocorrem na ordem <xref linkend="vle.x11.fontsys.example.alias.default"/>, <xref linkend="vle.x11.fontsys.example.alias.prefer"/> e <xref linkend="vle.x11.fontsys.example.alias.accept"/> e o usuário solicita <quote>Alegreya SC</quote>, a PFL é criada conforme mostrado na <xref linkend="tab.x11.fontsys.example.alias"/>.
   </para>
   <table xml:id="tab.x11.fontsys.example.alias">
    <title>Gerando a PFL com base nas regras de Fontconfig</title>
    <tgroup cols="2">
     <colspec colwidth="1*"/>
     <colspec colwidth="3*"/>
     <thead>
      <row>
       <entry>
        <para>
         Ordem
        </para>
       </entry>
       <entry>
        <para>
         PFL atual
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Solicitação
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.default"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>serif</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>serif</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.accept"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>serif</literal>, <literal>STIXGeneral</literal>
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <para>
    Nas métricas da Fontconfig, o nome da família tem maior prioridade sobre os outros padrões, como estilo, tamanho, etc. A Fontconfig verifica qual família está instalada no sistema. Se <quote>Alegreya SC</quote> estiver instalada, a Fontconfig a retornará. Do contrário, ela solicitará <quote>Droid Serif</quote>, etc.
   </para>
   <para>
    Tenha cuidado. Quando a ordem dos trechos da Fontconfig é modificada, a Fontconfig poderá retornar resultados diferentes, conforme mostrado na <xref linkend="tab.x11.fontsys.example.alias2"/>.
   </para>
   <table xml:id="tab.x11.fontsys.example.alias2">
    <title>Resultados da geração da PFL com base nas regras da Fontconfig com a ordem modificada</title>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>
         Ordem
        </para>
       </entry>
       <entry>
        <para>
         PFL atual
        </para>
       </entry>
       <entry>
        <para>
         Nota
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Solicitação
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>
        </para>
       </entry>
       <entry>
        <para>
         Mesma solicitação efetuada.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>
        </para>
       </entry>
       <entry>
        <para>
         <literal>serif</literal> não está na PFL; nada é substituído
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.accept"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>
        </para>
       </entry>
       <entry>
        <para>
         <literal>serif</literal> não está na PFL; nada é substituído
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.default"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>serif</literal>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal> presente na PFL; a substituição é realizada
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <note>
    <title>Implicação.</title>
    <para>
     Pense no álias <literal>&lt;default&gt;</literal> como uma classificação ou inclusão deste grupo (se não estiver instalado). Conforme mostrado no exemplo, <literal>&lt;default&gt;</literal> sempre deve preceder os áliases <literal>&lt;prefer&gt;</literal> e <literal>&lt;accept&gt;</literal> deste grupo.
    </para>
    <para>
     A classificação <literal>&lt;default&gt;</literal> não se limita aos áliases genéricos serif, sans-serif e monospace. Consulte <filename>/usr/share/fontconfig/conf.avail/30-metric-aliases.conf</filename> para ver um exemplo complexo.
    </para>


   </note>
   <para>
    O seguinte trecho da Fontconfig no <xref linkend="ex.x11.fontsys.fontconfig.aliases2"/> cria um grupo <literal>serif</literal>. Cada família desse grupo poderá substituir outras famílias, caso ainda não exista uma fonte instalada.
   </para>
   <example xml:id="ex.x11.fontsys.fontconfig.aliases2">
    <title>Substituições de álias e nome de família</title>
<screen>&lt;alias&gt;
 &lt;family&gt;Alegreya SC&lt;/family&gt;
 &lt;default&gt;
  &lt;family&gt;serif&lt;/family&gt;
 &lt;/default&gt;
&lt;/alias&gt;
&lt;alias&gt;
 &lt;family&gt;Droid Serif&lt;/family&gt;
 &lt;default&gt;
  &lt;family&gt;serif&lt;/family&gt;
 &lt;/default&gt;
&lt;/alias&gt;
&lt;alias&gt;
 &lt;family&gt;STIXGeneral&lt;/family&gt;
 &lt;default&gt;
  &lt;family&gt;serif&lt;/family&gt;
 &lt;/default&gt;
&lt;/alias&gt;
&lt;alias&gt;
 &lt;family&gt;serif&lt;/family&gt;
 &lt;accept&gt;
  &lt;family&gt;Droid Serif&lt;/family&gt;
  &lt;family&gt;STIXGeneral&lt;/family&gt;
  &lt;family&gt;Alegreya SC&lt;/family&gt;
 &lt;/accept&gt;
&lt;/alias&gt;</screen>
   </example>
   <para>
    A prioridade é aplicada seguindo a ordem do álias <literal>&lt;accept&gt;</literal>. Da mesma forma, é possível usar os áliases <literal>&lt;prefer&gt;</literal> mais fortes.
   </para>
   <para>
    O <xref linkend="ex.x11.fontsys.fontconfig.aliases1"/> é expandido pelo <xref linkend="ex.x11.fontsys.fontconfig.aliases3"/>.
   </para>
   <example xml:id="ex.x11.fontsys.fontconfig.aliases3">
    <title>Substituições de álias e nome de família</title>
    <variablelist>
     <varlistentry xml:id="vle.x11.fontsys.example.alias.accept2">
      <term>Regra 4</term>
      <listitem>
<screen>&lt;alias&gt;
 &lt;family&gt;serif&lt;/family&gt;
 &lt;accept&gt;
  &lt;family&gt;Liberation Serif&lt;/family&gt;
 &lt;/accept&gt;
&lt;/alias&gt;</screen>
      </listitem>
     </varlistentry>
     <varlistentry xml:id="vle.x11.fontsys.example.alias.prefer2">
      <term>Regra 5</term>
      <listitem>
<screen>&lt;alias&gt;
 &lt;family&gt;serif&lt;/family&gt;
 &lt;prefer&gt;
  &lt;family&gt;DejaVu Serif&lt;/family&gt;
 &lt;/prefer&gt;
&lt;/alias&gt;</screen>
      </listitem>
     </varlistentry>
    </variablelist>
   </example>
   <para>
    A configuração expandida do <xref linkend="ex.x11.fontsys.fontconfig.aliases3"/> leva à seguinte evolução da PFL:
   </para>
   <table xml:id="tab.x11.fontsys.example.alias3">
    <title>Resultados da geração da PFL com base nas regras de Fontconfig</title>
    <tgroup cols="2">
     <colspec colwidth="1*"/>
     <colspec colwidth="3*"/>
     <thead>
      <row>
       <entry>
        <para>
         Ordem
        </para>
       </entry>
       <entry>
        <para>
         PFL atual
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Solicitação
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.default"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>serif</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>serif</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.accept"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>serif</literal>, <literal>STIXGeneral</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.accept2"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>serif</literal>, <literal>Liberation Serif</literal>, <literal>STIXGeneral</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <xref linkend="vle.x11.fontsys.example.alias.prefer2"/>
        </para>
       </entry>
       <entry>
        <para>
         <literal>Alegreya SC</literal>, <literal>Droid Serif</literal>, <literal>DejaVu Serif</literal>, <literal>serif</literal>, <literal>Liberation Serif</literal>, <literal>STIXGeneral</literal>
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <note>
    <title>Implicações.</title>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       Caso haja várias declarações <literal>&lt;accept&gt;</literal> para o mesmo nome genérico, a declaração que for analisada por último <quote>vencerá</quote>. Se possível, não use <literal>&lt;accept&gt;</literal> <emphasis role="bold">após</emphasis> o usuário (<filename>/etc/fonts/conf.d/*-user.conf</filename>) ao criar uma configuração de todo o sistema.
      </para>
     </listitem>
     <listitem>
      <para>
       Caso haja várias declarações <literal>&lt;prefer&gt;</literal> para o mesmo nome genérico, a declaração que for analisada por último <quote>vencerá</quote>. Se possível, não use <literal>&lt;prefer&gt;</literal> <emphasis role="bold">antes</emphasis> do usuário na configuração de todo o sistema.
      </para>
     </listitem>
     <listitem>
      <para>
       Cada declaração <literal>&lt;prefer&gt;</literal> sobregrava as declarações <literal>&lt;accept&gt;</literal> para o mesmo nome genérico. Se o administrador quiser dar ao usuário liberdade total para utilizar <literal>&lt;accept&gt;</literal>, e não apenas <literal>&lt;prefer&gt;</literal>, ele não deverá usar <literal>&lt;prefer&gt;</literal> na configuração de todo o sistema. Por outro lado, os usuários utilizam mais o <literal>&lt;prefer&gt;</literal>, portanto, isso não pode ser restritivo, já que constatamos também o uso de <literal>&lt;prefer&gt;</literal> nas configurações de todo o sistema.
      </para>
     </listitem>
    </itemizedlist>
   </note>
  </sect3>
 </sect2>
</sect1>
