<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="yast2_printer.xml" version="5.0" xml:id="sec-yast-hw-print">
 <title>设置打印机</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  YaST 可用于配置区域设置和网络打印机。<xref linkend="cha-print"/>中提供了有关打印的进一步信息（一般信息、技术细节和查错）。
 </para>

 <para>
  在 YaST 中，单击<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>以启动打印机模块。默认情况下，<guimenu>打印机配置</guimenu>视图会打开，显示所有可用和已配置打印机的列表。这一点在通过网络访问大量打印机时尤其有用。在这里，您还可以<guimenu>打印测试页</guimenu>及配置打印机。
 </para>

 <note>
  <title>启动 CUPS</title>
  <para>
   要使用连接到计算机的打印机，系统上必须安装并运行 CUPS。如果 CUPS 未运行，系统会提示您将其启动。如果 CUPS 不会在引导时启动，系统还会提示您启用此设置（建议做法）。
  </para>
 </note>

 <sect1 xml:id="sec-yast-hw-print-local">
  <title>配置打印机</title>
  <para>
   系统通常可以自动检测到 USB 打印机。如果未检测到打印机，请检查打印机是否已打开并连接到计算机。
  </para>
  <para>
   配置打印机分为三个步骤：指定连接类型、选择驱动程序，以及为此设置命名打印队列。
  </para>
  <para>
   许多打印机型号可能有多个可用驱动程序。配置打印机时，YaST 默认使用标有 <literal>recommended</literal> 的驱动程序。通常不需要更改驱动程序。但是，如果您希望彩色打印机只打印黑白颜色，可以使用不支持彩色打印的驱动程序。如果使用 PostScript 打印机打印图形时遇到性能问题，请尝试从 PostScript 切换到 PCL 驱动程序（假设您的打印机支持 PCL）。
  </para>
  <para>
   如果系统为列出适用于您的打印机的驱动程序，可以尝试从列表中选择相应标准语言的通用驱动程序。请参见您的打印机文档，以找出您的打印机支持的语言（控制打印机的命令集）。如果无法解决问题，请参见<xref linkend="sec-yast-hw-print-local-get-ppd"/>了解备选解决方案。
  </para>
  <para>
   打印机始终都是通过打印队列来使用的。这样可确保将同时执行的作业排入队列，然后逐个处理。每个打印队列都会被指派给一个特定驱动程序，而一台打印机可有多个队列。这样就能在彩色打印机上设置另一个队列，例如，专门用于打印黑白内容。请参见<xref linkend="sec-print-workflow"/>以获取有关打印队列的更多信息。
  </para>
  <procedure xml:id="pro-y2-hw-print-local-config">
   <title>添加新打印机</title>
   <step>
    <para>
     通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>打印机配置</guimenu>屏幕中，单击<guimenu>添加</guimenu>。
    </para>
   </step>
   <step>
    <para>
     如果 <literal>Specify the
     Connection</literal> 下已列出打印机，请继续执行下一步。否则，请尝试<guimenu>检测更多</guimenu>或启动<guimenu>连接向导</guimenu>。
    </para>
   </step>
   <step>
    <para>
     在 <literal>Find and Assign a Driver</literal> 下的文本框中输入供应商名称和型号名称，然后单击<guimenu>搜索</guimenu>。
    </para>
   </step>
   <step>
    <para>
     选择与您的打印机匹配的驱动程序。建议您选择最先列出的驱动程序。如果未显示适合的驱动程序，请尝试以下操作。
    </para>
    <substeps performance="required">
     <step>
      <para>
       检查搜索词。
      </para>
     </step>
     <step>
      <para>
       单击<guimenu>查找更多</guimenu>扩大搜索范围。
      </para>
     </step>
     <step>
      <para>
       根据<xref linkend="sec-yast-hw-print-local-get-ppd"/>中所述添加驱动程序。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     指定 <literal>Default paper size</literal>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>设置任意名称</guimenu>字段中，为打印队列输入一个唯一的名称。
    </para>
   </step>
   <step>
    <para>
     此时，打印机配置了默认设置并准备好可供使用。单击<guimenu>确定</guimenu>返回<guimenu>打印机配置</guimenu>视图。现在可以在打印机列表中看到新配置的打印机。
    </para>
   </step>
  </procedure>
  <sect2 xml:id="sec-yast-hw-print-local-get-ppd">
   <title>使用 YaST 添加驱动程序</title>
   <para>
    并非所有适用于 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 的打印机驱动程序都会默认安装。在添加打印机时，如果<guimenu>查找并指派驱动程序</guimenu>对话框中没有合适的驱动程序可用，请安装包含打印机驱动程序的驱动程序软件包：
   </para>
   <procedure>
    <title>安装其他驱动程序软件包</title>
    <step>
     <para>
      通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
     </para>
    </step>
    <step>
     <para>
      在<guimenu>打印机配置</guimenu>屏幕中，单击<guimenu>添加</guimenu>。
     </para>
    </step>
    <step>
     <para>
      在 <literal>Find and Assign a Driver</literal> 部分，单击<guimenu>驱动程序软件包</guimenu>。
     </para>
    </step>
    <step>
     <para>
      从列表中选择一个或多个合适的驱动程序软件包。<emphasis>不要</emphasis>指定打印机描述文件的路径。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>确定</guimenu>并确认安装软件包。
     </para>
    </step>
    <step>
     <para>
      要直接使用这些驱动程序，请按照<xref linkend="pro-y2-hw-print-local-config"/>所述操作。
     </para>
    </step>
   </procedure>
   <para>
    PostScript 打印机不需要打印机驱动程序软件。PostScript 打印机只需要与特定型号匹配的 PostScript 打印机描述 (PPD) 文件。PPD 文件由打印机制造商提供。
   </para>
   <para>
    添加 PostScript 打印机时，如果<guimenu>查找并指派驱动程序</guimenu>对话框中没有合适的 PPD 文件，请安装适合您打印机的 PPD 文件：
   </para>
   <para>
    PPD 文件来源有数个。建议先尝试 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 随附但默认未安装的其他驱动程序软件包（有关安装说明，请参见下文）。如果这些软件包不包含适合您的打印机的驱动程序，请直接从打印机供应商处或从 PostScript 打印机的驱动程序 CD 中取得 PPD 文件。有关详细信息，请参见 <xref linkend="sec-print-prob-ppd"/>。或者，也可以在 <link xlink:href="https://www.openprinting.org/printers"></link>（<quote>OpenPrinting.org 打印机数据库</quote>）中查找 PPD 文件。使用来自 OpenPrinting 的 PPD 文件时，请注意它们可能不受 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 支持。
   </para>
   <procedure>
    <title>添加 PostScript 打印机的 PPD 文件</title>
    <step>
     <para>
      通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
     </para>
    </step>
    <step>
     <para>
      在<guimenu>打印机配置</guimenu>屏幕中，单击<guimenu>添加</guimenu>。
     </para>
    </step>
    <step>
     <para>
      在 <literal>Find and Assign a Driver</literal> 部分，单击<guimenu>驱动程序软件包</guimenu>。
     </para>
    </step>
    <step>
     <para>
      在 <literal>Make
      a Printer Description File Available</literal> 下的文本框中输入 PPD 文件的完整路径。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>确定</guimenu>返回 <literal>Add New Printer
      Configuration</literal> 屏幕。
     </para>
    </step>
    <step>
     <para>
      要想直接使用该 PPD 文件，请按照<xref linkend="pro-y2-hw-print-local-config"/>中所述操作。
     </para>
    </step>
   </procedure>
  </sect2>
  <sect2 xml:id="sec-yast-hw-print-local-tune">
   <title>编辑本地打印机配置</title>
   <para>
    您可以编辑打印机的现有配置来更改连接类型和驱动程序等基本设置。还可以调整纸张大小、分辨率、媒体来源等的默认设置。通过修改打印机描述或位置，可以更改打印机的标识符。
   </para>
   <procedure>
    <step>
     <para>
      通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
     </para>
    </step>
    <step>
     <para>
      在<guimenu>打印机配置</guimenu>屏幕的列表中选择本地打印机配置，然后单击<guimenu>编辑</guimenu>。
     </para>
    </step>
    <step>
     <para>
      按<xref linkend="pro-y2-hw-print-local-config"/>中所述更改连接类型或驱动程序。只有当前配置存在问题时，才需要执行该操作。
     </para>
    </step>
    <step>
     <para>
      （可选）选中<guimenu>默认打印机</guimenu>将该打印机设为默认打印机。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>当前驱动程序的所有选项</guimenu>调整默认设置。要更改设置，可以单击 <literal>+</literal> 符号展开选项列表。通过单击选项更改默认值。单击<guimenu>确定</guimenu>应用您的更改。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-yast-hw-print-network">
  <title>使用 YaST 配置网络打印</title>
  <para>
   无法自动检测到网络打印机。必须使用 YaST 打印机模块手动进行配置。根据网络设置的不同，您可以打印到打印服务器（CUPS、LPD、SMB 或 IPX），或直接打印到网络打印机（最好通过 TCP）。通过从 YaST 打印机模块的左窗格中选择<guimenu>通过网络打印</guimenu>来访问网络打印配置视图。
  </para>
  <sect2 xml:id="sec-yast-hw-print-network-cups">
   <title>使用 CUPS</title>
   <para>
    在 Linux 环境中，使用 CUPS 来通过网络打印。最简单的设置是仅通过所有客户端都可直接访问的一台 CUPS 服务器来打印。通过多个 CUPS 服务器进行打印时，需要运行与远程 CUPS 服务器通讯的本地 CUPS 守护程序。
   </para>
   <important>
    <title>浏览网络打印队列</title>
    <para>
     CUPS 服务器通过传统的 CUPS 浏览协议或 Bonjour/DNS-SD 在网络上通告它们的打印队列。客户端需要浏览这些列表，以使用户能够选择要向其发送打印作业的特定打印机。要浏览网络打印队列，则必须在通过 CUPS 服务器打印的所有客户端上运行 <systemitem class="resource">cups-filters-cups-browsed</systemitem> 软件包提供的 <systemitem class="daemon">cups-browsed</systemitem> 服务。使用 YaST 配置网络打印时，<systemitem class="daemon">cups-browsed</systemitem> 会自动启动。
    </para>
    <para>
     如果在启动 <systemitem class="daemon">cups-browsed</systemitem> 之后无法浏览，则表明 CUPS 服务器可能是通过 Bonjour/DNS-SD 通告网络打印队列的。在此情况下，您需要另外安装 <systemitem class="resource">avahi</systemitem> 软件包，并在所有客户端上使用 <command>sudo systemctl start avahi-daemon</command> 启动关联的服务。
    </para>
   </important>
   <procedure>
    <title>通过单台 CUPS 服务器打印</title>
    <step>
     <para>
      通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
     </para>
    </step>
    <step>
     <para>
      在左侧窗格中，选择<guimenu>通过网络打印</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选中<guimenu>直接通过一个单一 CUPS 服务器执行所有打印</guimenu>并指定该服务器的名称或 IP 地址。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>测试服务器</guimenu>以确保您已选择正确的名称或 IP 地址。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>确定</guimenu>返回<guimenu>打印机配置</guimenu>屏幕。现在会列出通过 CUPS 服务器提供的所有打印机。
     </para>
    </step>
   </procedure>
   <procedure>
    <title>通过多个 CUPS 服务器进行打印</title>
    <step>
     <para>
      通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
     </para>
    </step>
    <step>
     <para>
      在左侧窗格中，选择<guimenu>通过网络打印</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选中<guimenu>接受来自 CUPS 服务器的打印机声明</guimenu>。
     </para>
    </step>
    <step>
     <para>
      在 <literal>General Settings</literal> 下，指定要使用的服务器。您可以接受来自所有可用网络或来自特定主机的连接。如果选择后一个选项，则需要指定主机名或 IP 地址。
     </para>
    </step>
    <step>
     <para>
      在系统提示您启动本地 CUPS 服务器时，依次单击<guimenu>确定</guimenu>和<guimenu>是</guimenu>。服务器启动之后，YaST 会返回<guimenu>打印机配置</guimenu>屏幕。单击<guimenu>刷新列表</guimenu>查看目前为止检测到的打印机。
     </para>
    </step>
   </procedure>
  </sect2>
  <sect2 xml:id="sec-yast-hw-print-network-other">
   <title>使用 CUPS 之外的打印服务器</title>
   <para>
    如果网络通过 CUPS 以外的其他打印服务器提供打印服务，可以单击<menuchoice><guimenu>硬件</guimenu><guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块，然后从左侧窗格中选择<guimenu>通过网络打印</guimenu>。启动<guimenu>连接向导</guimenu>并选择相应的<guimenu>连接类型</guimenu>。关于在您的环境中配置网络打印机的细节，请咨询您的网络管理员。
   </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-yast-hw-print-share">
  <title>通过网络共享打印机</title>
  <para>
   您可以通过网络共享本地 CUPS 守护程序所管理的打印机，这实际上是将您的计算机变成了 CUPS 服务器。可通过启用 CUPS 中所谓的<quote>浏览模式</quote>来共享打印机。如果浏览已启用，就可将本地打印队列用于在网络上侦听远程 CUPS 守护程序。您也可以设置专用 CUPS 服务器来管理所有打印队列，让远程客户端可以直接访问该服务器。在这种情况下，不需要启用浏览。
  </para>
  <procedure>
   <title>共享打印机</title>
   <step>
    <para>
     通过<menuchoice><guimenu>硬件</guimenu> <guimenu>打印机</guimenu></menuchoice>启动 YaST 打印机模块。
    </para>
   </step>
   <step>
    <para>
     从左侧窗格中选择<guimenu>共享打印机</guimenu>。
    </para>
   </step>
   <step>
    <para>
     选择<guimenu>允许远程访问</guimenu>。另外请选中<guimenu>对于本地网络中的计算机</guimenu>，并通过选中<guimenu>默认在本地网络内发布打印机</guimenu>启用浏览模式。
    </para>
   </step>
   <step>
    <para>
     单击<guimenu>确定</guimenu>重启 CUPS 服务器，并返回<guimenu>打印机配置</guimenu>屏幕。
    </para>
   </step>
   <step>
    <para>
     有关 CUPS 和防火墙设置，请参见 <link xlink:href="https://en.opensuse.org/SDB:CUPS_and_SANE_Firewall_settings"></link>。
    </para>
   </step>
  </procedure>
 </sect1>
</chapter>
