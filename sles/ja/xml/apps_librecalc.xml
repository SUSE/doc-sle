<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apps_librecalc.xml" version="5.0" xml:id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  Calcは、LibreOfficeのスプレッドシートモジュールです。スプレッドシートは、テキスト、数値、または数式などの要素を入力できるセルを含む複数のシートから構成されます。式を使用すれば、他のセルからのデータを操作して、式を挿入したセルの値を生成できます。Calcでは、データの範囲指定、フィルタ、およびソートが可能なほか、データからチャートを作成してグラフィカルに表現することができます。ピボットテーブルを使用すると、より大量のデータの組み合わせ、分析、および比較が可能です。
 </para>
 <para>
  この章では、非常に基本的なCalc機能のみを紹介します。詳細および詳しい手順については、LibreOfficeアプリケーションヘルプ、および<xref linkend="sec.oo.oview.help"/>に示されている参照先を参照してください。
 </para>
 <note>
  <title>VBAマクロ</title>
  <para>
   Calcでは、ExcelドキュメントのさまざまなVBAマクロを処理できます。ただし、VBAマクロが完全にサポートされているわけではありません。マクロを多用するExcelスプレッドシートを開くとき、一部のマクロが機能しないことがあります。
  </para>
 </note>
 <sect1 xml:id="sec.oo.calc.createnew">
  <title>新しい文書の作成</title>

  <para>
   新しいCalc文書を作成するには、次の2種類の方法があります。
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>最初から</title>
     <para>
      新しい空白ドキュメントを作成するには、<menuchoice><guimenu>ファイル</guimenu> <guimenu>新規</guimenu> <guimenu>スプレッドシート</guimenu></menuchoice>の順にクリックします。
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>テンプレートから</title>
     <para>
      テンプレートを使用するには、<menuchoice><guimenu>ファイル</guimenu> <guimenu>新規</guimenu> <guimenu>テンプレート</guimenu></menuchoice>の順にクリックし、<guimenu>ファイナンス</guimenu>などを開きます。スプレッドシートのテンプレートのリストから、ユーザのニーズに適したものを選択します。
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   ウィンドウ下部の対応するタブをクリックすることにより、個々のシートにアクセスします。
  </para>

  <para>
   必要に応じてセルにデータを入力します。外観を調整するには、<guimenu>Formatting (書式設定)</guimenu>ツールバーやサイドバーパネルを使用するか、<guimenu>フォーマット</guimenu>メニューを使用するか、<xref linkend="sec.oo.calc.styles"/>の説明に従ってスタイルを定義します。<guimenu>ファイル</guimenu>メニューまたはツールバーの該当するボタンを使用して、文書を印刷または保存します。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.styles">
  <title>Calcでの書式設定とスタイルの使用</title>

  <para>
   Calcには、スプレッドシートやレポートの外観を変更するセルやページ用スタイルがいくつか用意されています。通常はこれらのスタイルでも十分ですが、必要に応じて独自のスタイルを作成することもできます。
  </para>

  <procedure xml:id="pro.oo.calc.createstyle">
   <title>スタイルの作成</title>
   <step>
    <para>
     <menuchoice><guimenu>フォーマット</guimenu> <guimenu>Styles (スタイル)￼</guimenu> <guimenu>Styles and Formatting (スタイルと書式設定)</guimenu></menuchoice>の順にクリックするか、<keycap>F11</keycap>を押します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>Styles and Formatting (スタイルと書式設定)</guimenu>パネルの最上部で、<guimenu>Cell Styles (セルのスタイル)</guimenu>(緑のセル)または<guimenu>Page Styles (ページのスタイル)</guimenu>(ドキュメント)のいずれかをクリックします。
    </para>
   </step>
   <step>
    <para>
     <guimenu>Styles and Formatting (スタイルと書式設定)</guimenu>パネルで、スタイルのリスト内の任意の場所を右クリックします。続いて<guimenu>New (新規)</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     スタイルの名前を指定し、さまざまなタブを使用して必要な書式設定オプションを設定します。
    </para>
   </step>
   <step>
    <para>
     スタイルを設定したら、<guimenu>OK</guimenu>をクリックします。
    </para>
   </step>
  </procedure>

  <procedure>
   <title>スタイルの変更</title>
   <step>
    <para>
     <menuchoice><guimenu>フォーマット</guimenu> <guimenu>スタイル</guimenu> <guimenu>Styles and Formatting (スタイルと書式設定)</guimenu></menuchoice>の順にクリックします。
    </para>
   </step>
   <step>
    <para>
     <guimenu>Styles and Formatting (スタイルと書式設定)</guimenu>パネルの最上部で、<guimenu>Cell Styles (セルのスタイル)</guimenu>(緑のセル)または<guimenu>Page Styles (ページのスタイル)</guimenu>(ドキュメント)のいずれかをクリックします。
    </para>
   </step>
   <step>
    <para>
     変更したいスタイルの名前を右クリックし、<guimenu>変更</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     選択した書式設定オプションを変更します。
    </para>
   </step>
   <step>
    <para>
     スタイルを設定したら、<guimenu>OK</guimenu>をクリックします。
    </para>
   </step>
  </procedure>

  <para>
   スタイルを特定のセルに適用するには、書式設定するセルを選択します。続いて、<guimenu>スタイルと書式設定</guimenu>ウィンドウで適用するスタイルをダブルクリックします。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.sheets">
  <title>シートでの作業</title>

  <para>
   シートは計算をまとめるには最適な方法です。たとえば、事業を経営している場合、月ごとにシートを作成すると、経理がはるかに明確になることがあります。
  </para>

  <para>
   末尾のシートの後に新しいシートを挿入するには、シートのタブの横にある<guimenu>+</guimenu>ボタンをクリックします。
  </para>

  <para>
   1つまたは複数の新しいシートをファイルからスプレッドシートに挿入したり、特定の場所にすぐに挿入したりするには、次のように実行します。
  </para>

  <procedure xml:id="pro.oo.insert.sheet">
   <title>新しいシートの挿入</title>
   <step>
    <para>
     シートタブを右クリックし、<guimenu>Insert Sheet (シートの挿入)</guimenu>を選択します。ダイアログが開きます。
    </para>
   </step>
   <step>
    <para>
     新しいシートを選択したシートの前に置くか後ろに置くかを指定します。
    </para>
   </step>
   <step>
    <para>
     新しいシートを作成する際には、必ず<guimenu>New She (新規のシート)</guimenu>ラジオボタンが有効になっていることを確認してください。シート数とシート名を入力します。このステップの残りはスキップします。
    </para>
    <para>
     または、別のファイルからシートをインポートするには、次の手順を実行します。
    </para>
    <substeps performance="optional">
     <step>
      <para>
       <guimenu>From file (ファイルから)</guimenu>を選択し、<guimenu>参照</guimenu>をクリックします。
      </para>
     </step>
     <step>
      <para>
       ファイル名を選択し、<guimenu>OK</guimenu>を押して確認します。これですべてのシート名がリストに表示されます。
      </para>
     </step>
     <step>
      <para>
       <keycap function="shift"/>キーを押しながらクリックして、インポートするシートの名前を選択します。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     1つまたは複数のシートを追加するには、<guimenu>OK</guimenu>をクリックします。
    </para>
   </step>
  </procedure>

  <para>
   シートの名前を変更するには、シートのタブを右クリックしてから<guimenu>Rename Sheet (シートの名前変更)</guimenu>を選択します。または、シートタブをダブルクリックすることもできます。
  </para>

  <para>
   1つまたは複数のシートを削除するには、削除対象のシートを選択します。複数のシートを選択するには、選択時に<keycap function="shift"/>を押したままにします。次に、シートのタブを右クリックし、<guimenu>Delete Sheet (シートの削除)</guimenu>を選択して、<guimenu>はい</guimenu>をクリックします。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.condformat">
  <title>条件付き書式設定</title>

  <para>
   条件付き書式設定は、スプレッドシートで特定の値を強調表示する役立つ機能です。たとえば、条件を定義して、その条件が<literal>true</literal>の場合、スタイルはこの条件を満たすそれぞれのセルに適用されます。
  </para>

  <note>
   <title>自動計算の有効化</title>
   <para>
    条件付き書式設定を適用する前に、<menuchoice><guimenu>Tools (ツール)</guimenu><guimenu>Cell Contents (セルの内容)</guimenu><guimenu>AutoCalculate (自動計算)</guimenu></menuchoice>の順に選択します。<guimenu>自動計算</guimenu>の前のチェックマークを確認してください。
   </para>
  </note>

  <procedure xml:id="pro.oo.calc.condformat">
   <title>条件付き書式設定の使用</title>
   <step>
    <para>
     最初にスタイルを定義します。このスタイルは、条件が<literal>true</literal>の場合に各セルに適用されます。<menuchoice><guimenu>書式</guimenu><guimenu>スタイルと書式設定</guimenu></menuchoice>を使用するか、<keycap>F11</keycap>を押します。詳細については、<xref linkend="pro.oo.calc.createstyle"/>を参照してください。<guimenu>OK</guimenu>をクリックして、確定します。
    </para>
   </step>
   <step>
    <para>
     条件を適用するセル範囲を選択します。
    </para>
   </step>
   <step>
    <para>
     メニューから<menuchoice><guimenu>フォーマット</guimenu> <guimenu>Conditional Formatting (条件付き書式設定)</guimenu> <guimenu>Condition (条件)</guimenu></menuchoice>の順に選択します。ダイアログが開きます。
    </para>
   </step>
   <step>
    <para>
     新しい条件のテンプレートが表示されます。条件には、さまざまな動作モードがあります。
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>Cell value is (セル値)</guimenu>
      </term>
      <listitem>
       <para>
        条件は、セルが特定の値と一致しているかどうかをテストします。最初のドロップダウンボックスの横にある<guimenu>equal to (等しい)</guimenu>、<guimenu>less than (より小さい)</guimenu>、<guimenu>より大きい</guimenu>などのオペレータを選択します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Formula is (式)</guimenu>
      </term>
      <listitem>
       <para>
        条件は、特定の式が<literal>true</literal>を返すかどうかをテストします。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Date is (日付)</guimenu>
      </term>
      <listitem>
       <para>
        条件は、特定の日付値に達しているかどうかをテストします。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>All Cells (すべてのセル)</guimenu>
      </term>
      <listitem>
       <para>
        このモードでは、<guimenu>Cell value is (セル値)</guimenu>と同様に、セルの値に依存するデータ表現を作成できます。ただし、<guimenu>All Cells (すべてのセル)</guimenu>では、1つの条件を使用して範囲全体のスタイルを適用することができます。
       </para>
       <para>
        使用可能なスタイルの種類には、カラースケール(セルの背景色)、データバー(セル内のさまざまな幅のバー)、およびアイコンセット(セル内のアイコン)などがあります。
       </para>
       <para>
        たとえば、カラースケールでは、<literal>0</literal>を黒の背景色に、<literal>100</literal>を緑の背景色に割り当てることができます。これらの間の値は、自動的に計算されます。たとえば、<literal>50</literal>は濃い緑の背景色になります。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     この例では、デフォルトの<guimenu>Cell value is (セル値)</guimenu>のままにします。
    </para>
   </step>
   <step>
    <para>
     演算子と、テストするセルの値を選択します。
    </para>
   </step>
   <step>
    <para>
     この条件が<literal>true</literal>の場合に適用するスタイルを選択するか、<guimenu>New Style (新しいスタイル)</guimenu>をクリックして新しい外観を定義します。
    </para>
   </step>
   <step>
    <para>
     さらに条件が必要な場合は、<guimenu>Add (追加)</guimenu>をクリックします。その後、これまでのステップを繰り返します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>OK</guimenu>をクリックして、確定します。これでセルのスタイルが変更されました。
    </para>
   </step>
  </procedure>

  <remark>
   We might also want a procedure showing how to use the Manage dialog to remove
   conditions. -- sknorr, 2015-09-17
  </remark>
 </sect1>
 <sect1 xml:id="sec.oo.calc.grouping">
  <title>セルのグループ化とグループ化解除</title>

  <para>
   セル範囲をグループ化すると、スプレッドシートの一部を非表示にできます。これにより、現在必要でない部分をすべて非表示にできるので、スプレッドシートが見やすくなります。行または列をグループ化したり、グループを他のグループの入れ子にすることができます。
  </para>

  <para>
   範囲をグループ化するには、次の手順に従います。
  </para>

  <procedure>
   <title>選択したセル範囲のグループ化</title>
   <step>
    <para>
     スプレッドシートでセル範囲を選択します。
    </para>
   </step>
   <step>
    <para>
     <menuchoice><guimenu>データ</guimenu><guimenu>グループとアウトライン</guimenu><guimenu>グループ化</guimenu></menuchoice>の順に選択します。ｴﾎ､ﾎ･ﾀ･､･｢･愠ｰ､ｬｱ桄ｾ､ｵ､・ﾞ､ｹ｡｣.
    </para>
   </step>
   <step>
    <para>
     行単位または列単位で選択した範囲をグループ化するかをどうかを決めます。<guimenu>OK</guimenu>をクリックして、確定します。
    </para>
   </step>
  </procedure>

  <para>
   選択したセルをグループ化した後、グループ化したセル範囲を示す線が、左上の余白に表示されます。<guimenu>+</guimenu>と<guimenu>–</guimenu>のアイコンを使用して、セル範囲を折り畳んだり、展開したります。余白の左上の数値はグループの深さを示し、クリックすることもできます。
  </para>

  <para>
   セル範囲をグループ化解除するには、グループに含まれるセルをクリックして、<menuchoice><guimenu>データ</guimenu><guimenu>グループとアウトライン</guimenu><guimenu>グループ化解除</guimenu></menuchoice>の順に選択します。余白内の線が消えます。最も奥深くにあるグループが常に最初に削除されます。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.freezing">
  <title>ヘッダとする行または列の固定</title>

  <para>
   多数のデータを含むスプレッドシートがある場合、通常は、スクロールするとヘッダが消えてしまいます。LibreOfficeでは、行または列、あるいは両方をロックして、スクロールするときに固定しておくことができます。
  </para>

  <para>
   単一の行または単一の列を固定するには、次の手順に従います。
  </para>

  <procedure>
   <title>単一の行または列の固定</title>
   <step>
    <para>
     固定された領域を行の前に作成するには、行のヘッダ(<literal>1</literal>、<literal>2</literal>、<literal>3</literal>など)をクリックします。
    </para>
    <para>
     または、固定された領域を列の上に作成するには、列のヘッダ(<literal>A</literal>、<literal>B</literal>、<literal>C</literal>など)をクリックします。
    </para>
   </step>
   <step>
    <para>
     <menuchoice><guimenu>表示</guimenu> <guimenu>Freeze Rows and Columns(行と列の固定)</guimenu></menuchoice>の順に選択します。固定された領域を示す、濃い色の線が表示されます。
    </para>
   </step>
  </procedure>

  <para>
   また、行と列の両方を固定することもできます。
  </para>

  <procedure>
   <title>行と列の固定</title>
   <step>
    <para>
     固定する列の右側と行の下にあるセルをクリックします。たとえば、ヘッダがA1からB3までのスペースを占めている場合、セルC4をクリックします。
    </para>
   </step>
   <step>
    <para>
     <menuchoice><guimenu>表示</guimenu> <guimenu>Freeze Rows and Columns(行と列の固定)</guimenu></menuchoice>の順に選択します。固定された領域を示す、濃い色の線が表示されます。
    </para>
   </step>
  </procedure>

  <para>
   固定を解除するには、<menuchoice><guimenu>表示</guimenu> <guimenu>Freeze Rows and Columns(行と列の固定)</guimenu></menuchoice>の順に選択します。メニュー項目の前に表示されていたチェックマークが消えます。
  </para>
 </sect1>
</chapter>
