<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="storage_raidroot.xml" version="5.0" xml:id="cha.raidroot" xml:lang="zh-tw">
 <title>設定根分割區的軟體 RAID 1</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker>
   </dm:bugtracker>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
    </info>
    <para>
  在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 中，裝置對應程式 RAID 工具已整合到 YaST 磁碟分割程式中。您可以在安裝時使用磁碟分割程式為包含根 (<filename>/</filename>) 分割區的系統裝置建立一個軟體 RAID 1。不能將 <filename>/boot</filename> 分割區儲存在除 RAID 1 以外的 RAID 分割區上。在此情況下，開機載入程式必須安裝在 MBR 中。
 </para>
 <sect1 xml:id="sec.raidroot.require">
  <title>
   使用根分割區的軟體 RAID 1 裝置的先決條件
  </title>

  <para>
   確保您的組態符合下列要求：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     您需要兩個硬碟來建立 RAID 1 鏡像裝置。這兩個硬碟的大小應相似。RAID 假設為較小磁碟機的大小。區塊儲存裝置可以是本地 (機器中或直接連接到機器上)、光纖通道儲存子系統或 iSCSI 儲存子系統的任意組合。
    </para>
   </listitem>
   <listitem>
    <para>
     如果在 MBR 中安裝開機載入程式，則不需要為 <filename>/boot</filename> 建立獨立分割區。如果無法選擇在 MBR 中安裝開機載入程式，<filename>/boot</filename> 需要存放在不屬於軟體 RAID 的獨立分割區上。
    </para>
   </listitem>
   <listitem>
    <para>
     如果您使用的是硬體 RAID 裝置，請不要嘗試在其上執行軟體 RAID。
    </para>
   </listitem>
   <listitem>
    <para>
     如果您使用的是 iSCSI 目標裝置，必須先啟用 iSCSI 啟動器支援，然後再建立 RAID 裝置。
    </para>
   </listitem>
   <listitem>
    <para>
     如果儲存子系統在伺服器與要用於軟體 RAID 的裝置 (直接連接的本地裝置、光纖通道裝置或 iSCSI 裝置) 之間提供了多重 I/O 路徑，您必須先啟用多重路徑支援，然後才能建立 RAID 裝置。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sec.raidroot.setup">
  <title>為系統設定根 (<filename>/</filename>) 分割區的軟體 RAID 1 裝置</title>

  <procedure>
   <step>
    <para>
     使用 YaST 啟動安裝並依照<xref linkend="cha.inst"/>所述操作，直到<guimenu>建議的分割方式</guimenu>步驟為止。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>進階磁碟分割程式</guimenu>開啟該自定分割工具。
    </para>
   </step>
   <step>
    <para>
     (選擇性) 如果有要使用的 iSCSI 目標裝置，則需要從螢幕右下方的區段中選擇<menuchoice><guimenu>設定</guimenu> <guimenu>設定 iSCSI</guimenu></menuchoice>，以啟用 iSCSI 啟動器軟體。如需更多詳細資料，請參閱<xref linkend="cha.iscsi"/>。
    </para>
   </step>
   <step>
    <para>
     (選擇性) 如果要使用的裝置存在多個 I/O 路徑，您需要從螢幕右下方的區段中選擇<menuchoice><guimenu>設定</guimenu> <guimenu>設定多重路徑</guimenu> <guimenu>是</guimenu></menuchoice>，以啟用多重路徑支援。
    </para>
   </step>
   <step>
    <para>
     (選擇性) 如果您既未設定 iSCSI 又未設定多重路徑，則會顯示預設的建議設定。請按一下<guimenu>重新掃描裝置</guimenu>刪除它們。
    </para>
   </step>

   <step>
    <para>
     為要用於軟體 RAID 1 的每個裝置設定 <guimenu>0xFD Linux RAID</guimenu> 格式。
    </para>
    <substeps performance="required">
     <step>
      <para>
       在左側面板中，選取<guimenu>硬碟</guimenu>，然後選取要使用的裝置，再按一下<guimenu>新增分割區</guimenu>。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>新分割區類型</guimenu>下，選取<guimenu>主分割區</guimenu>，然後按<guimenu>下一步</guimenu>。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>新分割區大小</guimenu>下，指定要使用的大小，然後按<guimenu>下一步</guimenu>。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>角色</guimenu>下，選擇<guimenu>原始磁碟區 (未格式化)</guimenu>。
      </para>
     </step>
     <step>
      <para>
       選取<guimenu>不格式化</guimenu>，並將<guimenu>檔案系統 ID</guimenu> 設定為 <guimenu>0xFD Linux RAID</guimenu>。
      </para>
     </step>
     <step>
      <para>
       按一下<guimenu>完成</guimenu>，然後對第二個分割區重複這些指示。
      </para>
      <informalfigure>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="raid_yast_install2_a.png" width="80%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="raid_yast_install2_a.png" width="100%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </informalfigure>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     建立 RAID 裝置。
    </para>
    <substeps performance="required">
     <step>
      <para>
       在左側面板中，選取 <guimenu>RAID</guimenu>，然後選取<guimenu>新增 RAID</guimenu>。
      </para>
     </step>
     <step>
      <para>
       將 <guimenu>RAID 類型</guimenu>設定為 <guimenu>RAID 1 (鏡像)</guimenu>，將 <guimenu>RAID 名稱</guimenu>設定為 <literal>system</literal>。
      </para>
     </step>
     <step>
      <para>
       從<guimenu>可用的裝置</guimenu>區段中選取您在上一步中準備的兩個 RAID 裝置，並<guimenu>新增</guimenu>它們。
      </para>
      <informalfigure>
       <mediaobject>
        <imageobject role="fo">
         <imagedata fileref="raid_yast_install3_a.png" width="80%" format="PNG"/>
        </imageobject>
        <imageobject role="html">
         <imagedata fileref="raid_yast_install3_a.png" width="100%" format="PNG"/>
        </imageobject>
       </mediaobject>
      </informalfigure>
      <para>
       按<guimenu>下一步</guimenu>繼續。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>RAID 選項</guimenu>下的下拉式清單中選取區塊大小。區塊大小對 RAID 1 的效能影響不大，因此建議保留預設值。
      </para>
     </step>
     <step>
      <para>
       在<guimenu>角色</guimenu>下，選取<guimenu>作業系統</guimenu>。
      </para>
     </step>

     <step>
      <para>
       按一下<guimenu>完成</guimenu>結束此對話方塊。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     該軟體 RAID 裝置便會受裝置對應程式的管理，並會在 <filename>/dev/md/system</filename> 路徑下建立一個裝置。按一下<guimenu>接受</guimenu>結束磁碟分割程式。
    </para>
    <para>
     新建議會出現在<guimenu>建議的分割方式</guimenu>頁面上。
    </para>
   </step>
   <step>
    <para>
     繼續安裝。
    </para>
    <para>
     每次將伺服器重新開機時，裝置對應程式都會在開機時啟動，以便讓系統能夠自動辨識軟體 RAID，並啟動根 (/) 分割區上的作業系統。
    </para>
   </step>
  </procedure>
 </sect1>
</chapter>
