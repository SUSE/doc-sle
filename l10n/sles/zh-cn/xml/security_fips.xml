<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="security_fips.xml" version="5.0" xml:id="cha-security-fips">
  <title>确保符合 FIPS 140-3 标准</title>
  <info>
    <abstract>
      <para>
        FIPS 140-3 是一个安全认证程序，用于验证私营公司生产的加密模块。联邦信息处理标准 (FIPS) 140 版本是美国国家标准与技术研究院 (NIST) 为确保加密模块的质量而制定的一系列计算机安全标准。</para>
      <para>
        如果您的组织要为美国联邦政府履行任何责任，那么，您的加密应用程序（例如 openSSL、GnuTLS 和 OpenJDK）可能需要符合联邦信息处理标准 (FIPS) 140-3。如果合规性规则不要求您的组织以 FIPS 模式运行 SUSE Linux Enterprise，则最好不要以这种模式运行。本章提供有关启用 FIPS 模式的指导，以及包含详细信息的资源的链接。
      </para>
    </abstract>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker/>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>
  <important>
    <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 SP7 和 FIPS 140-3</title>
    <para> <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>15 SP7 将进行通用标准认证，但不会申请 NIST FIPS 140-3 认证。有关详细信息，请参见 <link xlink:href="https://www.suse.com/support/security/certifications/"></link>。
    </para>
  </important>
  <sect1 xml:id="sec-fips-concept">
    <title>FIPS 概览</title>

    <para>
      开发和维护加密应用程序并想要测试其 FIPS 合规性的每家供应商必须将这些应用程序提交到加密模块验证程序 (CMVP)（请参见 <link xlink:href="https://csrc.nist.gov/projects/cryptographic-module-validation-program"></link>）。
    </para>

    <para>
      最新的 FIPS 140-3 标准已于 2019 年 3 月获得批准并取代了 140-2。
    </para>

    

    
  </sect1>
  <sect1 xml:id="sec-fips-use-case">
    <title>何时启用 FIPS 模式</title>

    <warning>
      <title>实施 FIPS 需要具备专业知识</title>
      <para>
        FIPS 的管理非常复杂，需要具备丰富的专业知识。正确实施、测试 FIPS 以及对其进行查错都需要很高的知识水平。
      </para>
    </warning>

    <para>
      请仅在需要满足合规性规则时，以 FIPS 模式运行 <phrase role="productname"><phrase os="sles">SLES</phrase></phrase>。否则，我们不建议以 FIPS 模式运行您的系统。
    </para>

    <para>
      下面是<emphasis>不</emphasis>建议使用 FIPS 模式的一些原因（如果没有明确的要求）：
    </para>

    <itemizedlist>
      <listitem>
        <para>
          FIPS 有约束性。它强制要求使用经验证的特定加密算法，并强制要求使用实现这些经验证算法的特定已认证二进制文件。您只能使用已认证的二进制文件。
        </para>
      </listitem>
      <listitem>
        <para>
          升级可能会破坏功能。
        </para>
      </listitem>
      <listitem>
        <para>
          审批过程非常漫长，因此已认证的二进制文件始终比最新版本要落后几个版本。
        </para>
      </listitem>
      <listitem>
        <para>
          已认证的二进制文件（例如 ssh、sshd 和 sftp-server）会在启动时运行自检，并仅在这些检查成功时才会运行。这会导致性能小幅下降。
        </para>
      </listitem>
      <listitem>
        <para>
          FIPS 的管理非常复杂，需要具备丰富的专业知识。
        </para>
      </listitem>
    </itemizedlist>
  </sect1>
  
  <sect1 os="sles" xml:id="sec-fips-install">
    <title>安装 FIPS</title>

    <para>
      最好在新的安装中安装 <package>patterns-base-fips</package> 软件集。
      
    </para>

      <para>
      可以在运行中的系统上安装 <package>patterns-base-fips</package> 并启用 FIPS 模式，但可能必须进行调整，例如重新生成密钥，并审计设置以确保 FIPS 设置正确。
    </para>
  </sect1>
  <sect1 os="sles" xml:id="sec-how-to-fips-install">
    <title>启用 FIPS 模式</title>
   <para>
    以下过程说明如何启用 FIPS 模式：
    </para>
   <procedure>
    <step>
<para>默认情况下，可能不会安装提供 <literal>fips-mode-setup</literal> 命令的 <package>crypto-policies-scripts</package> 软件包。如果未安装，您可以使用受支持的方式安装该软件包，然后启用内核 FIPS 模式，该模式还会将系统策略设置为 FIPS：
</para>
<screen><prompt>&gt; </prompt><command>sudo</command>  fips-mode-setup --enable
Setting system policy to FIPS
FIPS mode will be enabled.
[...]
Please reboot the system for the setting to take effect.
</screen>
      </step>
<step>
  <para>重新引导并使用以下命令校验 FIPS 模式：
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command>  fips-mode-setup --check
FIPS mode is enabled.
Initramfs fips module is enabled.
The current crypto policy (FIPS) is based on the FIPS policy.
</screen>
</step>
<step>
  <para>要禁用 FIPS 模式，请运行：
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command>  fips-mode-setup --disable
Setting system policy to DEFAULT
FIPS mode will be disabled.
[...]
Please reboot the system for the setting to take effect.
</screen>
</step>
      </procedure>
<para>也可以使用以下选项：</para>
<itemizedlist mark="bullet" spacing="normal">
<listitem><para><literal>--no-bootcfg</literal>：该工具不会重新配置引导加载程序，而是列显需要添加到内核命令行的选项。例外：它仍会尝试在 <literal>s390x</literal> 上执行 <command>zipl</command>，否则系统可能会变得无法引导。</para></listitem>
<listitem><para><literal> --is-enabled</literal>：检查系统 FIPS 模式状态，如果已禁用或不一致，则分别返回失败错误代码 2 或 1。</para></listitem>
</itemizedlist>
      </sect1>
  
  
  <sect1 xml:id="sec-fips-samba-cifs">
    <title>Samba/CIFS 不支持 MD5</title>

    <para>
      根据 FIPS 标准，MD5 不是安全的哈希算法，不得将它用于身份验证。如果您的网络环境符合 FIPS 要求，并且您的客户端或服务器以符合 FIPS 要求的模式运行，您必须使用 Kerberos 服务对 Samba/CIFS 用户进行身份验证。之所以必须这样做，是因为所有其他 Samba 身份验证模式都包含 MD5。
    </para>

    <para os="sles">
      有关运行 Samba 服务器的详细信息，请参见《存储管理指南》的“Samba”一节。
    </para>
  </sect1>
  <sect1 xml:id="sec-fips-more">
    <title>更多信息</title>

    <para>
     有关详细信息，请参见：
    </para>

    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       Man 8 <literal>fips-mode-setup</literal>
      </para>
     </listitem>
     <listitem>
      <para>
        Man 8 <literal>fips-finish-install</literal>
      </para>
     </listitem>
     <listitem>
      <para>
        Man 7 <literal>crypto-policies</literal>
      </para>
     </listitem>
     <listitem>
      <para>
        Man 8 <literal>update-crypto-policies</literal>
      </para>
     </listitem>
    </itemizedlist>
   </sect1>
</chapter>
