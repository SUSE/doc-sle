<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="adm_support.xml" version="5.0" xml:id="cha.adm.support">


 <title>收集系統資訊以供支援所用</title>
 <info>
      <abstract>
        <para>
    為了讓使用者快速綜覽機器的所有相關系統資訊，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 提供了 <systemitem class="systemname">hostinfo</systemitem> 套件。該套件還可以協助系統管理員檢查污染的 (不受支援的) 核心，或者機器上安裝的任何協力廠商套件。
   </para>
        <para>
    出現問題時，可以使用 <command>supportconfig</command> 指令行工具或 YaST <guimenu>支援</guimenu>模組建立詳細的系統報告。這兩種方法都會收集系統的相關資訊，包括目前核心版本、硬體、已安裝套件、分割區設定及其他資訊。最後會產生一個包含多個檔案的 TAR 歸檔。在建立服務要求 (SR) 後，您可以將該 TAR 歸檔上傳至全球技術支援。該歸檔有助於找出您所報告的問題，並可以協助您解決問題。
   </para>
        <para>
    此外，您可以分析 <command>supportconfig</command> 輸出來發現已知問題，以協助快速解決問題。為此，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 提供了一個裝置和一個指令行工具用於進行 <literal>Supportconfig 分析</literal> (SCA)。
   </para>
      </abstract>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker>
        </dm:bugtracker>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
    </info>
    <indexterm> <primary>支援</primary> </indexterm> <indexterm> <primary>系統資訊</primary> </indexterm>
 <sect1 xml:id="sec.admsupport.hostinfo">
  <title>顯示目前系統資訊</title>



  <para>
   在登入伺服器時，要想快速方便地綜覽所有相關系統資訊，請使用套件 <systemitem class="systemname">hostinfo</systemitem>。機器上安裝該套件後，控制台將會向登入此機器的任何 <systemitem class="username">root</systemitem> 使用者顯示以下資訊：
  </para>

  <example xml:id="ex.support.hostinfo">
   <title>以 <systemitem class="username">root</systemitem> 身分登入時的 <command>hostinfo</command> 輸出</title>
<screen>Hostname:                 earth
Current As Of:            Wed 12 Mar 2014 03:57:05 PM CET
Distribution:             SUSE Linux Enterprise Server 12
 -Service Pack:           0
Architecture:             x86_64
Kernel Version:           3.12.12-3-default
 -Installed:              Mon 10 Mar 2014 03:15:05 PM CET
 -Status:                 Not Tainted
Last Updated Package:     Wed 12 Mar 2014 03:56:43 PM CET
 -Patches Needed:         0
 -Security:               0
 -3rd Party Packages:     0
IPv4 Address:             ens3 192.168.1.1
Total/Free/+Cache Memory: 983/95/383 MB (38% Free)
Hard Disk:                /dev/sda 10 GB</screen>
  </example>

  <para>
   如果輸出顯示 <literal>tainted</literal> 核心狀態，請參閱<xref linkend="sec.admsupport.kernel"/>以取得詳細資訊。
  </para>
 </sect1>
 <sect1 xml:id="sec.admsupport.supportconfig">
  <title>使用 Supportconfig 收集系統資訊</title>

  <para>
   若要建立包含詳細系統資訊的 TAR 歸檔以送交全球技術支援，請直接使用 <command>supportconfig</command> 指令行工具，或者使用 YaST <guimenu>支援</guimenu>模組。該指令行工具由預設安裝的套件 <systemitem>supportutils</systemitem> 提供。YaST <guimenu>支援</guimenu>模組也以該指令行工具為基礎。
  </para>

  <sect2 xml:id="sec.admsupport.supportconfig.sr">
   <title>建立服務要求號碼</title>
   <para>
    系統隨時都可以產生 Supportconfig 歸檔。但是，要將 supportconfig 資料送交全球技術支援，首先需要產生一個服務要求號碼。上傳歸檔以獲得支援時，您需要使用此號碼。
   </para>
   <para>
    若要建立服務要求，請造訪 <link xlink:href="http://www.novell.com/center/eservice"/> 並依照螢幕上的指示執行操作。記下您的 11 位數服務要求號碼。
   </para>
   <note>
    <title>隱私權聲明</title>
    <para>
     SUSE 和 Novell 將系統報告視為機密資料。關於我們在隱私方面所做承諾的詳細資訊，請參閱 <link xlink:href="http://www.novell.com/company/legal/privacy/"/>。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="sec.admsupport.supportconfig.upload">
   <title>上傳目標</title>
   <para>
    在建立服務要求號碼後，可以依照<xref linkend="pro.admsupport.submit.yast"/>或<xref linkend="pro.admsupport.submit.cli"/>中所述將 supportconfig 歸檔上傳到全球技術支援。使用下列上傳目標之一：
   </para>


   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      美國客戶：<link xlink:href="ftp://ftp.novell.com/incoming"/>
     </para>
    </listitem>
    <listitem>
     <para>
      EMEA (歐洲、中東和非洲)：<link xlink:href="ftp://support-ftp.suse.com/in"/>
     </para>
    </listitem>
   </itemizedlist>
   <para>
    或者，可以使用以下服務要求 URL 手動將該 TAR 歸檔附加到您的服務要求：<link xlink:href="http://www.novell.com/center/eservice"/>。
   </para>
  </sect2>

  <sect2 xml:id="sec.admsupport.yast">
   <title>使用 YaST 建立 Supportconfig 歸檔</title>
   <para>
    若要使用 YaST 收集系統資訊，請執行下列步驟： <remark>2008-11-20 toms: YaST asks the user to open a URL as
     root(!). This happens when the users clicks on "Open" (Open
     Support Center/ This will start a browser with
     Support Center Portal). I don't think we should describe this
     and only *use* the above URL as a normal user for security
     reasons.</remark>
   </para>
   <procedure>
    <step>
     <para>
      啟動 YaST 並開啟<guimenu>支援</guimenu>模組。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2-support-main.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2-support-main.png" width="60%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step>
     <para>
      按一下<guimenu>建立報告 Tar 聚合檔</guimenu>。
     </para>
    </step>
    <step>
     <para>
      在隨後出現的視窗中，從選項圓鈕清單中選取一個 supportconfig 選項。依預設，系統會預先選取<guimenu>使用自定 (進階) 設定</guimenu>。如果要先測試報告功能，請使用<guimenu>僅收集最少量的資訊</guimenu>。關於其他選項的某些背景資訊，請參閱 <command>supportconfig</command> 的 man 頁面。
     </para>
     <para>
      按<guimenu>下一步</guimenu>繼續。
     </para>
    </step>
    <step xml:id="step.supportconfig.contact">
     <para>
      輸入您的聯絡人資訊。該資訊將寫入名為 <filename>basic-environment.txt</filename> 的檔案，並包含在要建立的歸檔中。
     </para>
    </step>
    <step xml:id="step.supportconfig.upload.target">
     <para>
      如果要在結束資訊收集程序時將歸檔提交至全球技術支援，則需要指定<guimenu>上傳資訊</guimenu>。YaST 會自動推薦一個上傳伺服器。如果要修改該伺服器，請參閱<xref linkend="sec.admsupport.supportconfig.upload"/>，以詳細瞭解可以使用哪些上傳伺服器。
     </para>
     <para>
      如果希望稍後提交歸檔，則可以暫時將<guimenu>上傳資訊</guimenu>保留空白。
     </para>
    </step>
    <step>
     <para>
      按<guimenu>下一步</guimenu>繼續。
     </para>
    </step>
    <step>
     <para>
      系統即開始收集資訊。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2-support-conf.png" width="90%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2-support-conf.png" width="80%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <para>
      該程序完成後，按<guimenu>下一步</guimenu>繼續。
     </para>
    </step>
    <step>
     <para>
      檢查資料收集：選取記錄檔案的<guimenu>檔案名稱</guimenu>可以在 YaST 中檢視其內容。在將 TAR 歸檔提交至支援人員之前，若要移除您不希望包含在該歸檔中的檔案，請使用<guimenu>從資料移除</guimenu>。按<guimenu>下一步</guimenu>繼續。
     </para>
    </step>
    <step>
     <para>
      儲存該 TAR 歸檔。如果您以 <systemitem class="username">root</systemitem> 使用者身分啟動了 YaST 模組，則 YaST 預設會建議將該歸檔儲存到 <filename>/var/log</filename> (否則將儲存到您的主目錄)。檔案名稱格式為 <filename>nts_<replaceable>主機</replaceable>_<replaceable>日期</replaceable>_<replaceable>時間</replaceable>.tbz</filename>。
     </para>
    </step>
    <step>
     <para>
      如果要直接將該歸檔上傳給支援人員，請確定啟用了<guimenu>將記錄檔案 Tar 聚合檔上傳到 URL</guimenu>。這裡顯示的<guimenu>上傳目標</guimenu>是<xref linkend="step.supportconfig.upload.target"/> 中 YaST 建議的上傳目標。如果要修改上傳目標，請在<xref linkend="sec.admsupport.supportconfig.upload"/>中查看關於哪些上傳伺服器可用的詳細資訊。
     </para>
    </step>
    <step>
     <para>
      如果要跳過上傳步驟，請停用<guimenu>將記錄檔案 Tar 聚合檔上傳到 URL</guimenu>。
     </para>
    </step>
    <step>
     <para>
      確認變更以關閉 YaST 模組。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.admsupport.cli">
   <title>從指令行建立 Supportconfig 歸檔</title>
   <para>
    以下程序顯示如何建立 supportconfig 歸檔但不將它直接提交給支援人員。要上傳該歸檔，需要依照<xref linkend="pro.admsupport.submit.cli"/>中所述，結合某些選項執行指令。
   </para>
   <procedure>
    <step>
     <para>
      開啟外圍程序，切換為 <systemitem class="username">root</systemitem> 身分。
     </para>
    </step>
    <step>
     <para>
      執行 <command>supportconfig</command>，且不使用任何選項。此操作會收集預設的系統資訊。
     </para>
    </step>
    <step>
     <para>
      等待工具完成操作。
     </para>
    </step>
    <step>
     <para>
      預設的歸檔位置為 <filename>/var/log</filename>，檔案名稱格式為 <filename>nts_<replaceable>主機</replaceable>_<replaceable>日期</replaceable>_<replaceable>時間</replaceable>.tbz</filename>
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.admsupport.options">
   <title>Supportconfig 通用選項</title>
   <para>
    呼叫 <command>supportconfig</command> 公用程式時通常不會顯示任何選項。請使用 <command>supportconfig</command> <option>-h</option> 顯示所有選項的清單，或參閱 man 頁面。下面的清單簡要概述了一些常見的使用案例︰
   </para>
   <variablelist>
    <varlistentry>
     <term>減少所收集資訊的大小</term>
     <listitem>
      <para>
       使用最少量選項 (<option>-m</option>)：
      </para>
<screen>supportconfig -m</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>將資訊限制為特定的主題</term>
     <listitem>
      <para>
       如果您已使用預設的 <command>supportconfig</command> 輸出找到問題原因所在，並發現該問題只與特定的區域或功能集相關，則您在下一次執行 <command>supportconfig</command> 時，可以將收集的資訊限制為特定的區域。例如，如果您偵測到 LVM 出現問題，並想要測試最近對 LVM 組態所做的變更，則合適的做法是僅收集關於 LVM 的最少量 supportconfig 資訊：
      </para>
<screen>supportconfig -i LVM</screen>
      <para>
       要查看可用來將收集之資訊限制為特定區域的功能關鍵字的完整清單，請執行
      </para>
<screen>supportconfig -F</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>在輸出中包含其他聯絡資訊：</term>
     <listitem>
<screen>supportconfig -E tux@example.org -N "Tux Penguin" -O "Penguin Inc." ...</screen>
      <para>
       (在一行中輸入所有指令)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>收集已輪替的記錄檔案</term>
     <listitem>
<screen>supportconfig -l</screen>
      <para>
       這對記錄量大的環境，或在重新開機後 syslog 輪替記錄檔案時核心發生當機的情況特別有用。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.admsupport.submit">
  <title>將資訊提交至全球技術支援</title>

  <para>
   可以使用 YaST <guimenu>支援</guimenu>模組或 <command>supportconfig</command> 指令行公用程式向全球技術支援提交系統資訊。如果您遇到伺服器問題，想要獲得支援人員的協助，則首先需要建立一個服務要求。如需詳細資料，請參閱<xref linkend="sec.admsupport.supportconfig.sr"/>。
  </para>

  <para>
   以下範例使用 <replaceable>12345678901</replaceable> 做為服務要求號碼的預留位置。請以您在<xref linkend="sec.admsupport.supportconfig.sr"/>中建立的服務要求號碼取代 <replaceable>12345678901</replaceable>。
  </para>

  <procedure xml:id="pro.admsupport.submit.yast">
   <title>使用 YaST 向支援人員提交資訊</title>
   <para>
    以下程序假設您已建立一個 supportconfig 歸檔，但尚未上傳。請確定已按<xref linkend="sec.admsupport.yast"/>中<xref linkend="step.supportconfig.contact" xrefstyle="select:label nopage"/>所述，在歸檔中包含了您的聯絡資訊。關於如何透過一個步驟產生並提交 supportconfig 歸檔的指示，請參閱<xref linkend="sec.admsupport.yast"/>。
   </para>
   <step>
    <para>
     啟動 YaST 並開啟<guimenu>支援</guimenu>模組。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>上傳</guimenu>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>含記錄檔案的套件</guimenu>中，指定現有 supportconfig 歸檔的路徑，或者按一下<guimenu>瀏覽</guimenu>找到該歸檔。
    </para>
   </step>
   <step xml:id="step.supportcfg.submit.upltarget">
    <para>
     YaST 會自動推薦一個上傳伺服器。如果要修改該伺服器，請參閱<xref linkend="sec.admsupport.supportconfig.upload"/>，以詳細瞭解可以使用哪些上傳伺服器。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="yast2-support-conf-upload.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="yast2-support-conf-upload.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <para>
     <remark>taroth 2014-04-11: this does not make sense to me - why does the
      YaST module *not* ask for the SR number now? and lets you continue after
      specifying an upload target (but no RC or customer info at all)? I would
      expect it to *check* if an SR has been entered and otherwise show an error
      message - filed http://bugzilla.suse.com/show_bug.cgi?id=880943 for this, unfortunately it
      was rejected for technical reasons</remark>按<guimenu>下一步</guimenu>繼續。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>完成</guimenu>。
    </para>
   </step>
  </procedure>

  <procedure xml:id="pro.admsupport.submit.cli">
   <title>從指令行向支援人員提交資訊</title>
   <para>
    以下程序假設您已建立一個 supportconfig 歸檔，但尚未上傳。關於如何透過一個步驟產生並提交 supportconfig 歸檔的指示，請參閱<xref linkend="sec.admsupport.yast"/>。
   </para>
   <step>
    <para>
     伺服器連接至網際網路︰
    </para>
    <substeps performance="required">
     <step>
      <para>
       要使用預設上載目標，請執行︰
      </para>
<screen>supportconfig -ur <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       對於安全上傳目標，請使用以下指令：
      </para>

<screen>supportconfig -ar <replaceable>12345678901</replaceable></screen>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     伺服器<emphasis>未</emphasis>連接至網際網路
    </para>
    <substeps performance="required">
     <step>
      <para>
       執行以下指令︰
      </para>
<screen>supportconfig -r <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       將 <filename>/var/log/nts_<replaceable>SR12345678901</replaceable>*tbz</filename> 歸檔手動上傳到我們的 FTP 伺服器之一。要使用哪個伺服器取決於您所在的位置。如需綜覽，請參閱<xref linkend="sec.admsupport.supportconfig.upload"/>。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     TAR 歸檔傳輸到我們 FTP 伺服器的內送目錄後，會自動附加到您的服務要求中。
    </para>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec.admsupport.sca">
  <title>分析系統資訊</title>

  <para>
   您可以分析使用 <command>supportconfig</command> 建立的系統報告來發現已知問題，以幫助快速解決問題。為此，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 提供了一個裝置和一個指令行工具用於進行 <literal>Supportconfig 分析</literal> (SCA)。SCA 裝置是一個非互動式伺服器端工具。SCA 工具 (<command>scatool</command>) 在用戶端的指令行上執行。這兩個工具都能分析來自受影響伺服器的 supportconfig 歸檔。初始伺服器分析在 SCA 裝置或執行 scatool 的工作站上進行。線上伺服器上不會發生任何分析週期。
  </para>

  <para>
   此外，該裝置與指令行工具另外還需要產品特定的模式，這樣它們才能分析關聯產品的 supportconfig 輸出。每種模式都是一個程序檔，用於針對某個已知問題分析和評估 supportconfig 歸檔。模式以 RPM 套件的形式提供。
  </para>

  <para>
   例如，如果您想要分析 SUSE Linux Enterprise 11 機器上產生的 supportconfig 歸檔，則需要將 <systemitem class="resource">sca-patterns-sle11</systemitem> 套件隨 SCA 工具一並安裝 (或者，在您想要用做 SCA 裝置伺服器的機器上安裝該套件)。要分析 SUSE Linux Enterprise 10 機器上產生的 supportconfig 歸檔，需要安裝 <systemitem class="resource">sca-patterns-sle10</systemitem> 套件。
  </para>

  <para>
   您也可以依照<xref linkend="sec.admsupport.sca.patterns"/>中的簡要描述開發自己的模式。
  </para>

  <sect2 xml:id="sec.admsupport.sca.tool">
   <title>SCA 指令行工具</title>
   <para>
    SCA 指令行工具讓您既可使用 <command>supportconfig</command>，又可使用本地機器上安裝的特定產品的分析模式來分析該機器。該工具將建立一份顯示分析結果的 HTML 報告。如需取得範例說明，請參閱<xref linkend="fig.scatool.html"/>。
   </para>
   <figure xml:id="fig.scatool.html">
    <title>SCA 工具產生的 HTML 報告</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    <command>scatool</command> 指令由 <systemitem class="resource">sca-server-report</systemitem> 套件提供。系統上預設不會安裝該套件。此外，您需要 <systemitem class="resource">sca-patterns-base</systemitem> 套件，以及與您想要在其上執行 <command>scatool</command> 指令的機器上所安裝產品相符之任一產品特定的 <systemitem class="resource">sca-patterns-*</systemitem> 套件。
   </para>
   <para>
    以 <systemitem class="username">root</systemitem> 使用者身分或者結合 <command>sudo</command> 執行 <command>scatool</command> 指令。在呼叫 SCA 工具時，您可以分析現有的 <command>supportconfig</command> TAR 歸檔，也可以讓該工具透過一個步驟產生並分析新的歸檔。該工具還提供了一個互動式控制台 (具有 Tab 鍵補齊功能)，並允許使用者在外部機器上執行 <command>supportconfig</command>，然後在本地機器上執行後續分析。
   </para>
   <para>
    下面提供了一些範例指令：
   </para>
   <variablelist>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option>
     </term>
     <listitem>
      <para>
       呼叫 <command>supportconfig</command> 並在本地機器上產生新的 supportconfig 歸檔。透過套用與所安裝產品相符的 SCA 分析模式來分析歸檔，以發現已知問題。顯示基於分析結果產生之 HTML 報告的路徑。通常，該報告會寫入 supportconfig 歸檔所在的同一個目錄。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option> <option>-o</option> <replaceable>/opt/sca/reports/</replaceable> 
     </term>
     <listitem>
      <para>
       與 <command>sudo scatool </command><option>-s</option> 類似，唯一的差別在於，HTML 報告會寫入 <option>-o</option> 選項指定的路徑。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>PATH_TO_TARBALL_OR_DIR</replaceable> 
     </term>
     <listitem>
      <para>
       分析指定的 supportconfig 歸檔檔案 (或者 supportconfig 歸檔解壓縮到的指定目錄)。產生的 HTML 報告儲存在 supportconfig 歸檔或目錄所在的位置。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>sles_server.company.com</replaceable> 
     </term>
     <listitem>
      <para>
       與外部伺服器 <replaceable>sles_server.company.com</replaceable> 建立 SSH 連接，並在該伺服器上執行 <command>supportconfig</command>。supportconfig 歸檔隨後將複製回本地機器，並在該機器上進行分析。產生的 HTML 報告儲存在預設的 <filename>/var/log</filename> 目錄中。(<replaceable>sles_server.company.com</replaceable> 上只建立 supportconfig 歸檔)。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-c</option>
     </term>
     <listitem>
      <para>
       啟動 <command>scatool</command> 的互動式控制台。按 <keycap function="tab"/> 兩次可查看可用指令。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    關於其他選項和資訊，請執行 <command>sudo scatool -h</command> 或參閱 <command>scatool</command> 的 man 頁面。
   </para>
  </sect2>

  <sect2 xml:id="sec.admsupport.sca.appliance">
   <title>SCA 裝置</title>
   <para>
    如果您決定使用 SCA 裝置來分析 supportconfig 歸檔，則需要設定一台伺服器 (或虛擬機器) 做為專用的 SCA 裝置伺服器。然後，便可以使用 SCA 裝置伺服器，在企業中執行 SUSE Linux Enterprise Server 或 SUSE Linux Enterprise Desktop 的所有機器上分析 supportconfig 歸檔。您只需要將 supportconfig 歸檔上傳到該裝置伺服器，等待它進行分析。此程序無需任何互動。在 MariaDB 資料庫中，SCA 裝置將會追蹤已分析的所有 supportconfig 歸檔。您可以直接從裝置 Web 介面閱讀 SCA 報告。或者，可以讓裝置透過電子郵件將 HTML 報告傳送給任何管理使用者。如需詳細資料，請參閱<xref linkend="sec.admsupport.sca.appliance.config.mail"/>。
   </para>
   <para>
    若要透過指令行快速安裝和設定 SCA 裝置，請依照<xref linkend="sec.admsupport.sca.appliance.installquick"/>中的指示執行操作。該程序面向進階使用者，主要透過單純的安裝與設定指令來完成。如需詳細資訊，請參閱<xref linkend="sec.admsupport.sca.appliance.pre"/>到<xref linkend="sec.admsupport.sca.appliance.install"/>中的詳細描述。
   </para>
   <sect3 xml:id="sec.admsupport.sca.appliance.installquick">
    <title>快速安裝</title>
    <itemizedlist mark="bullet" spacing="normal">
     <title>必要條件</title>
     <listitem>
      <para>
       Web 與 LAMP 模式
      </para>
     </listitem>
     <listitem>
      <para>
       Web 與程序檔模組 (您必須註冊機器才能選取此模組)。
      </para>
     </listitem>
    </itemizedlist>
    <note>
     <title>需要 <systemitem class="username">root</systemitem> 權限</title>
     <para>
      以下程序中的所有指令必須以 <systemitem class="username">root</systemitem> 身分執行。
     </para>
    </note>
    <procedure>
     <title>使用匿名 FTP 進行上傳的安裝</title>
     <para>
      設定並執行裝置後，將不再需要人工互動。因此，在使用 cron 工作建立和上傳 supportconfig 歸檔時，非常適合使用這種方法來設定裝置。
     </para>
     <step>
      <para>
       在要安裝裝置的機器上，登入控制台並執行以下指令：
      </para>
<screen>zypper install sca-appliance-* sca-patterns-* vsftpd
systemctl enable apache2
systemctl start apache2
systemctl enable vsftpd
systemctl start vsftpd
yast ftp-server</screen>
     </step>
     <step>
      <para>
       在 YaST FTP 伺服器中，選取<menuchoice><guimenu>驗證</guimenu> <guimenu>啟用上載</guimenu> <guimenu>匿名使用者可上載</guimenu> <guimenu>完成</guimenu> <guimenu>是</guimenu></menuchoice>，以<guimenu>建立 /srv/ftp/upload</guimenu>。
      </para>
     </step>
     <step>
      <para>
       執行以下指令：
      </para>
<screen>systemctl enable mysql
systemctl start mysql
mysql_secure_installation
setup-sca -f</screen>
      <para>
       mysql_secure_installation 將建立一個 MariaDB <systemitem class="username">root</systemitem> 密碼。
      </para>
     </step>
    </procedure>
    <procedure>
     <title>使用 SCP/tmp 進行上傳的安裝</title>
     <para>
      這種設定裝置的方法需要在輸入 SSH 密碼時進行人工互動。
     </para>
     <step>
      <para>
       在要安裝裝置的機器上，登入控制台。
      </para>
     </step>
     <step>
      <para>
       執行以下指令：
      </para>
<screen>zypper install sca-appliance-* sca-patterns-*
systemctl enable apache2
systemctl start apache2
sudo systemctl enable mysql
systemctl start mysql
mysql_secure_installation
setup-sca</screen>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.pre">
    <title>必要條件</title>
    <para>
     若要執行 SCA 裝置伺服器，需要滿足以下必要條件：
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       安裝所有 <systemitem>sca-appliance-*</systemitem> 套件。
      </para>
     </listitem>
     <listitem>
      <para>
       安裝 <systemitem class="resource">sca-patterns-base</systemitem> 套件。此外，需要為您想要使用裝置分析的 supportconfig 歸檔類型安裝產品特定的 <systemitem class="resource">sca-patterns-*</systemitem>。
      </para>
     </listitem>
     <listitem>
      <para>
       Apache
      </para>
     </listitem>
     <listitem>
      <para>
       PHP
      </para>
     </listitem>
     <listitem>
      <para>
       MariaDB
      </para>
     </listitem>
     <listitem>
      <para>
       匿名 FTP 伺服器 (選擇性)
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.install">
    <title>安裝與基本設定</title>
    <para>
     如<xref linkend="sec.admsupport.sca.appliance.pre"/>中所列，SCA 裝置與其他套件存在若干相依性。因此，在安裝和設定 SCA 裝置伺服器之前，需要做一些準備工作：
    </para>
    <procedure>
     <step>
      <para>
       對於 Apache 和 MariaDB，需安裝 <systemitem>Web</systemitem> 和 <systemitem>LAMP</systemitem> 安裝模式。
      </para>
     </step>
     <step>
      <para>
       設定 Apache 和 MariaDB，並視需要設定一個匿名 FTP 伺服器。<phrase os="sles">如需詳細資訊，請參閱 <xref linkend="cha.apache2"/> 與 <xref linkend="cha.ftp"/>。</phrase>
      </para>
     </step>
     <step>
      <para>
       將 Apache 和 MariaDB 設定為在開機時啟動：
      </para>
<screen>sudo systemctl enable apache2 mysql</screen>
     </step>
     <step>
      <para>
       啟動這兩個服務：
      </para>
<screen>sudo systemctl start apache2 mysql</screen>
     </step>
    </procedure>
    <para>
     現在，您便可以依照<xref linkend="pro.sca.appl.install"/>中所述安裝和設定 SCA 裝置。
    </para>
    <procedure xml:id="pro.sca.appl.install">
     <title>安裝和設定 SCA 裝置</title>
     <para>
      安裝這些套件後，可以使用 <command>setup-sca</command> 程序檔來對 SCA 裝置使用的 MariaDB 管理與報告資料庫進行基本設定。
     </para>
     <para>
      使用該程序檔可以設定以下選項，以便將 supportconfig 歸檔從您的機器上傳到 SCA 裝置：
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <command>scp</command>
       </para>
      </listitem>
      <listitem>
       <para>
        匿名 FTP 伺服器
       </para>
      </listitem>
     </itemizedlist>
     <step>
      <para>
       安裝裝置和 SCA 基本模式程式庫：
      </para>
<screen>sudo zypper install sca-appliance-* sca-patterns-base</screen>
     </step>
     <step>
      <para>
       此外，請為您要分析的 supportconfig 歸檔類型安裝模式套件。例如，如果您的環境中安裝了 SUSE Linux Enterprise Server 11 和 SUSE Linux Enterprise Server 12 伺服器，請安裝 <systemitem>sca-patterns-sle11</systemitem> 和 <systemitem>sca-patterns-sle12</systemitem> 這兩個套件。
      </para>
      <para>
       若要安裝所有可用模式：
      </para>
<screen>zypper install sca-patterns-*</screen>
     </step>
     <step>
      <para>
       若要對 SCA 裝置進行基本設定，請使用 <command>setup-sca</command> 程序檔。呼叫該指令的方式取決於您要以哪種方式將 supportconfig 歸檔上傳到 SCA 裝置伺服器：
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         如果您設定了使用 <filename>/srv/ftp/upload</filename> 目錄的匿名 FTP 伺服器，請結合 <option>-f</option> 選項執行設定程序檔，並依照螢幕上的指示執行操作。
        </para>
<screen>setup-sca -f</screen>
        <note>
         <title>使用其他目錄的 FTP 伺服器</title>
         <para>
          如果 FTP 伺服器使用的目錄不是 <filename>/srv/ftp/upload</filename>，請先調整以下組態檔案，使其指向正確的目錄：<filename>/etc/sca/sdagent.conf</filename> 與 <filename>/etc/sca/sdbroker.conf</filename>。
         </para>
        </note>
       </listitem>
       <listitem>
        <para>
         如果您要透過 <command>scp</command> 將 supportconfig 檔案上傳到 SCA 裝置伺服器的 <filename>/tmp</filename> 目錄，請不要使用任何參數，直接呼叫設定程序檔，然後依照螢幕上的指示執行操作：
        </para>
<screen>setup-sca</screen>
       </listitem>
      </itemizedlist>
      <para>
       該設定程序檔將會根據它的要求執行一些檢查，並設定所需的子元件。它會提示您輸入兩個密碼：您設定之 MariaDB 的 MySQL <systemitem class="username">root</systemitem> 密碼，以及用於登入 SCA 裝置 Web 介面的 Web 使用者密碼。
      </para>
     </step>
     <step>
      <para>
       輸入現有的 MariaDB <systemitem class="username">root</systemitem> 密碼。SCA 裝置將使用該密碼連接到 MariaDB。
      </para>
     </step>
     <step>
      <para>
       定義 Web 使用者的密碼。該密碼將寫入 <filename>/srv/www/htdocs/sca/web-config.php</filename>，並設定為使用者 <systemitem class="username">scdiag</systemitem> 的密碼。以後，您可隨時變更使用者名稱和密碼，請參閱<xref linkend="sec.admsupport.sca.appliance.config.passwd"/>。
      </para>

     </step>
    </procedure>
    <para>
     在成功完成安裝和設定後，便可以開始使用 SCA 裝置，請參閱<xref linkend="sec.admsupport.sca.appliance.use"/>。但是，您可能需要修改某些選項，例如，變更 Web 介面的密碼，變更 SCA 模式更新來源，啟用歸檔模式，或者設定電子郵件通知。如需相關的詳細資訊，請參閱<xref linkend="sec.admsupport.sca.appliance.config"/>。
    </para>
    <warning>
     <title>資料保護</title>
     <para>
      由於 SCA 裝置伺服器上的報告包含已分析其 supportconfig 歸檔之機器的安全相關資訊，因此，請務必保護好 SCA 裝置伺服器上的資料，以防未經授權的人員存取。
     </para>
    </warning>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.use">
    <title>使用 SCA 裝置</title>
    <para>
     您可以將現有的 supportconfig 歸檔手動上傳到 SCA 裝置，也可以一步即完成建立新 supportconfig 歸檔並將其上傳到 SCA 裝置的操作。可以透過 FTP 或 SCP 來上傳。對於這兩種上傳方式，您需要知道可用來存取 SCA 裝置的 URL。要透過 FTP 上傳，需要為 SCA 裝置設定一台 FTP 伺服器，請參閱<xref linkend="pro.sca.appl.install"/>。
    </para>
    <sect4 xml:id="sec.admsupport.sca.appliance.use.upload">
     <title>將 Supportconfig 歸檔上傳到 SCA 裝置</title>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        若要建立 supportconfig 歸檔並透過 (匿名) FTP 上傳：
       </para>
<screen>sudo supportconfig -U “ftp://<replaceable>sca-appliance.company.com</replaceable>/upload”</screen>
      </listitem>
      <listitem>
       <para>
        若要建立 supportconfig 歸檔並透過 SCP 上傳：
       </para>
<screen>sudo supportconfig -U “scp://<replaceable>sca-appliance.company.com</replaceable>/tmp”</screen>
       <para>
        系統將提示您輸入執行 SCA 裝置之伺服器的 <systemitem class="username">root</systemitem> 使用者密碼。
       </para>
      </listitem>
      <listitem>
       <para>
        如果要手動上傳一或多個歸檔，請將現有的歸檔檔案 (通常位於 <filename>/var/log/nts_*.tbz</filename>) 複製到 SCA 裝置中。對於目標，請使用裝置伺服器的 <filename>/tmp</filename> 目錄或 <filename>/srv/ftp/upload</filename> 目錄 (如果為 SCA 裝置伺服器設定了 FTP)。
       </para>
      </listitem>
     </itemizedlist>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.use.view">
     <title>檢視 SCA 報告</title>
     <para>
      可以在裝有瀏覽器並能存取 SCA 裝置之報告索引頁面的任何機器上檢視 SCA 報告。
     </para>
     <procedure>
      <step>
       <para>
        啟動網頁瀏覽器並確定 JavaScript 和 Cookie 已啟用。
       </para>
      </step>
      <step>
       <para>
        輸入 SCA 裝置的報告索引頁面做為 URL。
       </para>
<screen>https://sca-appliance.company.com/sca</screen>
       <para>
        如有疑問，請諮詢您的系統管理員。
       </para>
      </step>
      <step>
       <para>
        系統將提示您輸入用於登入的使用者名稱和密碼。
       </para>
       <figure xml:id="fig.sca.appl.html">
        <title>SCA 裝置產生的 HTML 報告</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </step>
      <step>
       <para>
        登入後，按一下您要閱讀之報告的日期。
       </para>
      </step>
      <step>
       <para>
        首先按一下<guimenu>基本狀態</guimenu>類別將其展開。
       </para>
      </step>
      <step>
       <para>
        在<guimenu>訊息</guimenu>欄中按一下個別項目。SUSE 知識庫中的相應文章即會開啟。閱讀建議的解決方案，並遵循所述的指示操作。
       </para>
      </step>
      <step>
       <para>
        如果 <guimenu>Supportconfig 分析報告</guimenu>的<guimenu>解決方案</guimenu>欄顯示了其他項目，請按一下這些項目。閱讀建議的解決方案，並遵循所述的指示操作。
       </para>
      </step>
      <step>
       <para>
        請查看 SUSE 知識庫 (<link xlink:href="http://www.suse.com/support/kb/"/>)，以瞭解與 SCA 識別之問題直接相關的結果。設法解決這些問題。
       </para>
      </step>
      <step>
       <para>
        檢查有無可前瞻性處理的結果，以免將來發生問題。
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.config">
    <title>自定 SCA 裝置</title>
    <para>
     以下幾節顯示了如何變更 Web 介面的密碼、變更 SCA 模式更新來源、啟用歸檔模式，以及設定電子郵件通知。
    </para>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.passwd">
     <title>Web 介面的密碼</title>
     <para>
      SCA 裝置 Web 介面要求提供使用者名稱和密碼才能登入。預設的使用者名稱為 <literal>scdiag</literal>，預設的密碼為 <literal>linux</literal> (如果未做其他指定，請參閱<xref linkend="pro.sca.appl.install"/>)。請儘早將預設密碼變更為一個較為安全的密碼。您也可以修改使用者名稱。
     </para>
     <procedure xml:id="pro.sca.passwd.change">
      <title>變更 Web 介面的使用者名稱或密碼</title>
      <step>
       <para>
        在 SCA 裝置伺服器的系統控制台上以 <systemitem class="username">root</systemitem> 使用者身分登入。
       </para>
      </step>
      <step>
       <para>
        在編輯器中開啟 <filename>/srv/www/htdocs/sca/web-config.php</filename>。
       </para>
      </step>
      <step>
       <para>
        視需要變更 <literal>$username</literal> 和 <literal>$password</literal> 的值。
       </para>
      </step>
      <step>
       <para>
        儲存檔案並離開。
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.upd">
     <title>SCA 模式的更新</title>
     <para>
      依預設，所有 <systemitem class="resource">sca-patterns-*</systemitem> 套件將由一個 <systemitem class="username">root</systemitem> cron 工作來定期更新，該工作將在夜間執行 <filename>sdagent-patterns</filename> 程序檔，而該程序檔又會執行 <command>zypper update sca-patterns-*</command>。定期的系統更新將會更新所有 SCA 裝置套件和模式套件。若要手動更新 SCA 裝置和模式，請執行：
     </para>
<screen>sudo zypper update sca-*</screen>
     <para>
      系統預設從 SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP1</phrase></phrase> 更新儲存庫安裝更新。如果需要，您可以將更新來源變更為某台 SMT 伺服器。當 <filename>sdagent-patterns</filename> 執行 <command>zypper update sca-patterns-*</command> 時，將從目前設定的更新通道中取得更新。如果該通道在 SMT 伺服器上，將從該伺服器提取套件。
     </para>
     <procedure>
      <title>停用 SCA 模式的自動更新</title>
      <step>
       <para>
        在 SCA 裝置伺服器的系統控制台上以 <systemitem class="username">root</systemitem> 使用者身分登入。
       </para>
      </step>
      <step>
       <para>

        在編輯器中開啟 <filename>/etc/sca/sdagent-patterns.conf</filename>。
       </para>
      </step>
      <step>
       <para>
        將項目
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=1</screen>
       <para>
        變更為
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=0</screen>
      </step>
      <step>
       <para>
        儲存檔案並離開。機器無需重新啟動就能套用變更。
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.archive">
     <title>歸檔模式</title>
     <para>
      系統在分析了 supportconfig 歸檔並將其結果儲存在 MariaDB 資料庫中後，會從 SCA 裝置中刪除所有這些歸檔。但是，若要進行疑難排解，在機器中保留 supportconfig 歸檔的副本可能會有所幫助。依預設，歸檔模式處於停用狀態。
     </para>
     <procedure>
      <title>在 SCA 裝置中啟用歸檔模式</title>
      <step>
       <para>
        在 SCA 裝置伺服器的系統控制台上以 <systemitem class="username">root</systemitem> 使用者身分登入。
       </para>
      </step>
      <step>
       <para>
        在編輯器中開啟 <filename>/etc/sca/sdagent.conf</filename>。
       </para>
      </step>
      <step>
       <para>
        將項目
       </para>
<screen>ARCHIVE_MODE=0</screen>
       <para>
        變更為
       </para>
<screen>ARCHIVE_MODE=1</screen>
      </step>
      <step>
       <para>
        儲存檔案並離開。機器無需重新啟動就能套用變更。
       </para>
      </step>
     </procedure>
     <para>
      啟用歸檔模式後，SCA 裝置會將 supportconfig 檔案儲存至 <filename>/var/log/archives/saved</filename> 目錄，而不會將其刪除。
     </para>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.mail">
     <title>透過電子郵件傳送 SCA 報告</title>
     <para>
      SCA 裝置可透過電子郵件傳送所分析之各 supportconfig 的 HTML 報告檔案。預設此功能是停用的。啟用該功能後，您可以定義要將報告傳送到的電子郵件地址清單，並定義會觸發報告傳送動作的狀態訊息層級 (<literal>STATUS_NOTIFY_LEVEL</literal>)。
     </para>
     <variablelist xml:id="vl.sca.mails.notify.level">
      <title><literal>STATUS_NOTIFY_LEVEL</literal> 的可能值</title>
      <varlistentry>
       <term>$STATUS_OFF</term>
       <listitem>
        <para>
         停用傳送 HTML 報告功能。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_CRITICAL</term>
       <listitem>
        <para>
         僅傳送包含「關鍵」狀態的 SCA 報告。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_WARNING </term>
       <listitem>
        <para>
         僅傳送包含「警告」或「關鍵」狀態的 SCA 報告。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_RECOMMEND</term>
       <listitem>
        <para>
         僅傳送包含「建議」、「警告」或「關鍵」狀態的 SCA 報告。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_SUCCESS</term>
       <listitem>
        <para>
         傳送包含「成功」、「建議」、「警告」或「關鍵」狀態的 SCA 報告。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <procedure>
      <title>為 SCA 報告設定電子郵件通知</title>
      <step>
       <para>
        在 SCA 裝置伺服器的系統控制台上以 <systemitem class="username">root</systemitem> 使用者身分登入。
       </para>
      </step>
      <step>
       <para>
        在編輯器中開啟 <filename>/etc/sca/sdagent.conf</filename>。
       </para>
      </step>
      <step>
       <para>
        搜尋 <systemitem>STATUS_NOTIFY_LEVEL</systemitem> 項目。該項目預設設定為 <literal>$STATUS_OFF</literal> (停用電子郵件通知)。
       </para>
      </step>
      <step>
       <para>
        若要啟用電子郵件通知，請將 <literal>$STATUS_OFF</literal> 變更為要針對其產生電子郵件報告的狀態訊息層級，例如：
       </para>
<screen>STATUS_NOTIFY_LEVEL=$STATUS_SUCCESS</screen>
       <para>
        如需詳細資料，請參閱<xref linkend="vl.sca.mails.notify.level"/>。
       </para>
      </step>
      <step>
       <para>
        若要定義要將報告傳送到的收件人清單：
       </para>
       <substeps performance="required">
        <step>
         <para>
          搜尋 <literal>EMAIL_REPORT='root'</literal> 項目。
         </para>
        </step>
        <step>
         <para>
          請使用您要向其傳送 SCA 報告的電子郵件地址清單取代 <literal>root</literal>。各電子郵件地址必須以空格分隔。例如：
         </para>
<screen>EMAIL_REPORT='tux@my.company.com wilber@your.company.com'</screen>
        </step>
       </substeps>
      </step>
      <step>
       <para>
        儲存檔案並離開。機器無需重新啟動就能套用變更。以後產生的所有 SCA 報告都將透過電子郵件傳送到指定地址。
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.backup">
    <title>備份和還原資料庫</title>
    <para>
     若要備份和還原儲存 SCA 報告的 MariaDB 資料庫，請依照如下所述使用 <command>scadb</command> 指令。
    </para>
    <procedure>
     <title>備份資料庫</title>
     <step>
      <para>
       在執行 SCA 裝置之伺服器的系統控制台上，以 <systemitem class="username">root</systemitem> 使用者身分登入。
      </para>
     </step>
     <step>
      <para>
       執行以下指令以將裝置置於維護模式：
      </para>
<screen>scadb maint</screen>
     </step>
     <step>
      <para>
       使用以下指令啟動備份程序：
      </para>
<screen>scadb backup</screen>
      <para>
       資料將儲存到 TAR 歸檔 <filename>sca-backup-*sql.gz</filename> 中。
      </para>
     </step>
     <step>
      <para>
       如果您正在使用模式建立資料庫開發自己的模式 (參閱<xref linkend="sec.admsupport.sca.patterns"/>)，則還要備份以下資料：
      </para>
<screen>sdpdb backup</screen>
      <para>
       資料將儲存到 TAR 歸檔 <filename>sdp-backup-*sql.gz</filename> 中。
      </para>
     </step>
     <step>
      <para>
       將以下資料複製到另一台機器或外部儲存媒體中：
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         <filename>sca-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>sdp-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>/usr/lib/sca/patterns/local</filename> (僅當您已建立自定模式時才需要複製該資料)
        </para>
       </listitem>
      </itemizedlist>
     </step>
     <step>
      <para>
       使用以下指令重新啟動 SCA 裝置：
      </para>
<screen>scadb reset agents</screen>
     </step>
    </procedure>
    <procedure>
     <title>還原資料庫</title>
     <para>
      若要基於您的備份還原資料庫，請按如下所述執行操作：
     </para>
     <step>
      <para>
       在執行 SCA 裝置之伺服器的系統控制台上，以 <systemitem class="username">root</systemitem> 使用者身分登入。
      </para>
     </step>
     <step>
      <para>
       將最新的 <filename>sca-backup-*sql.gz</filename> 和 <filename>sdp-backup-*sql.gz</filename> TAR 歸檔複製到 SCA 裝置伺服器。
      </para>
     </step>
     <step>
      <para>
       若要解壓縮檔案，請執行：
      </para>
<screen>gzip -d *-backup-*sql.gz</screen>
     </step>
     <step>
      <para>
       若要將資料輸入資料庫，請執行：
      </para>
<screen>scadb import sca-backup-*sql</screen>
     </step>
     <step>
      <para>
       如果您正在使用模式建立資料庫建立自己的模式，則還要透過以下指令輸入以下資料：
      </para>
<screen>sdpdb import sdp-backup-*sql</screen>
     </step>
     <step>
      <para>
       如果您正在使用自定模式，則還要基於備份資料還原 <filename>/usr/lib/sca/patterns/local</filename>。
      </para>
     </step>
     <step>
      <para>
       使用以下指令重新啟動 SCA 裝置：
      </para>
<screen>scadb reset agents</screen>
     </step>
     <step>
      <para>
       使用以下指令更新資料庫中的模式模組：
      </para>
<screen>sdagent-patterns -u</screen>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 xml:id="sec.admsupport.sca.patterns">
   <title>開發自定分析模式</title>
   <para>
    SCA 裝置隨附了一個完整的模式開發環境 (SCA 模式資料庫)，可讓您開發自己的自定模式。模式可用任何程式設計語言編寫。若要使這些模式可用於 supportconfig 分析程序，需要將其儲存到 <filename>/usr/lib/sca/patterns/local</filename> 並使其可執行。然後，SCA 裝置與 SCA 工具將會針對做為分析報告一部分的新 supportconfig 歸檔執行這些自定模式。關於如何建立 (和測試) 自己模式的詳細指示，請參閱<link xlink:href="http://www.suse.com/communities/conversations/sca-pattern-development/"/>。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.admsupport.kernel">
  <title>核心模組支援</title>

  <para>
   對於任何企業作業系統，一個重要的要求就是您獲得的環境方面的支援層級。核心模組是硬體 (<quote>控制器</quote>) 與作業系統之間最為相關的連接器。SUSE Linux Enterprise 中的每個核心模組都有一個 <literal>supported</literal> 旗標，該旗標可使用以下三個值：
  </para>

  <itemizedlist mark="bullet" spacing="normal">

   <listitem>
    <para>
     <quote>是</quote>，相當於 <literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote>外部</quote>，相當於 <literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote/> (空白，未設定)，相當於 <literal>unsupported</literal>
    </para>
   </listitem>
  </itemizedlist>

  <para>
   以下規則適用：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     依預設，自我重新編譯之核心的所有模組會標示為 unsupported。
    </para>
   </listitem>
   <listitem>
    <para>
     SUSE 合作夥伴支援的核心模組以及使用 <literal>SUSE SolidDriver 程式</literal>提供的核心模組會標示為 <quote>external</quote>。
    </para>
   </listitem>
   <listitem>
    <para>
     如果未設定 <literal>supported</literal> 旗標，則載入此模組會污染核心。污染的核心不受支援。不支援的核心模組包含在一個附加的 RPM 套件 (<systemitem>kernel-<replaceable>FLAVOR</replaceable>-extra</systemitem>) 中，該套件只適用於 SUSE Linux Enterprise Desktop 和 SUSE Linux Enterprise 工作站延伸。預設不會載入這些核心 (<replaceable>FLAVOR</replaceable>=<literal>default</literal>|<literal>xen</literal>|...)。此外，安裝程式中將不提供這些不受支援的模組，並且 <systemitem class="resource">kernel-<replaceable>FLAVOR</replaceable>-extra</systemitem> 套件也不會包含在 SUSE Linux Enterprise 媒體中。
    </para>
   </listitem>
   <listitem>
    <para>
     不是依據與 Linux 核心授權相容之授權提供的核心模組也會污染核心。如需詳細資訊，請參閱 <filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename> 及 <filename>/proc/sys/kernel/tainted</filename> 的狀態。
    </para>
   </listitem>
  </itemizedlist>

  <sect2 xml:id="sec.admsupport.kernel.background">
   <title>技術背景</title>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Linux 核心：在 SUSE Linux Enterprise <filename/>12 SP1<literal/> 上，<phrase role="productnumber">/proc/sys/kernel/unsupported<phrase os="sles;sled;slerte"> 的值預設為 </phrase>2</phrase> (<literal>載入不受支援的模組時，syslog 中不會產生警告</literal>)。安裝程式以及已安裝的系統中使用此預設值。如需詳細資訊，請參閱 <filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename>。
     </para>
    </listitem>
    <listitem>
     <para>
      <command>modprobe</command>：用於檢查模組相依性及載入模組的 <command>modprobe</command> 公用程式會相應地檢查 <literal>supported</literal> 旗標的值。如果該值為 <quote>yes</quote> 或 <quote>external</quote>，則會載入該模組，否則不會載入。關於如何覆寫此行為的資訊，請參閱<xref linkend="sec.admsupport.kernel.unsupported"/>。
     </para>
     <note>
      <para>
       SUSE 一般不支援透過 <command>modprobe -r</command> 移除儲存模組。
      </para>
     </note>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec.admsupport.kernel.unsupported">
   <title>使用不受支援的模組</title>
   <para>
    儘管廣泛可支援性非常重要，但有時會發生需要載入不受支援之模組的情況 (例如，要進行測試或除錯，或者硬體供應商提供了 Hotfix)。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      若要覆寫預設行為，請編輯 <filename>/etc/modprobe.d/10-unsupported-modules.conf</filename>，並將變數
      <varname>allow_unsupported_modules</varname> 的值變更為 <literal>1</literal>。如果 initrd 中需要一個不受支援的模組，則請記得執行 <command>dracut </command><option>-f</option> 以更新 initrd。
     </para>
     <para>
      如果只想嘗試載入模組一次，可將 <option>--allow-unsupported-modules</option> 選項與 <command>modprobe</command> 結合使用。如需詳細資訊，請參閱 <command>modprobe</command> 的 man 頁面。
     </para>
    </listitem>
    <listitem>
     <para>
      在安裝期間，可透過驅動程式更新磁碟新增不受支援的模組，這樣便會載入這些模組。若要在開機期間以及開機後強制載入不受支援的模組，請使用核心指令行選項 <option>oem-modules</option>。安裝和啟始化 <systemitem class="resource">suse-module-tools</systemitem> 套件時，系統將評估核心旗標 <literal>TAINT_NO_SUPPORT</literal> (<filename>/proc/sys/kernel/tainted</filename>)。如果核心已污染，將啟用 <literal>allow_unsupported_modules</literal>。這可以防止不受支援的模組在正在安裝的系統中載入失敗。如果安裝期間沒有任何不受支援的模組，並且未使用其他特殊的核心指令行選項 (<option>oem-modules=1</option>)，則預設行為仍是禁止不受支援的模組。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    請記住，載入和執行不受支援的模組會導致 SUSE 不支援該核心和整個系統。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.admsupport.moreinfo">
  <title>更多資訊</title>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <command>man supportconfig</command> — <command>supportconfig</command> 的 man 頁面。
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man supportconfig.conf</command> — supportconfig 組態檔案的 man 頁面。
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scatool</command> — <command>scatool</command> 的 man 頁面。
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scadb</command> — <command>scadb</command> 的 man 頁面。
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man setup-sca</command> — <command>setup-sca</command> 的 man 頁面。
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://mariadb.com/kb/en/"/> — MariaDB 文件。
    </para>
   </listitem>
   <listitem os="sles">
    <para>
     <link xlink:href="http://httpd.apache.org/docs/"/> 和<xref linkend="cha.apache2"/> — 關於 Apache Web 伺服器的文件。
    </para>
   </listitem>
   <listitem os="sles">
    <para>
     <xref linkend="cha.ftp"/> — 關於如何設定 FTP 伺服器的文件。
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/sca-pattern-development/"/> — 關於如何建立 (和測試) 自己的 SCA 模式的指示。
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/basic-server-health-check-supportconfig/"/> — 使用 Supportconfig 進行的基本伺服器狀態檢查。
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://www.novell.com/communities/coolsolutions/cool_tools/create-your-own-supportconfig-plugin/"/> — 建立自己的 Supportconfig 外掛程式。
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/creating-a-central-supportconfig-repository/"/> — 建立中心 Supportconfig 儲存庫。
    </para>
    <para>
     <remark>taroth 2014-04-25: jrecord, should we still refer to the three articles above? </remark>
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
</chapter>
