<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         version="5.0"
         xml:id="cha-security-cryptopolicy">
  <!--taroth 2023-04-28
    Main ToDos (based on https://bugzilla.suse.com/show_bug.cgi?id=1209998#c7)
    * add new chapter to Security Guide, describe also integration
    * explain how we intend customers to use the crypto-policies
    * explain what changed exactly and what impact this has,
    e.g. if someone updates from SP3 (no active crypto-policies)
    to SP4 (active crypto-policies)-->
  <title>Using system-wide crypto policies</title>
  <info>
    <abstract>
      <para>
        bla
      </para>
    </abstract>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker></dm:bugtracker>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>
  <sect1 xml:id="sec-security-cryptopolicy-oview">
    <title>Conceptual overview</title>

    <para>
      The <package>crypto-policies</package> RPM package provides pre-built
      configuration files with cryptographic policies for cryptographic
      back-ends, such as SSL/TLS libraries. This package allows to set the
      cryptographic security level for all applications that use a
      cryptographic back-end supported by the policies.
    </para>

    <para>
      Crypto-policies apply to the configuration of the core cryptographic
      subsystems. They cover the supported secure communications protocols on
      the base operating system, such as TLS, IKE, IPSec, DNSSec and Kerberos
      protocols.
    </para>
  </sect1>
  <sect1>
    <title>Predefined policy levels</title>

    <para>
      The <package>crypto-policies</package> package comes with the following
      predefined policy levels:
    </para>

    <variablelist>
      <varlistentry>
        <term>DEFAULT</term>
        <listitem>
          <para>
            A reasonable default policy for today's standards. It allows the
            TLS 1.2, and TLS 1.3 protocols, as well as IKEv2 and SSH2. The
            Diffie-Hellman parameters are accepted if they are at least 2048
            bits long. The level provides at least 112-bit security with the
            exception of allowing SHA-1 signatures in DNSSec where they are
            still prevalent.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>FIPS</term>
        <listitem>
          <para>
            A level that conforms to the FIPS 140-2 requirements. This policy
            is used internally by the <command>fips-mode-setup</command> tool
            which can switch the system into FIPS 140-2 compliance mode. The
            level provides at least 112-bit security.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>FUTURE</term>
        <listitem>
          <para>
            A conservative security level that is believed to withstand any
            near-term future attacks. This level does not allow the use of
            SHA-1 in signature algorithms. The level also provides some (not
            complete) preparation for post-quantum encryption support in form
            of 256-bit symmetric encryption requirement. The RSA and
            Diffie-Hellman parameters are accepted if larger than 3071 bits.
            The level provides at least 128-bit security.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>LEGACY</term>
        <listitem>
          <para>
            This policy ensures maximum compatibility with legacy systems. It
            is less secure and it includes support for TLS 1.0, TLS 1.1, and
            SSH2 protocols or later. The algorithms DSA, 3DES, and RC4 are
            allowed, while RSA and Diffie-Hellman parameters are accepted if
            larger than 1023 bits. The level provides at least 64-bit security.
          </para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>
      For more details on the individual policies, see the man page of
      <command>crypto-policies</command>. All policies are located in
      <filename>/usr/share/crypto-policies/policies<replaceable>NAME</replaceable>.pol</filename>.
    </para>
  </sect1>
</chapter>
