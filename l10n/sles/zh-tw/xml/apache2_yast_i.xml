<?xml version="1.0" encoding="UTF-8"?>
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apache2_yast_i.xml" version="5.0" xml:id="sec-apache2-configuration-yast">
 <title>使用 YaST 設定 Apache</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  若要使用 YaST 來設定您的 Web 伺服器，請啟動 YaST 並選取<menuchoice> <guimenu>網路服務</guimenu> <guimenu> HTTP 伺服器</guimenu> </menuchoice>。第一次啟動模組時，<guimenu>HTTP 伺服器精靈</guimenu>會啟動，提示您對伺服器管理進行一些基本設定。完成精靈之後，每當您呼叫<guimenu>HTTP 伺服器</guimenu>模組時，<guimenu>HTTP 伺服器組態</guimenu>對話方塊就會啟動。如需詳細資訊，請參閱 <xref linkend="sec-apache2-configuration-yast-server-configuration"/>。
 </para>
 <sect3 xml:id="sec-apache2-configuration-yast-wizard">
  <title>HTTP 伺服器精靈</title>
  <para>
   HTTP 伺服器精靈包含有五個步驟。在最後一個步驟的對話方塊中，您可以進入進階組態模式以執行更具體的設定。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-network-device">
   <title>網路裝置選擇</title>
   <para>
    在此，您可以指定 Apache 用來監聽內送要求的網路介面和連接埠。您可以選取任何現有網路介面及其 IP 位址的組合。若連接埠 (連接埠隸屬以下三種：已知埠、註冊埠和動態或私人埠) 不供其他服務使用，則皆可供您使用。預設設定為在連接埠 <systemitem>80</systemitem> 上監聽所有網路介面 (IP 位址)。
   </para>
   <para>
    核取<guimenu>在防火牆中開啟埠</guimenu>選項，可在防火牆中開啟 Web 伺服器監聽的連接埠。若要使網頁伺服器在網路 (包括 LAN、WAN 或公用網際網路) 上為可用狀態，請核取此選項。只有在測試時，並且此時不須由外部網路存取 Web 伺服器，才可以關閉該連接埠。如果您有多個網路介面，請按一下<guimenu>防火牆細節</guimenu>以指定應在哪些介面上開啟連接埠。
   </para>
   <para>
    按<guimenu>下一步</guimenu>繼續設定組態。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-modules">
   <title>模組</title>
   <para>
    使用<guimenu>模組</guimenu>組態選項，可以啟用或停用 Web 伺服器應支援的程序檔語言。如需有關啟用或停用其他模組的詳細資訊，請參閱<xref linkend="sec-apache2-configuration-yast-server-configuration-modules"/>。按一下<guimenu>下一步</guimenu>，繼續進行下一個對話方塊。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-default-host">
   <title>預設主機</title>
   <para>
    此選項與預設網頁伺服器相關。正如<xref linkend="sec-apache2-configuration-manually-vhost"/>內容所述，Apache 可以在一部實體機器上提供多個虛擬主機。組態檔案中第一個宣告的虛擬主機通常稱為<emphasis>預設主機</emphasis>。每部虛擬主機都會繼承預設主機的組態。
   </para>
   <para>
    若要編輯主機設定 (又稱為<emphasis>指令</emphasis>)，請在表格中選取相應項目，然後按一下<guimenu>編輯</guimenu>。若要新增指示詞，請按一下<guimenu>新增</guimenu>。若要刪除指示詞，請選取該指示詞，然後按一下<guimenu>刪除</guimenu>。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-host">
    <title>HTTP 伺服器精靈：預設主機</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard3.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard3.png"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    這是伺服器預設值的清單：
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>Document Root</systemitem></term>
     <listitem>
      <para>
       目錄路徑，Apache 會從此路徑為此主機提供檔案。<filename>/srv/www/htdocs</filename> 是預設位置。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Alias</systemitem></term>
     <listitem>
      <para>
       使用 <systemitem>Alias</systemitem> 指令可以將 URL 對應到實體檔案系統位置。這表示某個路徑即使不在檔案系統的 <literal>Document Root</literal> 中，仍可藉由該路徑別名的 URL 進行存取。
      </para>
      <para>
       預設的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <systemitem>Alias</systemitem>
       <filename>/icons</filename> 指向 <filename>/usr/share/apache2/icons</filename>，做為目錄索引檢視中顯示的 Apache 圖示。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>ScriptAlias</systemitem></term>
     <listitem>
      <para>
       功能相似於 <systemitem>Alias</systemitem> 指示詞，<systemitem>ScriptAlias</systemitem> 指示詞可以將 URL 映射到檔案系統位置。兩者差別在於 <systemitem>ScriptAlias</systemitem> 可以將目標目錄指定作為 CGI 位置，表示該 CGI 程序檔必須在該位置執行。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Directory</systemitem></term>
     <listitem>
      <para>
       使用 <systemitem>Directory</systemitem> 設定時，您可以指定一組組態選項，只將其中的選項套用到特定目錄。
      </para>
      <para>
       在此可以設定 <filename>/srv/www/htdocs</filename>、<filename>/usr/share/apache2/icons</filename> 和 <filename>/srv/www/cgi-bin</filename> 目錄的存取和顯示選項。其中預設值應該不需要進行改變。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Include</systemitem></term>
     <listitem>
      <para>
       使用 Include 可以指定其他的組態檔案。預先設定的 <systemitem>Include</systemitem> 指示詞有兩個：<filename>/etc/apache2/conf.d/</filename> 為外部模組隨附之組態檔所在的目錄。使用此指示詞時，此目錄中所有以 <filename>.conf</filename> 結尾的檔案都會包含在內。使用第二個指示詞時，<filename>/etc/apache2/conf.d/apache2-manual.conf</filename>，即 <filename>apache2-manual</filename> 組態檔將包含在內。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Server Name</systemitem></term>
     <listitem>
      <para>
       這個項目可以指定用戶端用來聯絡網頁伺服器的預設 URL。請使用完全合格的網域名稱 (FQDN) 來連接 <literal>http://<replaceable>FQDN</replaceable>/</literal> 的網頁伺服器或其 IP 位址。您不能在此選擇任意名稱 -- 該伺服器必須是<quote>已知</quote>採用這個名稱。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Server Administrator E-Mail</systemitem></term>
     <listitem>
      <para>
       伺服器管理員的電子郵件地址。這個地址可顯示在 Apache 建立的錯誤頁面 (舉例說明)。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    完成設定<guimenu>預設主機</guimenu>步驟後，請按一下<guimenu>下一步</guimenu>，繼續下一個組態步驟。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-virtual-hosts">
   <title>虛擬主機</title>
   <para>
    在此步驟中，精靈會顯示已完成設定之虛擬主機的清單 (請參閱<xref linkend="sec-apache2-configuration-manually-vhost"/>)。如果在啟動 YaST HTTP 精靈之前尚未進行手動變更，則不會顯示虛擬主機。
   </para>
   <para>
    若要新增主機，請按一下<guimenu>新增</guimenu>開啟對應的對話方塊，並在其中輸入主機的基本資訊，例如<guimenu>伺服器名稱</guimenu>、<guimenu>伺服器內容根目錄</guimenu>(<systemitem>DocumentRoot</systemitem>) 和<guimenu>管理員電子郵件</guimenu>。<guimenu>伺服器解析</guimenu>可用來決定主機的識別方式 (以名稱為基礎或是以 IP 為基礎)。透過<guimenu>變更虛擬主機 ID</guimenu>指定名稱或 IP 位址
   </para>
   <para>
    按一下<guimenu>下一步</guimenu>，繼續進入虛擬主機組態對話方塊的第二部分。
   </para>
   <para>
    在虛擬主機組態對話方塊的第二部分中，您可以指定是否要啟用 CGI 程序檔、以及這些程序檔要使用哪個目錄。您也可以在此啟用 SSL。如果執行了這個動作，您就必須同時指定證書的路徑。如需有關 SSL 和證書的詳細資訊，請參閱<xref linkend="sec-apache2-ssl-configuration"/>。使用<guimenu>目錄索引</guimenu>選項，可以指定當用戶端要求目錄時要顯示哪個檔案 (預設為 <filename>index.html</filename>)。新增一或多個檔案名稱 (以空格分隔) 可變更此設定。使用<guimenu>啟用公用 HTML</guimenu>，便可在伺服器的 <literal>http://www.example.com/~<replaceable>USER</replaceable></literal> 下存取使用者公用目錄 (<filename>~<replaceable>USER</replaceable>/public_html/</filename>) 的內容。
   </para>
   <important>
    <title>建立虛擬主機</title>
    <para>
     您不能在此隨意新增虛擬主機。如果使用以名稱為基礎的虛擬主機，就必須在網路上解析每部主機名稱。如果是使用以 IP 為基礎的虛擬主機，每個可用 IP 位址就只能指派一部主機。
    </para>
   </important>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-summary">
   <title>摘要</title>
   <para>
    這是精靈的最後一個步驟。您可以在此處決定 Apache 伺服器啟動的方式和時間：開機時啟動或手動啟動。同時可檢視目前已完成之組態的簡短摘要。如果您接受目前設定，請按一下<guimenu>完成</guimenu>以完成組態設定。若要進行變更，請按一下<guimenu>上一步</guimenu>，直至所需的對話方塊顯示。按一下 <guimenu>HTTP 伺服器進階組態</guimenu>便可開啟<xref linkend="sec-apache2-configuration-yast-server-configuration"/> 所介紹的對話方塊。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-summary">
    <title>HTTP 伺服器精靈：摘要</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard5.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard5.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
 </sect3>
 <sect3 xml:id="sec-apache2-configuration-yast-server-configuration">
  <title>HTTP 伺服器組態</title>
  <para>
   <guimenu>HTTP 伺服器組態</guimenu>對話方塊可提供比精靈更多的組態調整 (精靈
只會在第一次設定網頁伺服器時執行)。其中包含下列要介紹的四個索引標籤。在此變更的任何選項都無法立即生效 -- 您必須先按一下<guimenu>完成</guimenu>進行確認之後，它們才會生效。按一下<guimenu>中止</guimenu>，系統將不變更組態模組，並會捨棄您的變更。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-listen">
   <title>傾聽埠和位址</title>
   <para>
    在<guimenu>HTTP 服務</guimenu>中，選取執行 (<guimenu>啟用</guimenu>) 或停止 (<guimenu>停用</guimenu>) Apache。在<guimenu>監聽埠</guimenu>中，<guimenu>新增</guimenu>、<guimenu>編輯</guimenu>或<guimenu>刪除</guimenu>可透過其使用伺服器的位址和連接埠。預設會在連接埠 <literal>80</literal> 上監聽所有介面。任何情況下都必須核取<guimenu>在防火牆中開啟埠</guimenu>，否則將無法從外部連接 Web 伺服器。只有在測試時，並且此時不須由外部網路存取 Web 伺服器，才可以關閉該連接埠。如果您有多個網路介面，請按一下<guimenu>防火牆細節</guimenu>以指定應在哪些介面上開啟連接埠。
   </para>
   <para>
    使用<guimenu>記錄檔案</guimenu>時，可檢視存取記錄檔案或錯誤記錄檔案。測試組態時此選項非常有用。記錄檔案會在另一個視窗中開啟，您也可以在此處重新啟動或重新載入 Web 伺服器。如需詳細資料，請參閱<xref linkend="sec-apache2-start-stop"/>。這些指令會立即生效，其記錄訊息也會即刻顯示。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-listen">
    <title>HTTP 伺服器組態：監聽連接埠和位址</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_listen.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_listen.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-modules">
   <title>伺服器模組</title>
   <para>
    您可以按一下<guimenu>切換狀態</guimenu>，變更 Apache2 模組的狀態 (啟用或停用)。按一下<guimenu>新增模組</guimenu>，可新增已經安裝但是未列出的新模組。若要更進一步認識模組，請參閱<xref linkend="sec-apache2-modules"/>。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-modules">
    <title>HTTP 伺服器組態：伺服器模組</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_modules.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_modules.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-host">
   <title>主要主機</title>
   <para>
    這些對話方塊相同於前面已介紹過的對話方塊。請參閱<xref linkend="sec-apache2-configuration-yast-wizard-default-host"/>和<xref linkend="sec-apache2-configuration-yast-wizard-virtual-hosts"/>。
   </para>
  </sect4>
 </sect3>
</sect2>
