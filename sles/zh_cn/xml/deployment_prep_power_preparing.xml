<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_power_preparing.xml" version="5.0" xml:id="cha.power.prep">
 <title>准备</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  本节介绍在实际安装 SUSE Linux Enterprise Server 之前必须执行的准备步骤。安装过程取决于所使用的系统。支持以下方法：
 </para>

 <itemizedlist>
  <listitem>
   <para>
    <xref linkend="sec.prep.powerlinux.powerkvm.kimchi" xrefstyle="select:title nopage"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.prep.powerlinux.powerkvm.virt-install" xrefstyle="select:title nopage"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.prep.powerlinux.powerkvm.ivm" xrefstyle="select:title nopage"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.prep.powerlinux.powerkvm.bare_metal" xrefstyle="select:title nopage"/>
   </para>
  </listitem>
 </itemizedlist>

 <para>
  如果需要将 SUSE® Linux Enterprise Server 安装在多个系统或分区中，建议您创建网络安装源。同一源也可用于在几个分区或几个系统上的并行安装。在<xref linkend="sec.deployment.instserver.sles9"/>里描述了怎样配置网络安装源。
 </para>

 <sect2 version="5.0" xml:id="sec.prep.powerlinux.powerkvm.kimchi">
  <title>使用 Kimchi 在运行 IBM PowerKVM 的 服务器上进行安装</title>
  <para>
   本节介绍在运行 PowerKVM 的 IBM PowerLinux 系统上安装前的准备步骤。其中介绍了如何使用 Kimchi Web 界面从 ISO 映像进行安装。Kimchi 是用于管理 IBM PowerKVM 的工具。
  </para>
  <para>
   本节假设您的 IBM PowerLinux 服务器上正在运行 PowerKVM。如果未预装 PowerKVM，请参见 <link xlink:href="http://www.ibm.com/support/knowledgecenter/linuxonibm/liabp/liabpkickoff.htm"/> 上的<quote>Configuring IBM PowerKVM on Power Systems</quote>（在 Power Systems 上配置 IBM PowerKVM），了解如何安装及设置 PowerKVM。
  </para>
  <sect3 xml:id="sec.prep.powerlinux.powerkvm.template">
   <title>使用 Kimchi 创建 SUSE Linux Enterprise Server 模板</title>
   <para>
    模板是 PowerKVM guest 的安装源。您可以创建模板、编辑现有模板或克隆模板。要从现有 Guest 克隆模板，该 Guest 必须处于停用状态。
   </para>
   <procedure>
    <title>使用 Kimchi 创建模板</title>
    <step>
     <para>
      在 Web 浏览器中，输入运行 PowerKVM 的 PowerLinux 服务器的 URL，例如 <literal>https://<replaceable>powerlinux IP</replaceable>:8001</literal>（将 <replaceable>powerlinux IP</replaceable> 替换为您系统的 IP 地址）。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>模板</guimenu>选项卡以激活<guimenu>模板</guimenu>页。
     </para>
    </step>
    <step>
     <para>
      单击绿色加号 (<guimenu>+</guimenu>) 创建 SUSE Linux Enterprise Server 模板。
     </para>
    </step>
    <step>
     <para>
      在<guimenu>添加模板</guimenu>对话框中，从以下选项中进行选择：
     </para>
     <variablelist>
      <varlistentry>
       <term><guimenu>本地 ISO 映像</guimenu>
       </term>
       <listitem>
        <para>
         选择此选项可扫描储存池以查看系统上是否有安装 ISO 映像。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>本地映像文件</guimenu>
       </term>
       <listitem>
        <para>
         选择此选项可指定本地映像文件的路径。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>远程 ISO 文件</guimenu>
       </term>
       <listitem>
        <para>
         选择此选项可指定安装 ISO 映像的远程位置。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
    </step>
    <step>
     <para>
      选择要用于创建 Guest 的 ISO 文件，然后单击<guimenu>从选定 ISO 创建模板</guimenu>。
     </para>
    </step>
    <step>
     <para>
      要配置新建的模板，请单击<menuchoice><guimenu>操作</guimenu> <guimenu>编辑</guimenu></menuchoice>，然后根据工作负载的需要更改默认值。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="kimchi_create_template.png" width="50%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="kimchi_create_template.png" width="50%"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
   </procedure>
   <para>
    有关详细信息，请参见 <link xlink:href="http://www.ibm.com/support/knowledgecenter/linuxonibm/liabp/liabpkimchitemplate.htm"/> 上的<quote>Setting up a template using Kimchi</quote>（使用 Kimchi 设置模板）。
   </para>
  </sect3>
  <sect3 xml:id="sec.prep.powerlinux.powerkvm.install">
   <title>使用 Kimchi 安装用作 Guest 的 SUSE Linux Enterprise Server</title>
   <para/>
   <procedure>
    <step>
     <para>
      在 Web 浏览器中，输入运行 PowerKVM 的 PowerLinux 服务器的 URL，例如 <literal>https://<replaceable>powerlinux IP</replaceable>:8001</literal>（将 <replaceable>powerlinux IP</replaceable> 替换为您系统的 IP 地址）。
     </para>
    </step>
    <step>
     <para>
      单击 <guimenu>Guest</guimenu> 选项卡以激活 <guimenu>Guest</guimenu> 页。
     </para>
    </step>
    <step>
     <para>
      单击绿色加号 (<guimenu>+</guimenu>) 创建 SUSE Linux Enterprise Server guest。
     </para>
    </step>
    <step>
     <para>
      输入 SUSE Linux Enterprise Server guest 的<guimenu>虚拟机名称</guimenu>。
     </para>
     <para>
      选择您在<xref linkend="sec.prep.powerlinux.powerkvm.template"/>中创建的 SUSE Linux Enterprise Server 模板，然后单击<guimenu>创建</guimenu>。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="kimchi_create_guest.png" width="70%"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="kimchi_create_guest.png" width="70%"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step>
     <para>
      Guest 创建好后，您便可以启动它了。单击红色电源按钮启动 SUSE Linux Enterprise Server guest。或者，选择<menuchoice><guimenu>操作</guimenu><guimenu>启动</guimenu></menuchoice>。
     </para>
    </step>
    <step>
     <para>
      单击<menuchoice><guimenu>操作</guimenu><guimenu>连接</guimenu></menuchoice>，然后按<xref linkend="sec.deployment.remoteinst.monitor.vnc.connect"/>中所述，将 VNC 查看器连接到安装进程。
     </para>
    </step>
   </procedure>
   <tip>
    <title>创建多个 Guest</title>
    <para>
     要创建多个相似类型的 Guest，请从现有 Guest 的<guimenu>操作</guimenu>菜单中选择<guimenu>克隆</guimenu>。
    </para>
   </tip>
   <para>
    现在，您便可以按<xref linkend="sec.i.yast2.steps"/>中所述通过 VNC 继续执行默认安装。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.powerlinux.powerkvm.virt-install">
  <title>
   使用 <command>virt-install</command> 在运行 IBM PowerKVM 的 服务器上进行安装
  </title>
  <para>
   或者，要利用 Kimchi 进行安装，请使用 <command>virt-install</command> 命令行工具在运行 IBM PowerKVM 的服务器上安装。如果您需要在 IBM PowerLinux 服务器系统上安装多个虚拟机，此项功能尤为有用。<command>virt-install</command> 支持多种安装方案；下面概述了通过 VNC 和 PXE 启动进行的远程安装方案。有关 <command>virt-install</command> 的更多信息，请参见<xref linkend="sec.libvirt.inst.virt-install"/>。
  </para>
  <para>
   根据<xref linkend="sec.deployment.remoteinst.scenario.vncpxe"/>中所述，准备一个包含安装源的储存库，以及已启用 PXE 启动的目标系统。
  </para>
  <para>
   在命令行中，输入类似于下面的命令（根据您的需要和硬件情况调整选项）：
  </para>

<screen>virt-install --name server_sle12 --memory 4096 --vcpus=2 --pxe \
--graphics vnc --os-variant sles11 \
--disk pool=default,size=3000,format=qcow2,allocation=1G,bus=virtio \
-w mac=<replaceable>mac_address</replaceable>,model=spapr-vlan</screen>
  <para>
   这些命令将使用 VNC 图形，并自动启动图形客户端。按<xref linkend="sec.i.yast2.steps"/>中所述完成安装。
  </para>
 </sect2>

 <sect2 xml:id="sec.prep.powerlinux.powerkvm.ivm">
  <title>
   使用 IVM 在分区中安装
  </title>
  <para>
   本指南将帮助您使用集成虚拟化管理器 (IVM) Web 界面在 Power Systems 服务器分区上安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。在开始安装之前，请确保满足以下要求：
  </para>
  <itemizedlist>
   <listitem>
    <para>
     已启动 Linux on Power 系统
    </para>
   </listitem>
   <listitem>
    <para>
     已安装 Virtual I/O 服务器
    </para>
   </listitem>
   <listitem>
    <para>
     IVM 已经过初始配置
    </para>
   </listitem>
  </itemizedlist>
  <procedure>
   <title>登录到 IVM Web 界面</title>
   <step>
    <para>
     打开 Web 浏览器窗口，使用 HTTP 或 HTTPS 协议连接到安装过程中指派给 IVM 的 IP 地址（例如 https://<replaceable>IP 地址</replaceable>）。“欢迎”窗口即会显示。
    </para>
   </step>
   <step>
    <para>
     以 <systemitem class="username">padmin</systemitem> 用户身份使用在安装过程中定义的口令登录。IVM 界面即会显示。
    </para>
   </step>
   <step>
    <para>
     选择<guimenu>查看/修改虚拟以太网</guimenu>。
    </para>
   </step>
   <step>
    <para>
     单击<guimenu>初始化虚拟以太网</guimenu>以在各分区之间提供以太网连接性。
    </para>
   </step>
   <step>
    <para>
     虚拟以太网初始化后，单击“应用”。
    </para>
   </step>
   <step>
    <para>
     如果安装需要外部网络，请创建虚拟以太网网桥
    </para>
    <substeps>
     <step>
      <para>
       选择<guimenu>虚拟以太网网桥</guimenu>选项卡。
      </para>
     </step>
     <step>
      <para>
       选择网桥的物理适配器，然后单击<guimenu>应用</guimenu>继续。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>
  <para>接着，执行以下步骤创建分区：</para>
  <procedure>
   <title>创建分区</title>
   <step>
    <para>
     在 IVM Web 界面中，单击<menuchoice><guimenu>查看/修改分区</guimenu><guimenu>创建分区</guimenu></menuchoice>。
    </para>
   </step>
   <step>
    <para>
     输入分区的名称。要进入下一步，请对此步骤及后续步骤单击<guimenu>下一步</guimenu>。
    </para>
   </step>
   <step>
    <para>
     指定分区的内存。如果您已创建共享内存池，则分区可以共享内存。否则，请选择<guimenu>专用</guimenu>。
    </para>
   </step>
   <step>
    <para>
     指定处理器数量和分区的处理模式。
    </para>
   </step>
   <step>
    <para>
     指定分区的虚拟以太网。如果不想配置适配器，请针对虚拟以太网选择<guimenu>无</guimenu>。
    </para>
   </step>
   <step>
    <para>
     创建新的虚拟磁盘，或指派当前未指派给分区的现有虚拟磁盘和物理卷。
    </para>
   </step>
   <step>
    <para>
     校验磁盘的<guimenu>虚拟磁盘名称</guimenu>和<guimenu>储存池名称</guimenu>，然后指定<guimenu>虚拟磁盘大小</guimenu>。
    </para>
   </step>
   <step>
    <para>
     配置分区的光驱设备，方法是扩展<guimenu>物理光驱设备</guimenu>和<guimenu>虚拟光驱设备</guimenu>，然后选择要指派给分区的设备。
    </para>
   </step>
   <step>
    <para>
     校验您的分区配置设置，然后单击<guimenu>完成</guimenu>。分区即创建完成并显示在<guimenu>查看/修改分区</guimenu>列表中。
    </para>
   </step>
  </procedure>
  <para>现在激活您已创建的分区：</para>
  <procedure>
   <title>激活分区</title>
   <step>
    <para>
     在 IVM Web 界面中，单击<guimenu>查看/修改分区</guimenu>，然后选择要激活的分区旁的对话框。
    </para>
   </step>
   <step>
    <para>
     选择<guimenu>更多任务</guimenu>。
    </para>
   </step>
   <step>
    <para>
     选择<guimenu>打开终端窗口</guimenu>。
    </para>
   </step>
   <step>
    <para>
     单击分区旁边的<guimenu>激活</guimenu>。
    </para>
   </step>
   <step>
    <para>
     在终端窗口中，输入 <keycap>1</keycap> 启动系统管理服务 (SMS)。
    </para>
   </step>
  </procedure>
  <para>
   计算机现已设置完毕，您可以引导至安装的系统：
  </para>
  <procedure>
   <title>引导安装的 Linux</title>
   <step>
    <para>
     在<guimenu>引导选择</guimenu>窗口中，输入 <keycap>1</keycap> 选择 <guimenu>SMS 菜单</guimenu>。在固件引导屏幕在显示器上完全显示之前输入 <keycap>1</keycap>，因为该屏幕在完全显示后即会消失。如果错过该屏幕，请重引导系统。
    </para>
   </step>
   <step>
    <para>
     此时，您可以将 Virtual I/O Server (VIOS) 媒体磁盘插入磁盘驱动器。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>语言选择</guimenu>菜单中按 <keycap>2</keycap> 进入输入口令屏幕。输入管理员 ID 的口令。
    </para>
   </step>
   <step>
    <para>
     在主 SMS 菜单中输入 <keycap>5</keycap> 选择<guimenu>选择引导选项</guimenu>。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>1</keycap> 选择<guimenu>安装/引导设备</guimenu>。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>7</keycap> 查看所有可用的引导设备。
    </para>
   </step>
   <step>
    <para>
     输入要使用的设备对应的数字。如果您的设备未列出，请输入 <keycap>N</keycap> 显示更多。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>2</keycap> 执行<guimenu>常规模式引导</guimenu>。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>1</keycap> 离开 SMS 菜单并启动引导进程。
    </para>
   </step>
   <step>
    <para>
     在安装程序的引导提示符处键入
    </para>
    <screen>install vnc=1
vncpassword=<replaceable>VNC_PASSWORD</replaceable></screen>
    <para>
     将 <replaceable>VNC_PASSWORD</replaceable> 替换为您所选的口令（最小长度为八个字符），然后按 <keycap function="enter"/> 开始安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。内核将开始装载。
    </para>
   </step>
  </procedure>
  <para>
   内核开始装载后，安装程序需要来自系统的一些信息，以便设置 VNC 会话。您必须拥有一个有效的 TCP/IP 堆栈才能使用 VNC。使用 DHCP，或者使用安装程序提供的说明手动定义网络信息。
  </para>
  <procedure>
   <title>启动 VNC 会话</title>
   <step>
    <para>
     在<guimenu>网络设备</guimenu>窗口中，选择 <guimenu>eth0</guimenu> 作为您的网络设备。选择<guimenu>确定</guimenu>，然后按 <keycap function="enter"/>.
    </para>
   </step>
   <step>
    <para>
     测试安装媒体。或者，选择<guimenu>跳过</guimenu>继续而不进行测试。
    </para>
   </step>
   <step>
    <para>
     系统启动 VNC 服务器后，您将看到一条要求您连接 VNC 客户端的讯息，后跟一个 IP 地址。请记下此 IP 地址。
    </para>
   </step>
   <step>
    <para>
     在便携式计算机或 PC 上启动 VNC 客户端。输入上一步中的 IP 地址，后跟 <literal>:1</literal>，例如 192.168.2.103:1。
    </para>
   </step>
   <step>
    <para>
     按<xref linkend="sec.i.yast2.steps"/>中所述完成安装。
    </para>
   </step>
  </procedure>
 </sect2>
 <sect2 xml:id="sec.prep.powerlinux.powerkvm.bare_metal">
  <title>
   在无 Open Power Abstraction Layer 的服务器上安装
  </title>
  <para>
   遵照下面的信息可使用串行控制台或显示器和鼠标在 Power Systems 服务器上安装 Linux。此安装假设不受管理（独立）系统已就绪，可以引导。
  </para>
  <procedure>
   <step>
    <para>
     从<guimenu>启动/关闭系统</guimenu>菜单中选择<guimenu>启动</guimenu>来启动系统。当系统询问您是否要继续使用控制台时，输入 <keycap>0</keycap> 继续使用。
    </para>
   </step>
   <step>
    <para>
     将 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装媒体插入磁盘驱动器。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>选择语言</guimenu>窗口中，输入 <keycap>2</keycap> 继续引导过程。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>1</keycap> 接受许可协议。
    </para>
   </step>   <step>
    <para>
     在<guimenu>引导选择</guimenu>窗口中，输入 <keycap>1</keycap> 选择 <guimenu>SMS 菜单</guimenu>。在固件引导屏幕在显示器上完全显示之前输入 <keycap>1</keycap>，因为该屏幕在完全显示后即会消失。如果错过该屏幕，请重引导系统。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>语言选择</guimenu>菜单中按 <keycap>2</keycap> 进入输入口令屏幕。输入管理员 ID 的口令。
    </para>
   </step>
   <step>
    <para>
     在主 SMS 菜单中输入 <keycap>5</keycap> 选择<guimenu>选择引导选项</guimenu>。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>7</keycap> 查看所有可用的引导设备。
    </para>
   </step>
   <step>
    <para>
     输入要使用的设备对应的数字。如果您的设备未列出，请输入 <keycap>N</keycap> 显示更多。
    </para>
   </step>
   <step>
    <para>
     输入 <keycap>2</keycap> 执行<guimenu>常规模式引导</guimenu>。
    </para>
   </step>   <step>
    <para>
     输入 <keycap>1</keycap> 离开 SMS 菜单并启动引导进程。
    </para>
   </step>
   <step>
    <para>
     在安装程序的引导提示符处键入
    </para>
    <screen>install vnc=1
vncpassword=<replaceable>VNC_PASSWORD</replaceable></screen>
    <para>
     将 <replaceable>VNC_PASSWORD</replaceable> 替换为您所选的口令（最小长度为八个字符），然后按 <keycap function="enter"/> 开始安装 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。内核将开始装载。
    </para>
   </step>
  </procedure>

  <para>
   内核开始装载后，安装程序需要来自系统的一些信息，以便设置 VNC 会话。您必须拥有一个有效的 TCP/IP 堆栈才能使用 VNC。使用 DHCP，或者使用安装程序提供的说明手动定义网络信息。
  </para>
  <procedure>
   <title>启动 VNC 会话</title>
   <step>
    <para>
     在<guimenu>网络设备</guimenu>窗口中，选择 <guimenu>eth0</guimenu> 作为您的网络设备。选择<guimenu>确定</guimenu>，然后按 <keycap function="enter"/>.
    </para>
   </step>
   <step>
    <para>
     测试安装媒体。或者，选择<guimenu>跳过</guimenu>继续而不进行测试。
    </para>
   </step>
   <step>
    <para>
     系统启动 VNC 服务器后，您将看到一条要求您连接 VNC 客户端的讯息，后跟一个 IP 地址。请记下此 IP 地址。
    </para>
   </step>
   <step>
    <para>
     在便携式计算机或 PC 上启动 VNC 客户端。输入上一步中的 IP 地址，后跟 <literal>:1</literal>，例如 192.168.2.103:1。
    </para>
   </step>
   <step>
    <para>
     按<xref linkend="sec.i.yast2.steps"/>中所述完成安装。
    </para>
   </step>
  </procedure>
 </sect2>

</sect1>
