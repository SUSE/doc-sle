<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="virt_support.xml" version="5.0" xml:id="cha-virt-support">
  <title>虚拟化限制和支持</title>
  <info>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker/>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>
  <important>
    <para>
      仅支持在 KVM 和 Xen 超级管理程序中进行 QEMU 模拟。
    </para>
  </important>
  <sect1 xml:id="sec-architecture-support">
    <title>体系结构支持</title>

    <sect2 xml:id="sec-kvm-requires-hardware">
      <title>KVM 硬件要求</title>
      <para>
        SUSE 支持在 AMD64/Intel 64、Arm AArch64、IBM Z 和 IBM LinuxONE 主机上实施 KVM 全虚拟化。
      </para>
      <itemizedlist>
        <listitem>
          <para>
            在 AMD64/Intel 64 体系结构上，KVM 是围绕 AMD* (AMD-V) 和 Intel* (VT-x) CPU 中包含的硬件虚拟化功能设计的。它支持芯片组和 PCI 设备的虚拟化功能，例如 I/O 内存映射单元 (<xref linkend="gloss-vt-acronym-iommu"/>) 和单根 I/O 虚拟化 (<xref linkend="vt-io-sriov"/>)。您可以使用以下命令测试您的 CPU 是否支持硬件虚拟化：
          </para>
<screen><prompt>&gt; </prompt>egrep '(vmx|svm)' /proc/cpuinfo</screen>
          <para>
            如果此命令未返回任何输出，则表示您的处理器不支持硬件虚拟化，或者已在 BIOS 或固件中禁用此功能。
          </para>
          <para>
            以下网站指出了支持硬件虚拟化的 AMD64/Intel 64 处理器：<link xlink:href="http://ark.intel.com/Products/VirtualizationTechnology"/>（针对 Intel CPU），以及 <link xlink:href="http://products.amd.com/"/>（针对 AMD CPU）。
          </para>
        </listitem>
        <listitem>
          <para>
            在 Arm 体系结构上，Armv8-A 处理器支持虚拟化。
          </para>
        </listitem>
        <listitem>
          <para>
            在 Arm 体系结构上，仅支持通过 CPU 型号 <literal>host</literal>（在虚拟机管理器或 <systemitem class="library">libvirt</systemitem> 中名为 <literal>host-passthrough</literal>）运行 QEMU/KVM。
          </para>
        </listitem>
      </itemizedlist>
      <note>
        <title>不装载 KVM 内核模块</title>
        <para>
          仅当 CPU 硬件虚拟化功能可用时，才会装载 KVM 内核模块。
        </para>
      </note>
      <para>
        <phrase os="sles">VM 主机服务器的一般性最低硬件要求与<xref linkend="sec-x86-requirements"/>中概述的相同。</phrase>不过，对于每个虚拟化的 Guest 都需要提供额外的 RAM。此额外 RAM 量应至少与物理安装所需的 RAM 量相同。另外，强烈建议为每个运行中的 Guest 至少配备一个处理器核心或超线程。
      </para>
      <note os="sles">
        <title>Arm AArch64</title>
        <para>
          Arm AArch64 是个持续发展的平台。它不遵循传统的标准与合规性认证计划来实现与操作系统和超级管理程序的互操作性。请让您的供应商提供针对 SUSE Linux Enterprise Server 的支持声明。
        </para>
      </note>
      <note os="sles">
        <title>POWER</title>
        <para>
          不支持在 POWER 平台上运行 KVM 或 Xen 超级管理程序。
        </para>
      </note>
    </sect2>

    <sect2 xml:id="sec-xen-requires-hardware">
      <title>Xen 硬件要求</title>
      <para>
        SUSE 支持 AMD64/Intel 64 上的 Xen。
      </para>
    </sect2>
  </sect1>
  <sect1 xml:id="virt-hypervisors-limits">
    <title>超级管理程序限制</title>

    <para os="sles;sled">
      每个服务包 (SP) 的<link xlink:href="https://www.suse.com/releasenotes/">Release
      Notes</link>中都概述了 Xen 和 KVM 的新功能和虚拟化限制。
    </para>

    <para>
      仅支持 SUSE Linux Enterprise Server 官方软件源中包含的软件包。相反，<link xlink:href="https://packagehub.suse.com/">packagehub</link> 中提供的所有可选子软件包和插件（对于 QEMU 为 <systemitem class="library">libvirt</systemitem>）均不受支持。
    </para>

    <para>
      有关每个主机的最大虚拟 CPU 总数，请参见<link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/article-virtualization-best-practices.html#sec-vt-best-perf-cpu-assign">recommendations
      in the Virtualization Best Practices Guide regarding over-commitment of
      physical CPUs</link>。虚拟 CPU 总数应与可用物理 CPU 数成正比。
    </para>

    <note>
      <title>32 位超级管理程序</title>
      <para>
        我们已从 32 位版本的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 11 SP2 中去除虚拟化主机设施。32 位 Guest 不受影响，可以使用提供的 64 位超级管理程序为其提供全面支持。
      </para>
    </note>

    <sect2 xml:id="virt-kvm-limits">
      <title>KVM 限制</title>
      <para>
        在 AMD64/Intel 64 上运行 Linux Guest 的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>
        <phrase role="productnumber"><phrase os="sles;sled">15 SP5</phrase></phrase> 主机所支持（已经过测试）虚拟化的限制。对于其他操作系统，请咨询具体的供应商。
      </para>
      <table>
        <title>KVM VM 限制</title>
        <tgroup cols="2">
          <colspec colnum="1" colname="1"/>
          <colspec colnum="2" colname="2"/>
          <tbody>
            <row>
              <entry>
                <para>
                  每个 VM 的最大虚拟 CPU 数
                </para>
              </entry>
              <entry>
                <para>
                  1024
                </para>
              </entry>
            </row>
            <row>
              <entry>
                <para>
                  每个 VM 的最大内存
                </para>
              </entry>
              <entry>
                <para>
                  6 TiB
                </para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <note>
        <para>
          KVM 主机限制与 SUSE Linux Enterprise Server 相同（请参见发行说明的相应章节），但以下限制除外：
        </para>
        <itemizedlist>
          <listitem>
            <para>
              <emphasis>每个 VM 的最大虚拟 CPU 数</emphasis>：请参见 <link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/article-virtualization-best-practices.html#sec-vt-best-perf-cpu-assign"/> 上的《<citetitle>Virtualization Best Practices
              Guide</citetitle>》中有关过量分配物理 CPU 的建议。虚拟 CPU 总数应与可用物理 CPU 数成正比。
            </para>
          </listitem>
        </itemizedlist>
      </note>
    </sect2>

    <sect2 xml:id="virt-xen-limits">
      <title>Xen 限制</title>
      <table>
        <title>Xen VM 限制</title>
        <tgroup cols="2">
          <colspec colnum="1" colname="1"/>
          <colspec colnum="2" colname="2"/>
          <tbody>
            <row>
              <entry>
                <para>
                  每个 VM 的最大虚拟 CPU 数
                </para>
              </entry>
              <entry>
                <para>
                  32（一般的 HVM 建议）、64 (HVM Windows Guest)、128（可信 HVM）或 512 (PV)
                </para>
              </entry>
            </row>
            <row>
              <entry>
                <para>
                  每个 VM 的最大内存
                </para>
              </entry>
              <entry>
                <para>
                  2 TiB（64 位 Guest）、16 GiB（具有 PAE 的 32 位 Guest）
                </para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <table>
        <title>Xen 主机限制</title>
        <tgroup cols="2">
          <colspec colnum="1" colname="1"/>
          <colspec colnum="2" colname="2"/>
          <tbody>
            <row>
              <entry>
                <para>
                  最大物理 CPU 总数
                </para>
              </entry>
              <entry>
                <para>
                  1024
                </para>
              </entry>
            </row>
            <row>
              <entry>
                <para>
                  每个主机的最大虚拟 CPU 总数
                </para>
              </entry>
              <entry>
                <para>
                  请参见 <link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/article-virtualization-best-practices.html#sec-vt-best-perf-cpu-assign"/> 上的《虚拟化最佳实践指南》中有关过量分配物理 CPU 的建议。虚拟 CPU 总数应与可用物理 CPU 数成正比
                </para>
              </entry>
            </row>
            <row>
              <entry>
                <para>
                  最大物理内存
                </para>
              </entry>
              <entry>
                <para>
                  建议保持在 16 TiB 地址边界以下。
                </para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </sect2>
  </sect1>
  <sect1 xml:id="virt-support-hosts">
    <title>支持的主机环境（超级管理程序）</title>

    <para>
      本节介绍在各种虚拟化主机（超级管理程序）上作为 Guest 操作系统运行的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>
      <phrase role="productnumber"><phrase os="sles;sled">15 SP5</phrase></phrase> 的支持状态。
    </para>

    <table>
      <title>支持以下 SUSE 主机环境</title>
      <tgroup cols="2">
        <colspec colnum="1" colname="1"/>
        <colspec colnum="2" colname="2"/>
        <thead>
          <row>
            <entry>
              <para>
                SUSE Linux Enterprise Server
              </para>
            </entry>
            <entry>
              <para>
                超级管理程序
              </para>
            </entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>
              <para>
                SUSE Linux Enterprise Server 11SP4
              </para>
            </entry>
            <entry>
              <para>
                Xen 和 KVM
              </para>
            </entry>
          </row>
          <row>
            <entry>
              <para>
                SUSE Linux Enterprise Server 12 SP1 到 SP5
              </para>
            </entry>
            <entry>
              <para>
                Xen 和 KVM
              </para>
            </entry>
          </row>
          <row>
            <entry>
              <para>
                SUSE Linux Enterprise Server 15 GA 到 SP4
              </para>
            </entry>
            <entry>
              <para>
                Xen 和 KVM
              </para>
            </entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <itemizedlist>
      <title>支持以下第三方主机环境</title>
      
      <listitem>
        <para>
          <link xlink:href="https://www.citrix.com/products/citrix-hypervisor/">Citrix XenServer</link>
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/supported-suse-virtual-machines-on-hyper-v">Hyper-V</link>
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://www.nutanix.com/products/acropolis">Nutanix
          Acropolis Hypervisor with AOS</link>
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://www.oracle.com/fr/virtualization/virtualbox/">Oracle
          VM Server 3.4</link>
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://www.oracle.com/linux/">Oracle Linux KVM 7,
          8</link>
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://www.vmware.com/products/esxi-and-esx.html">VMware
          ESXi 6.5, 6.7, 7.0</link>
        </para>
      </listitem>
      <listitem>
        <para>
          Windows Server 2022
        </para>
      </listitem>
    </itemizedlist>

    <para>
      您也可以在 <link xlink:href="https://www.suse.com/yessearch/Search.jsp">SUSE YES
      certification database</link>中进行搜索
    </para>

    <itemizedlist>
      <title>支持级别如下</title>
      <listitem>
        <para>
          根据相应的<link xlink:href="https://www.suse.com/lifecycle/">product life
          cycle</link>，对 SUSE 主机操作系统的支持级别为全面 L3（适用于 Guest 和主机）。
        </para>
      </listitem>
      <listitem>
        <para>
          SUSE 为第三方主机环境中的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> Guest 提供全面 L3 支持。
        </para>
      </listitem>
      <listitem>
        <para>
          对主机的支持以及与 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> Guest 相关的合作必须由主机系统供应商提供。
        </para>
      </listitem>
    </itemizedlist>
  </sect1>
  <sect1 xml:id="virt-support-guests">
    <title>支持的 Guest 操作系统</title>

    <para>
      本节列出了在 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP5</phrase></phrase> 上虚拟化且适用于 KVM 和 Xen 超级管理程序的 Guest 操作系统的支持状态。
    </para>

    <important>
      <para>
        仅当 Guest 中安装了半虚拟化驱动程序时，才能通过 <systemitem class="library">libvirt</systemitem>/<command>virsh</command> 重引导 Microsoft Windows Guest。有关下载和安装 PV 驱动程序的更多细节，请参见 <link xlink:href="https://www.suse.com/products/vmdriverpack/"/>。
      </para>
    </important>

    <itemizedlist>
      <title>以下 Guest 操作系统受到全面支持 (L3)：</title>
      <listitem>
        <para>
          SUSE Linux Enterprise Server 11SP4
        </para>
      </listitem>
      <listitem>
        <para>
          SUSE Linux Enterprise Server 12 SP3、12 SP4、12 SP5
        </para>
      </listitem>
      <listitem>
        <para>
          SUSE Linux Enterprise Server 15 GA、15 SP1、15 SP2、15 SP3、15 SP4
        </para>
      </listitem>
      <listitem>
        <para>
          Windows Server 2008 SP2+、2008 R2 SP1+、2012+、2012 R2+、2016、2019、2022
        </para>
      </listitem>
      <listitem>
        <para>
          <link xlink:href="https://www.windowsservercatalog.com/results.aspx?text=suse&amp;bCatID=1282&amp;avc=10&amp;ava=0&amp;OR=5">Microsoft
          Windows Server Catalog</link>
        </para>
      </listitem>
      <listitem>
        <para>
          Oracle Linux 6、7、8（仅适用于 KVM 超级管理程序）
        </para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>以技术预览（L2，在合理的情况下提供修复）的形式支持以下 Guest 操作系统：</title>
      <listitem>
        <para>
          SLED 15 SP3
        </para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>如果客户购买了 SUSE Liberty Linux，SUSE 将为 Red Hat 和 CentOS Guest 操作系统提供全面支持 (L3)。</title>
      <listitem>
        <para>
          有关可用组合和受支持版本的列表，请参见 <link xlink:href="https://documentation.suse.com/liberty"/> 上的 SUSE Liberty Linux 文档。对于其他情况，将为这些操作系统提供有限的支持（L2，在合理的情况下提供修复）。
        </para>
      </listitem>
    </itemizedlist>

    <note>
      <title>RHEL PV 驱动程序</title>
      <para>
        从 RHEL 7.2 开始，Red Hat 去除了 Xen PV 驱动程序。
      </para>
    </note>

    <itemizedlist>
      <title>按照尽力而为的原则为以下 Guest 操作系统提供支持（L2，在合理的情况下提供修复）：</title>
      <listitem>
        <para>
          Windows 8+、8.1+、10+
        </para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>所有其他 Guest 操作系统</title>
      <listitem>
        <para>
          在其他组合中提供 L2 支持，但只在可行的情况下才提供修复。SUSE 会对主机操作系统（超级管理程序）提供全面支持。Guest 操作系统问题需要在相应操作系统供应商的支持下予以解决。如果修复某个问题同时涉及到主机环境和 Guest 环境，则客户需要联系 SUSE 和 Guest VM 操作系统供应商。
        </para>
      </listitem>
      <listitem>
        <para>
          所有 Guest 操作系统既支持全虚拟化，也支持半虚拟化。只有以下操作系统例外：Windows 系统，它们只支持全虚拟化（但可以使用 PV 驱动程序：<link xlink:href="https://www.suse.com/products/vmdriverpack/"/>）；OES 操作系统，它们只支持半虚拟化。
        </para>
      </listitem>
      <listitem>
        <para>
          除非另有说明，否则所有 Guest 操作系统在 32 位和 64 位环境中均受支持。
        </para>
      </listitem>
    </itemizedlist>

    <sect2 xml:id="sec-kvm-requires-guests-virt-drivers">
      <title>半虚拟化驱动程序的提供</title>
      <para>
        为了提升 Guest 操作系统的性能，我们将会提供半虚拟化驱动程序（如果有）。尽管这些驱动程序不是必需的，但我们强烈建议使用。
      </para>
      <para>
        从 SUSE Linux Enterprise Server 12 SP2 开始，我们已改用 PVops 内核。我们不再使用专用的 <package>kernel-xen</package> 软件包：
      </para>
      <itemizedlist>
        <listitem>
          <para>
            dom0 上的 <package>kernel-default+kernel-xen</package> 已由 <package>kernel-default</package> 软件包取代。
          </para>
        </listitem>
        <listitem>
          <para>
            PV domU 上的 <package>kernel-xen</package> 软件包已由 <package>kernel-default</package> 软件包取代。
          </para>
        </listitem>
        <listitem>
          <para>
            HVM domU 上的 <package>kernel-default+xen-kmp</package> 已由 <package>kernel-default</package> 取代。
          </para>
        </listitem>
      </itemizedlist>
      <para>
        对于 SUSE Linux Enterprise Server 12 SP1 和更低版本（低至 10 SP4），半虚拟化驱动程序包含在专用 <package>kernel-xen</package> 软件包中。
      </para>
      <para>
        半虚拟化驱动程序的提供方式如下：
      </para>
      <variablelist>
        
        <varlistentry>
          <term>SUSE Linux Enterprise Server 12/12 SP1/12 SP2</term>
          <listitem>
            <para>
              包含在内核中
            </para>
          </listitem>
        </varlistentry>
        <varlistentry os="sles;sled">
          <term>SUSE Linux Enterprise Server 11/11 SP1/11 SP2/11 SP3/11 SP4</term>
          <listitem>
            <para>
              包含在内核中
            </para>
          </listitem>
        </varlistentry>
        <varlistentry os="sles;sled">
          <term>SUSE Linux Enterprise Server 10SP4</term>
          <listitem>
            <para>
              包含在内核中
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Red Hat</term>
          <listitem>
            <para>
              从 Red Hat Enterprise Linux 5.4 开始提供。从 Red Hat Enterprise Linux 7.2 开始，Red Hat 已去除了 PV 驱动程序。
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Windows</term>
          <listitem>
            <para>
              SUSE 开发了适用于 Windows 的基于 virtio 的驱动程序，这些驱动程序包含在虚拟机驱动程序包 (VMDP) 中。有关详细信息，请参见 <link xlink:href="https://www.suse.com/products/vmdriverpack/"/>。
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </sect2>
  </sect1>
  <sect1 xml:id="virt-migration-support">
    <title>支持的 VM 迁移场景</title>

    <para>
      <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 支持将虚拟机从一台物理主机迁移到另一台物理主机。
    </para>

    <sect2 xml:id="virt-migration-offline">
      <title>脱机迁移场景</title>
      <para>
        SUSE 支持脱机迁移：关闭 Guest VM，然后将其迁移到运行不同 SLE 产品（从 SLE 12 到 SLE 15 SP<replaceable>X</replaceable>）的主机。对于以下主机操作系统组合，全面支持 (L3) 从一台主机的 Guest 迁移到另一台主机的 Guest：
      </para>
      <table>
        <title>支持的 Guest 脱机迁移方案</title>
        <tgroup cols="9">
          <colspec colname="c1" align="center" colwidth="3*"/>
          <colspec colname="c2" align="center"/>
          <colspec colname="c3" align="center"/>
          <colspec colname="c4" align="center"/>
          <colspec colname="c5" align="center"/>
          <colspec colname="c6" align="center"/>
          <colspec colname="c7" align="center"/>
          <colspec colname="c8" align="center"/>
          <colspec colname="c9" align="center"/>
          <thead>
            <row valign="middle">
              <entry align="right">
         目标 SLES 主机
       </entry>
              <entry morerows="1">
         12 SP3
       </entry>
              <entry morerows="1">
         12 SP4
       </entry>
              <entry morerows="1">
          12 SP5
       </entry>
              <entry morerows="1">
          15 GA
       </entry>
              <entry morerows="1">
          15 SP1
       </entry>
              <entry morerows="1">
          15 SP2
       </entry>
              <entry morerows="1">
          15 SP3
       </entry>
              <entry morerows="1">
          15 SP4
       </entry>
            </row>
            <row>
              <entry align="left">
        源 SLES 主机
       </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry><emphasis role="bold">12 SP3</emphasis>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">12 SP4</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry>(<phrase role="color:suse-jungle-green">✓</phrase>)</entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">12 SP5</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 GA</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP1</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP2</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP3</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <informaltable frame="none" rowsep="0" colsep="0">
        <tgroup cols="2" align="left">
          <colspec colwidth=".5in"/>
          <colspec colwidth="100%"/>
          <tbody>
            <row>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry>
                <para>
                  完全兼容且完全受支持
                </para>
              </entry>
            </row>
            <row>
              <entry>(<phrase role="color:suse-jungle-green">✓</phrase>)</entry>
              <entry>
                <para>
                  仅支持在 KVM 超级管理程序中迁移。
                </para>
              </entry>
            </row>
            <row>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry>
                <para>
                  不支持
                </para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect2>

    <sect2 xml:id="virt-migration-live">
      <title>实时迁移场景</title>
      <para>
        本节列出了在 SLES 上运行虚拟化时实时迁移方案的支持状态。另请参见受支持方案所要满足的<link xlink:href="https://documentation.suse.com/sles-15/html/SLES-all/cha-libvirt-managing.html#libvirt-admin-live-migration-requirements">live
        migration requirements</link>。全面支持以下主机操作系统组合（根据相应的<link xlink:href="https://www.suse.com/lifecycle">product life
        cycle</link>，支持级别为 L3）。
      </para>
      <note>
        <title>实时迁移</title>
        <itemizedlist>
          <listitem>
            <para>
              SUSE 始终支持在运行 SLES 的主机之间实时迁移虚拟机，但这两个 SLES 版本的服务包编号必须是连续的。例如，从 SLES 15 SP2 迁移到 SLES 15 SP3。
            </para>
          </listitem>
          <listitem>
            <para>
              SUSE 致力于为以下实时迁移提供支持：在 SUSE Linux Enterprise Server 的同一主要版本中，将虚拟机从运行 LTSS 所涵盖的服务包的主机迁移到运行更新服务包的主机。例如，将虚拟机从 SLES 12 SP2 主机迁移到 SLES 12 SP5 主机。对于从 LTSS 迁移到更新的服务包的场景，SUSE 只会执行极简单的测试，建议在尝试迁移关键的虚拟机之前执行全面的现场测试。
            </para>
          </listitem>
        </itemizedlist>
      </note>
      <important>
        <title>Xen 实时迁移</title>
        <para>
          由于工具栈不同，不支持在 SLE 11 与 SLE 12 之间实时迁移，有关更多细节，请参见<link xlink:href="https://www.suse.com/releasenotes/x86_64/SUSE-SLES/12/#fate-317306">
          Release notes</link>。
        </para>
      </important>
      <table>
        <title>支持的 Guest 实时迁移方案</title>
        <tgroup cols="8">
          <colspec colname="c1" align="center" colwidth="3*"/>
          <colspec colname="c2" align="center"/>
          <colspec colname="c3" align="center"/>
          <colspec colname="c4" align="center"/>
          <colspec colname="c5" align="center"/>
          <colspec colname="c6" align="center"/>
          <colspec colname="c7" align="center"/>
          <colspec colname="c8" align="center"/>
          <thead>
            <row valign="middle">
              <entry align="right">
         目标 SLES 主机
       </entry>
              <entry morerows="1">
         12 SP4
       </entry>
              <entry morerows="1">
          12 SP5
       </entry>
              <entry morerows="1">
          15 GA
       </entry>
              <entry morerows="1">
          15 SP1
       </entry>
              <entry morerows="1">
          15 SP2
       </entry>
              <entry morerows="1">
          15 SP3
       </entry>
              <entry morerows="1">
          15 SP4
       </entry>
            </row>
            <row>
              <entry align="left">
        源 SLES 主机
       </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry><emphasis role="bold">12 SP3</emphasis>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">12 SP4</emphasis>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry>(<phrase role="color:suse-jungle-green">✓</phrase>)</entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">12 SP5</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 GA</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP1</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP2</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry><emphasis role="bold">15 SP3</emphasis>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <informaltable frame="none" rowsep="0" colsep="0">
        <tgroup cols="2" align="left">
          <colspec colwidth=".5in"/>
          <colspec colwidth="100%"/>
          <tbody>
            <row>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry>
                <para>
                  完全兼容且完全受支持
                </para>
              </entry>
            </row>
            <row>
              <entry>(<phrase role="color:suse-jungle-green">✓</phrase>)</entry>
              <entry>
                <para>
                  仅支持在 KVM 超级管理程序中迁移。
                </para>
              </entry>
            </row>
            <row>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry>
                <para>
                  不支持
                </para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect2>
  </sect1>
  <sect1 xml:id="virt-support-feature-support">
    <title>功能支持</title>

    <para/>

    <sect2 xml:id="virt-support-feature-support-host">
      <title>Xen 主机 (Dom0)</title>
      <table>
        <title>功能支持 — 主机 (<literal>Dom0</literal>)</title>
        <tgroup cols="2">
          <colspec colnum="1" colname="c1" colwidth="7*"/>
          <colspec colnum="2" colname="c2" align="center"/>
          <thead>
            <row>
              <entry>
         功能
       </entry>
              <entry>
         Xen
       </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>
         网络和块设备热插拔
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         物理 <xref linkend="gloss-vt-cpu-hotplug"/>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry>
         虚拟 <xref linkend="gloss-vt-cpu-hotplug"/>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         虚拟 <xref linkend="gloss-vt-cpu-pinning"/>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         虚拟 <xref linkend="gloss-vt-cpu-capping"/>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         Intel* VT-x2：FlexPriority、FlexMigrate（迁移限制适用于不同的 CPU 体系结构）
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         Intel* VT-d2（具有中断过滤和排队失效的 DMA 重新映射）
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         AMD* IOMMU（具有 Guest 到主机物理地址转换的 I/O 页表）
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <note>
        <title>不支持在运行时添加或去除物理 CPU</title>
        <para>
          不支持在运行时添加或去除物理 CPU，但可以脱机添加或去除每个 VM Guest 的虚拟 CPU。
        </para>
      </note>
    </sect2>

    <sect2 xml:id="virt-support-feature-support-fv">
      <title>Guest 功能支持</title>
      <note>
        <title>Xen PV Guest 实时迁移</title>
        <para>
          对于实时迁移，源体系结构和目标体系结构均需要匹配；即处理器（AMD* 或 Intel*）必须相同。除非使用了 CPU ID 掩码（例如，使用 Intel FlexMigration），否则目标的处理器修订版应该与源相同或者比源更新。如果在不同系统之间移动 VM，那么这些规则适用于每一次移动。为了避免优化的代码在运行时或应用程序启动期间失败，源 CPU 和目标 CPU 需要公开相同的处理器扩展。Xen 透明地向 VM 公开物理 CPU 扩展。总而言之，Guest 可以是 32 位或 64 位，但 <xref linkend="gloss-vt-vhs"/> 必须相同。
        </para>
      </note>
      <note>
        <title>Windows Guest</title>
        <para>
          仅当使用的是 PV 驱动程序 (<link xlink:href="https://www.suse.com/products/vmdriverpack/">VMDP</link>) 时，才支持在 Xen 和 KVM 中热插拔虚拟网络和虚拟块设备，以及收缩、恢复动态虚拟内存及调整其大小。
        </para>
      </note>
      <note>
        <title>Intel flexMigration</title>
        <para>
          对于支持 Intel FlexMigration 的计算机，CPU-ID 掩码和错误引发可以提高跨 CPU 迁移的灵活性。
        </para>
      </note>
      <tip>
        <para>
          对于 KVM，有关支持的限制、功能、建议的设置和方案的详细说明以及其他有用信息均在 <filename>kvm-supported.txt</filename> 中提供。此文件是 KVM 软件包的一部分，可在 <filename>/usr/share/doc/packages/qemu-kvm</filename> 中找到。
        </para>
      </tip>
      <table>
        <title>Xen 和 KVM 的 Guest 功能支持</title>
        <tgroup cols="4">
          <colspec colnum="1" colname="c1" colwidth="2*"/>
          <colspec colnum="2" colname="c2" align="center"/>
          <colspec colnum="3" colname="c3" align="center"/>
          <colspec colnum="4" colname="c4" align="center"/>
          <thead>
            <row>
              <entry>
         功能
       </entry>
              <entry>
         Xen PV Guest (DomU)
       </entry>
              <entry>
         Xen FV Guest
       </entry>
              <entry>
         KVM FV Guest
       </entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>
         虚拟网络和虚拟块设备热插拔
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         虚拟 <xref linkend="gloss-vt-cpu-hotplug"/>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry>
         虚拟 <xref linkend="gloss-vt-cpu-overcommit"/>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         动态虚拟内存大小调整
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         VM 保存和恢复
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         VM 实时迁移
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase> [1]
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase> [1]
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         VM 快照
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         使用 GDBC 进行高级调试
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         对 VM 可见的 Dom0 度量
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         内存气球
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
            </row>
            <row>
              <entry>
         PCI 直通
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase> [2]
       </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
            </row>
            <row>
              <entry>
         AMD SEV
       </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry><phrase role="color:suse-jungle-green">✓</phrase> [3]
       </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <informaltable frame="none" rowsep="0" colsep="0">
        <tgroup cols="2" align="left">
          <colspec colname="c1" colwidth=".5in"/>
          <colspec colname="c2" colwidth="100%"/>
          <tbody>
            <row>
              <entry><phrase role="color:suse-jungle-green">✓</phrase>
              </entry>
              <entry>
                <para>
                  完全兼容且完全受支持
                </para>
              </entry>
            </row>
            <row>
              <entry><phrase role="color:red">❌</phrase>
              </entry>
              <entry>
                <para>
                  不支持
                </para>
              </entry>
            </row>
            <row>
              <entry>
        [1]
       </entry>
              <entry>
         请参见 <xref linkend="libvirt-admin-live-migration-requirements"/>。
       </entry>
            </row>
            <row>
              <entry>
        [2]
       </entry>
              <entry>
         不包括 NetWare Guest。
       </entry>
            </row>
            <row>
              <entry>
        [3]
       </entry>
              <entry>
        请参见<link xlink:href="https://documentation.suse.com/sles/15-SP3/html/SLES-amd-sev/article-amd-sev.html"/>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect2>
  </sect1>
  <sect1 xml:id="vt-support-nested">
    <title>嵌套虚拟化</title>

    <para>
      使用嵌套虚拟化可在一个 VM 的内部运行另一个虚拟机，同时仍可利用主机的硬件加速功能。嵌套虚拟化的性能较差，并且在调试时会提高复杂性。嵌套虚拟化通常用于测试目的。在 SUSE Linux Enterprise Server 中，嵌套虚拟化是作为技术预览提供的。此版本仅用于测试目的，我们不提供相关支持。用户可以报告 bug，但这些 bug 的处理优先级较低。此外我们明确指出，在使用嵌套虚拟化的情况下，不支持实时迁移或者保存或恢复 VM。
    </para>
  </sect1>
  
</chapter>
