<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="grub2.xml" version="5.0" xml:id="cha.grub2">
 <title>O carregador de boot GRUB 2</title>
 <info>
  <abstract>
   <para>
    Este capítulo descreve como configurar o GRUB 2, o carregador de boot usado no <phrase role="productname"><phrase os="sled">SUSE® Linux Enterprise Desktop</phrase></phrase>. Ele é o sucessor do carregador de boot GRUB tradicional, agora chamado de <quote>GRUB Legacy</quote>. <phrase os="sled;sles">O GRUB 2 tornou-se o carregador de boot padrão do <phrase role="productname"><phrase os="sled">SUSE® Linux Enterprise Desktop</phrase></phrase> desde a versão 12.</phrase> Um módulo do YaST está disponível para definir as configurações mais importantes. O procedimento de boot como um todo é detalhado no <xref linkend="cha.boot"/>. Para obter detalhes sobre o suporte a Boot Seguro para máquinas UEFI, consulte o <xref linkend="cha.uefi"/>.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes (sim)</dm:translation>
  </dm:docmanager>
 </info><indexterm> <primary>inicializando</primary> <secondary>GRUB 2</secondary></indexterm><indexterm> <primary>GRUB 2</primary></indexterm>
 <sect1 xml:id="sec.grub2.new.features">
  <title>Principais diferenças entre o GRUB Legacy e o GRUB 2</title>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     A configuração é armazenada em arquivos diferentes.
    </para>
   </listitem>
   <listitem>
    <para>
     Mais sistemas de arquivos são suportados (por exemplo, Btrfs).
    </para>
   </listitem>
   <listitem>
    <para>
     Pode ler arquivos armazenados em dispositivos LVM ou RAID diretamente.
    </para>
   </listitem>
   <listitem>
    <para>
     A interface do usuário pode ser traduzida e alterada com temas.
    </para>
   </listitem>
   <listitem>
    <para>
     Inclui um mecanismo para carregar módulos que suportam recursos adicionais, como sistemas de arquivos, etc.
    </para>
   </listitem>
   <listitem>
    <para>
     Pesquisa e gera automaticamente entradas de boot para outros kernels e sistemas operacionais, como o Windows.
    </para>
   </listitem>
   <listitem>
    <para>
     Inclui um console mínimo do tipo Bash.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sec.grub2.file_structure">
  <title>Estrutura do arquivo de configuração</title>

  <para>
   A configuração do GRUB 2 baseia-se nos seguintes arquivos:
  </para>

  <variablelist>
   <varlistentry>
    <term><filename>/boot/grub2/grub.cfg</filename>
    </term>
    <listitem><indexterm> <primary>GRUB 2</primary> <secondary>grub.cfg</secondary></indexterm>
     <para>
      Este arquivo inclui a configuração dos itens de menu do GRUB 2. Ele substitui o <filename>menu.lst</filename> usado no GRUB Legacy. O <filename>grub.cfg</filename> é automaticamente gerado pelo comando <xref linkend="vle.grub2.mkconfig"/> e não deve ser editado.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/boot/grub2/custom.cfg</filename>
    </term>
    <listitem><indexterm> <primary>GRUB 2</primary> <secondary>custom.cfg</secondary></indexterm>
     <para>
      Este arquivo opcional é diretamente originado pelo <filename>grub.cfg</filename> no momento da inicialização e pode ser usado para adicionar itens personalizados ao menu de boot. A partir do <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>, essas entradas também serão analisadas ao usar o <command>grub-once</command>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/default/grub</filename>
    </term>
    <listitem><indexterm> <primary>GRUB 2</primary> <secondary>/etc/default/grub</secondary></indexterm>
     <para>
      Este arquivo controla as configurações do usuário do GRUB 2 e, normalmente, inclui outras configurações de ambiente, como fundos e temas.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Scripts em <filename>/etc/grub.d/</filename>
    </term>
    <listitem><indexterm> <primary>GRUB 2</primary> <secondary>/etc/grub.d/</secondary></indexterm>
     <para>
      Os scripts neste diretório são lidos durante a execução do comando <xref linkend="vle.grub2.mkconfig"/>. Suas instruções estão integradas ao arquivo de configuração principal <filename>/boot/grub/grub.cfg</filename>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="vle.grub2.sysconfig">
    <term><filename>/etc/sysconfig/bootloader</filename>
    </term>
    <listitem><indexterm> <primary>GRUB 2</primary> <secondary>sysconfig/bootloader</secondary></indexterm>
     <para>
      Este arquivo de configuração é usado ao configurar o carregador de boot com o YaST e sempre que um novo kernel é instalado. Ele é avaliado pelo perl-bootloader, que modifica o arquivo de configuração do carregador de boot apropriadamente (por exemplo, <filename>/boot/grub2/grub.cfg</filename> para GRUB 2). O <filename>/etc/sysconfig/bootloader</filename> não é um arquivo de configuração específico do GRUB 2, os valores são aplicados a qualquer carregador de boot instalado no <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename arch="x86_64">/boot/grub2/x86_64-efi</filename>, <filename arch="power">/boot/grub2/power-ieee1275</filename>, <filename arch="zseries">/boot/grub2/s390x</filename>
    </term>
    <listitem>
     <para>
      Estes arquivos de configuração incluem opções específicas da arquitetura.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   O GRUB 2 pode ser controlado de várias maneiras. As entradas de boot de uma configuração existente podem ser selecionadas no menu gráfico (splash screen). A configuração é carregada do arquivo <filename>/boot/grub2/grub.cfg</filename>, que é compilado de outros arquivos de configuração (veja abaixo). Todos os arquivos de configuração do GRUB 2 são considerados arquivos do sistema, e você precisa de privilégios de <systemitem class="username">root</systemitem> para editá-los.
  </para>

  <note>
   <title>Ativando mudanças de configuração</title>
   <para>
    Depois de editar manualmente os arquivos de configuração do GRUB 2, será necessário executar <xref linkend="vle.grub2.mkconfig"/> para ativar as mudanças. Porém, isso não é necessário ao mudar a configuração com o YaST, já que ele executa <xref linkend="vle.grub2.mkconfig"/> automaticamente.
   </para>
  </note>

  <sect2 xml:id="sec.grub2.cfg">
   <title>O arquivo <filename>/boot/grub2/grub.cfg</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>grub.cfg</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>menu de boot</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>grub.cfg</secondary></indexterm>
   <para>
    A splash screen gráfica com o menu de boot baseia-se no arquivo de configuração do GRUB 2 <filename>/boot/grub2/grub.cfg</filename>, que contém as informações sobre todas as partições ou sistemas operacionais que podem ser inicializados pelo menu.
   </para>
   <para>
    Todas as vezes que o sistema é inicializado, o GRUB 2 carrega o arquivo de menu diretamente do sistema de arquivos. Por essa razão, o GRUB 2 não precisa ser reinstalado após as modificações no arquivo de configuração. O <filename>grub.cfg</filename> é recriado automaticamente com as instalações ou remoções do kernel.
   </para>
   <para>
    O <filename>grub.cfg</filename> é compilado pelo <xref linkend="vle.grub2.mkconfig"/> do arquivo <filename>/etc/default/grub</filename> e dos scripts que estão no diretório <filename>/etc/grub.d/</filename>. Portanto, você nunca deve editar o arquivo manualmente. Em vez disso, edite os arquivos de origem relacionados ou use o módulo <guimenu>Carregador de Boot</guimenu> do YaST para modificar a configuração, conforme descrito na <xref linkend="sec.grub2.yast2.config"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec.grub2.etc_default_grub">
   <title>O arquivo <filename>/etc/default/grub</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>/etc/default/grub</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>/etc/default/grub</secondary></indexterm>
   <para>
    Há mais opções gerais do GRUB 2 nesse local, como o horário em que o menu é exibido ou o OS padrão para inicializar. Para listar todas as opções disponíveis, consulte a saída do seguinte comando:
   </para>
<screen>grep "export GRUB_DEFAULT" -A50 /usr/sbin/grub2-mkconfig | grep GRUB_</screen>
   <para>
    Além das variáveis já definidas, o usuário pode incluir suas próprias variáveis e usá-las posteriormente nos scripts que estão no diretório <filename>/etc/grub.d</filename>.
   </para>
   <para>
    Após editar o <filename>/etc/default/grub</filename>, execute <xref linkend="vle.grub2.mkconfig"/> para atualizar o arquivo de configuração principal.
   </para>
   <note>
    <title>Escopo</title>
    <para>
     Todas as opções definidas neste arquivo são opções gerais que afetam todas as entradas de boot. É possível definir opções específicas para os Kernels ou o hipervisor do Xen usando as opções de configuração GRUB_*_XEN_*. Veja os detalhes a seguir.
    </para>
   </note>
   <variablelist>
    <varlistentry>
     <term><literal>GRUB_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       Define a entrada do menu de boot que será inicializada por padrão. Seu valor pode ser numérico, o nome completo de uma entrada do menu ou <quote>saved</quote> (gravado).
      </para>
      <para>
       <literal>GRUB_DEFAULT=2</literal> inicializa a terceira entrada (contada a partir de zero) do menu de boot.
      </para>
      <para>
       <literal>GRUB_DEFAULT="2&gt;0"</literal> inicializa a primeira entrada do submenu da terceira entrada do menu de nível superior.
      </para>
      <para>
       <literal>GRUB_DEFAULT="Exemplo de entrada do menu de boot"</literal> inicializa a entrada do menu com o título <quote>Exemplo de entrada do menu de boot</quote>.
      </para>
      <para>
       <literal>GRUB_DEFAULT=saved</literal> inicializa a entrada especificada pelos comandos <command>grub2-reboot </command> ou <command>grub2-set-default </command>. Enquanto <command>grub2-reboot</command> define a entrada de boot padrão apenas para a próxima reinicialização, o <command>grub2-set-default</command> define a entrada de boot padrão até ser modificada.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_HIDDEN_TIMEOUT</literal>
     </term>
     <listitem>
      <para>
       Aguarda o usuário pressionar uma tecla durante o número especificado de segundos. Durante o período, nenhum menu é exibido, exceto se o usuário pressionar uma tecla. Se nenhuma tecla for pressionada durante o período especificado, o controle será passado para <literal>GRUB_TIMEOUT</literal>. <literal>GRUB_HIDDEN_TIMEOUT=0</literal> verifica primeiro se a tecla <keycap function="shift"/> foi pressionada e mostra o menu de boot em caso afirmativo, do contrário, inicializa a entrada do menu padrão imediatamente. Esse é o procedimento padrão quando apenas um OS inicializável é identificado pelo GRUB 2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_HIDDEN_TIMEOUT_QUIET</literal>
     </term>
     <listitem>
      <para>
       Se <literal>false</literal> (falso) for especificado, um temporizador de contagem regressiva será exibido em uma tela em branco quando o recurso <literal>GRUB_HIDDEN_TIMEOUT</literal> estiver ativo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_TIMEOUT</literal>
     </term>
     <listitem>
      <para>
       O período em segundos durante o qual o menu de boot é exibido antes de inicializar a entrada de boot padrão automaticamente. Se você pressionar uma tecla, o tempo de espera será cancelado, e o GRUB 2 aguardará você fazer uma seleção manualmente. <literal>GRUB_TIMEOUT=-1</literal> exibe o menu até você selecionar a entrada de boot manualmente.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX</literal>
     </term>
     <listitem>
      <para>
       As entradas nesta linha são adicionadas ao fim das entradas de boot para o modo normal e de recuperação. Use-a para adicionar parâmetros do kernel à entrada de boot.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       Igual a <literal>GRUB_CMDLINE_LINUX</literal>, mas as entradas são anexadas apenas no modo normal.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_RECOVERY</literal>
     </term>
     <listitem>
      <para>
       Igual a <literal>GRUB_CMDLINE_LINUX</literal>, mas as entradas são anexadas apenas no modo de recuperação.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_XEN_REPLACE</literal>
     </term>
     <listitem>
      <para>
       Esta entrada substitui completamente os parâmetros de <literal>GRUB_CMDLINE_LINUX</literal> por todas as entradas de boot do Xen.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_XEN_REPLACE_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       Igual a <literal>GRUB_CMDLINE_LINUX_XEN_REPLACE</literal>, mas substitui apenas os parâmetros de <literal>GRUB_CMDLINE_LINUX_DEFAULT</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_XEN</literal>
     </term>
     <listitem>
      <para>
       Esta entrada especifica os parâmetros de kernel apenas para o kernel convidado do Xen. O princípio da operação é o mesmo de <literal>GRUB_CMDLINE_LINUX</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_XEN_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       Igual a <literal>GRUB_CMDLINE_XEN</literal>. O princípio da operação é o mesmo de <literal>GRUB_CMDLINE_LINUX_DEFAULT</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_TERMINAL</literal>
     </term>
     <listitem>
      <para>
       Habilita e especifica um dispositivo de terminal de entrada/saída. Pode ser <literal>console</literal> (consoles BIOS e EFI do PC), <literal>serial</literal> (terminal serial), <literal>ofconsole</literal> (console do Open Firmware) ou o <literal>gfxterm</literal> padrão (saída do modo gráfico). É possível também habilitar mais de um dispositivo colocando as opções necessárias entre aspas, por exemplo, <literal>GRUB_TERMINAL="console serial"</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_GFXMODE</literal>
     </term>
     <listitem>
      <para>
       A resolução usada para o terminal gráfico <literal>gfxterm</literal> . Observe que você só pode usar os modos suportados por sua placa gráfica (VBE). O padrão é ''auto'', que tenta selecionar uma resolução preferencial. É possível exibir as resoluções de tela disponíveis para o GRUB 2 digitando <command>vbeinfo</command> na linha de comando do GRUB 2. Para acessar a linha de comando, digite <keycap>C</keycap> quando aparecer a tela do menu de boot do GRUB 2.
      </para>
      <para>
       É possível também especificar a profundidade de cores anexando-a à configuração da resolução, por exemplo, <literal>GRUB_GFXMODE=1280x1024x24</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_BACKGROUND</literal>
     </term>
     <listitem>
      <para>
       Defina uma imagem de fundo para o terminal gráfico <literal>gfxterm</literal>. A imagem deve ser um arquivo legível pelo GRUB 2 no momento da inicialização, que deve terminar com o sufixo <literal>.png</literal>, <literal>.tga</literal>, <literal>.jpg</literal> ou <literal>.jpeg</literal>. Se necessário, a imagem será dimensionada para caber na tela.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_DISABLE_OS_PROBER</literal>
     </term>
     <listitem>
      <para>
       Se esta opção for definida como <literal>true</literal> (verdadeiro), a pesquisa automática de outros sistemas operacionais será desabilitada. Apenas as imagens do kernel em <filename>/boot/</filename> e as opções de seus próprios scripts em <filename>/etc/grub.d/</filename> serão detectadas.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>SUSE_BTRFS_SNAPSHOT_BOOTING</literal>
     </term>
     <listitem>
      <para>
       Se essa opção for definida como <literal>true</literal> (verdadeiro), o GRUB 2 poderá ser inicializado diretamente nos instantâneos do Snapper. Para obter mais informações, consulte o <xref linkend="sec.snapper.snapshot-boot"/>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <title>Gerenciamento de parâmetros</title>
    <para>
     Todos os parâmetros <literal>*_DEFAULT</literal> podem ser configurados manualmente ou pelo YaST.
    </para>
   </note>
   <para>
    Para ver a lista completa de opções, consulte o <link xlink:href="http://www.gnu.org/software/grub/manual/grub.html#Simple-configuration"> manual do GNU GRUB</link>. Para ver a lista completa de parâmetros possíveis, visite <link xlink:href="http://en.opensuse.org/Linuxrc"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec.grub2.etc_grub_d">
   <title>Scripts em <filename>/etc/grub.d</filename></title>
   <para>
    Os scripts neste diretório são lidos durante a execução do comando <xref linkend="vle.grub2.mkconfig"/>, e suas instruções estão incorporadas ao <filename>/boot/grub2/grub.cfg</filename>. A ordem dos itens de menu no <filename>grub.cfg</filename> é determinada pela ordem em que os arquivos são executados nesse diretório. Os arquivos com um número à esquerda são executados primeiro, começando pelo número mais baixo. <filename>00_header</filename> é executado antes de <filename>10_linux</filename>, que é executado antes de <filename>40_custom</filename>. Se houver arquivos com nomes alfabéticos, eles serão executados depois dos arquivos com números nos nomes. Apenas os arquivos executáveis geram uma saída para <filename>grub.cfg</filename> durante a execução de <command>grub2-mkconfig</command>. Por padrão, todos os arquivos no diretório <filename>/etc/grub.d</filename> são executáveis. Os scripts mais importantes são:
   </para>
   <variablelist>
    <varlistentry>
     <term><filename>00_header</filename>
     </term>
     <listitem>
      <para>
       Define variáveis de sistema, como locais de arquivos do sistema, configurações de tela, temas e entradas que já foram gravadas. Ele também importa as preferências armazenadas no <filename>/etc/default/grub</filename>. Normalmente, não é necessário modificar este arquivo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>10_linux</filename>
     </term>
     <listitem>
      <para>
       Identifica os kernels do Linux no dispositivo raiz e cria entradas de menu relevantes. Inclui a opção de modo de recuperação associada, se habilitada. Somente o kernel mais recente é exibido na página de menu principal, com kernels adicionais incluídos em um submenu.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>30_os-prober</filename>
     </term>
     <listitem>
      <para>
       Este script usa o <command>OS-prober</command> para procurar o Linux e outros sistemas operacionais e apresenta os resultados no menu do GRUB 2. Há seções para identificar outros sistemas operacionais específicos, como Windows ou macOS.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>40_custom</filename>
     </term>
     <listitem>
      <para>
       Este arquivo oferece uma forma simples de incluir entradas de boot personalizadas no <filename>grub.cfg</filename>. Não mude a parte <literal>exec tail -n +3 $0</literal> que fica no começo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>90_persistent</filename>
     </term>
     <listitem>
      <para>
       Este é um script especial que copia uma parte correspondente do arquivo <filename>grub.cfg</filename> e retorna sua saída inalterada. Desta forma, é possível modificar essa parte do <filename>grub.cfg</filename> diretamente, e a mudança se mantém após a execução de <xref linkend="vle.grub2.mkconfig"/>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    A sequência de processamento é definida pelos números precedentes, sendo o menor número executado primeiro. Se os scripts forem precedidos pelo mesmo número, a ordem alfabética do nome completo determinará a disposição.
   </para>
  </sect2>

  <sect2 xml:id="sec.grub2.map">
   <title>Mapeamento entre unidades BIOS e dispositivos Linux</title><indexterm> <primary>GRUB 2</primary> <secondary>device.map</secondary></indexterm>
   <para>
    No GRUB Legacy, o arquivo de configuração <filename>device.map</filename> era usado para derivar nomes de dispositivos Linux dos números das unidades BIOS. O mapeamento entre as unidades BIOS e os dispositivos Linux nem sempre pode ser previsto corretamente. Por exemplo, o GRUB Legacy obterá a ordem incorreta se a sequência de boot das unidades IDE e SCSI for trocada na configuração do BIOS.
   </para>
   <para>
    O GRUB 2 evita este problema usando strings de ID de dispositivo (UUIDs) ou rótulos de sistema de arquivos ao gerar o <filename>grub.cfg</filename>. Os utilitários do GRUB 2 criam um mapa de dispositivos temporário simultaneamente, que, na maioria das vezes, é suficiente, sobretudo em caso de sistemas de disco único.
   </para>
   <para>
    Porém, se você tiver que anular o mecanismo de mapeamento de dispositivos automático do GRUB 2, crie seu arquivo de mapeamento personalizado <filename>/boot/grub2/device.map</filename>. O seguinte exemplo muda o mapeamento para transformar o <literal>DISK 3</literal> no disco de boot. Observe que os números de partição do GRUB 2 começam com <literal>1</literal>, e não com <literal>0</literal> como no GRUB Legacy.
   </para>
<screen>(hd1)  /dev/disk-by-id/<replaceable>DISK3 ID</replaceable>
(hd2)  /dev/disk-by-id/<replaceable>DISK1 ID</replaceable>
(hd3)  /dev/disk-by-id/<replaceable>DISK2 ID</replaceable></screen>
  </sect2>

  <sect2 xml:id="sec.grub2.menu_change">
   <title>Editando as entradas de menu durante o procedimento de boot</title><indexterm> <primary>GRUB 2</primary> <secondary>editor de menu</secondary></indexterm>
   <para>
    É útil editar diretamente as entradas de menu quando o sistema não é mais inicializado por causa de falha na configuração. Ele também pode ser usado para testar novas configurações sem alterar a configuração do sistema.
   </para>
   <procedure>
    <step>
     <para>
      No menu gráfico de boot, selecione a entrada que deseja editar com as teclas de seta.
     </para>
    </step>
    <step>
     <para>
      Pressione <keycap>E</keycap> para abrir o editor baseado em texto.
     </para>
    </step>
    <step>
     <para>
      Use as teclas de seta para ir até a linha que deseja editar.
     </para>
     <figure xml:id="fig.grub2.boot.editor">
      <title>Editor de boot do GRUB 2</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="grub2_edit_config.png" width="75%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="grub2_edit_config.png" width="75%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Agora você tem duas opções:
     </para>
     <substeps performance="required">
      <step>
       <para>
        Adicione parâmetros separados por espaço ao fim da linha que começa com <literal>linux</literal> ou <literal>linuxefi</literal> para editar os parâmetros de kernel. Há uma lista completa de parâmetros disponível em <link xlink:href="http://en.opensuse.org/Linuxrc"/>. 
       </para>
      </step>
      <step>
       <para>
        Se preferir, edite as opções gerais para mudar a versão do kernel, por exemplo. A tecla <keycap function="tab"/> sugere todas as complementações possíveis.
       </para>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      Pressione <keycap>F10</keycap> para inicializar o sistema com as mudanças feitas ou pressione <keycap function="escape"/> para descartar suas edições e retornar ao menu do GRUB 2.
     </para>
    </step>
   </procedure>
   <para>
    As mudanças feitas desta maneira só se aplicam ao processo de boot atual, elas não são gravadas permanentemente.
   </para>
   <important>
    <title>Layout do teclado durante o procedimento de boot</title>
    <para>
     O layout do teclado norte-americano é o único disponível na hora de inicializar. Consulte a <xref linkend="fig.trouble.install.keyboard_us"/>.
    </para>
   </important>
   <note arch="x86_64">
    <title>Carregador de boot na mídia de instalação</title>
    <para>
     O Carregador de Boot da mídia de instalação em sistemas com BIOS tradicional ainda é o GRUB Legacy. Para adicionar opções de boot, selecione uma entrada e comece a digitar. As adições feitas à entrada de boot de instalação são gravadas no sistema instalado permanentemente.
    </para>
   </note>
   <note arch="zseries">
    <title>Editando entradas do menu do GRUB 2 no z Systems</title>
    <para>
     O movimento do cursor e os comandos de edição no IBM z Systems são diferentes. Consulte a <xref linkend="sec.grub2.zseries"/> para obter detalhes.
    </para>
   </note>
  </sect2>

  <sect2 xml:id="sec.grub2.password">
   <title>Configurando uma senha de boot</title><indexterm> <primary>GRUB 2</primary> <secondary>senha de boot</secondary></indexterm>
   <para>
    Mesmo antes da inicialização do sistema operacional, o GRUB 2 permite acessar os sistemas de arquivos. Os usuários que não têm permissões de root poderão acessar os arquivos no sistema Linux aos quais não têm acesso depois que o sistema for inicializado. Para bloquear esse tipo de acesso ou impedir que os usuários inicializem determinadas entradas de menu, defina uma senha de boot.
   </para>
   <important>
    <title>Inicialização exige senha</title>
    <para>
     Se definida, a senha de boot será necessária em cada inicialização, o que significa que o sistema não será inicializado automaticamente.
    </para>
   </important>
   <para>
    Para definir uma senha de boot, faça o seguinte. Se preferir, use o YaST (<xref linkend="vle.grub2.yast2.boot.password"/>).
   </para>
   <procedure>
    <step>
     <para>
      Criptografe a senha usando <command>grub2-mkpasswd-pbkdf2:</command>
     </para>
<screen><prompt>tux &gt; </prompt> sudo grub2-mkpasswd-pbkdf2
Password: ****
Reenter password: ****
PBKDF2 hash of your password is grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...
</screen>
    </step>
    <step>
     <para>
      Cole a string resultante no arquivo <filename>/etc/grub.d/40_custom</filename> juntamente com o comando <command>set superusers</command>.
     </para>
<screen>set superusers="root"
password_pbkdf2 root grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...</screen>
    </step>
    <step>
     <para>
      Execute <xref linkend="vle.grub2.mkconfig"/> para importar as mudanças para o arquivo de configuração principal.
     </para>
    </step>
   </procedure>
   <para>
    Após a reinicialização, você terá que informar o nome de usuário e a senha ao tentar inicializar uma entrada de menu. Insira <literal>root</literal> e a senha digitada durante o comando <command>grub2-mkpasswd-pbkdf2</command>. Se as credenciais estiverem corretas, o sistema inicializará a entrada de boot selecionada.
   </para>
   <para>
    Para obter mais informações, consulte o <link xlink:href="https://www.gnu.org/software/grub/manual/grub.html#Security"/>.
   </para>
  </sect2>
 </sect1>
 <xi:include href="grub2_yast_i.xml"/>
 <sect1 xml:id="sec.grub2.zseries">
  <title>Diferenças no uso de terminais no z Systems</title>

  <para>
   Nos terminais 3215 e 3270, há algumas diferenças e limitações referentes à maneira de mover o cursor e emitir comandos de edição no GRUB 2.
  </para>

  <sect2 xml:id="sec.grub2.zseries.limitations">
   <title>Limitações</title>
   <variablelist>
    <varlistentry>
     <term>Interatividade</term>
     <listitem>
      <para>
       A interatividade é altamente limitada. A digitação quase sempre não resulta em feedback visual. Para ver onde está o cursor, digite um sublinhado (<keycap>_</keycap>).
      </para>
      <note>
       <title>Comparação entre 3270 e 3215</title>
       <para>
        O terminal 3270 é muito melhor no que diz respeito à exibição e atualização de telas do que o terminal 3215.
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Movimento do Cursor</term>
     <listitem>
      <para>
       O movimento do cursor <quote>tradicional</quote> não é possível. <keycap function="alt"/>, <keycap function="meta"/>, <keycap function="control"/> e as teclas de cursor não funcionam. Para mover o cursor, use as combinações de teclas listadas na <xref linkend="sec.grub2.zseries.keys"/>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Acento Circunflexo</term>
     <listitem>
      <para>
       O acento circunflexo (<keycap>^</keycap>) é usado como caractere de controle. Para digitar um <keycap>^</keycap> literal seguido de uma letra, digite <keycap>^</keycap>, <keycap>^</keycap>, <replaceable>LETRA</replaceable>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Digite</term>
     <listitem>
      <para>
       A tecla <keycap function="enter"/> não funciona; em vez dela, use <keycombo><keycap>^</keycap> <keycap>J</keycap></keycombo>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="sec.grub2.zseries.keys">
   <title>Combinações de tecla</title>
   <informaltable>
    <tgroup cols="3">
     <tbody>
      <row>
       <entry morerows="2" valign="top">
        <para>
         Substitutos Comuns:
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap> <keycap>J</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         acionar (<quote>Enter</quote>)
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>L</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         interromper, retornar ao <quote>estado</quote> anterior
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>I</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         preenchimento de tabulação (nos modos de edição e shell)
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="8" valign="top">
        <para>
         Teclas Disponíveis no Modo de Menu:
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         primeira entrada
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         última entrada
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         entrada anterior
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         próxima entrada
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>G</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         página anterior
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>C</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         próxima página
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         inicializar entrada selecionada ou inserir submenu (igual a <keycombo><keycap>^</keycap><keycap>J</keycap></keycombo>)
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         editar entrada selecionada
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>C</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         inserir GRUB-Shell
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="13" valign="top">
        <para>
         Teclas Disponíveis no Modo de Edição:
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         linha anterior
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         próxima linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>B</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         caractere de recuo
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         caractere de avanço
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         começo da linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         fim da linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>H</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         backspace
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>D</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         apagar
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>K</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         eliminar linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>Y</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         remover
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>O</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         abrir linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>L</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         atualizar tela
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>X</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         inicializar entrada
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>C</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         inserir GRUB-Shell
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="10" valign="top">
        <para>
         Teclas Disponíveis no Modo de Linha de Comando:
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         comando anterior
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         próximo comando do histórico
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         começo da linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         fim da linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>B</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         caractere de recuo
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         caractere de avanço
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>H</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         backspace
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>D</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         apagar
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>K</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         eliminar linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>U</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         descartar linha
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>Y</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         remover
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.grub2.commands">
  <title>Comandos úteis do GRUB 2</title>

  <variablelist>
   <varlistentry xml:id="vle.grub2.mkconfig">
    <term><command>grub2-mkconfig</command>
    </term>
    <listitem>
     <para>
      Gera um novo <filename>/boot/grub2/grub.cfg</filename> com base no <filename>/etc/default/grub</filename> e nos scripts de <filename>/etc/grub.d/</filename>.
     </para>
     <example>
      <title>Uso do grub2-mkconfig</title>
<screen>grub2-mkconfig -o /boot/grub2/grub.cfg</screen>
     </example>
     <tip>
      <title>Verificação de sintaxe</title>
      <para>
       A execução de <command>grub2-mkconfig</command> sem nenhum parâmetro imprime a configuração em STDOUT, de onde é possível revisá-la. Use <xref linkend="vle.grub2.script_check"/> após a gravação de <filename>/boot/grub2/grub.cfg</filename> para verificar sua sintaxe.
      </para>
     </tip>
     <important>
      <title>O <command>grub2-mkconfig</command> não conserta tabelas de boot seguro UEFI</title>
      <para>
       Se você usa Boot Seguro UEFI e o sistema não consegue mais acessar o GRUB 2 corretamente, talvez seja necessário reinstalar o Shim e gerar novamente a tabela de boot UEFI. Para fazer isso, use:
      </para>
<screen><prompt>root # </prompt>shim-install --config-file=/boot/grub2/grub.cfg</screen>
     </important>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="vle.grub2.mkrescue">
    <term><command>grub2-mkrescue</command></term>
    <listitem>
     <para>
      Cria uma imagem de recuperação inicializável da configuração do GRUB 2 instalado.
     </para>
     <example>
      <title>Uso do grub2-mkrescue</title>
<screen>grub2-mkrescue -o save_path/name.iso iso</screen>
     </example>
    </listitem>
   </varlistentry>
   <varlistentry xml:id="vle.grub2.script_check">
    <term><command>grub2-script-check</command>
    </term>
    <listitem>
     <para>
      Verifica se há erros de sintaxe no arquivo especificado.
     </para>
     <example>
      <title>Uso do grub2-script-check</title>
<screen>grub2-check-config /boot/grub2/grub.cfg</screen>
     </example>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>grub2-once</command>
    </term>
    <listitem>
     <para>
      Defina a entrada de boot padrão apenas para a próxima inicialização. Para ver a lista de entradas de boot disponíveis, use a opção <option>--list</option>.
     </para>
     <example>
      <title>Uso do grub2-once</title>
<screen>grub2-once number_of_the_boot_entry</screen>
     </example>
     <tip>
      <title>Ajuda do <command>grub2-once</command></title>
      <para>
       Chame o programa sem nenhuma opção para obter a lista completa de todas as opções possíveis.
      </para>
     </tip>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="sec.grub2.info">
  <title>Mais informações</title>

  <para>
   Em <link xlink:href="http://www.gnu.org/software/grub/"/>, há informações abrangentes sobre o GRUB 2. Consulte também a página de informações <command>grub</command>. Você também pode pesquisar a palavra-chave <quote>GRUB 2</quote> na Pesquisa de Informações Técnicas em <link xlink:href="http://www.suse.com/support"/> para obter informações sobre problemas específicos.
  </para>
 </sect1>
</chapter>
