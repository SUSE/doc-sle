<?xml version="1.0" encoding="UTF-8"?>
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apache2_yast_i.xml" version="5.0" xml:id="sec-apache2-configuration-yast">
 <title>使用 YaST 配置 Apache</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  要使用 YaST 配置 Web 服务器，请启动 YaST，并选择<menuchoice> <guimenu>网络服务</guimenu> <guimenu> HTTP 服务器</guimenu> </menuchoice>。第一次启动此模块时，<guimenu>HTTP 服务器向导</guimenu>会启动，提示您做出一些有关服务器管理的基本决定。完成向导后，在您每次调用 <guimenu>HTTP 服务器</guimenu>模块时，<guimenu>HTTP 服务器配置</guimenu>对话框都会启动。有关详细信息，请参见<xref linkend="sec-apache2-configuration-yast-server-configuration"/>。
 </para>
 <sect3 xml:id="sec-apache2-configuration-yast-wizard">
  <title>HTTP 服务器向导</title>
  <para>
   HTTP 服务器向导包括五个步骤。在对话框的最后一步中，您可以进入专家配置模式进行更具体的设置。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-network-device">
   <title>网络设备选择</title>
   <para>
    在这里，指定 Apache 用以侦听传入请求的网络接口和端口。可以选择现有网络接口及其各自 IP 地址的任意组合。可以使用其他服务未预留的所有三个范围内的端口（公认端口、注册端口和动态或私用端口）。默认设置是在端口 <systemitem>80</systemitem> 上侦听所有网络接口（IP 地址）。
   </para>
   <para>
    选中<guimenu>打开防火墙中的端口</guimenu>，在防火墙中打开 Web 服务器侦听的端口。要使 Web 服务器在网络（LAN、WAN 或公共因特网）中可用，这样做是必要的。仅在测试时不必对 Web 服务器进行外部访问的情况下，关闭端口是有用的。如果有多个网络接口，请单击<guimenu>防火墙细节</guimenu>以指定要在哪些接口上打开端口。
   </para>
   <para>
    单击<guimenu>下一步</guimenu>继续配置。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-modules">
   <title>模块</title>
   <para>
    <guimenu>模块</guimenu>配置选项允许激活或停用 Web 服务器应支持的脚本语言。要激活或停用其他模块，请参见<xref linkend="sec-apache2-configuration-yast-server-configuration-modules"/>。单击<guimenu>下一步</guimenu>进入下一个对话框。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-default-host">
   <title>默认主机</title>
   <para>
    该选项与默认的 Web 服务器相关。正如<xref linkend="sec-apache2-configuration-manually-vhost"/>中所述，Apache 可以在一台物理计算机上为多台虚拟主机提供服务。配置文件中最先声明的虚拟主机通常称为<emphasis>默认主机</emphasis>。每个虚拟主机都将继承默认主机的配置。
   </para>
   <para>
    要编辑主机设置（也称为<emphasis>指令</emphasis>），请在表中选择相应的项，然后单击<guimenu>编辑</guimenu>。要添加新指令，请单击<guimenu>添加</guimenu>。要删除指令，请选择该主机，然后单击<guimenu>删除</guimenu>。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-host">
    <title>HTTP 服务器向导：默认主机</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard3.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard3.png"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    这里是服务器默认设置的列表：
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>Document Root</systemitem>
     </term>
     <listitem>
      <para>
       Apache 为此主机提供文件的目录路径。<filename>/srv/www/htdocs</filename> 是默认位置。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Alias</systemitem>
     </term>
     <listitem>
      <para>
       使用 <systemitem>Alias</systemitem> 指令可以将 URL 映射到物理文件系统位置。这意味着可以通过对某路径进行 URL 别名判别来访问该路径（即使是在文件系统中<literal>文档根目录</literal>之外的路径）。
      </para>
      <para>
       默认的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <systemitem> Alias</systemitem>
       <filename> /icons</filename> 指向 <filename>/usr/share/apache2/icons</filename>，作为显示在目录索引视图中的 Apache 图标。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>ScriptAlias</systemitem>
     </term>
     <listitem>
      <para>
       和 <systemitem>Alias</systemitem> 指令类似，<systemitem>ScriptAlias</systemitem> 指令将 URL 映射到文件系统位置。不同之处在于 <systemitem>ScriptAlias</systemitem> 将目标目录指定为 CGI 位置，意味着 CGI 脚本应该在此位置执行。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Directory</systemitem>
     </term>
     <listitem>
      <para>
       设置 <systemitem>Directory</systemitem> 后，便可包含一组只能应用于指定目录的配置选项。
      </para>
      <para>
       目录 <filename>/srv/www/htdocs</filename>、<filename>/usr/share/apache2/icons</filename> 和 <filename>/srv/www/cgi-bin</filename> 的访问和显示选项是在此处配置的。不需要更改默认值。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Include</systemitem>
     </term>
     <listitem>
      <para>
       使用 include，还可指定其他配置文件。已预配置两个 <systemitem>Include</systemitem> 指令：<filename>/etc/apache2/conf.d/</filename> 是包含与外部模块一起提供的配置文件的目录。使用此指令可包含该目录中以 <filename>.conf</filename> 结尾的所有文件。使用第二个指令可包含 <filename>/etc/apache2/conf.d/apache2-manual.conf</filename>（<filename>apache2-manual</filename> 配置文件）。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Server Name</systemitem>
     </term>
     <listitem>
      <para>
       这指定了客户端用来联系 Web 服务器的默认 URL。使用完全限定的域名 (FQDN) 到达 Web 服务器（位于 <literal>http://<replaceable>FQDN</replaceable>/</literal>）或其 IP 地址。不能在此处随意选择名称 － 服务器在此名称下必须是<quote>已知</quote>的。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Server Administrator E-Mail</systemitem>
     </term>
     <listitem>
      <para>
       服务器管理员的电子邮件地址。例如，此地址将显示在 Apache 创建的错误页面上。
      </para>
     </listitem>
    </varlistentry>


   </variablelist>
   <para>
    完成<guimenu>默认主机</guimenu>步骤后，单击<guimenu>下一步</guimenu>继续完成配置。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-virtual-hosts">
   <title>虚拟主机</title>
   <para>
    在本步骤中，向导显示已配置的虚拟主机（请参见<xref linkend="sec-apache2-configuration-manually-vhost"/>）的列表。如果启动 YaST HTTP 向导前未进行手动更改，将不显示虚拟主机。
   </para>
   <para>
    要添加主机，请单击<guimenu>添加</guimenu>以打开一个对话框，可在其中输入有关该主机的基本信息，如<guimenu>服务器名称</guimenu>、<guimenu>服务器内容根</guimenu> (<systemitem>DocumentRoot</systemitem>) 和<guimenu>管理员电子邮件</guimenu>。<guimenu>服务器解析</guimenu>用来确定如何识别主机（基于名称或基于 IP）。通过<guimenu>更改虚拟主机 ID</guimenu> 指定名称或 IP 地址
   </para>
   <para>
    单击<guimenu>下一步</guimenu>进入虚拟主机配置对话框的第二部分。
   </para>
   <para>
    在虚拟主机配置的第二部分中，可以指定是否启用 CGI 脚本以及用于这些脚本的目录。还可启用 SSL。如果要启用，还必须指定证书的路径。请参见<xref linkend="sec-apache2-ssl-configuration"/>了解有关 SSL 和证书的细节。使用<guimenu>目录索引</guimenu>选项，可指定在客户端请求目录时所显示的文件（默认情况下为 <filename>index.html</filename>）。添加一个或多个文件名（用空格分隔）可更改此设置。使用<guimenu>启用公用 HTML</guimenu>，便可在服务器的 <literal>http://www.example.com/~<replaceable>USER</replaceable></literal> 下访问用户公共目录 (<filename>~<replaceable>USER</replaceable>/public_html/</filename>) 的内容。
   </para>
   <important>
    <title>创建虚拟主机</title>
    <para>
     不能随意添加虚拟主机。如果使用基于名称的虚拟主机，必须在网络上解析每个主机名。如果使用基于 IP 的虚拟主机，则仅可向每个可用的 IP 地址指定一个主机。
    </para>
   </important>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-summary">
   <title>摘要</title>
   <para>
    这是本向导的最后一步。在此，确定 Apache 服务器启动的方式和时间：何时引导或手动引导。另请参见迄今为止所作配置的简短摘要。如果对设置满意，单击<guimenu>完成</guimenu>以完成配置。要进行更改，请单击<guimenu>后退</guimenu>直至显示所需的对话框。单击 <guimenu>HTTP 服务器专家配置</guimenu>打开<xref linkend="sec-apache2-configuration-yast-server-configuration"/>中所述的对话框。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-summary">
    <title>HTTP 服务器向导：摘要</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard5.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard5.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
 </sect3>
 <sect3 xml:id="sec-apache2-configuration-yast-server-configuration">
  <title>HTTP 服务器配置</title>
  <para>
   <guimenu>HTTP 服务器配置</guimenu>对话框还允许您对配置进行比在向导（它只在您首次配置 Web 服务器时运行）中更多的调整。它由四个如下所述的选项卡组成。在此处更改的任何配置选项都不会立即生效，总是需要使用<guimenu>完成</guimenu>来确认更改从而使其生效。单击<guimenu>中止</guimenu>退出配置模块并丢弃所作更改。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-listen">
   <title>监听端口和地址</title>
   <para>
    在 <guimenu>HTTP Service</guimenu> 中，选择应该运行（<guimenu>启用</guimenu>）还是停止（<guimenu>禁用</guimenu>）Apache。在<guimenu>侦听端口</guimenu>中，<guimenu>添加</guimenu>、<guimenu>编辑</guimenu>或<guimenu>删除</guimenu>服务器可用的地址和端口。默认设置是在端口 <literal>80</literal> 上侦听所有接口。应始终选中<guimenu>打开防火墙中的端口</guimenu>，否则无法从外部访问 Web 服务器。仅在测试时不必对 Web 服务器进行外部访问的情况下，关闭端口是有用的。如果有多个网络接口，请单击<guimenu>防火墙细节</guimenu>以指定要在哪些接口上打开端口。
   </para>
   <para>
    使用<guimenu>日志文件</guimenu>查阅访问日志文件或错误日志文件。如果要测试配置，这很有用。该日志文件将在单独的窗口中打开，您还可从该窗口重启动或重新装载 Web 服务器。有关详细信息，请参见<xref linkend="sec-apache2-start-stop"/>。这些命令将立即生效，并且其日志消息也会立即显示。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-listen">
    <title>HTTP 服务器配置：侦听端口和地址</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_listen.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_listen.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-modules">
   <title>服务器模块</title>
   <para>
    可以通过单击<guimenu>切换状态</guimenu>来更改 Apache2 模块的状态（启用或禁用）。单击<guimenu>添加模块</guimenu>可添加已安装但还未列出的新模块。要了解模块的更多信息，请参见<xref linkend="sec-apache2-modules"/>。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-modules">
    <title>HTTP 服务器配置：服务器模块</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_modules.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_modules.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-host">
   <title>主要主机</title>
   <para>
    这些对话框与上述对话框相同。请参见<xref linkend="sec-apache2-configuration-yast-wizard-default-host"/>和<xref linkend="sec-apache2-configuration-yast-wizard-virtual-hosts"/>。
   </para>
  </sect4>
 </sect3>
</sect2>
