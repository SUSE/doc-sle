<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec-zseries-prep">
 <title>インストールの準備</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  この章では、インストールに使用するデータをアクセス可能にする方法、さまざまな手段による<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストール方法、および<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムのIPLを準備して使用する方法について説明します。また、この章では、ネットワーク設定とネットワークインストールについても説明します。
 </para>

 <sect2 xml:id="sec-prep-makeavail">
  <title>インストールデータを利用できるようにする</title>
  <para>
   このセクションでは、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のIBM Z向けインストールデータをインストール時にアクセス可能にする方法について詳しく説明します。コンピュータとシステム環境に応じて、NFSまたはFTPによるインストールを選択します。Microsoft Windowsワークステーションを実行している環境では、Windowsネットワーク(SMBプロトコルを含めて)を使用して、IBM Zシステムに<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>をインストールすることができます。
  </para>
  <tip>
   <title>DVDからのIPL</title>
   <para>
    DVDからIPL処理して、そのDVDをインストールメディアとして使用することができます。これは、ネットワークを介してインストールメディアを提供するインストールサーバを設定することに制約がある場合に、非常に便利です。前提条件はFCP接続SCSI DVDドライブです。
   </para>
  </tip>
  <note>
   <title>ハードディスクからのインストールに非対応</title>
   <para>
    DVDのコンテンツをDASDのパーティションに格納することでハードディスクからインストールを実行することは不可能です。
   </para>
  </note>
  <sect3 xml:id="sec-prep-makeavail-linuxws">
   <title>Linuxワークステーションまたは<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のDVDの使用</title>
   <para>
    コンピュータ環境でLinuxワークステーションを使用して、NFS経由またはFTP経由でインストールデータをIBM Zインストールプロセスで使用できるようにします。
   </para>
   <important>
    <title>マウントされたデバイスのNFSを使用するエクスポート</title>
    <para>
     ファイルシステムのroot (<filename>/</filename>)をエクスポートしても、DVDなどのマウントされたデバイスが自動的にエクスポートされるわけではありません。したがって、<filename>/etc/exports</filename>のマウントポイントに明示的に名前を付ける必要があります。
    </para>
<screen>/media/dvd  *(ro)</screen>
    <para>
     このファイルの変更後に、<command>sudo systemctl restart nfsserver</command>コマンドを使用してNFSサーバを再起動します。
    </para>
   </important>
   <para>
    LinuxシステムでのFTPサーバの設定には、<package>vsftpd</package>などのサーバソフトウェアのインストールおよび設定が含まれます。匿名ログインを使用したインストールデータのダウンロードはサポートされていないため、ユーザ認証がサポートされるようにFTPサーバを設定する必要があります。
   </para>
   <sect4 xml:id="sec-prep-makeavail-linuxws-oncd">
    <title>DVDでの<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase></title>
    <para>
     IBM Z対応の<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>の最初のインストールメディアには、Intelベースのワークステーション向けのブート可能なLinuxイメージおよびIBM Z向けのイメージが収録されています。
    </para>
    <para>
     Intelベースのワークステーションの場合は、このメディアからブートします。プロンプトが表示されたら、目的の回答言語とキーボードレイアウトを選択して、<guimenu>Start rescue system (レスキューシステムの開始)</guimenu>を選択します。この操作には64MB以上のRAMが必要です。レスキューシステム全体がワークステーションのRAMに常駐するため、ディスク領域は必要ありません。この方法では、ワークステーションのネットワーキングを手動で設定する必要があります。
    </para>
    <para>
     IBM Zの場合は、<xref linkend="sec-prep-ipling-lpar-dvd"/>で説明しているとおり、このメディアからLPAR/VMゲストをIPL処理します。ネットワークパラメータを入力したら、インストールシステムはメディアをインストールデータのソースとして処理します。IBM Zでは、X11対応の端末を直接接続できないので、VNCによるインストールまたはSSHによるインストールを選択します。SSHはまた、<command>ssh -X</command>でX接続をSSHにトンネルさせることで、グラフィカルインストールを提供します。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-windowsws">
   <title>Microsoft Windowsワークステーションの使用</title>
   <para>
    ネットワーク上のMicrosoft Windowsワークステーションを使用して、インストールメディアを使用できるようにすることができます。これを行う最も簡単な方法はSMBプロトコルを使用する方法です。必ず<guimenu>SMB over TCP/IP</guimenu>を有効にしてください。この機能によって、SMBパッケージをTCP/IPパッケージにカプセル化できるようになります。詳細については、Windowsオンラインヘルプ、またはネットワーキングを対象にしたその他のWindows関連マニュアルを参照してください。
   </para>
   <sect4 xml:id="sec-prep-makeavail-windowsws-smb">
    <title>SMBの使用</title>
    <para>
     SMBを使用してインストールメディアを使用できるようにするには、SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.isoを含むUSBフラッシュドライブをWindowsワークステーションのUSBポートに挿入します。次に、USBフラッシュドライブの文字を使用して新しい共有を作成し、ネットワーク内のどのユーザでも使用できるようにします。
    </para>
    
    <para>
     YaSTでのインストールパスは次のとおりです。
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     各プレースホルダは次のような意味です。
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable></term>
      <listitem>
       <para>
        ワークグループまたはActive Directoryのドメイン(オプション)。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable></term>
      <term><replaceable>PW</replaceable></term>
      <listitem>
       <para>
        このサーバとその共有にアクセスできるユーザのオプションのユーザ名およびパスワード。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable></term>
      <listitem>
       <para>
        共有をホストするサーバの名前。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable></term>
      <listitem>
       <para>
        共有へのパス。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para/>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-nfs">
    <title>NFSを使用する</title>
    <para>
     Windowsワークステーション用にNFSサーバサービスを有効にするサードパーティ製品のマニュアルを参照してください。SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.isoメディアを含むUSBフラッシュドライブは、使用可能なNFSパスに存在する必要があります。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-ftp">
    <title>FTPの使用</title>
    <para>
     Windowsワークステーション用にFTPサーバサービスを有効にするサードパーティ製品のマニュアルを参照してください。SLE-15-SP5-Online-<replaceable>ARCH</replaceable>-GM-media1.isoメディアを含むUSBフラッシュドライブは、使用可能なFTPパスに存在する必要があります。
    </para>
    <para>
     Microsoft Windowsの特定のリリースにバンドルされているFTPサーバは、FTPコマンドのサブセットのみを実装するので、インストールデータの提供には適しません。この場合、必要な機能を提供するサードパーティのFTPサーバを使用してください。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-scsi">
    <title>FCP接続SCSI DVDドライブの使用</title>
    <para>
     <xref linkend="sec-prep-ipling-lpar-dvd"/>の説明に従ってSCSI DVDからIPLすると、インストールシステムによってDVDがインストールメディアとして使用されます。この場合、FTP、NFS、またはSMBサーバにはインストールメディアは必要ありません。ただし、VNCまたはXによるグラフィカルインストールを実行するには、インストールの際にネットワークを設定する必要があるので、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のネットワーク設定データは必要です。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-zpxe-cobbler">
   <title>zPXE用のCobblerサーバの使用</title>
   <para>
    ネットワークからのIPL処理では、カーネル、initrd、インストールデータを提供するためのCobblerサーバが必要です。Cobblerサーバを準備するには、次のステップを実行する必要があります。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-import"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-system"/>
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-import">
    <title>インストールデータのインポート</title>
    <para>
     メディアをインポートするには、USBフラッシュドライブまたはネットワークソースにあるインストールソースをCobblerサーバ上で使用できるようにする必要があります。次のコマンドを実行してデータをインポートします。
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler import --path=<replaceable>PATH</replaceable><co xml:id="co-cobbler-import-path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-import-dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="co-cobbler-import-path">
      <para>
       インストールデータのマウントポイント。
      </para>
     </callout>
     <callout arearefs="co-cobbler-import-dirname">
      <para>
       インポートした製品を識別する文字列(例: <quote>sles15_s390x</quote>)。この文字列は、インストールデータのコピー先のサブディレクトリとして使用されます。SUSE Linux Enterpriseで実行されているCobblerサーバで、これは<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>です。Cobblerが別のオペレーティングシステムで実行されている場合、これは別のパスになる可能性があります。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-add-distro">
    <title>配布の追加</title>
    <para>
     配布を追加することで、CobblerはIPLに必要なカーネルとinitrdをzPXEを介して提供できます。Cobblerサーバ上で次のコマンドを実行して、IBM Z対応の<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>を追加します。
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-identifier"/> \
  --os-version=<phrase os="slemicro">slemicro5.2</phrase><co xml:id="co-cobbler-add-os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="co-cobbler-add-initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="co-cobbler-add-kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-server"/>
    </screen>    
    <calloutlist>
     <callout arearefs="co-cobbler-add-identifier">
      
      <para os="slemicro">
       配布の固有の識別子(<quote>SLE Micro <phrase role="productnumber"><phrase os="slemicro">5.5</phrase></phrase> IBM Z</quote>など)。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-os">
      <para>
       オペレーティングシステムの識別子。<literal>sles15</literal>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-initrd">
      <para>
       initrdへのパス。パスの最初の部分(<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>)は、インポートされたデータの場所と、インストールデータのインポート時に選択したサブディレクトリ名によって異なります。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-kernel">
      <para>
       カーネルへのパス。パスの最初の部分(<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>)は、インポートされたデータの場所と、インストールデータのインポート時に選択したサブディレクトリ名によって異なります。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-server">
      <para>
       Cobblerサーバ上のインストールディレクトリへのURL。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-profile">
    <title>プロファイルの調整</title>
    <para>
     配布を追加すると(<xref linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>を参照)、対応する<replaceable>IDENTIFIER</replaceable>を持つプロファイルが自動的に生成されます。次のコマンドを使用して、必要な調整を行います。
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-profile-name"/> --os-version=sles10<co xml:id="co-cobbler-profile-os"/> --ksmeta=""<co xml:id="co-cobbler-profile-meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-profile-opts"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-profile-name">
      <para>
       プロファイルの識別子。配布を追加するときに指定した文字列を使用します。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-os">
      <para>
       オペレーティングシステムのバージョン.プロファイルの適用先の配布。インポートステップでは、<option>--name=<replaceable>IDENTIFIER</replaceable></option>で指定した文字列を使用します。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-meta">
      <para>
       キックスタートファイルのテンプレートに必要なオプション 。SUSEでは使用されないため、空のままにしておきます。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-opts">
      <para>
       カーネルパラメータのスペース区切りのリスト。少なくとも<literal>install</literal>パラメータを含める必要があります。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-system">
    <title>システムの追加</title>
    <para>
     最後のステップは、Cobblerサーバへのシステムの追加です。このステップは、zPXEを介してブートする必要があるすべてのIBM Zゲストに対して実行する必要があります。ゲストはz/VMユーザIDで識別されます(次の例では、ID <quote>linux01</quote>)。IDは小文字でなければならないことに注意してください。システムを追加するには、次のコマンドを実行します。
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     <option>--kopts</option>オプションを使用すると、通常はparmfileで指定されるカーネルとインストールパラメータを指定できます。次の形式を使用してパラメータを指定します: <replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>。インストーラは不足しているパラメータの入力を求めます。完全な自動インストールを実現するには、ネットワークやDASDに対するすべてのパラメータを指定し、AutoYaSTファイルを用意する必要があります。次に、上記と同じネットワークパラメータを使用してOSAインタフェースを装備したゲストの例を示します。
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-dvd-usb-hmc">
   <title>HMCのUSBフラッシュドライブからのインストール</title>
   <para>
    IBM Zサーバに<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>をインストールするには通常、ネットワークインストールソースが必要です。この要件を満たすことができない場合、SUSE Linux Enterprise Serverでは、ハードウェア管理コンソール(HMC)のUSBフラッシュドライブをLPARにインストールするためのインストールソースとして使用できます。
   </para>
   <para>
    HMCのUSBフラッシュドライブからインストールを実行するには、次のように続行します。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <option>install=hmc:/</option>を<filename>parmfile</filename>に追加(<xref linkend="sec-appdendix-parm"/>を参照)またはカーネルオプションに追加します。
     </para>
    </listitem>
    <listitem>
     <para>
      <filename>linuxrc</filename>を使用した手動モードのインストールでは、［Start Installation (インストールの開始)］、［インストール］、［Hardware Management Console (ハードウェア管理コンソール)］の順に選択します。<emphasis role="italic"></emphasis><emphasis role="italic"></emphasis><emphasis role="italic"></emphasis>インストールメディアは、HMCにある必要があります。
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>ネットワークの設定</title>
    <para>
     インストールを開始する前に、<filename>linuxrc</filename>でネットワーク設定を指定します。ブートパラメータを使用してこれを実行することはできません。また、ネットワークアクセスが必要になる可能性が高くなります。<filename>linuxrc</filename>で、［Start Installation (インストールの開始)］をクリックし、［ネットワーク設定］を選択します。<emphasis role="italic"></emphasis><emphasis role="italic"></emphasis>
    </para>
   </important>
   <important>
    <title>Linuxシステムを最初にブートする必要がある</title>
    <para>
     Linuxシステムがブートするのを待ってから、HMCのUSBフラッシュドライブのメディアへのアクセスを許可するようにしてください。IPL処理を行うと、HMCとLPARとの間の接続に支障が生じる可能性があります。すでに説明した方法を最初に試行して失敗した場合は、アクセス権を付与して<option>HMC</option>オプションで再試行できます。
    </para>
   </important>
   <note>
    <title>インストールリポジトリ</title>
    <para>
     インストールは1回限りの手順であるため、USBフラッシュドライブはインストールリポジトリとして保存されません。インストールリポジトリが必要な場合は、オンラインリポジトリを登録して使用してください。
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-inst-types">
  <title>インストールのタイプ</title>
  <para>
   このセクションでは、各インストールモードにおける、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストール手順を説明します。前の章で説明されている準備手順が完了したら、目的のインストールモードの概要に従います。
  </para>
  <para>
   <xref linkend="sec-prep-makeavail"/>で説明されるように、Linux on IBM Zには3つの異なるインストールモード(LPAR、z/VM、およびKVMゲストインストール)があります。
  </para>
  <procedure xml:id="pro-prep-inst-types-lpar">
   <title>LPARインストールの概要</title>
   <step>
    <para>
     インストールに必要なデバイスを準備します。<xref linkend="sec-prep-prep-ipl-natlpar"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールシステムをIPL処理します。<xref linkend="sec-prep-ipling-lpar"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     ネットワークを設定します。<xref linkend="sec-prep-netcfg"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムに接続します。<xref linkend="sec-prep-connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。<xref linkend="cha-install"/>を参照してください。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-vm">
   <title>z/VMインストールの概要</title>
   <step>
    <para>
     インストールに必要なデバイスを準備します。<xref linkend="sec-prep-prep-ipl-vm-linux-guest"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールシステムをIPL処理します。<xref linkend="sec-prep-ipling-vm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     ネットワークを設定します。<xref linkend="sec-prep-netcfg"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムに接続します。<xref linkend="sec-prep-connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。<xref linkend="cha-install"/>を参照してください。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-kvm">
   <title>KVMゲストのインストールの概要</title>
   <step>
    <para>
     仮想ディスクイメージを作成し、ドメインXMLファイルを作成します。<xref linkend="sec-prep-prep-ipl-kvm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールターゲットを準備し、VMゲストのIPL処理を実行します。<xref linkend="sec-prep-ipling-kvm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec-prep-netcfg-data"/>ボタンをクリックします。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムに接続します。<xref linkend="sec-prep-connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。<xref linkend="cha-install"/>を参照してください。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-prep-prep-ipl">
  <title><phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムのIPLの準備</title>
  <para/>
  <sect3 xml:id="sec-prep-prep-ipl-natlpar">
   <title>LPARインストールのIPLの準備</title>
   <para>
    適切な有効化プロファイルとIOCDSを使用して、ESA/S390モードまたはLinux専用モードで起動するようにIBM Zシステムを設定します。詳細については、IBMドキュメントを参照してください。<xref linkend="sec-prep-ipling-lpar"/>の説明に従って、作業を行ってください。
   </para>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-vm">
   <title>z/VMインストールのIPLの準備</title>
   <para/>
   <sect4 xml:id="sec-prep-prep-ipl-vm-linux-guest">
    <title>dirMaintを使用したLinuxゲストの追加</title>
    <para>
     最初の手順として、z/VM環境のLinuxゲストによって使用されるシステム内の1つ以上のDASDを接続してフォーマットします。次に、z/VMでの新しいユーザを作成します。この例は、パスワード<literal>LINPWD</literal>を使用するユーザ<literal>LINUX1</literal>のディレクトリ、1GBのメモリ(2GBまで拡張可能)、複数のミニディスク(MDISK)、2つのCPU、およびOSA QDIOデバイスを示しています。
    </para>
    <tip>
     <title>z/VMゲストへのメモリの割り当て</title>
     <para>
      メモリをz/VMゲストに割り当てるときは、<xref linkend="sec-zseries-requirements-hw-mem"/>で説明されているように、メモリサイズが優先的に選択するインストールタイプに適していることを確認します。メモリサイズを1GBに設定するには、<command>CP DEFINE STORAGE 1G</command>コマンドを使用します。インストールが完了したら、メモリサイズを必要な値に戻します。
     </para>
    </tip>
    <example xml:id="ex-prep-prep-ipl-vm-linux-guest-config">
     <title>z/VMディレクトリの設定</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     この例では、ミニディスク201を、ゲストのホームディスクとして使用します。200のシリンダを持つミニディスク150は、Linux swapデバイスです。また、2800のシリンダを持つディスク151は、Linuxインストールデータを保持するメディアです。
    </para>
    <para>
     <command>DIRM FOR LINUX1 ADD</command>を使用して、<systemitem class="username">MAINT</systemitem>ユーザとしてゲストをユーザディレクトリに追加します。ゲストの名前(<literal>LINUX1</literal>)を入力して、<keycap>F5</keycap>キーを押します。次のように、ユーザの環境を設定します。
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     最後のコマンドは、リーダファイル番号を返します。次に示すように、この番号は、次のコマンドを実行するのに必要です。
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     ユーザ <systemitem class="username">LINUX1</systemitem> として、ゲスト上でログインできるようになります。
    </para>
    <para>
     <literal>dirmaint</literal>オプションが使用できない場合は、このユーザを設定する方法に関してIBMのドキュメントを参照してください。
    </para>
    <para>
     <xref linkend="sec-prep-ipling-vm"/>に従って手順を進めます。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-kvm">
   <title>KVMゲストインストールのIPLの準備</title>
   <para>
    KVMゲストインストールでは、仮想マシンを指定するドメインXMLファイルと、インストール用の最低1つの仮想ディスクイメージを用意しておく必要があります。
   </para>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-disk">
    <title>仮想ディスクイメージの作成</title>
    <para>
     デフォルトでは、libvirtはVMホストサーバ上の<filename>/var/lib/libvirt/images/</filename>でディスクイメージを検索します。イメージは、ファイルシステム上の他の任意の場所に保存することもできますが、管理を容易にするため、1つの場所にすべてのイメージを保存することをお勧めします。イメージを作成するには、KVMホストサーバにログインし、次のコマンドを実行します。
    </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
    <para>
     これにより、サイズが10GBのqcow2イメージが<filename>/var/lib/libvirt/images/</filename>に作成されます。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-domain">
    <title>ドメインXMLファイルの作成</title>
    <para>
     ドメインXMLファイルは、VMゲストの定義に使用します。ドメインXMLファイルを作成するには、エディタで空白ファイル<filename>s15-1.xml</filename>を開き、次の例のようなファイルを作成します。
    </para>
    <example>
     <title>ドメインXMLファイルの例</title>
     <para>
      次の例では、単一のCPU、1GBのRAM、および前のセクション(<xref linkend="sec-prep-prep-ipl-kvm-disk"/>)で作成した仮想ディスクイメージを持ったVMゲストを作成します。仮想サーバはホストネットワークインタフェース<literal>bond0</literal>に接続されていることを前提としています。使用するネットワークのセットアップと一致するようにソースデバイス要素を変更します。
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s15-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE SLES15&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successful installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s15-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s15-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s15lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-ipling">
  <title><phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムのIPL処理</title>
  <para/>
  <sect3 xml:id="sec-prep-ipling-lpar">
   <title>LPARインストールでのIPL処理</title>
   <para>
    LPARに対して<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>をIPL処理するにはさまざまな方法があります。推奨されているのは、SEまたはHMCの<guimenu>Load from CD-ROM or server</guimenu>機能を使用する方法です。
   </para>
   <sect4 xml:id="sec-prep-ipling-lpar-cdrom">
    <title>DVD-ROMからのIPL</title>
    <para>
     インストールするLPARをマークして、<guimenu>Load from CD-ROM or server</guimenu>を選択します。ファイルの場所を指定するフィールドを空白のままにするか、最初のDVD-ROMのルートディレクトリへのパスを入力して、<guimenu>続行</guimenu>を選択します。表示されるオプションのリストについては、デフォルト設定のままにしてください。ここで、<guimenu>Operating system messages</guimenu>によって、カーネルブートメッセージが表示されます。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-lpar-dvd">
    <title>FCP接続SCSI DVDからのIPL</title>
    <para>
     <guimenu>SCSI</guimenu>を<guimenu>Load type</guimenu>として選択し、<guimenu>LOAD</guimenu>手順を使用して、SCSIからのIPLを実行できます。SCSIブリッジまたはSCSIストレージで指定されているWWPN (Worldwide port name)とLUN (Logical unit number)を入力します。これは16桁の数字ですが、末尾のゼロを省略しないようにします。ブートプログラムのセレクタは2でなければなりません。使用するFCPアダプタを<guimenu>Load address</guimenu>として使用し、IPLを実行します。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-vm">
   <title>z/VMインストールでのIPL処理</title>
   <para>
    このセクションでは、z/VMシステムにIBM Z対応の<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>をインストールするようにインストールシステムをIPL処理する方法について説明します。
   </para>
   <sect4 xml:id="sec-prep-ipling-vm-reader">
    <title>z/VMリーダからのIPL</title>
    <para>
     FTPを介してインストールシステムを転送するには、新規に定義されたz/VMゲスト内では、有効なTCP/IP接続とFTPクライアントプログラムが必要です。z/VM用のTCP/IPの設定は、このマニュアルの範囲を超えています。適切なIBMマニュアルを参照してください。
    </para>
    <para>
     z/VM Linuxゲストとしてログインし、IPLを実行します。ネットワーク内のFTPを介して利用可能なUnified Installer (メディア1)のディレクトリ<filename>/boot/s390x</filename>のコンテンツを作成します。このディレクトリから、ファイル<filename>linux</filename>、<filename>initrd</filename>、<filename>parmfile</filename>、および<filename>sles.exec</filename>を取得します。80文字の固定ブロックサイズでファイルを転送します。サイズを指定するには、FTPコマンド <command>locsite fix 80</command> を使用します。<filename>linux</filename> (Linuxカーネル)と<filename>initrd</filename> (インストールイメージ)はバイナリファイルとしてコピーすることが重要です。したがって、<literal>binary</literal>転送モードを使用します。<filename>parmfile</filename>と<filename>sles.exec</filename>はASCIIモードで転送する必要があります。
    </para>
    <para>
     次の例では、必要なステップを示します。この特定のシナリオでは、IPアドレス<literal>192.168.0.3</literal>を指定して、FTPサーバから、必要なファイルにアクセスできることを前提としています。ログインは<systemitem class="username">lininst</systemitem>です。
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-ftp-ftptrans">
     <title>FTP経由のバイナリ転送</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles.exec sles.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     ダウンロードしたREXXスクリプトsles.execを使用して、LinuxインストールシステムのIPLを実行します。このスクリプトは、次のように、カーネル、parmfile、およびRAMディスクを、IPL用のリーダにロードします。
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-startscript-slesexec">
     <title>sles.exec</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES LINUX A (NOH'
'PUNCH SLES PARMFILE A (NOH'
'PUNCH SLES INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     このスクリプトでは、<command>sles</command>コマンドを使用して、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムのIPLを実行できます。Linuxカーネルが起動し、そのブートメッセージが出力されます。
    </para>
    <para>
     インストールを続行するには、<xref linkend="sec-prep-netcfg"/>の説明に従います。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-dvd">
    <title>FCP接続SCSI DVDからのIPL</title>
    <para>
     z/VMでIPLを実行するには、次のように、 SET LOADDEV パラメータを使用して、SCSI IPLプロセスを準備します。
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     たとえば、適切な値でLOADDEVパラメータを設定したら、FCPアダプタのIPLを実行します。
    </para>
<screen>IPL FC00</screen>
    <para>
     インストールを続行するには、<xref linkend="sec-prep-netcfg"/>に従って処理を行います。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-zpxe">
    <title>zPXEによるCobblerサーバからのIPL</title>
    <para>
     zPXEによってCobblerサーバからIPLを実行するには、Cobblerサーバからz/VMゲストに対して、FTP経由で<filename>zpxe.rexx</filename>スクリプトを転送する必要があります。これを実行するため、z/VMゲストでは、TCP/IP接続とFTPクライアントプログラムが機能している必要があります。
    </para>
    <para>
     z/VM LinuxゲストとしてIPLにログインし、ASCIIモードの80文字の固定サイズでスクリプトを転送します(例は、<xref linkend="ex-prep-ipling-vm-reader-ftp-ftptrans"/>を参照)。<filename>zpxe.rexx</filename>スクリプトは、<filename>/boot/s390x/zpxe.rexx</filename>にあるUnified Installer DVDまたは<filename>/usr/share/doc/packages/s390-tools/zpxe.rexx</filename>にあるSLE Cobblerサーバで入手できます。
    </para>
    <para>
     <filename>zpxe.rexx</filename>は、ゲストの<filename>PROFILE EXEC</filename>を置き換えることが想定されています。既存の<filename>PROFILE EXEC</filename>のバックアップコピーを作成し、名前<filename>ZPXE
     REXX</filename>を<filename>PROFILE EXEC</filename>に変更します。または、<literal>'ZPXE REXX'</literal>行を追加して既存の<filename>PROFILE
     EXEC</filename>から<filename>ZPXE REXX</filename>を呼び出します。
    </para>
    <para>
     最後のステップでは設定ファイル<filename>ZPXE
     CONF</filename>を作成し、そこで接続先のCobblerサーバとIPLの実行対象とするディスクを<filename>ZPXE REXX</filename>に対して指定します。<command>xedit zpxe
     conf a</command>を実行して、次のコンテンツで<filename>ZPXE CONF</filename>を作成します(それに応じて例のデータを置き換えます)。
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     これにより、次回z/VMゲストにログインするときにCobblerサーバが接続されます。Cobblerサーバ上でインストールがスケジュールされている場合は、それが実行されます。インストールをスケジュールするには、Cobblerサーバで次のコマンドを実行します。
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system edit --name <replaceable>ID</replaceable><co xml:id="co-cobbler-sysedit-id"/> --netboot-enabled 1<co xml:id="co-cobbler-sysedit-netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="co-cobbler-sysedit-profile"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-sysedit-id">
      <para>
       z/VMのユーザID。
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-netboot">
      <para>
       ネットワークからのIPLingを有効にします。
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-profile">
      <para>
       既存のプロファイルの名前(<xref linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>を参照)。
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-kvm">
   <title>KVMゲストインストールでのIPL処理</title>
   <para>
    ゲストインストールを開始するには、まず<xref linkend="sec-prep-prep-ipl-kvm-disk"/>で定義されているVMゲストを起動する必要があります。開始する前に、カーネルとinitrdがIPLに使用できることを確認します。
   </para>
   <sect4 xml:id="sec-prep-ipling-kvm-prep">
    <title>インストールソースの準備</title>
    <para>
     インストールシステムへのVMゲストのIPLを実行するには、インストールシステムのカーネルとinitrdをVMホストサーバにコピーする必要があります。
    </para>
    <procedure>
     <step>
      <para>
       KVMホストにログインし、インストールソースを提供するリモートホストやデバイスに接続できることを確認します。
      </para>
     </step>
     <step>
      <para>
       次の2つのファイルをインストールソースから<filename>/var/lib/libvirt/images/</filename>にコピーします。リモートホストからデータが提供される場合は、<command>ftp</command>、<command>sftp</command>、または<command>scp</command>を使用してファイルを転送します。
      </para>
      <simplelist><member><filename>/boot/s390x/initrd</filename></member><member><filename>/boot/s390x/cd.ikr</filename></member>
      </simplelist>
     </step>
     <step>
      <para>
       KVMホスト上のファイルの名前を変更します。
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cd /var/lib/libvirt/images/
<prompt>&gt; </prompt><command>sudo</command> mv initrd s15-initrd.boot
<prompt>&gt; </prompt><command>sudo</command> mv cd.ikr s15-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-kvm-guest">
    <title>VMゲストのIPLの実行</title>
    <para>
     VMゲストのIPLを実行するには、KVMホストにログインし、次のコマンドを実行します。
    </para>
<screen><prompt>&gt; </prompt>virsh  create s15-1.xml --console</screen>
    <para>
     VMゲストが起動し稼働中であるときにインストールプロセスが開始され、次のメッセージが表示されます。
    </para>
<screen>Domain s15-1 started
Connected to domain s15-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     <guimenu>2) いいえ</guimenu>と答え、次のステップで<guimenu>インストール</guimenu>を選択します。<xref linkend="sec-prep-netcfg-data"/>の説明に従って、作業を行ってください。
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-netcfg">
  <title>ネットワーク設定</title>
  <para>
   カーネルがその起動ルーチンを完了するまで待機します。基本モードまたはLPARでインストールを行う場合は、HMCまたはSEの<guimenu>Operating System Messages</guimenu>を開きます。
  </para>
  <para>
   最初に、<filename>linuxrc</filename>メインメニューで、<guimenu>Start Installation (インストールの開始)</guimenu>を選択します。次に、<guimenu>Start Installation or Update (インストールの開始または更新)</guimenu>を選択して、インストールプロセスを開始します。<guimenu>ネットワーク</guimenu>をインストールメディアとして選択し、次に、インストールに使用するネットワークプロトコルの種類を選択します。<xref linkend="sec-prep-makeavail"/>には、さまざまなタイプのネットワーク接続でインストールデータを使用できるようにする方法が説明されています。現在は、<guimenu>FTP</guimenu>、<guimenu>HTTP</guimenu>、<guimenu>NFS</guimenu>、<guimenu>SMB/CIFS</guimenu>(Windowsファイル共有)がサポートされています。
  </para>
  <para>
   使用可能なデバイスのリストから、インストールデータを受信するためのOSAまたはHiperSocketsネットワークデバイスを選択します。このリストにはCTC、ESCON、またはIUCVデバイスも挙げられていることがありますが、これらは<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>ではサポート対象外となっています。
  </para>
  <sect3 xml:id="sec-prep-netcfg-hypersockets">
   <title>HiperSocketsインタフェースの設定</title>
   <para>
    ネットワークデバイスのリストからHiperSocketデバイスを選択します。続いて、次のように読み取りチャネル、書き込みチャネル、およびデータチャネルの各値を入力します。
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-types">
    <title>サポートされているネットワーク接続の種類とドライバパラメータ</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.0800]&gt; 0.0.0800

Device address for write channel. (Enter '+++' to abort).
[0.0.0801]&gt; 0.0.0801

Device address for data channel. (Enter '+++' to abort).
[0.0.0802]&gt; 0.0.0802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-osa">
   <title>OSA Expressデバイスの設定</title>
   <para>
    ネットワークデバイスのリストからOSA Expressデバイスを選択し、ポート番号を指定します。読み取りチャネル、書き込みチャネル、およびデータチャネルの各値を入力します。OSIレイヤ2のサポートを有効にするかどうかを選択します。
   </para>
   <para>
    新しい2ポートOSA Express 3ネットワークデバイスにはポート番号が必要です。OSA Express 3デバイスを使用しない場合は、「<literal>0</literal>」を入力します。OSA Expressカードは、<quote>OSIレイヤ2サポート</quote>モード、またはより一般的で古い<quote>レイヤ3</quote>モードでも実行できます。カードのモードは、他のLPAR上のシステムを含むデバイスを共有するすべてのシステムに影響します。不明な場合は、z/VMやz/OSなどの他のオペレーティングシステムで使用するデフォルトモードとの互換性を確保するために「<literal>2</literal>」を指定します。これらのオプションに関する詳細については、ハードウェア管理者にご相談ください。
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-gigabit-param">
    <title>ネットワークデバイスドライバのパラメータ</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-data">
   <title>ネットワークの設定とインストールソースの選択</title>
   <para>
    ネットワークデバイスのすべてのパラメータを入力すると、該当のドライバがインストールされ、対応するカーネルメッセージが表示されます。
   </para>
   <para>
    次に、ネットワークインタフェースパラメータの設定に、DHCP自動設定を使用するかどうかを決定する必要があります。DHCPは少数のデバイスのみで動作し、特別なハードウェア設定が必要なため、<guimenu>いいえ</guimenu>を選択します。これを実行すると、次のネットワークパラメータを指定するよう求められます。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      インストールするシステムのIPアドレス
     </para>
    </listitem>
    <listitem>
     <para>
      対応するネットマスク(IPアドレスで指定していない場合に入力)
     </para>
    </listitem>
    <listitem>
     <para>
      サーバにアクセスするためのゲートウェイのIPアドレス
     </para>
    </listitem>
    <listitem>
     <para>
      ドメイン名サーバ(DNS)で扱う検索ドメインのリスト
     </para>
    </listitem>
    <listitem>
     <para>
      ドメイン名サーバのIPアドレス
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex-prep-netcfg-vm-network-setup">
    <title>ネットワークパラメータ</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    最後にインストールサーバに関する必要な情報を提供します。この情報として、IPアドレス、インストールデータを格納しているディレクトリ、ログインアカウント情報などがあります。必要な情報が提供されるとインストールシステムがロードされます。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-connect">
  <title><phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムに接続する</title>
  <para>
   インストールシステムをロードした後で、linuxrcによりインストール手順を制御するためにどのタイプのディスプレイを選択するかが求められます。使用可能なオプションには、<literal>Remote X11</literal> (X Window System)、<literal>VNC</literal> (Virtual Network Computingプロトコル)、<literal>SSH</literal> (テキストモードまたはSecure Shellを介したX11インストール)、<literal>Text-based UI</literal>および<literal>Graphical UI</literal>があります。後者は、YaSTが存在する場合、ローカルグラフィックスディスプレイ上でグラフィカルモードでYaSTを起動します。s390xアーキテクチャでは、QEMUと<systemitem>virtio-gpu</systemitem>ドライバを使用してローカルグラフィックスディスプレイを実装できます。
   </para>
   <para>
   推奨されるオプションは、<literal>VNC</literal>または<literal>SSH</literal>です。
   </para>
  <para>
   <literal>Text-based UI</literal>オプションが選択される場合、YaSTはテキストモードで起動し、端末内で直接インストールを実行できます。<literal>Text-based UI</literal>オプションは、LPARにインストールするときにのみ役立ちます。
  </para>
  <note>
   <title>Text-based UIのターミナルエミュレーション</title>
   <para>
    テキストモードでYaSTを操作できるようにするには、VT220/Linuxエミュレーションを備えた端末(<literal>Text-based UI</literal>ともいいます)でYaSTを実行する必要があります。
   </para>
  </note>
  <sect3 xml:id="sec-inst-connect-vnc-inst">
   <title>VNCでのインストールの開始</title>
   <para>
    VNCを使用してインストールをリモート制御するには、次の手順に従います。
   </para>
   <procedure>
    <step>
     <para>
      <literal>VNC</literal>オプションを選択すると、VNCサーバが起動します。コンソールの短いメモには、vncviewerと接続するためのIPアドレスとディスプレイ番号が表示されます。
     </para>
    </step>
    <step>
     <para>
      <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のインストールシステムのIPアドレスとディスプレイ番号の入力を求められた場合は、これらの値を入力します。
     </para>
    </step>
    <step>
     <para>
      この入力を求められた場合は、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>インストールシステムのIPアドレスとディスプレイ番号を入力します。
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      接続が確立された後、YaSTを使用して<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>をインストールします。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-x">
   <title>X Window Systemでのインストールの開始</title>
   <important>
    <title>X認証メカニズム</title>
    <para>
     X Window Systemを使用する直接インストールでは、ホスト名に基づく認証メカニズムに依存します。現在のバージョンの<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>では、このメカニズムが無効になっています。SSHまたはVNCを使用してインストールを実行することをお勧めします。
    </para>
   </important>
   <para>
    X転送を使用してインストールをリモート制御するには、次の手順に従います。
   </para>
   <procedure>
    <step>
     <para>
      Xサーバを使用してクライアント(インストールされるシステム)の接続が可能なことを確認します。ファイル<filename>/etc/sysconfig/displaymanager</filename>に変数<command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command>を設定します。Xサーバを再起動し、コマンド<command>xhost
      <replaceable>CLIENT_IP_ADDRESS</replaceable></command>を使用して、サーバへのクライアントのバインドを行うことができるようにします。
     </para>
    </step>
    <step>
     <para>
      インストールシステムで入力するように指示されたら、Xサーバが稼働するコンピュータのIPアドレスを入力します。
     </para>
    </step>
    <step>
     <para>
      YaSTが起動されるまで待機してから、インストールを開始します。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-ssh">
   <title>SSHでのインストールの開始</title>
   <para>
    名前が<literal>earth</literal>であるインストールシステムにSSHを使用して接続するには、<command>ssh -X
    earth</command>コマンドを使用します。ワークステーションがMicrosoft Windowsで実行されている場合は、<link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/>で入手可能なPuttyツールを使用します。<guimenu>接続</guimenu>SSH<menuchoice>
    <guimenu>X11</guimenu> <guimenu>の順に選択して、Puttyで</guimenu> <guimenu>Enable X11 forwarding (X11転送を有効にする)</guimenu>
    </menuchoice>を設定します。
   </para>
   <para>
    別のオペレーティングシステムを使用する場合は、<command>ssh -X
    earth</command>を実行して、<systemitem>earth</systemitem>という名前のインストールシステムに接続します。ローカルXサーバが使用可能な場合は、SSHのX転送がサポートされます。使用可能でない場合は、YaSTによって、ncursesのテキストインタフェースが表示されます。
   </para>
   <para>
    プロンプト表示されたら、<literal>root</literal>ユーザ名を入力し、パスワードを使用してログインします。「<command>yast.ssh</command>」と入力してYaSTを起動します。その後、YaSTの指示に従ってインストール手順を実行します。
   </para>
   <important>
    <title>SSH経由でYaSTを使用する際の問題の修正</title>
    <para>
     特定の状況では、Xフォワーディングを使用してSSH経由でGUI版のYaSTを実行すると、次のエラーメッセージが出て失敗する場合があります。
    </para>
<screen>XIO: fatal IO error 11 (Resource temporarily unavailable) on X server "localhost:11.0"</screen>
    <para>
     この場合、次の2つの選択肢があります。
    </para>
    <itemizedlist>
     <listitem>
      <para>
       次のように、<option>QT_XCB_GL_INTEGRATION=none</option>オプションを指定してYaSTを実行します。
      </para>
<screen>QT_XCB_GL_INTEGRATION=none yast.ssh
QT_XCB_GL_INTEGRATION=none yast2 disk</screen>
     </listitem>
     <listitem>
      <para>
       Xフォワーディングを無効化するか、使用するUIにncursesを指定して、ncurses版のYaSTアプリケーションを実行する。後で実行するには、<command>yast2 disk --ncurses</command>または<command>YUI_PREFERED_BACKEND=ncurses yast2 disk</command>コマンドを使用します。
      </para>
     </listitem>
    </itemizedlist>
   </important>
   <para>
    <xref linkend="cha-install"/>の説明に従って、インストール手順を進めます。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-boot-procedure">
  <title>IBM Zでの<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>のブート手順</title>
  <para>
   SLES 10および11では、ブートプロセスはziplブートローダによって処理されていました。BtrfsパーティションからのブートとSnapperでのシステムロールバックのサポートを有効にするため、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>がIBM Zでブートする方法が変更されました。
  </para>
  <para>
   IBM Z対応の<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>では、GRUB 2がziplに取って代わりました。AMD64/Intel 64アーキテクチャのGRUB 2では、ファームウェアレベルで、ファイルシステムにアクセスするためのデバイスドライバが組み込まれています。メインフレームにはファームウェアがないため、GRUB 2への<literal>ccw</literal>の追加は、大変な作業であり、GRUB 2にziplを再実装する必要も生じます。そのため、<phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>は、2段階のアプローチを使用します。
  </para>
  <variablelist>
   <varlistentry>
    <term>第1段階:</term>
    <listitem>
     <para>
      カーネルとinitrdを含む別のパーティションが<filename>/boot/zipl</filename>にマウントされます。このカーネルとinitrdは、<filename>/boot/zipl/config</filename>の設定を使用して、ziplを介してロードされます。
     </para>
     <para>
      この設定は、<literal>initgrub</literal>というキーワードをカーネルコマンドラインに追加します。カーネルとinitrdがロードされると、initrdは、ルートファイルシステムをマウントするために必要なデバイスを有効化します(<filename>/boot/zipl/active_devices.txt</filename>を参照)。その後、GRUB 2ユーザ領域プログラムが開始され<filename>/boot/grub2/grub.cfg</filename>を読み込みます。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>第2段階:</term>
    <listitem>
     <para>
      <filename>/boot/grub2/grub.cfg</filename>で指定されたカーネルとinitrdは、<command>kexec</command>を介して起動されます。オンディスクシステムを起動するために必要な<filename>/boot/zipl/active_devices.txt</filename>に一覧表示されているデバイスが有効になります。リストの他のデバイスはホワイトリストに設定されますが、それ以外は無視されます。ルートファイルシステムがマウントされ、ブートプロシージャが他のアーキテクチャと同様に進みます。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  
 </sect2>
</sect1>
