<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="deployment_firstboot.xml" id="cha.deployment_firstboot">
 <title>Implantando pré-instalações personalizadas</title>
 <para>
  A implementação de pré-instalações personalizadas do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> em um grande número de máquinas idênticas dispensa a instalação de cada uma delas separadamente e oferece uma instalação padronizada para os usuários finais. Com o Firstboot do YaST, crie imagens de pré-instalação personalizadas e determine o workflow das etapas finais de personalização que envolvem interação do usuário final (ao contrário do AutoYaST, que permite instalações completamente automatizadas. Para obter mais informações, consulte o <xref linkend="cha.deployment.autoinst"/>).
 </para>
 <para>
  A criação de uma instalação personalizada, a implementação dessa instalação em seu hardware e a personalização do produto final envolve as seguintes etapas:
 </para>
 <procedure>
  <step performance="required">
   <para>
    Prepare a máquina master que tem o disco que precisa ser clonado para as máquinas clientes. Para obter mais informações, consulte a <xref linkend="sec.fb.master"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Personalize o workflow do firstboot. Para obter mais informações, consulte a <xref linkend="sec.fb.customize"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Clone o disco da máquina master e implemente essa imagem nos discos dos clientes. Para obter mais informações, consulte a <xref linkend="sec.fb.clone"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Oriente o usuário final a personalizar a instância do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Para obter mais informações, consulte a <xref linkend="sec.fb.personalize"/>.
   </para>
  </step>
 </procedure>
 <sect1 id="sec.fb.master">
  <title>Preparando a máquina master</title>

  <para>
   Para preparar uma máquina master para um workflow do firstboot, faça o seguinte:
  </para>

  <procedure>
   <step id="st.master1" performance="required">
    <para>
     Insira a mídia de instalação na máquina master.
    </para>
   </step>
   <step id="st.master2" performance="required">
    <para>
     Inicialize a máquina.
    </para>
   </step>
   <step id="st.master3" performance="required">
    <para>
     Execute uma instalação normal, incluindo todas as etapas de configuração necessárias, e aguarde a inicialização da máquina instalada. Instale também o pacote <systemitem>yast2-firstboot</systemitem>.
    </para>
   </step>
   <step id="st.master4" performance="required">
    <para>
     Para definir seu próprio workflow de etapas de configuração do YaST para o usuário final ou adicionar seus próprios módulos do YaST a esse workflow, continue na <xref linkend="sec.fb.customize"/>. Caso contrário, vá diretamente para a <xref linkend="st.master5"/>.
    </para>
   </step>
   <step id="st.master5" performance="required">
    <para>
     Habilite o firstboot como <systemitem class="username">root</systemitem>:
    </para>
    <para>
     Crie um arquivo vazio <filename>/var/lib/YaST2/reconfig_system</filename> para acionar a execução do firstboot. Esse arquivo será apagado após o término bem-sucedido da configuração do firstboot. Crie esse arquivo usando o seguinte comando:
    </para>
<screen>touch /var/lib/YaST2/reconfig_system</screen>
   </step>
   <step performance="required">
    <para>
     Prossiga para a <xref linkend="sec.fb.clone"/>.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.fb.customize">
  <title>Personalizando a instalação do firstboot</title>

  <para>
   Personalizar o workflow da instalação do firstboot pode envolver vários componentes diferentes. A personalização deles é opcional. Se você não fizer mudanças, o firstboot executará a instalação usando as configurações padrão. As seguintes opções estão disponíveis:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Personalizando mensagens ao usuário, conforme descrito na <xref linkend="sec.fb.customize.msg"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Personalizando licenças e ações de licença, conforme descrito na <xref linkend="sec.fb.customize.license"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Personalizando as notas de versão para exibição, conforme descrito na <xref linkend="sec.fb.customize.rn"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Personalizando a ordem e o número de componentes envolvidos na instalação, conforme descrito na <xref linkend="sec.fb.customize.wf"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Configurando scripts opcionais extras, conforme descrito na <xref linkend="sec.fb.customize.script"/>.
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Para personalizar qualquer um desses componentes, modifique os seguintes arquivos de configuração:
  </para>

  <variablelist>
   <varlistentry>
    <term><filename>/etc/sysconfig/firstboot</filename>
    </term>
    <listitem>
     <para>
      Configure vários aspectos do primeiro boot (como notas de versão, scripts e ações de licença).
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/YaST2/firstboot.xml</filename>
    </term>
    <listitem>
     <para>
      Configure o workflow de instalação, habilitando ou desabilitando componentes ou adicionando componentes personalizados.
     </para>
     <para>
      Traduza um workflow de instalação personalizado, conforme descrito na <xref linkend="sec.fb.provide.trans"/>.
     </para>
     <tip>
      <title>Local alternativo do arquivo de controle</title>
      <para>
       <filename>/etc/YaST2/firstboot.xml</filename> é o caminho padrão do arquivo de controle instalado pelo pacote <systemitem>yast2-firstboot</systemitem>. Caso seja necessário definir outro local para o arquivo de controle, edite <filename>/etc/sysconfig/firstboot</filename> e mude a variável <literal>FIRSTBOOT_CONTROL_FILE</literal> para o local de sua preferência.
      </para>
     </tip>
    </listitem>
   </varlistentry>
  </variablelist>



  <para>
   Para personalizar mais do que apenas os componentes do workflow, consulte a documentação do <filename>control.xml</filename> em <ulink url="http://doc.opensuse.org/projects/YaST/SLES11/tdg/inst_in_general_chap.html#product_control"/>.
  </para>

  <sect2 id="sec.fb.customize.msg">
   <title>Personalizando as mensagens do YaST</title>
   <para>
    Por padrão, a instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> apresenta várias mensagens predefinidas que são localizadas e exibidas em determinadas fases do processo de instalação. Elas incluem uma mensagem de boas-vindas, uma mensagem de licença e uma mensagem de felicitação no final da instalação. Você pode substituir qualquer uma delas por suas próprias versões e incluir versões localizadas dessas mensagens na instalação. Para incluir sua própria mensagem de boas-vindas, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Efetue login como <systemitem class="username">root</systemitem>.
     </para>
    </step>
    <step performance="required">
     <para>
      Abra o arquivo de configuração <filename>/etc/sysconfig/firstboot</filename> e aplique as seguintes mudanças:
     </para>
     <substeps performance="required">
      <step performance="required">
       <para>
        Defina <envar>FIRSTBOOT_WELCOME_DIR</envar> como o caminho de diretório em que deseja armazenar os arquivos contendo a mensagem de boas-vindas e as versões localizadas, por exemplo:
       </para>
<screen>FIRSTBOOT_WELCOME_DIR="/usr/share/firstboot/"
</screen>
      </step>
      <step performance="required">
       <para>
        Se a sua mensagem de boas-vindas tiver nomes de arquivo diferentes de <filename>welcome.txt</filename> e <filename>welcome_<replaceable>idioma</replaceable>.txt</filename> (em que <replaceable>idioma</replaceable> corresponde aos códigos de idioma ISO 639, como <quote>cs</quote> ou <quote>de</quote>), especifique o padrão do nome de arquivo em <envar>FIRSTBOOT_WELCOME_PATTERNS</envar>. Por exemplo:
       </para>
<screen>FIRSTBOOT_WELCOME_PATTERNS="mywelcome.txt"</screen>
       <para>
        Se não for definido, o valor padrão de <filename>welcome.txt</filename> será considerado.
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      Crie o arquivo de boas-vindas e as versões localizadas e insira-os no diretório especificado no arquivo de configuração <filename>/etc/sysconfig/firstboot</filename>.
     </para>
    </step>
   </procedure>
   <para>
    Execute um procedimento semelhante para configurar mensagens personalizadas de licença e de conclusão. Essas variáveis são <envar>FIRSTBOOT_LICENSE_DIR</envar> e <envar>FIRSTBOOT_FINISH_FILE</envar>.
   </para>
   <para>
    Mude <envar>SHOW_Y2CC_CHECKBOX</envar> para <quote>yes</quote>, se o usuário tiver que iniciar o YaST diretamente após realizar a instalação.
   </para>
  </sect2>

  <sect2 id="sec.fb.customize.license">
   <title>Personalizando a ação de licença</title>
   <para>
    É possível personalizar a maneira como o sistema de instalação reage quando o usuário não aceita o contrato de licença. Há três maneiras diferentes para o sistema reagir a esse cenário:
   </para>
   <variablelist>
    <varlistentry>
     <term>halt</term>
     <listitem>
      <para>
       A instalação do firstboot é interrompida e todo o sistema é encerrado. Essa é a configuração padrão.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Continuar</term>
     <listitem>
      <para>
       A instalação do firstboot continua.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>interromper</term>
     <listitem>
      <para>
       A instalação no primeiro boot é interrompida, mas o sistema tenta inicializar.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Faça sua escolha e defina <envar>LICENSE_REFUSAL_ACTION</envar> para o valor apropriado.
   </para>
  </sect2>

  <sect2 id="sec.fb.customize.rn">
   <title>Personalizando as notas de versão</title>
   <para>
    Se você mudar a instância do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> que está implantando com o firstboot, provavelmente precisará explicar aos usuários finais sobre os aspectos importantes de seu novo sistema operacional. A instalação padrão usa as notas de versão (exibidas durante uma das fases finais da instalação) para fornecer informações importantes aos usuários. Para que suas próprias notas de versão modificadas sejam exibidas como parte de uma instalação do firstboot, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Crie seu próprio arquivo de notas de versão. Use o formato RTF como no arquivo de exemplo em <filename>/usr/share/doc/release-notes</filename> e grave o resultado como <filename>RELEASE-NOTES.en.rtf</filename> (para inglês).
     </para>
    </step>
    <step performance="required">
     <para>
      Armazene as versões localizadas opcionais perto da versão original e substitua a parte <literal>en</literal> do nome de arquivo pelo código de idioma ISO 639 real, como <literal>de</literal> para alemão.
     </para>
    </step>
    <step performance="required">
     <para>
      Abra o arquivo de configuração do firstboot de <filename>/etc/sysconfig/firstboot</filename> e defina <envar>FIRSTBOOT_RELEASE_NOTES_PATH</envar> como o diretório real no qual os arquivos de notas de versão serão armazenados.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 id="sec.fb.customize.wf">
   <title>Personalizando o workflow</title>
   <para>
    Por padrão, um workflow de firstboot padrão inclui os seguintes componentes:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Seleção de idioma
     </para>
    </listitem>
    <listitem>
     <para>
      Bem-vindo
     </para>
    </listitem>

    <listitem>
     <para>
      Contrato de Licença
     </para>
    </listitem>
    <listitem>
     <para>
      Nome do Host
     </para>
    </listitem>

    <listitem>
     <para>
      Rede
     </para>
    </listitem>

    <listitem>
     <para>
      Horário e data
     </para>
    </listitem>

    <listitem>
     <para>
      Desktop
     </para>
    </listitem>
    <listitem>
     <para>
      Senha de root
     </para>
    </listitem>
    <listitem>
     <para>
      Método de Autenticação do Usuário
     </para>
    </listitem>
    <listitem>
     <para>
      Gerenciamento de Usuário
     </para>
    </listitem>
    <listitem>
     <para>
      Configuração de hardware
     </para>
    </listitem>
    <listitem>
     <para>
      Terminar Configuração
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Esse layout padrão de um workflow de instalação de firstboot não é obrigatório. É possível habilitar ou desabilitar determinados componentes ou integrar seus próprios módulos ao workflow. Para modificar o workflow do firstboot, edite manualmente o arquivo de configuração do firstboot <filename>/etc/YaST2/firstboot.xml</filename>. Esse arquivo XML é um subconjunto do arquivo padrão <filename>control.xml</filename> usado pelo YaST para controlar o workflow de instalação.
   </para>
   <para>
    Para obter uma visão geral das propostas, consulte o <xref linkend="ex.fb.proposal"/>. Ela fornece informações básicas suficientes para modificar o workflow de instalação do firstboot. A sintaxe básica do arquivo de configuração do primeiro boot (e como os elementos principais são configurados) é explicada neste exemplo.
   </para>
   <example id="ex.fb.proposal">
    <title>Configurando as telas de proposta</title>
<screen>
    …
    &lt;proposals config:type="list"&gt;<co id="co.fb.plist"/>
        &lt;proposal&gt;<co id="co.fb.p"/>
            &lt;name&gt;firstboot_hardware&lt;/name&gt;<co id="co.fb.pname"/>
            &lt;mode&gt;installation&lt;/mode&gt;<co id="co.fb.pmode"/>
            &lt;stage&gt;firstboot&lt;/stage&gt;<co id="co.fb.pstage"/>
            &lt;label&gt;Hardware Configuration&lt;/label&gt;<co id="co.fb.plabel"/>
            &lt;proposal_modules config:type="list"&gt;<co id="co.fb.pmodl"/>
                &lt;proposal_module&gt;printer&lt;/proposal_module&gt;<co id="co.fb.pmod"/>
            &lt;/proposal_modules&gt;
        &lt;/proposal&gt;
        &lt;proposal&gt;
        …
        &lt;/proposal&gt;
    &lt;/proposals&gt;
   </screen>
   </example>
   <calloutlist>
    <callout arearefs="co.fb.plist">
     <para>
      O container de todas as propostas que devem fazer parte do workflow de firstboot.
     </para>
    </callout>
    <callout arearefs="co.fb.p">
     <para>
      O container de uma proposta individual.
     </para>
    </callout>
    <callout arearefs="co.fb.pname">
     <para>
      O nome interno da proposta.
     </para>
    </callout>
    <callout arearefs="co.fb.pmode">
     <para>
      O modo desta proposta. Não faça mudanças aqui. Para uma instalação de firstboot, isso deve ser definido como <literal>installation</literal>.
     </para>
    </callout>
    <callout arearefs="co.fb.pstage">
     <para>
      O estágio do processo de instalação em que esta proposta é chamada. Não faça mudanças aqui. Para uma instalação de firstboot, isso deve ser definido como <literal>firstboot</literal>.
     </para>
    </callout>
    <callout arearefs="co.fb.plabel">
     <para>
      O rótulo a ser exibido na proposta.
     </para>
    </callout>
    <callout arearefs="co.fb.pmodl">
     <para>
      O container de todos os módulos que fazem parte da tela de proposta.
     </para>
    </callout>
    <callout arearefs="co.fb.pmod">
     <para>
      Um ou mais módulos que fazem parte da tela de proposta.
     </para>
    </callout>
   </calloutlist>
   <para>
    A seção seguinte do arquivo de configuração de firstboot consiste na definição do workflow. Todos os módulos que devem fazer parte do workflow de instalação de firstboot devem ser listados aqui.
   </para>
   <example id="ex.fb.wf">
    <title>Configurando a seção de workflow</title>
<screen>
    &lt;workflows  config:type="list"&gt;
        &lt;workflow&gt;
            &lt;defaults&gt;
                &lt;enable_back&gt;yes&lt;/enable_back&gt;
                &lt;enable_next&gt;yes&lt;/enable_next&gt;
                &lt;archs&gt;all&lt;/archs&gt;
            &lt;/defaults&gt;
            &lt;stage&gt;firstboot&lt;/stage&gt;
            &lt;label&gt;Configuration&lt;/label&gt;
            &lt;mode&gt;installation&lt;/mode&gt;
            … &lt;!–– list of modules  ––&gt;
            &lt;/modules&gt;
        &lt;/workflow&gt;
    &lt;/workflows&gt;
    …
  </screen>
   </example>
   <para>
    A estrutura geral da seção <literal>workflows</literal> é bem semelhante à da seção <literal>proposals</literal>. Um container inclui os elementos do workflow, e todos os elementos do workflow incluem as informações sobre fase, rótulo e modo (exatamente como as propostas apresentadas no <xref linkend="ex.fb.proposal"/>). A diferença mais significativa é a seção <filename>defaults</filename>, que contém informações básicas de design para os componentes de workflow:
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>enable_back</literal>
     </term>
     <listitem>
      <para>
       Inclua o botão <guimenu>Voltar</guimenu> em todas as caixas de diálogo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>enable_next</literal>
     </term>
     <listitem>
      <para>
       Inclua o botão <guimenu>Avançar</guimenu> em todas as caixas de diálogo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>archs</literal>
     </term>
     <listitem>
      <para>
       Especifique as arquiteturas de hardware nas quais este workflow deve ser usado.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <example id="ex.fb.wfmod">
    <title>Configurando a lista de componentes de workflow</title>
<screen>
    &lt;modules  config:type="list"&gt;<co id="co.fb.modl"/>
        &lt;module&gt;<co id="co.fb.mod"/>
            &lt;label&gt;Language&lt;/label&gt;<co id="co.fb.label"/>
            &lt;enabled config:type="boolean"&gt;false&lt;/enabled&gt;<co id="co.fb.en"/>
            &lt;name&gt;firstboot_language&lt;/name&gt;<co id="co.fb.name"/>
        &lt;/module&gt;
    &lt;modules&gt;
  </screen>
   </example>
   <calloutlist>
    <callout arearefs="co.fb.modl">
     <para>
      O container de todos os componentes do workflow.
     </para>
    </callout>
    <callout arearefs="co.fb.mod">
     <para>
      A definição do módulo.
     </para>
    </callout>
    <callout arearefs="co.fb.label">
     <para>
      O rótulo exibido com o módulo.
     </para>
    </callout>
    <callout arearefs="co.fb.en">
     <para>
      O switch para habilitar ou desabilitar este componente no workflow.
     </para>
    </callout>
    <callout arearefs="co.fb.name">
     <para>
      O nome do módulo. O módulo deve estar localizado em <filename>/usr/share/YaST2/clients</filename> e ter o sufixo de arquivo <filename>.ycp</filename>.
     </para>
    </callout>
   </calloutlist>
   <para>
    Para fazer mudanças no número ou na ordem das telas de proposta durante a instalação do firstboot, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Abra o arquivo de configuração de firstboot em <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Apague ou adicione telas de proposta ou mude a ordem das telas existentes:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Para apagar toda a proposta, remova o elemento <literal>proposal</literal>, incluindo todos os seus subelementos, da seção <literal>proposals</literal> e remova o respectivo elemento <literal>module</literal> (com os subelementos) do workflow.
       </para>
      </listitem>
      <listitem>
       <para>
        Para adicionar uma nova proposta, crie um novo elemento <literal>proposal</literal> e preencha todos os subelementos necessários. Verifique se a proposta existe como um módulo do YaST em <filename>/usr/share/YaST2/clients</filename>.
       </para>
      </listitem>
      <listitem>
       <para>
        Para mudar a ordem das propostas, mova os respectivos elementos <literal>module</literal> que contêm as telas de proposta no workflow. Observe que é possível haver dependências em relação a outras etapas de instalação que exijam uma ordem específica de propostas e componentes de workflow.
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step performance="required">
     <para>
      Aplique suas mudanças e feche o arquivo de configuração.
     </para>
    </step>
   </procedure>
   <para>
    Você poderá sempre mudar o workflow das etapas de configuração quando o padrão não atender às suas necessidades. Habilitar ou desabilitar alguns módulos do workflow (ou adicionar módulos personalizados).
   </para>
   <para>
    Para alternar o status de um módulo no workflow de firstboot, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Abra o arquivo de configuração <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Mude o valor do elemento <literal>enabled</literal> de <literal>true</literal> para <filename>false</filename>, para desabilitar o módulo, ou de <literal>false</literal> para <literal>true</literal>, para habilitá-lo novamente.
     </para>
<screen>
&lt;module&gt;
    &lt;label&gt;Time and Date&lt;/label&gt;
    &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
    &lt;name&gt;firstboot_timezone&lt;/name&gt;
&lt;/module&gt;
</screen>
    </step>
    <step performance="required">
     <para>
      Aplique suas mudanças e feche o arquivo de configuração.
     </para>
    </step>
   </procedure>
   <para>
    Para adicionar um módulo personalizado ao workflow, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Crie seu próprio módulo do YaST e armazene o arquivo de módulo <filename><replaceable>nome_do_módulo</replaceable>.ycp</filename> em <filename>/usr/share/YaST2/clients</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Abra o arquivo de configuração <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Determine em que ponto do workflow o novo módulo deverá ser executado. Ao fazer isso, lembre-se de considerar e resolver possíveis dependências em relação a outras etapas do workflow.
     </para>
    </step>
    <step performance="required">
     <para>
      Crie um novo elemento <literal>module</literal> dentro do container <literal>modules</literal> e adicione os subelementos apropriados:
     </para>
<screen>&lt;modules config:type="list"&gt;
     …
     &lt;module&gt;
        &lt;label&gt;<replaceable>my_module</replaceable>&lt;/label&gt;
        &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
        &lt;name&gt;<replaceable>filename_my_module</replaceable>&lt;/name&gt;
     &lt;/module&gt;
&lt;/modules&gt;
</screen>
     <substeps performance="required">
      <step performance="required">
       <para>
        Digite o rótulo que será exibido no seu módulo no elemento <literal>label</literal>.
       </para>
      </step>
      <step performance="required">
       <para>
        Verifique se <literal>enabled</literal> está definido como <literal>true</literal> para que seu módulo seja incluído no workflow.
       </para>
      </step>
      <step performance="required">
       <para>
        Digite o nome de arquivo do módulo no elemento <literal>name</literal>. Omita o caminho completo e o sufixo <filename>.ycp</filename>.
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      Aplique suas configurações e feche o arquivo de configuração.
     </para>
    </step>
   </procedure>
   <tip>
    <title>Localizando interface de rede conectada para configuração automática</title>
    <para>
     Se o hardware de destino puder ter mais de uma interface de rede, adicione o pacote <systemitem>network-autoconfig</systemitem> à imagem do aplicativo. O <systemitem>network-autoconfig</systemitem> verifica se, durante o firstboot, todas as interfaces Ethernet disponíveis são testadas em ciclo até que uma seja configurada com êxito com o DHCP.
    </para>
   </tip>
  </sect2>

  <sect2 id="sec.fb.customize.script">
   <title>Configurando scripts adicionais</title>
   <para>
    É possível configurar o primeiro boot para executar scripts adicionais após a conclusão do workflow de primeiro boot. Para adicionar mais scripts à sequência de firstboot, faça o seguinte:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Abra o arquivo de configuração <filename>/etc/sysconfig/firstboot</filename> e verifique se o caminho especificado para <envar>SCRIPT_DIR</envar> está correto. O valor padrão é <filename>/usr/share/firstboot/scripts</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Crie seu script shell, armazene-o no diretório especificado e aplique as permissões de arquivo apropriadas.
     </para>
    </step>
   </procedure>
  </sect2>



  <sect2 id="sec.fb.provide.trans">
   <title>Traduzindo o workflow de instalação</title>
   <para>
    Dependendo do usuário final, convém oferecer traduções do workflow personalizado. Essas traduções poderão ser necessárias, caso tenha personalizado o workflow mudando o arquivo <filename>/etc/YaST2/firstboot.xml</filename>, conforme descrito na <xref linkend="sec.fb.customize.wf"/>. Isso é diferente da localização de mensagens personalizadas do YaST, que já está descrita na <xref linkend="sec.fb.customize.msg"/>.
   </para>
   <para>
    Se você modificar <filename>/etc/YaST2/firstboot.xml</filename> e fizer mudanças na string, gere um novo arquivo de gabarito de tradução (arquivo <filename>.pot</filename>) e use a cadeia de ferramentas <systemitem>gettext</systemitem> para traduzir e, por fim, instalar os arquivos traduzidos nos diretórios de idiomas do YaST (<filename>/usr/share/YaST2/locale</filename>) como arquivos <filename>.mo</filename> compilados. Proceda da seguinte maneira:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Mude a configuração <systemitem>textdomain</systemitem> de:
     </para>
<screen>&lt;textdomain&gt;firstboot&lt;/textdomain&gt;</screen>
     <para>
      para, por exemplo,
     </para>
<screen>&lt;textdomain&gt;firstboot-oem&lt;/textdomain&gt;</screen>
    </step>
    <step performance="required">
     <para>
      Use <command>xgettext</command> para extrair as strings traduzíveis para o arquivo de modelo de tradução (arquivo <filename>.pot</filename>) para, por exemplo, <filename>firstboot-oem.pot</filename>:
     </para>
<screen>xgettext -L Glade -o firstboot-oem.pot /etc/YaST2/firstboot.xml</screen>
    </step>
    <step performance="required">
     <para>
      Inicie o processo de tradução. Empacote os arquivos traduzidos (<filename>.arquivos <replaceable>LL_code</replaceable>.po</filename>) da mesma forma que as traduções de outros projetos e instale os arquivos compilados <filename>firstboot-oem.mo</filename>.
     </para>
    </step>
   </procedure>
   <para>
    Se você precisar de traduções para módulos adicionais ou modificados do YaST, traduza dentro do próprio módulo. Se você mudar um módulo existente, mude também sua declaração de domínio de texto para evitar efeitos colaterais indesejados.
   </para>
   <tip>
    <title>Para obter mais informações</title>
    <para>
     Para obter mais informações sobre o desenvolvimento do YaST, visite <ulink url="http://en.opensuse.org/openSUSE:YaST_development"/>. Para obter informações detalhadas sobre o firstboot do YaST, visite <ulink url="http://doc.opensuse.org/projects/YaST/SLES11/tdg/bk09ch01s02.html"/>.
    </para>
   </tip>
  </sect2>
 </sect1>
 <sect1 id="sec.fb.clone">
  <title>Clonando a instalação master</title>

  <para>
   Clone o disco da máquina master usando qualquer mecanismo de criação de imagens disponível e implante essas imagens nas máquinas de destino. Para obter mais informações sobre criação de imagens, consulte <ulink url="http://doc.opensuse.org/projects/kiwi/doc/"/>.
  </para>
 </sect1>
 <sect1 id="sec.fb.personalize">
  <title>Personalizando a instalação</title>

  <para>
   Assim que a imagem de disco clonada for inicializada, o firstboot será iniciado e a instalação continuará exatamente conforme descrito na <xref linkend="sec.fb.customize.wf"/>. Apenas os componentes incluídos na configuração do workflow de firstboot serão iniciados. Todas as outras etapas de instalação são ignoradas. O usuário final ajustará as configurações de idioma, teclado, rede e senha para personalizar a estação de trabalho. Após o término deste processo, o sistema instalado pelo firstboot terá o mesmo comportamento de qualquer outra instância do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
  </para>
 </sect1>
</chapter>
