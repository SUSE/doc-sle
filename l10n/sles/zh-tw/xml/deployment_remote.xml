<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_remote.xml" version="5.0" role="General" xml:id="cha-remote-installation">
 <title>遠端安裝</title>
 <info>
  <abstract>
   <para>
    <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase> 的安裝過程全部都可透過網路執行。本章介紹如何提供所需的環境，以透過網路開機、安裝和控制安裝。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <sect1 xml:id="sec-remote-installation-overview">
  <title>綜覽</title>

  <para>
   若要進行遠端安裝，需要考慮如何開機、如何控制安裝，以及安裝資料的來源。您可以將所有可用選項互相結合使用 (如果它們適用於您的硬體平台)。
  </para>

  <variablelist>
   <varlistentry>
    <term>開機方法</term>
    <listitem>
     <para>
      根據所用的硬體，可以使用多種方式來將系統開機。常用的方式包括 DVD、USB 磁碟機或 PXE 開機。如需平台的詳細資訊，請參閱<xref linkend="part-prep"/>。
     </para>
     <para os="sles">
      若要透過 PXE 設定用於開機的伺服器，請參閱<xref linkend="cha-deployment-prep-pxe"/>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>資料來源</term>
    <listitem>
     <para>
      最常見的做法是將 DVD 或 USB 磁碟機當成 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的安裝來源使用。也可以使用安裝伺服器。在這種情況下，請使用 <literal>install</literal> 開機參數來指定來源。如需詳細資訊，請參閱<xref linkend="sec-boot-parameters-list-install-source"/>。
     </para>
     <para os="sles">
      若要使用網路來源進行安裝，請依據<xref linkend="cha-deployment-instserver"/>中所述準備一部伺服器。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>控制安裝</term>
    <listitem>
     <para>
      您可以透過 SSH、VNC 或機器的序列主控台來控制安裝，而無需使用直接連接至目標機器的鍵盤和顯示器。<xref linkend="sec-remote-installation-monitor-vnc"/>、<xref linkend="sec-remote-installation-monitor-ssh"/>和<xref linkend="sec-remote-installation-monitor-serial"/>章節對此做了介紹。
     </para>
     <para os="sles;slemicro">
      您可以使用 AutoYaST 將安裝程序完全自動化，而無需手動控制安裝。如需詳細資訊，請參閱<xref linkend="book-autoyast"/>。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="sec-remote-installation-scenario">
  <title>遠端安裝方案</title>

  <para>
   此章節將介紹最常用於遠端安裝的安裝方式。不論使用哪個方式，都必須仔細檢查先決條件清單，並依照該安裝方式中說明的程序進行安裝。如果需要某個特定步驟的詳細說明，請連接至每個步驟中提供的連結以取得說明。
  </para>

  <sect2 xml:id="sec-remote-installation-scenario-vncstat">
   <title>透過 VNC 從來源媒體安裝</title>
   <para>
    此安裝類型仍需要某個程度的實體存取權限，以便存取並啟動目標系統來進行安裝。由使用 VNC 連接至安裝程式的遠端工作站控制安裝。這時也必須執行像<xref linkend="cha-install"/> 所述手動安裝時的使用者互動。
   </para>
   <para>
    使用此安裝類型時，請確定已符合以下需求：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      執行網路連接的目標系統。
     </para>
    </listitem>
    <listitem>
     <para>
      具有有效網路連接，且裝有 VNC 檢視器軟體或啟用了 JavaScript 的瀏覽器 (Firefox、Chromium、Internet Explorer、Opera 等) 的控制系統。
     </para>
    </listitem>
    <listitem>
     <para>
      安裝 DVD 或 USB 隨身碟。
     </para>
    </listitem>
   </itemizedlist>
   <procedure xml:id="pro-remote-installation-scenario-vncstat">
    <para>
     若要執行此安裝類型，請按照下列步驟進行：
    </para>
    
    <step>
     <para>
      使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 媒體套件的安裝媒體 (USB 隨身碟) 將目標系統開機。
     </para>
    </step>
    <step>
     <para>
      當目標系統的開機畫面出現時，使用開機參數提示來設定 VNC 選項，並視需要設定靜態網路組態。如需開機參數的資訊，請參閱<xref linkend="cha-boot-parameters"/>。
     </para>
     <substeps>
      <step>
       <para>
        靜態網路組態的開機參數：
       </para>
<screen>netdevice=<replaceable>NETDEVICE</replaceable> hostip=<replaceable>IP_ADDRESS</replaceable> netmask=<replaceable>NETMASK</replaceable> gateway=<replaceable>IP_GATEWAY</replaceable> vnc=1 VNCPassword=<replaceable>PASSWORD</replaceable></screen>
      </step>
      <step>
       <para>
        動態 (DHCP) 網路組態的開機參數：
       </para>
<screen>vnc=1 VNCPassword=<replaceable>PASSWORD</replaceable></screen>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      目標系統會啟動到以文字模式為基礎的環境，並提供網路位址和顯示編號，而 VNC 檢視器應用程式或瀏覽器必須使用這些資訊才可在圖形安裝環境下進行安裝。VNC 安裝透過 OpenSLP 宣告自身的存在，以及防火牆設定是否允許。這些可透過 <command>slptool</command> 找到，如<xref linkend="sec-remote-installation-monitor-vnc-prep"/>中所述。
     </para>
    </step>
    <step>
     <para>
      接著，請在控制工作站上開啟 VNC 檢視應用程式或網頁瀏覽器，並依照<xref linkend="sec-remote-installation-monitor-vnc"/> 中的說明連接到目標系統。
     </para>
    </step>
    <step>
     <para>
      依照<xref linkend="cha-install"/> 所述步驟執行安裝。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-remote-installation-scenario-vncpxe">
   <title>透過 VNC 從網路安裝</title>
   <para>
    這種安裝不需要與目標電腦直接互動。透過 PXE 將系統開機，並從伺服器擷取安裝資料。
   </para>
   <para>
    若要執行此安裝類型，請確定已符合以下需求：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      至少有一部可用於安裝 DHCP、NFS、HTTP、FTP、TFTP 或 SMB 伺服器的機器。
     </para>
    </listitem>
    <listitem>
     <para>
      可以透過 PXE 開機、可連接網路並具有網路喚醒功能的目標系統，且需插入和連接到網路。
     </para>
    </listitem>
    <listitem>
     <para>
      具有有效網路連接，且裝有 VNC 檢視器軟體或啟用了 JavaScript 的瀏覽器 (Firefox、Chromium、Microsoft Edge、Opera 等) 的控制系統。
     </para>
    </listitem>
   </itemizedlist>
   <procedure xml:id="pro-remote-installation-scenario-vncpxe">
    <para>
     若要執行此安裝類型，請按照下列步驟進行：
    </para>
    
    <step>
     <para>
      設定包含安裝資料的伺服器。<phrase os="sles">如需詳細資料，請參閱<xref linkend="part-installserver"/>。</phrase>
     </para>
    </step>
    <step>
     <para>
      為網路設定 DHCP 和 TFTP 伺服器。<phrase os="sles"><xref linkend="cha-deployment-prep-pxe"/>中對此做了介紹。</phrase>新增所需的開機參數，以啟用 VNC 伺服器。
     </para>
    </step>
    <step>
     <para>
      在目標機器韌體中啟用 PXE 開機。<phrase os="sles">如需詳細資訊，請參閱<xref linkend="sec-deployment-prep-boot-pxeprep"/>。</phrase>
     </para>
    </step>
    <step>
     <para>
      使用網路喚醒功能啟動目標系統的開機程序。<phrase os="sles"><xref linkend="sec-deployment-prep-boot-wol"/>中對此做了介紹。</phrase>
     </para>
    </step>
    <step>
     <para>
      在控制工作站上，<phrase os="sles">依<xref linkend="sec-remote-installation-monitor-vnc"/></phrase>中所述開啟 VNC 檢視應用程式或網頁瀏覽器，並連接至目標系統。
     </para>
    </step>
    <step>
     <para>
      依照<xref linkend="cha-install"/> 所述步驟執行安裝。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-remote-installation-scenario-sshstat">
   <title>透過 SSH 從來源媒體安裝</title>
   <para>
    此安裝類型仍需要某個程度的實體存取權限，以便存取並啟動目標系統並決定安裝目標的 IP 位址。安裝本身完全受控於遠端工作站，遠端工作站會使用 SSH 連接至安裝程式。這時也必須執行像<xref linkend="cha-install"/> 所述一般安裝時的使用者互動。
   </para>
   <para>
    使用此安裝類型時，請確定已符合以下需求：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      執行網路連接的目標系統。
     </para>
    </listitem>
    <listitem>
     <para>
      執行網路連接和 SSH 用戶端軟體的控制系統。
     </para>
    </listitem>
    <listitem>
     <para>
      安裝 DVD 或 USB 隨身碟。
     </para>
    </listitem>
   </itemizedlist>
   <procedure xml:id="pro-remote-installation-scenario-sshstat">
    <para>
     若要執行此安裝類型，請按照下列步驟進行：
    </para>
    <step>
     <para>
      <phrase os="sles">依<xref linkend="part-installserver"/></phrase>中所述設定安裝目標和安裝伺服器。
     </para>
    </step>
    <step>
     <para>
      使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 媒體套件的安裝媒體 (USB 隨身碟) 將目標系統開機。
     </para>
    </step>
    <step>
     <para>
      當目標系統的開機畫面出現時，使用開機參數提示來設定 SSH 選項，並視需要設定靜態網路組態。如需開機參數的資訊，請參閱<xref linkend="cha-boot-parameters"/>。
     </para>
     <substeps>
      <step>
       <para>
        靜態網路組態的開機參數：
       </para>
<screen>netdevice=<replaceable>NETDEVICE</replaceable> hostip=<replaceable>IP_ADDRESS</replaceable> netmask=<replaceable>NETMASK</replaceable> gateway=<replaceable>IP_GATEWAY</replaceable> ssh=1 ssh.password=<replaceable>PASSWORD</replaceable></screen>
      </step>
      <step>
       <para>
        動態 (DHCP) 網路組態的開機參數：
       </para>
<screen>ssh=1 ssh.password=<replaceable>PASSWORD</replaceable></screen>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      目標系統會啟動到以文字模式為基礎的環境，並提供網路位址，而所有 SSH 用戶端必須使用這些資訊才可在圖形安裝環境下進行安裝。
     </para>
    </step>
    <step>
     <para>
      接著，請在控制工作站上開啟終端機視窗，並依照<xref linkend="sec-remote-installation-monitor-ssh-connect"/> 中的說明連接到目標系統。
     </para>
    </step>
    <step>
     <para>
      依照<xref linkend="cha-install"/> 所述步驟執行安裝。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-remote-installation-scenario-sshpxe">
   <title>透過 SSH 從網路安裝</title>
   <para>
    這種安裝不需要與目標電腦直接互動。透過 PXE 將系統開機，並從伺服器擷取安裝資料。
   </para>
   <para>
    若要執行此安裝類型，請確定已符合以下需求：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      至少有一部可用於安裝 DHCP、NFS、HTTP、FTP、TFTP 或 SMB 伺服器的機器。
     </para>
    </listitem>
    <listitem>
     <para>
      可以透過 PXE 開機、可連接網路並具有網路喚醒功能的目標系統，且需插入和連接到網路。
     </para>
    </listitem>
    <listitem>
     <para>
      具有有效網路連接和 SSH 檢視器軟體的控制系統。
     </para>
    </listitem>
   </itemizedlist>
   <procedure xml:id="pro-remote-installation-scenario-sshpxe">
    <para>
     若要執行此安裝類型，請按照下列步驟進行：
    </para>
    <step>
     <para>
      設定包含安裝資料的伺服器。<phrase os="sles">如需詳細資料，請參閱<xref linkend="part-installserver"/>。</phrase>
     </para>
    </step>
    <step>
     <para>
      為網路設定 DHCP 和 TFTP 伺服器。<phrase os="sles"><xref linkend="cha-deployment-prep-pxe"/>中對此做了描述。</phrase>新增所需的開機參數，以啟用 SSH 伺服器。
     </para>
    </step>
    <step>
     <para>
      在目標機器韌體中啟用 PXE 開機。<phrase os="sles">如需詳細資訊，請參閱<xref linkend="sec-deployment-prep-boot-pxeprep"/>。</phrase>
     </para>
    </step>
    <step>
     <para>
      使用網路喚醒功能啟動目標系統的開機程序。<phrase os="sles"><xref linkend="sec-deployment-prep-boot-wol"/>中對此做了介紹。</phrase>
     </para>
    </step>
    <step>
     <para>
      在控制工作站上，<phrase os="sles">依<xref linkend="sec-remote-installation-monitor-ssh"/></phrase>中所述開啟 SSH 用戶端軟體，並連接至目標系統。
     </para>
    </step>
    <step>
     <para>
      依照<xref linkend="cha-install"/> 所述步驟執行安裝。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-remote-installation-monitor-vnc">
  <title>透過 VNC 監控安裝</title>

  <para>
   您可以使用任何 VNC 檢視器軟體，在絕大多數作業系統上遠端控制 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的安裝。本節將介紹如何使用 VNC 檢視器應用程式或網頁瀏覽器來進行安裝。
  </para>

  <sect2 xml:id="sec-remote-installation-monitor-vnc-prep">
   <title>準備進行 VNC 安裝</title>
   <para>
    若要在安裝目標中啟用 VNC，請在安裝首次開機時指定相應的開機參數 (參閱<xref linkend="cha-boot-parameters"/>)。目標系統將會啟動到以文字為基礎的環境，接著，請等待 VNC 用戶端連接到安裝程式。
   </para>
   <para>
    安裝程式將會宣告進行連接安裝時所需要的 IP 位址和顯示編號。如果您有實體存取目標系統的權限，系統開機後會隨即提供用於安裝的資訊。當 VNC 用戶端軟體提示輸入資料時，請輸入資料並提供您的 VNC 密碼。
   </para>
   <para>
    由於安裝目標透過 OpenSLP 通告自身，因此您可以透過 SLP 瀏覽器擷取安裝目標的位址資訊。如果網路設定和所有機器都支援 OpenSLP，則您不需要與安裝目標本身有實體接觸：
   </para>
   <procedure xml:id="pro-remote-installation-monitor-vnc-prep">
    <title>透過 OpenSLP 為 VNC 安裝定址</title>
    <step>
     <para>
      執行 <command>slptool findsrvtypes | grep vnc</command> 以取得提供 VNC 之所有服務的清單。在名為 <literal>YaST.installation.suse</literal> 的服務下應有 VNC 安裝目標可供您使用。
     </para>
    </step>
    <step>
     <para>
      執行 <command>slptool findsrvs </command>
      <replaceable>YaST.installation.suse</replaceable> 以取得可用的安裝清單。使用 VNC 檢視器隨附的 IP 位址與連接埠 (通常是 <systemitem>5901</systemitem>)。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-remote-installation-monitor-vnc-connect">
   <title>連接至安裝程式</title>
   <para>
    有兩種方法可以連接到 VNC 伺服器 (即本範例中的安裝目標)。您可以在任何作業系統上啟動獨立的 VNC 檢視器應用程式，或是使用啟用了 JavaScript 的網頁瀏覽器進行連接。
   </para>
   <para>
    您可以使用 VNC 從其他任何作業系統 (包括其他 Linux 類別、Windows 或 macOS) 控制 Linux 系統的安裝。
   </para>
   <para>
    若是使用 Linux 機器，請確定已安裝 <systemitem>tightvnc</systemitem> 套件。若是使用 Windows 機器，請安裝此應用程式 (可在 TightVNC 首頁 <link xlink:href="http://www.tightvnc.com/download.html"/> 取得) 的 Windows 連接埠。
   </para>
   <procedure xml:id="pro-remote-installation-monitor-vnc-connect-app">
    <para>
     若要連接到在目標機器上執行的安裝程式，請執行下列步驟：
    </para>
    <step>
     <para>
      啟動 VNC 檢視器。
     </para>
    </step>
    <step>
     <para>
      輸入由 SLP 瀏覽器或安裝程式本身提供的安裝目標 IP 位址和顯示編號：
     </para>
<screen><replaceable>IP_ADDRESS</replaceable>:<replaceable>DISPLAY_NUMBER</replaceable></screen>
     <para>
      接著會在您的桌面上開啟一個視窗，並顯示做為一般本機安裝的 YaST 畫面。
     </para>
    </step>
   </procedure>
   <para>
    使用網頁瀏覽器連接到安裝程式，可讓您完全不需理會 VNC 軟體或舊版的作業系統。只要瀏覽器應用程式啟用了 JavaScript 支援，您就可以使用任何瀏覽器 (Firefox、Internet Explorer、Chromium、Opera 等) 來執行 Linux 系統安裝。
   </para>
   <para>
    請注意，瀏覽器 VNC 連接未加密。
   </para>
   <para>
    若要進行 VNC 安裝，請依照下列步驟執行：
   </para>
   <procedure xml:id="pro-deployment-remoteinst-monitor-vnc-connect-brow">
    <step>
     <para>
      啟動您要使用的網頁瀏覽器。
     </para>
    </step>
    <step>
     <para>
      在位址提示中輸入以下內容：
      
     </para>
<screen>http://<replaceable>IP_ADDRESS_OF_TARGET</replaceable>:5801</screen>
    </step>
    <step>
     <para>
      接著，系統會提示您輸入 VNC 密碼。然後，瀏覽器視窗會顯示做為一般本機安裝的 YaST 畫面。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-remote-installation-monitor-ssh">
  <title>透過 SSH 監控安裝</title>

  <para>
   您可以使用 SSH，透過任何 SSH 用戶端軟體遠端控制 Linux 機器的安裝。
  </para>

  <sect2 xml:id="sec-remote-installation-monitor-ssh-prep">
   <title>準備進行 SSH 安裝</title>
   <para>
    除了安裝所需的軟體套件 (用於 Linux 的 OpenSSH 和用於 Windows 的 PuTTY) 外，您還需要指定相應的開機參數來為安裝啟用 SSH。如需詳細資料，請參閱<xref linkend="cha-boot-parameters"/>。任何 SUSE Linux 作業系統上會預設安裝 OpenSSH。
   </para>
  </sect2>

  <sect2 xml:id="sec-remote-installation-monitor-ssh-connect">
   <title>連接至安裝程式</title>
   <para>
    啟動 SSH 安裝後，請執行以下程序以連接至 SSH 工作階段。
   </para>
   <procedure xml:id="pro-remote-installation-monitor-ssh-connect">
    <step>
     <para>
      擷取安裝目標的 IP 位址。如果您具有對目標機器的實體存取權限，請使用初始開機後安裝常式在主控台提供的 IP 位址。或者，也可以採用在 DHCP 伺服器組態中指定給此特定主機的 IP 位址。
     </para>
    </step>
    <step>
     <para>
      在指令行，輸入以下指令：
     </para>
<screen>ssh -X root@<replaceable>TARGET_IP_ADDRESS</replaceable></screen>
     <para>
      以安裝目標的實際 IP 位址取代 <replaceable>TARGET_IP_ADDRESS</replaceable>。
     </para>
    </step>
    <step>
     <para>
      出現輸入使用者名稱的提示時，請輸入 <literal>root</literal>。
     </para>
    </step>
    <step>
     <para>
      當系統提示輸入密碼時，請輸入使用 SSH 開機參數設定的密碼。完成驗證後，會出現一個指令行，提示您輸入安裝目標。
     </para>
    </step>
    <step>
     <para>
      請輸入 <command>yast</command> 啟動安裝程式。出現一個視窗，顯示<xref linkend="cha-install"/>所述的一般 YaST 畫面。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-remote-installation-monitor-serial">
  <title>透過序列主控台監控安裝</title>

  <para>
   使用這種安裝方法時，您還需要另一部電腦，該電腦需透過<emphasis>零數據機</emphasis>纜線與要安裝 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的電腦相連。兩部機器的硬體和韌體都需要支援序列主控台。一些韌體實作已設定為將開機主控台輸出傳送到序列主控台 (透過提供適當設定了 <replaceable>/CHOSEN_stdout_PATH</replaceable> 的裝置樹來實現)。在此情況下，不需要進行額外的設定。
  </para>

  <para>
   如果韌體不使用序列主控台顯示開機主控台輸出，請為安裝設定以下開機參數：<option>console=<replaceable>TTY</replaceable>,<replaceable>BAUDRATE</replaceable></option>。如需詳細資料<phrase os="sles">，請參閱<xref linkend="sec-grub2-menu-change"/>和</phrase> <xref linkend="cha-boot-parameters"/>。
  </para>

  <para>
   必須使用介面的鮑率來取代 <replaceable>BAUDRATE</replaceable>。有效值為 115200、38400 或 9600。必須使用介面的名稱來取代 <replaceable>TTY</replaceable>。大多數電腦上都有一或多個序列介面。介面的名稱可能因硬體而異：
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <emphasis>ttyS0</emphasis>，適用於 APM
    </para>
   </listitem>
   <listitem>
    <para>
     <emphasis>ttyAMA0</emphasis>，適用於伺服器基礎系統架構 (Server Base System Architecture，簡稱 SBSA)
    </para>
   </listitem>
   <listitem>
    <para>
     <emphasis>ttyPS0</emphasis>，適用於 Xilinx
    </para>
   </listitem>
  </itemizedlist>

  <para>
   要執行此安裝，需要使用 <command>minicom</command> 或 <command>screen</command> 等終端機程式。若要啟動序列連接，請輸入以下指令，啟動本地主控台中的螢幕程式：
  </para>

<screen><prompt>&gt; </prompt><command>screen</command> /dev/ttyUSB0 115200</screen>

  <para>
   這表示監聽第一個序列埠之螢幕的鮑率為 115200。此後，將以類似文字型的安裝方式透過此終端機進行安裝。
  </para>
 </sect1>
</chapter>
