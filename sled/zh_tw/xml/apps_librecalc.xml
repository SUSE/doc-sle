<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apps_librecalc.xml" version="5.0" xml:id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  Calc 是 LibreOffice 試算表模組。試算表由數個工作表組成，其中包括可填入文字、數字或公式等元素的儲存格。公式可操作其他儲存格中的資料，在插入公式的儲存格中產生一個值。Calc 還允許您定義範圍，篩選及排序資料，以及依據資料建立圖表以便以圖形化形式呈現資料。您可以使用樞紐分析表來組合、分析或比較大量的資料。
 </para>
 <para>
  本章只能介紹一些非常基本的 Calc 功能。如需詳細資訊及完整指示，請參閱 LibreOffice 應用程式說明以及<xref linkend="sec.oo.oview.help"/>中所列的來源。
 </para>
 <note>
  <title>VBA 巨集</title>
  <para>
   Calc 可以處理 Excel 文件中的許多 VBA 巨集，但對 VBA 巨集的支援並不全面。開啟使用大量巨集的 Excel 試算表時，您可能會發現某些巨集失效。
  </para>
 </note>
 <sect1 xml:id="sec.oo.calc.createnew">
  <title>建立新文件</title>

  <para>
   建立新 Calc 文件的方式有以下兩種：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>從頭開始建立</title>
     <para>
      若要建立新的空白文件，請按一下<menuchoice>
      <guimenu>檔案</guimenu> <guimenu>新增</guimenu>
      <guimenu>試算表</guimenu> </menuchoice>。
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>使用範本</title>
     <para>
      若要使用範本，請按一下<menuchoice> <guimenu> 檔案</guimenu> <guimenu> 新增</guimenu>
      <guimenu> 範本</guimenu> </menuchoice> ，然後開啟一個範本 (例如<guimenu>財務</guimenu>)。從試算表範本清單中，選取符合您需要的範本。
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   按一下視窗底部相應的標籤可存取各個不同的工作表。
  </para>

  <para>
   視需要在儲存格中輸入資料。若要調整外觀，可以使用<guimenu>格式化</guimenu>工具列或側邊欄面板，或者使用<guimenu>格式</guimenu>選單或依<xref linkend="sec.oo.calc.styles"/>中所述定義樣式。請使用<guimenu>檔案</guimenu>選單或工具列中對應的按鈕，列印或儲存您的文件。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.styles">
  <title>在 Calc 中使用格式化與樣式</title>

  <para>
   Calc 隨附一些內建的儲存格和頁面樣式，能夠美化試算表及報告的外觀。雖然這些內建的樣式足以應付大部分的使用情況，但您可能覺得根據自己常用的格式化喜好來建立樣式很有用。
  </para>

  <procedure xml:id="pro.oo.calc.createstyle">
   <title>建立樣式</title>
   <step>
    <para>
     按一下<menuchoice> <guimenu>格式</guimenu> <guimenu> 樣式</guimenu>
     <guimenu>樣式和格式化</guimenu> </menuchoice>，或按 <keycap>F11</keycap>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>樣式和格式</guimenu>面板頂部，按一下<guimenu>儲存格樣式</guimenu> (一個綠色的儲存格) 或<guimenu>頁面樣式</guimenu> (一個文件)。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>樣式和格式</guimenu>面板中樣式清單內的任何區域按一下滑鼠右鍵。然後按一下<guimenu>新增</guimenu>。
    </para>
   </step>
   <step>
    <para>
     指定樣式的名稱，並使用各種標籤來設定所需的格式化選項。
    </para>
   </step>
   <step>
    <para>
     設定完樣式之後，按一下<guimenu>確定</guimenu>。
    </para>
   </step>
  </procedure>

  <procedure>
   <title>修改樣式</title>
   <step>
    <para>
     按一下<menuchoice> <guimenu>格式</guimenu> <guimenu> 樣式</guimenu>
     <guimenu> 樣式和格式化</guimenu> </menuchoice>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>樣式和格式</guimenu>面板頂部，按一下<guimenu>儲存格樣式</guimenu> (一個綠色的儲存格) 或<guimenu>頁面樣式</guimenu> (一個文件)。
    </para>
   </step>
   <step>
    <para>
     在您要變更的樣式名稱上按一下滑鼠右鍵，然後按一下<guimenu>修改</guimenu>。
    </para>
   </step>
   <step>
    <para>
     變更所要的格式化選項。
    </para>
   </step>
   <step>
    <para>
     設定完樣式之後，按一下<guimenu>確定</guimenu>。
    </para>
   </step>
  </procedure>

  <para>
   若要將樣式套用到特定的儲存格，請選取您要格式化的儲存格。然後在<guimenu>樣式和格式</guimenu>視窗中連按兩下要套用的樣式。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.sheets">
  <title>使用工作表</title>

  <para>
   工作表是管理計算的有效方法。例如，如果您有一家公司，則每個月建立一張工作表會使會計帳目變得清楚得多。
  </para>

  <para>
   若要在最後一個工作表後面插入一個新的工作表，請按一下工作表標籤旁邊的 <guimenu>+</guimenu> 按鈕。
  </para>

  <para>
   若要在試算表中一次從某個檔案或於特定位置插入一或多個新的工作表，請執行以下操作︰
  </para>

  <procedure xml:id="pro.oo.insert.sheet">
   <title>插入新的工作表</title>
   <step>
    <para>
     在工作表標籤上按一下滑鼠右鍵，然後選取<guimenu>插入工作表</guimenu>。會開啟對話方塊。
    </para>
   </step>
   <step>
    <para>
     決定要將新工作表放在所選工作表之前還是之後。
    </para>
   </step>
   <step>
    <para>
     若要建立新的工作表，請確定<guimenu>新增工作表</guimenu>選項圓鈕處於啟用狀態。輸入工作表數量及工作表名稱。跳過此步驟的其餘操作。
    </para>
    <para>
     或者，若要從另一個檔案匯入工作表，請執行以下操作︰
    </para>
    <substeps performance="optional">
     <step>
      <para>
       選取<guimenu>取自檔案</guimenu>並按一下<guimenu>瀏覽</guimenu>。
      </para>
     </step>
     <step>
      <para>
       選取檔案名稱，然後按一下<guimenu>確定</guimenu>加以確認。現在，所有工作表名稱都會顯示在清單中。
      </para>
     </step>
     <step>
      <para>
       按住 <keycap function="shift"/> 鍵並按一下您要匯入的工作表名稱來選取這些工作表。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     若要新增一或多個工作表，請按一下<guimenu>確定</guimenu>加以確認。
    </para>
   </step>
  </procedure>

  <para>
   若要對工作表重新命名，請在工作表標籤上按一下滑鼠右鍵，然後選取<guimenu>重新命名工作表</guimenu>。或者，也可以連按兩下工作表標籤。
  </para>

  <para>
   若要刪除一或多個工作表，請執行以下操作︰選取要刪除的工作表。若要選取多個工作表，請在選擇時按住 <keycap function="shift"/> 不放。在工作表標籤上按一下滑鼠右鍵，選擇<guimenu>刪除工作表</guimenu>，並按一下<guimenu>是</guimenu>確認。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.condformat">
  <title>條件式格式</title>

  <para>
   條件式格式是一個可以在試算表中突顯特定值的有用功能。例如，定義一個條件，如果條件為<literal>真</literal>，則某個樣式就會套用到每個滿足此條件的儲存格。
  </para>

  <note>
   <title>啟用自動計算</title>
   <para>
    在您套用條件式格式化之前，請選擇<menuchoice>
    <guimenu> 工具</guimenu> <guimenu> 儲存格內容</guimenu>
    <guimenu> 自動計算</guimenu> </menuchoice> 。<guimenu>自動計算</guimenu>的前面應該會顯示一個核取記號。
   </para>
  </note>

  <procedure xml:id="pro.oo.calc.condformat">
   <title>使用條件式格式</title>
   <step>
    <para>
     首先定義一個樣式。當條件為<literal>真</literal>時，此樣式會套用到每個儲存格。使用<menuchoice>
     <guimenu>格式</guimenu><guimenu> 樣式和格式化</guimenu>
     </menuchoice>，或按 <keycap>F11</keycap>。如需詳細資訊，請參閱<xref linkend="pro.oo.calc.createstyle"/>。請按<guimenu>確定</guimenu>加以確認。
    </para>
   </step>
   <step>
    <para>
     選取您要套用條件的儲存格範圍。
    </para>
   </step>
   <step>
    <para>
     從選單中選取<menuchoice> <guimenu> 格式</guimenu> <guimenu> 條件式格式化</guimenu> <guimenu> 條件</guimenu> </menuchoice> 。會開啟對話方塊。
    </para>
   </step>
   <step>
    <para>
     現在，您會看到一個新條件的範本。條件可在多種模式下運作：
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>儲存格值</guimenu>
      </term>
      <listitem>
       <para>
        條件將會測試某個儲存格是否與特定的值相符。在第一個下拉式方塊的旁邊，選取一個運算子，例如<guimenu>等於</guimenu>、<guimenu>小於</guimenu>或<guimenu>大於</guimenu>。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>公式</guimenu>
      </term>
      <listitem>
       <para>
        條件將會測試特定公式是否傳回<literal>真</literal>。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>日期</guimenu>
      </term>
      <listitem>
       <para>
        條件將會測試是否達到特定日期值。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>所有儲存格</guimenu>
      </term>
      <listitem>
       <para>
        此模式可用於建立依據儲存格值的資料視覺效果，與<guimenu>儲存格值</guimenu>的作用類似。不過，使用<guimenu>所有儲存格</guimenu>可以透過一個條件就套用整個樣式範圍。
       </para>
       <para>
        可使用的樣式類型為色階 (儲存格背景色彩)，資料條 (儲存格中寬度可以變更的條) 及圖示集 (儲存格中的圖示)。
       </para>
       <para>
        例如，可以使用色階將 <literal>0</literal> 指定為黑色背景，並將 <literal>100</literal> 指定為綠色背景。系統會自動計算介於這兩者之間的所有值。例如，指定 <literal>50</literal> 會得到墨綠色的背景。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     對於本範例，請保留預設值：<guimenu>儲存格值</guimenu>。
    </para>
   </step>
   <step>
    <para>
     選取一個運算子，以及您要測試的儲存格值。
    </para>
   </step>
   <step>
    <para>
     選擇當此條件為<literal>真</literal>時要套用的樣式，或按一下<guimenu>新增樣式</guimenu>以定義新外觀。
    </para>
   </step>
   <step>
    <para>
     如果需要更多的條件，請按一下<guimenu>加入</guimenu>。然後重複前面的步驟。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>確定</guimenu>加以確認。現在，您的儲存格樣式已變更。
    </para>
   </step>
  </procedure>

  <remark>
   We might also want a procedure showing how to use the Manage dialog to remove
   conditions. -- sknorr, 2015-09-17
  </remark>
 </sect1>
 <sect1 xml:id="sec.oo.calc.grouping">
  <title>群組與取消群組儲存格</title>

  <para>
   對儲存格範圍進行分組，可以隱藏試算表的某些部分。這樣可讓試算表更加清晰直觀，因為您可以隱藏目前不感興趣的所有部分。可以群組列或欄以及其他群組中的巢狀群組。
  </para>

  <para>
   若要群組某個範圍，請執行以下步驟︰
  </para>

  <procedure>
   <title>群組所選的儲存格範圍</title>
   <step>
    <para>
     在試算表中選取儲存格範圍。
    </para>
   </step>
   <step>
    <para>
     選取<menuchoice> <guimenu>資料</guimenu> <guimenu> 群組與大綱</guimenu> <guimenu> 群組</guimenu> </menuchoice>。隨即會出現一個對話方塊。
    </para>
   </step>
   <step>
    <para>
     決定是以列還是欄分組所選的範圍。按一下<guimenu>確定</guimenu>加以確認。
    </para>
   </step>
  </procedure>

  <para>
   群組所選的儲存格之後，在左上方邊界處會顯示一條線標明已群組的儲存格範圍。使用 <guimenu>+</guimenu> 和 <guimenu>-</guimenu> 圖示摺疊或展開儲存格範圍。邊界左上方的數字顯示群組的深度，也可以按一下數字進行顯示。
  </para>

  <para>
   若要將儲存格範圍取消群組，請按一下屬於群組的一個儲存格，然後選取<menuchoice> <guimenu>資料</guimenu> <guimenu> 群組與大綱</guimenu> <guimenu> 取消群組</guimenu> </menuchoice>。邊界中的線即會消失。始終刪除最裡面的群組。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.freezing">
  <title>將列或欄做為標題固定</title>

  <para>
   如果您的試算表包含大量資料，則捲動後通常會看不見標題。LibreOffice 可以鎖定列和/或欄，以便在您捲動瀏覽時將其保持固定。
  </para>

  <para>
   若要固定單一列或單一欄，請執行以下步驟︰
  </para>

  <procedure>
   <title>固定單一列或欄</title>
   <step>
    <para>
     若要在列的前面建立固定區域，請按一下列標題 (<literal>1</literal>、<literal>2</literal>、<literal>3</literal>...)。
    </para>
    <para>
     或者，若要在欄的上面建立凍結的固定區域，請按一下欄標題 (<literal>A</literal>、<literal>B</literal>、<literal>C</literal>...)。
    </para>
   </step>
   <step>
    <para>
     選取<menuchoice> <guimenu>檢視</guimenu>
     <guimenu> 凍結列與欄</guimenu> </menuchoice>。隨即會顯示一條黑線，指出凍結的區域。
    </para>
   </step>
  </procedure>

  <para>
   您也可以同時固定列與欄：
  </para>

  <procedure>
   <title>固定列和欄</title>
   <step>
    <para>
     按一下您要固定之欄的右側、要固定之列的下方的儲存格。例如，如果您的標題佔用了 A1 至 B3 的空間，請按一下儲存格 C4。
    </para>
   </step>
   <step>
    <para>
     選取<menuchoice> <guimenu>檢視</guimenu>
     <guimenu> 凍結列與欄</guimenu></menuchoice>。隨即會顯示一條黑線，指出哪個區域已凍結。
    </para>
   </step>
  </procedure>

  <para>
   若要取消凍結，請選取<menuchoice><guimenu> 檢視</guimenu>
   <guimenu>凍結列與欄</guimenu></menuchoice>。該選單項目前面的核取記號即會消失。
  </para>
 </sect1>
</chapter>
