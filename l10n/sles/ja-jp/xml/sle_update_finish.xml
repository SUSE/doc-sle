<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_finish.xml" version="5.0" xml:id="cha-upgrade-finish">
 <title>アップグレードの終了</title>
 <info>
  <abstract>
   <para>
    アップグレード後に、いくつかの追加タスクを実行する必要があります。以下の章では、順を追って手順を説明します。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 
 <sect1 xml:id="sec-upgrade-postupgrade-checks">
  <title>アップグレード後のチェック</title>
  <itemizedlist>
   <listitem>
    <para>
     <quote>孤立したパッケージ</quote>がないか確認します。アップグレード手順の実行中に、パッケージの名前が変更されたり、削除されたり、マージされたり、分割されたりする場合があります。その結果、特定のパッケージが孤立してサポートされなくなる可能性があります。孤立したパッケージは、自動的に削除されません。次のコマンドで、これらのリストを表示できます。
    </para>
<screen><prompt>&gt; </prompt><command>zypper packages --orphaned --unneeded</command></screen>
    <para>
     リストを使用して、まだ必要なパッケージと、安全に削除できるパッケージを決定します。
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>*.rpmnew</filename>および<filename>*.rpmsave</filename>ファイルがないか確認して、そのコンテンツを調べ、できれば必要な変更をマージしてください。アップグレードに設定ファイルの上書きではなくデフォルトの設定ファイルへの変更が含まれる場合、パッケージはこれらのファイルタイプのいずれかを作成します。<filename>*.rpmnew</filename>に新しいデフォルトの設定が含まれ、元のファイルがそのまま残りますが、<filename>*.rpmsave</filename>は新しいデフォルトファイルによって置き換えられた元の設定のコピーです。
    </para>
    <para>
     ファイルシステム全体で<filename>*.rpmnew</filename>および<filename>*.rpmsave</filename>ファイルを検索する必要はありません。最も重要なファイルは<filename>/etc</filename>ディレクトリに格納されています。それらを一覧表示するには、次のコマンドを使用します。
    </para>
<screen><prompt>&gt; </prompt><command>find /etc/ -name "*.rpmnew" -o -name "*.rpmsave"</command></screen>
   </listitem>
  </itemizedlist>
 </sect1>

 
 <sect1 xml:id="sec-upgrade-finish-python3">
  <title><literal>Python 3</literal>モジュールを有効にする</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15では、デフォルトでPython 3.6を使用します。<phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP3では、最新の代替手段としてPython 3.9が追加されました。このバージョンは、<phrase role="productname"><phrase os="sles">SLES</phrase></phrase> 15 SP4ではサポートされなくなりました。代わりに、重要な更新とセキュリティの修正を含む最新のPythonバージョンが<literal>Python 3</literal>モジュールから入手できます。
  </para>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 15 SP3にPython 3.9をインストールした場合は、次のコマンドを使用して<literal>Python 3</literal>モジュールを有効にします。
  </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>SUSEConnect -p sle-module-python3/15.4/<replaceable>x86_64</replaceable></command>&#x002E;</screen>
  <para>
   または、<command>zypper remove -u python39</command>を使用して3.9を削除して、デフォルトのPythonバージョンに戻すこともできます。
  </para>
 </sect1>

 <sect1 xml:id="sec-upgrade-finish-xfs4">
  <title>XFS v4デバイスを再フォーマットする</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>はXFSファイルシステムの<quote>オンディスクフォーマット</quote>(v5)をサポートしています。このフォーマットの主な利点には、全XFSメタデータの自動チェックサム、ファイルタイプのサポート、および1つのファイルに対する大量のアクセス制御リストのサポートがあります。
  </para>
  <para>
   このフォーマットは、SUSE Linux Enterpriseカーネルの3.12より古いバージョン、<literal>xfsprogs</literal>の3.2.0より古いバージョン、およびSUSE Linux Enterprise 12より前にリリースされたバージョンのGRUB 2ではサポートされていません。
  </para>
  <important>
   <title>V4は非推奨です</title>
   <para>
    XFSはV4フォーマットのファイルシステムを非推奨にしています。このファイルシステムフォーマットは次のコマンドによって作成されました。
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=0 <replaceable>DEVICE</replaceable></screen>
   <para>
    このフォーマットはSLE 11以前のリリースで使用され、現在は<command>dmesg</command>によって警告メッセージが作成されています。
   </para>
<screen>Deprecated V4 format (crc=0) will not be supported after September 2030</screen>
   <para>
    <command>dmesg</command>コマンドの出力でこのメッセージが表示された場合は、ファイルシステムをV5フォーマットに更新することをお勧めします。
   </para>
   <procedure>
    <step>
     <para>
      データを別のデバイスにバックアップします。
     </para>
    </step>
    <step>
     <para>
      デバイスにファイルシステムを作成します。
     </para>
<screen><prompt>&gt; </prompt><command>sudo</command> mkfs.xfs -m crc=1 <replaceable>DEVICE</replaceable></screen>
    </step>
    <step>
     <para>
      更新されたデバイスのバックアップからデータを復元します。
     </para>
    </step>
   </procedure>
  </important>
 </sect1>
</chapter>
