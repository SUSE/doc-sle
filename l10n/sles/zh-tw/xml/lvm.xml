<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="lvm.xml" version="5.0" xml:id="sec-yast2-system-lvm">
 <title>LVM 組態</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  本節介紹設定 LVM 時要執行的特定步驟。<phrase os="sles">如果您需要邏輯磁碟區管理員的一般資訊，請參閱<xref linkend="sec-lvm-explained"/>。</phrase>
 </para>

 <warning>
  <title>備份資料</title>
  <para>
   使用 LVM 有時會增加風險，如遺失資料。這些危險也包括應用程式當機、電源中斷和錯誤指令。執行 LVM 或重新設定磁碟區前，請儲存您的資料。決不要在沒有備份的情形下工作。
  </para>
 </warning>





 <sect2 xml:id="sec-yast2-system-lvm-yast">
  <title>使用 YaST 進行 LVM 組態</title>
  <para>
   YaST LVM 組態可透過 YaST 進階磁碟分割程式 (請參閱<xref linkend="sec-yast2-i-y2-part-expert"/>) 中<guimenu>系統檢視</guimenu>窗格內的<guimenu>磁碟區管理</guimenu>項目來存取。進階磁碟分割程式可讓您編輯和刪除現有的分割區，以及建立需要用於 LVM 的新分割區。首先應建立為磁碟區群組提供空間的實體磁碟區︰
  </para>
  <procedure>
   <step>
    <para>
     從<guimenu>硬碟</guimenu>中選取一個硬碟。
    </para>
   </step>
   <step>
    <para>
     切換到<guimenu>分割區</guimenu>索引標籤。
    </para>
   </step>
   <step>
    <para>
     按一下<guimenu>新增</guimenu>並輸入此磁碟上 PV 所需的大小。
    </para>
   </step>
   <step>
    <para>
     使用<guimenu>不格式化分割區</guimenu>並將<guimenu>檔案系統 ID</guimenu>變更為<guimenu>0x8E Linux LVM</guimenu>。不要掛接此分割區。
    </para>
   </step>
   <step>
    <para>
     重複此程序，直到定義了可用磁碟上所有需要的實體磁碟區為止。
    </para>
   </step>
  </procedure>
  <sect3 xml:id="sec-yast2-system-lvm-yast-volume-groups">
   <title>建立磁碟區群組</title>
   <para>
    如果系統上沒有磁碟區群組，您必須新增一個 (請參閱<xref linkend="fig-lvm-yast-volgrp"/>)。您可以按一下<guimenu>系統檢視</guimenu>窗格中的<guimenu>磁碟區管理</guimenu>，然後按一下<guimenu>新增磁碟區群組</guimenu>建立其他群組。通常一個磁碟區群組就已足夠。
   </para>
   <procedure>
    <step>
     <para>
      為磁碟區群組輸入一個名稱，例如 <literal>system</literal>。
     </para>
    </step>
    <step>
     <para>
      選取所需的<guimenu>實體範圍大小</guimenu>。這個值定義了磁碟區群組中實體區塊的大小。在磁碟區群組中的所有磁碟空間都會以此大小的區塊來處理。
     </para>
    </step>
    <step>
     <para>
      選取裝置並按一下<guimenu>新增</guimenu>，將準備好的實體磁碟區新增至磁碟區群組。可以選取多個裝置，只要在選取裝置的同時一直按住 <keycap function="control"/> 即可。
     </para>
    </step>
    <step>
     <para>
      選取<guimenu>完成</guimenu>，使磁碟區群組可用於後面的組態步驟。
     </para>
    </step>
   </procedure>
   <figure xml:id="fig-lvm-yast-volgrp">
    <title>建立磁碟區群組</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm4.png" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm4.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    如果定義了多個磁碟區群組，並且想要新增或移除 PV，請在<guimenu>磁碟區管理</guimenu>清單中選取該磁碟區群組，然後按一下<guimenu>調整大小</guimenu>。在以下視窗中，您可以在選定的磁碟區群組中新增或移除 PV。
   </para>
  </sect3>
  <sect3 xml:id="sec-yast2-system-lvm-yast-logical-vol">
   <title>設定邏輯磁碟區</title>
   <para>
    當磁碟區群組中分派滿了 PV 後，在下一個對話方塊中定義作業系統應該使用的 LV。選擇目前的磁碟區群組，然後切換至<guimenu>邏輯磁碟區</guimenu>索引標籤。視需要<guimenu>新增</guimenu>、<guimenu>編輯</guimenu>、<guimenu>刪除</guimenu>LV 以及<guimenu>調整</guimenu>其大小，直到磁碟區群組中的所有空間都用完為止。為每個磁碟區群組至少指定一個 LV。
   </para>
   <figure xml:id="fig-lvm-yast-mgmt">
    <title>邏輯磁碟區管理</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm6.png" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm6.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    按一下<guimenu>新增</guimenu>，然後在開啟的類似於精靈的快顯視窗中進行設定︰
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      輸入 LV 名稱。對於應掛接至 <filename>/home</filename> 的分割區，可以使用 <literal>HOME</literal> 這樣的名稱。
     </para>
    </listitem>
    <listitem>
     <para>
      選取 LV 的類型。可以是<guimenu>一般磁碟區</guimenu>、<guimenu>簡易池</guimenu>或<guimenu>簡易磁碟區</guimenu>。請注意，您首先需要建立簡易池，可用於儲存個別簡易磁碟區。簡易佈建的一大優勢在於，儲存在簡易池中的所有簡易磁碟區的大小總和可以超過池本身的大小。
     </para>
    </listitem>
    <listitem>
     <para>
      選取 LV 的大小與等量磁碟區數量。如果只有一個 PV，則選取多個等量磁碟區毫無意義。
     </para>
    </listitem>
    <listitem>
     <para>
      選擇要在 LV 上使用的檔案系統以及掛接點。
     </para>
    </listitem>
   </orderedlist>
   <para>
    使用等量磁碟區可以在 LV 中跨多個 PV (等量) 分散資料流。但是，等量磁碟區操作只能在數個不同的 PV 上進行，每個 PV 至少需提供該磁碟區大小的空間。最大等量磁碟區數量等於 PV 的數量，其中等量磁碟區「1」表示「無等量磁碟區」。僅當 PV 分佈在數個不同硬碟上時，等量磁碟區操作才有意義，若非如此，效能將會降低。
   </para>
   <warning>
    <title>等量磁區</title>
    <para>
     YaST 在此時無法驗證您輸入之分割的正確性。在此所犯的錯誤只有稍後在磁碟上執行 LVM 時才會顯示出來。
    </para>
   </warning>
   <para>
    如果已經在系統上設定 LVM，還可以使用現有的邏輯磁碟區。在繼續前，請為這些邏輯磁碟區指定適當的掛接點。按一下<guimenu>完成</guimenu>返回 YaST 進階磁碟分割程式，然後於該處完成您的工作。
   </para>
  </sect3>
 </sect2>
</sect1>
