<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd" [
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter id="cha.uuid" lang="en">
  <title>Using UUIDs to Mount Devices</title>
  <para>
   This section describes the use of UUIDs (Universally Unique Identifiers)
   instead of device names (such as <filename>/dev/sda1</filename>) to
   identify file system devices. Starting with &productname; 12, UUIDs are
   used by default in the boot loader file and the
   <filename>/etc/fstab</filename> file.
  </para>
  <sect1 id="sec.uuid.udev">
   <title>Persistent Device Names with udev</title>

   <para>
    Since Kernel 2.6, <command>udev</command> provides a userspace solution
    for the dynamic <filename>/dev</filename> directory, with persistent
    device naming. As part of the hotplug system, <command>udev</command> is
    executed if a device is added to or removed from the system.
   </para>

   <para>
    A list of rules is used to match against specific device attributes. The
    <command>udev</command> rules infrastructure (defined in the
    <filename>/etc/udev/rules.d</filename> directory) provides stable names
    for all disk devices, regardless of their order of recognition or the
    connection used for the device. The <command>udev</command> tools
    examine every appropriate block device that the kernel creates to apply
    naming rules based on certain buses, drive types, or file systems. For
    information about how to define your own rules for
    <command>udev</command>, see
    <ulink url="http://reactivated.net/writing_udev_rules.html"><citetitle>Writing
    udev Rules</citetitle></ulink>.
   </para>

   <para>
    Along with the dynamic kernel-provided device node name,
    <command>udev</command> maintains classes of persistent symbolic links
    pointing to the device in the <filename>/dev/disk</filename> directory,
    which is further categorized by the <filename>by-id</filename>,
    <filename>by-label</filename>, <filename>by-path</filename>, and
    <filename>by-uuid</filename> subdirectories.
   </para>

   <note>
    <title>UUID Generators</title>
    <para>
     Other programs besides <command>udev</command>, such as LVM or
     <command>md</command>, might also generate UUIDs, but they are not
     listed in <filename>/dev/disk</filename>.
    </para>
   </note>
  </sect1>
  <sect1 id="sec.uuid.understanduuid">
   <title>Understanding UUIDs</title>

   <para>
    A UUID (Universally Unique Identifier) is a 128-bit number for a file
    system that is unique on both the local system and across other systems.
    It is randomly generated with system hardware information and time
    stamps as part of its seed. UUIDs are commonly used to uniquely tag
    devices.
   </para>
   <para>
    Using non-persistent <quote>traditional</quote> device names such as
    <filename>/dev/sda1</filename> may render the system unbootable when
    adding storage. For example, if root (<filename>/</filename>) is assigned
    to <filename>/dev/sda1</filename>, it might be reassigned to
    <filename>/dev/sdg1</filename> after a SAN has been attached or additional
    hard disks have been applied to the system. In this case the boot loader
    configuration and the <filename>/etc/fstab</filename> file need to be
    adjusted, otherwise the system will no longer boot.
   </para>
   <para>
    One way to avoid this problem is to use the UUID in the boot loader and
    <filename>/etc/fstab</filename> files for the boot device. This is the
    default in &sle; since version 12. The UUID is a property of the file
    system and can change if you reformat the drive. Other alternatives to
    using UUIDs of device names would be to identify devices by ID or label.
   </para>

   <para>
     You can also use the UUID as criterion for assembling and activating
     software RAID devices. When a RAID is created, the <command>md</command>
     driver generates a UUID for the device, and stores the value in the
     <filename>md</filename> superblock.
   </para>
   
   <para>
     You can find the UUID for any block device in the
     <filename>/dev/disk/by-uuid</filename> directory. For example, a UUID entry
     looks like this:
    </para>
    <screen>&prompt.user;ls -og /dev/disk/by-uuid/
lrwxrwxrwx 1 10 Dec  5 07:48 e014e482-1c2d-4d09-84ec-61b3aefde77a -> ../../sda1</screen>
  </sect1>

  <sect1 id="sec.uuid.moreinfo">
   <title>Additional Information</title>

   <para>
    For more information about using <systemitem>udev</systemitem> for managing
    devices, see <xref linkend="cha.udev"/>.
   </para>

   <para>
    For more information about <systemitem>udev</systemitem> commands, see
    <command>man 7 udev</command>.
   </para>
  </sect1>
 </chapter>
