<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="x11.xml" version="5.0" xml:id="cha-gui-desktop">
 <title>圖形使用者介面</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
   <para>
    <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 包含 X.org 伺服器<phrase os="sled;osuse">、Wayland</phrase> 和 GNOME 桌面。本章介紹用於所有使用者的圖形使用者介面組態。
   </para>
  </abstract>
 </info>
 <sect1 xml:id="sec-gui-desktop-xorg">
  <title>X Window 系統</title>
  <para>
   X.org 伺服器是實作 X11 通訊協定的事實上標準。X 採網路結構，可讓應用程式在一個主機上啟動而在透過任何種類的網路 (LAN 或網際網路) 連接的其他主機上顯示。
  </para>
  <para>
   X Window System 一般不需要任何組態設定。X 啟動期間會動態偵測硬體。因此，<filename>xorg.conf</filename> 的使用已被取代。如果您仍需要指定自訂選項來變更 X 的行為方式，您仍然可以透過修改 <filename>/etc/X11/xorg.conf.d/</filename> 下的組態檔案實現變更。
  </para>
  <para os="sled;osuse">
   <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled"> 15 SP4</phrase></phrase> 中包含 Wayland，做為 X.org 伺服器的替代選擇。您可在安裝期間選擇安裝它。
  </para>
  
  <para>
   您可安裝 <systemitem class="resource">xorg-docs</systemitem> 套件以更深入地瞭解 X11。<command>man 5 xorg.conf</command> 更詳細地說明了手動設定的格式 (如果需要)。您可在專案的首頁 <link xlink:href="http://www.x.org"/> 上找到關於 X11 開發的更多資訊。
  </para>

  <para>
   驅動程式位於 <systemitem>xf86-video-*</systemitem> 套件中，例如 <systemitem>xf86-video-ati</systemitem>。相關手冊頁中詳細描述了這些套件隨附的很多驅動程式。例如，如果您使用 <literal>ati</literal> 驅動程式，在 <command>man 4 ati</command> 中可以找到有關此驅動程式的詳細資訊。
  </para>

  <para>
   <filename>/usr/share/doc/packages/&lt;package_name&gt;</filename> 中提供了有關協力廠商驅動程式的資訊。例如，安裝套件後，<systemitem class="resource">x11-video-nvidiaG03</systemitem> 的文件就位於 <filename>/usr/share/doc/packages/x11-video-nvidiaG04</filename> 中。
  </para>
   
  <para>
   在伺服器上安裝套件 <systemitem class="resource">xrdp</systemitem>，並使用 RDP 用戶端軟體透過遠端桌面通訊協定存取伺服器。
  </para>

 </sect1>
 <xi:include href="x11_fonts.xml"/>
 <sect1 xml:id="sec-gui-desktop-gnome">
  <title>適用於管理員的 GNOME 組態</title>

  <sect2 xml:id="sec-gui-desktop-gnome-dconf">
   <title><literal>dconf</literal> 系統</title>

   <para>
    系統使用 <literal>dconf</literal> 管理 GNOME 桌面的組態。dconf 是依階層結構化的資料庫或登錄，可讓使用者修改其個人設定，並可讓系統管理員為所有使用者設定預設值或強制值。<literal>dconf</literal> 取代了 GNOME 2 的 <literal>gconf</literal> 系統。
   </para>

   <para>
    使用 <command>dconf-editor</command> 可透過圖形使用者介面檢視 dconf 選項。<literal></literal>使用 <command>dconf</command> 可透過指令行存取和修改組態選項。
   </para>

   <para>
    GNOME <literal>Tweaks</literal> 工具提供易於使用的使用者介面，其中包含不屬於一般 GNOME 組態的其他組態選項。從 GNOME 應用程式功能表或在指令行中使用 <command>gnome-tweak-tool</command> 可啟動該工具。
   </para>
  </sect2>

  <sect2 xml:id="sec-gui-desktop-gnome-global">
   <title>泛系統組態</title>
   <para>
    在 <filename>/etc/dconf/db/</filename> 目錄中可設定全域 <literal>dconf</literal> 組態參數，其中包括 GDM 的組態或針對使用者鎖定特定的組態選項。
   </para>
   <para>
    我們以下面的程序舉例說明如何建立泛系統組態：
   </para>
   <procedure>
    <step>
     <para>
      在 <filename>/etc/dconf/db/</filename> 中建立以 <literal>.d</literal> 結尾的新目錄。此目錄可包含任意數量的組態選項文字檔案。在此範例中，建立含有以下內容的檔案 <filename>/etc/dconf/db/network.d/00-proxy</filename>：
     </para>
     <screen># This is a comment
[system/proxy/http]
host='10.0.0.1'
enabled=true</screen>
    </step>
    <step>
     <para>
      將新組態指令剖析為 dconf 資料庫格式：
     </para>
     <screen><prompt>&gt; </prompt><command>sudo</command> <command>dconf update</command></screen>
    </step>
    <step>
     <para>
      建立 <filename>/etc/dconf/profiles/user</filename> 檔案，以將新 <literal>network</literal> 組態資料庫新增至預設使用者設定檔。然後新增以下內容：
     </para>
     <screen>system-db:network</screen>
     <para>
      <filename>/etc/dconf/profiles/user</filename> 檔案是將要使用的 GNOME 預設設定。在環境變數 <literal>DCONF_PROFILE</literal> 中可定義其他設定檔。
     </para>
    </step>
    <step>
     <para>
      選擇性：若要鎖定使用者的代理組態，請建立 <filename>/etc/dconf/db/network/locks/proxy</filename> 檔案。然後將含有不能變更的關鍵字的一行新增至此檔案：
     </para>
     <screen>/system/proxy/http/host
/system/proxy/http/enabled</screen>
    </step>
   </procedure>
   <para>
    您可以使用圖形 <command>dconf-editor</command> 建立包含一個使用者的設定檔，然後使用 <command>dconf dump /</command> 列出所有組態選項。之後便可將組態選項儲存在全域設定檔中。
   </para>
   <para>
    <link xlink:href="https://wiki.gnome.org/Projects/dconf/SystemAdministrators"/> 中提供了全域組態的詳細描述。
   </para>
  </sect2>

  <sect2 xml:id="sec-gui-desktop-gnome-more-info">
   <title>更多資訊</title>
   <para>
    如需詳細資訊，請參閱 <link xlink:href="http://help.gnome.org/admin/"/>。
   </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-gui-desktop-suse-prime">
  <title>使用 SUSE Prime 在 Intel 和 NVIDIA Optimus GPU 之間切換</title>
  <para>
   SUSE Prime 是一款用於在內建 Intel 圖形處理單位 (GPU) 和配有 NVIDIA「可切換圖形」Optimus 技術的 NVIDIA GPU 之間切換的工具。Optimus 提供了一種可在內建 Intel GPU 和獨立 NVIDIA GPU 之間輕鬆切換的機制。專為在省電模式下或以最佳效能執行筆記型電腦而設計：使用 Intel GPU 可省電，使用 NVIDIA GPU 可支援 3D 應用程式。
  </para>

  <para os="sled">
   SUSE Prime 隨附在 SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase> 的 SUSE Linux Enterprise Workstation Extension 中。
  </para>

  <para>
   SUSE Prime 只能在執行 X11 (而不是 Wayland) 的系統上工作。如果您的系統執行 Wayland，您必須將其停用，並回復為 X11 (如果您要使用 SUSE Prime) (請參閱<xref linkend="sec-gui-desktop-suse-prime-prereqs"/>)。
  </para>

  <sect2 xml:id="sec-gui-desktop-suse-prime-prereqs">
   <title>先決條件</title>
    
   
   <para os="sle;sled">
    您必須有一個已設定好可正常運作的 NVIDIA Optimus GPU，並且該 GPU 使用 SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase> 中隨附的 NVIDIA 驅動程式 (請參閱<xref linkend="sec-gui-desktop-install-nvidia"/>)，以及一個內建 Intel GPU。切勿安裝 NVIDIA Optimus 的較舊切換工具 Bumblebee。
   </para>
   
   <para>
    <filename>/etc/X11/xorg.conf.d</filename> 目錄中不能有 <filename>/etc/X11/xorg.conf</filename> 檔案，也不能有作用中「ServerLayout」、「Device」或「Screen」區段的組態檔案。
   </para>
   <para>
    SUSE Prime 僅適用於 X11。請使用 <command>loginctl</command> 指令查看您的系統是使用 X11 還是 Wayland：
   </para>
<screen><prompt>&gt; </prompt>loginctl
   SESSION        UID USER             SEAT             TTY             
         2       1000 tux             seat0               
<prompt>&gt; </prompt>loginctl show-session 2|grep Type
Type=x11
</screen>
   <para>
    如果您的系統使用 Wayland，請編輯 <filename>/etc/gdm/custom.conf</filename> 並取消註解 <literal>WaylandEnable=false</literal> 將其停用。然後重新開機。
   </para>
  </sect2>

  <sect2 xml:id="sec-gui-desktop-suse-prime-install">
   <title>安裝和使用 SUSE Prime</title>

    <para>
      您的 NVIDIA 圖形卡應已安裝且正常工作。如果沒有，請參閱<xref linkend="sec-gui-desktop-install-nvidia"/>。 
    </para>

   <para>
       安裝 <package>suse-prime</package> 套件：
   </para>
       <screen><prompt>&gt; </prompt><command>sudo</command> zypper install suse-prime</screen>
     
   <para>
    若要切換 GPU，請執行以下指令之一，然後登出並重新登入：
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> prime-select intel
<prompt>&gt; </prompt><command>sudo</command> prime-select intel2
<prompt>&gt; </prompt><command>sudo</command> prime-select nvidia
</screen>
   <para>
    如果是 modesetting 驅動程式，請使用 <command>intel</command> 驅動程式。<command>intel2</command> 用於使用 <package>xf86-video-intel</package> 驅動程式的系統。您可以透過安裝和執行 <package>inxi</package>:
   </para>
<screen><prompt>&gt; </prompt>inxi -G
Graphics: Device-1: Intel Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller
          Display Server: x11(X.org 1.20.1 ) drivers: modesetting (unloaded: fbdev, vesa)
          Resolution: 1920x1080@60.00hz
          OpenGL: renderer: Mesa DRI Intel Haswell Desktop version: 4.5 Mesa 18.2.8
      </screen>
   <para>
    哪個 GPU 目前處於作用中狀態？
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> /usr/sbin/prime-select get-current
Driver configured: intel
</screen>
  </sect2>

  <sect2 xml:id="sec-gui-desktop-install-nvidia">
   <title>安裝 NVIDIA 驅動程式</title>
   <para>
    如果您需要識別 NVIDIA 卡以便瞭解要使用哪個驅動程式，請執行以下指令：
</para>
   
<screen><prompt>&gt; </prompt>/sbin/lspci | grep VGA  
</screen>
   
      <para os="sles;sled">
    依照以下步驟使用 Zypper 安裝驅動程式。
   </para>

   

   <para>
    列出可用的驅動程式套件：
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper se nvidia
</screen>
   <para>
    然後為您的 NVIDIA 圖形卡安裝驅動程式：
   </para>
<screen><prompt>&gt; </prompt><command>sudo</command> zypper se <replaceable>packagename</replaceable>
</screen>
  </sect2>
 </sect1>
</chapter>
