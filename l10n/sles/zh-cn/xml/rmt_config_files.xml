<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="rmt_config_files.xml" version="5.0" xml:id="sec-rmt-config">
 <info>
  <title>RMT 配置文件</title>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  RMT 主配置文件为 <filename>/etc/rmt.conf</filename>。您可以使用 YaST RMT 服务器模块设置大部分选项。
 </para>

 <sect2 xml:id="sec-rmt-config-rmtconf">
  <title>/etc/rmt.conf</title>
  <para>
   系统仅支持使用 <command>yast2 rmt</command> 执行初始配置（如<xref linkend="sec-rmt-installation-yast-configuration"/>中所述）。只有代理配置需要手动输入。此处介绍了其他配置参数供您参考。
  </para>
  <para>
   您可在 <filename>/etc/rmt.conf</filename> 文件中找到所有可用的配置选项。
  </para>

  <sect3 xml:id="sec-rmt-config-rmtconf-mirror">
   <title>镜像设置</title>
   <para>
    <literal>mirroring</literal> 部分可让您调整镜像行为。
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>mirror_src</literal></term>
     <listitem>
      <para>
       决定是否镜像源 RPM 软件包（体系结构为 <literal>src</literal>）。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>dedup_method</literal></term>
     <listitem>
      <para>
       如果设为 <literal>hardlink</literal>，将在镜像期间创建硬链接。如果文件系统不支持硬链接，则可将其设为 <literal>copy</literal>。可能的值为：<literal>hardlink</literal>、<literal>copy</literal>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="sec-rmt-config-rmtconf-client">
   <title>HTTP 客户端设置</title>
   <para>
    <literal>http_client</literal> 部分定义 RMT 的全局 HTTP 连接设置。
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>verbose</literal></term>
     <listitem>
      <para>
       可让更多调试输出记录到 <systemitem class="daemon">systemd</systemitem> 日志。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>proxy</literal></term>
     <listitem>
      <para>
       代理服务器 URL。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>noproxy</literal></term>
      <listitem>
        <para>
          不应经由代理连接的域列表（以逗号分隔）。示例：“localhost,.mylocaldomain”
        </para>
      </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>proxy_auth</literal></term>
     <listitem>
      <para>
       此设置决定了代理身份验证机制。可能的值为：<option>none</option>、<option>basic</option>、<option>digest</option>、<option>gssnegotiate</option>、<option>ntlm</option>、<option>digest_ie</option>、<option>ntlm_wb</option>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>proxy_user</literal></term>
     <listitem>
      <para>
       代理服务器用户名。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>proxy_password</literal></term>
     <listitem>
      <para>
       代理服务器口令。
      </para>
     </listitem>
   </varlistentry>
    <varlistentry>
     <term><literal>low_speed_limit</literal></term>
     <listitem>
      <para>
        达到该速度下限时，下载便应中止（以字节/秒为单位）。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>low_speed_time</literal></term>
     <listitem>
      <para>
        当下载速度低于 <literal>low_speed_limit</literal> 时，持续该时间后中止下载。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="sec-rmt-config-rmtconf-access-scc">
   <title>用于访问 SUSE 储存库的设置</title>
   <para>
    <literal>scc</literal> 部分包含您用于连接 SUSE Customer Center 的镜像身份凭证。要获得您的镜像身份凭证，请参见<xref linkend="sec-rmt-mirroring-credentials"/>。
   </para>
   <para>
    该部分的有效配置键包括：
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>username</literal></term>
     <listitem>
      <para>
       镜像身份凭证的用户名。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>password</literal></term>
     <listitem>
      <para>
       镜像身份凭证的口令。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="sec-rmt-config-web-server-settings">
   <title>Web 服务器设置</title>
   <para>
    使用 <literal>web_server</literal> 部分可以调整 RMT 服务器的性能。
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>min_threads</literal></term>
     <listitem>
      <para>
       指定 RMT 服务器工作器产生的最小线程数。
      </para>
      <para>
        可接受的值：大于或等于 1 的整数。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>max_threads</literal></term>
     <listitem>
      <para>
       指定 RMT 服务器工作器产生的最大线程数。
      </para>
      <para>
       可接受的值：大于或等于 1 的整数。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>workers</literal></term>
     <listitem>
      <para>
       指定 RMT 的 Web 工作器数量。
      </para>
      <para>
       可接受的值：大于或等于 1 的整数。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-rmt-config-ssl">
  <title>SSL 证书和 HTTPS</title>
  <para>
   默认情况下，仅允许通过 HTTPS 访问 <command>SUSEConnect</command> 所使用的 API 端点。nginx 配置为使用来自以下位置的 SSL 证书和私用密钥：
  </para>
  <itemizedlist>
   <listitem>
   <para>证书：<filename>/etc/rmt/ssl/rmt-server.crt</filename></para>
   </listitem>
   <listitem>
    <para>私用密钥：<filename>/etc/rmt/ssl/rmt-server.key</filename></para>
   </listitem>
  </itemizedlist>
  <para>
   YaST RMT 模块会生成一个自定义证书颁发机构，用于签署 HTTPS 证书。这意味着如果要注册，此证书颁发机构必须受到客户端计算机的信任：
  </para>
  <itemizedlist>
   <listitem>
    <para>
     从媒体安装期间注册或使用 YaST 注册模块进行注册时，系统会显示一条消息，提示您信任服务器证书。
    </para>
   </listitem>
   <listitem>
    <para>
     通过命令行注册客户端系统时，请使用 <command>rmt-client-setup</command> 脚本。有关详细信息，请参见<xref linkend="sec-rmt-client-clientsetupscript"/>。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>
