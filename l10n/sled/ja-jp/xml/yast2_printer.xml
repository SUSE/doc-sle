<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="yast2_printer.xml" version="5.0" xml:id="sec-yast-hw-print">
 <title>プリンタの設定</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  YaSTを使用して、ローカルプリンタとネットワークプリンタを設定できます。印刷に関する詳細(一般情報、技術詳細、トラブルシューティング)は、<xref linkend="cha-print"/>に記載されています。
 </para>

 <para>
  YaSTで<menuchoice> <guimenu>ハードウェア</guimenu>
  <guimenu>プリンタ</guimenu> </menuchoice>の順に選択してプリンタモジュールを起動します。デフォルトでは、モジュールが<guimenu>プリンタ設定</guimenu>画面で開き、使用可能な設定済みのプリンタをすべて一覧します。これは、ネットワークを介して多数のプリンタにアクセスできる環境で、特に役に立ちます。ここから、<guimenu>テストページの印刷</guimenu>を実行し、プリンタを設定することもできます。
 </para>

 <note>
  <title>CUPSの起動</title>
  <para>
   マシンに接続されたプリンタを使用するには、システムにCUPSがインストールされ、実行されている必要があります。CUPSが実行されていない場合、起動するよう求められます。ブート時にCUPSが起動していない場合、これを有効にすることも求められます(推奨)。
  </para>
 </note>

 <sect1 xml:id="sec-yast-hw-print-local">
  <title>プリンタの環境設定</title>
  <para>
   通常、USBプリンタは自動検出されます。自動検出されない場合は、プリンタの電源がオンになっていて、マシンに接続されているか確認します。
  </para>
  <para>
   プリンタの設定プロセスは3つのステップで構成されます。つまり、接続タイプを指定し、ドライバを選択し、このセットアップ用の印刷キューに名前を付けます。
  </para>
  <para>
   多くのプリンタモデルは複数のドライバを利用できます。プリンタを設定するとき、YaSTはデフォルトでこれらに<literal>recommended</literal>のマークを付けます。通常は、ドライバを変更する必要はありません。ただし、カラープリンタでモノクロ印刷だけをしたい場合は、カラー印刷をサポートしないドライバを使用できます。画像印刷時にPostScriptプリンタでパフォーマンス上の問題が発生する場合は、PostScriptからPCLドライバに変更してみてください(ただし、使用するプリンタがPCLを理解できる場合)。
  </para>
  <para>
   プリンタ用ドライバがリストされていない場合は、該当する標準言語を使用する汎用ドライバをリストから選択してみてください。プリンタのマニュアルを参照して、プリンタがサポートしている言語(プリンタを制御するコマンドのセット)を見つけてください。これでうまくいかない場合は、<xref linkend="sec-yast-hw-print-local-get-ppd"/>を参照して他の解決方法を試してください。
  </para>
  <para>
   プリンタは、常に印刷キューを介して使用されます。これにより、同時実行ジョブをキューに入れ、1つずつ処理することができます。各印刷キューは、特定のドライバに割り当てられ、プリンタは、複数のキューを持つことができます。これにより、たとえば、カラープリンタ上に、モノクロでだけ印刷する2つ目のキューを設定することができます。印刷キューの詳細については、<xref linkend="sec-print-workflow"/>を参照してください。
  </para>
  <procedure xml:id="pro-y2-hw-print-local-config">
   <title>新しいプリンタを追加する</title>
   <step>
    <para>
     <menuchoice>
     <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu></menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>プリンタ設定</guimenu>画面で<guimenu>追加</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     プリンタがすでに<literal>Specify the
     Connection</literal>の下に一覧されている場合は、次のステップに進みます。そうでない場合は、<guimenu>さらに検出</guimenu>を試すか、または<guimenu>接続ウィザード</guimenu>を起動します。
    </para>
   </step>
   <step>
    <para>
     <literal>Find and Assign a Driver</literal>にあるテキストボックスにベンダ名とモデル名を入力し、<guimenu>検索</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     プリンタに適したドライバを選択します。最初に表示されるドライバを選択することをお勧めします。適切なドライバが表示されない場合、次を試してみます。
    </para>
    <substeps performance="required">
     <step>
      <para>
       検索条件をチェックします。
      </para>
     </step>
     <step>
      <para>
       <guimenu>検出を再度実行する (&amp;F)</guimenu>をクリックして、検索を拡張します。
      </para>
     </step>
     <step>
      <para>
       <xref linkend="sec-yast-hw-print-local-get-ppd"/>の説明のとおり、ドライバを追加します。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     <literal>Default paper size</literal>を指定します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>任意の名前の設定</guimenu>フィールドに、印刷キューの固有の名前を入力します。
    </para>
   </step>
   <step>
    <para>
     これで、プリンタはデフォルト値で設定され、使用可能な状態になりました。<guimenu>OK</guimenu>をクリックして、<guimenu>プリンタ設定</guimenu>画面に戻ります。新しく設定されたプリンタがプリンタ一覧に表示されます。
    </para>
   </step>
  </procedure>
  <sect2 xml:id="sec-yast-hw-print-local-get-ppd">
   <title>YaSTによるドライバの追加</title>
   <para>
    <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>で使用可能なすべてのプリンタドライバがデフォルトでインストールされるわけではありません。プリンタを追加する際に、<guimenu>ドライバの検索と割り当て</guimenu>ダイアログに適切なドライバがない場合は、プリンタ用ドライバを含むドライバパッケージをインストールします。
   </para>
   <procedure>
    <title>追加のドライバパッケージをインストールする</title>
    <step>
     <para>
      <menuchoice>
      <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>プリンタ設定</guimenu>画面で<guimenu>追加</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      <literal>Find and Assign a Driver</literal>セクションで<guimenu>ドライバパッケージ</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      リストから1つまたは複数の適切なドライバパッケージを選択します。プリンタ記述ファイルへのパスは指定<emphasis>しないでください</emphasis>。
     </para>
    </step>
    <step>
     <para>
      <guimenu>OK</guimenu>を選択し、パッケージのインストールを確認します。
     </para>
    </step>
    <step>
     <para>
      これらのドライバを直接使用するには、<xref linkend="pro-y2-hw-print-local-config"/>の説明に従って続行します。
     </para>
    </step>
   </procedure>
   <para>
    PostScriptプリンタでは、プリンタドライバソフトウェアが不要です。PostScriptプリンタは、特定のモデルに適したPPD (PostScript Printer Description )ファイルのみを必要としています。PPDファイルは、プリンタの製造元から提供されます。
   </para>
   <para>
    PostScriptプリンタを追加するときに、<guimenu>ドライバの検出と割り当て</guimenu>ダイアログに適切なPPDファイルが表示されない場合は、ご使用のプリンタに適したPPDファイルをインストールしてください。
   </para>
   <para>
    PPDファイルには複数のソースがあります。まず、<phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>に付属している追加のドライバパッケージのうち、デフォルトでインストールされていないものを試してみることをお勧めします(インストール手順については後で説明します)。これらのパッケージに、ご使用のプリンタに適したドライバが含まれていない場合、PPDファイルは、プリンタベンダから直接か、またはPostScriptプリンタのドライバCDから入手します。詳細については、<xref linkend="sec-print-prob-ppd"/>を参照してください。PPDファイルは、<link xlink:href="https://www.openprinting.org/printers"/>の<quote>OpenPrinting.org printer database</quote>で見つけることもできます。OpenPrintingからPPDファイルを使用する場合、これらは、<phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>でサポートされていない場合があることに注意してください。
   </para>
   <procedure>
    <title>PostScriptプリンタのPPDファイルを追加する</title>
    <step>
     <para>
      <menuchoice>
      <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>プリンタ設定</guimenu>画面で<guimenu>追加</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      <literal>Find and Assign a Driver</literal>セクションで<guimenu>ドライバパッケージ</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      PPDファイルへの完全パスを<literal>Make
      a Printer Description File Available</literal>の下のテキストボックスに入力します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>OK</guimenu>をクリックして、<literal>Add New Printer
      Configuration</literal>画面に戻ります。
     </para>
    </step>
    <step>
     <para>
      このPPDファイルを直接使用するには、<xref linkend="pro-y2-hw-print-local-config"/>の説明に従って続行します。
     </para>
    </step>
   </procedure>
  </sect2>
  <sect2 xml:id="sec-yast-hw-print-local-tune">
   <title>ローカルプリンタ設定の編集</title>
   <para>
    プリンタの既存の設定を編集することで、接続タイプやドライバなどの基本設定を変更できるだけでなく、用紙サイズ、解像度、メディアソースなどのデフォルト設定を調整することもできます。プリンタの説明や場所を変更することで、プリンタの識別子を変更できます。
   </para>
   <procedure>
    <step>
     <para>
      <menuchoice>
      <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>プリンタ設定</guimenu>画面で、リストからローカルプリンタ設定を選択し、<guimenu>編集</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      接続タイプまたはドライバを変更します(<xref linkend="pro-y2-hw-print-local-config"/>参照)。この手順は、現在の設定で問題がある場合にのみ必要です。
     </para>
    </step>
    <step>
     <para>
      必要に応じて<guimenu>既定のプリンタ</guimenu>を選択して、このプリンタをデフォルトにします。
     </para>
    </step>
    <step>
     <para>
      <guimenu>現在のドライバに対する全てのオプション</guimenu>をクリックして、デフォルト設定を調整します。設定を変更するには、<literal>+</literal>記号をクリックしてオプションのリストを展開します。オプションをクリックして、デフォルトを変更します。変更内容を反映するには、<guimenu>OK</guimenu>をクリックします。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-yast-hw-print-network">
  <title>YaSTによるネットワーク印刷の設定</title>
  <para>
   ネットワークプリンタは、自動的には検出されません。ネットワークプリンタは、YaSTのプリンタモジュールを使用して手動で設定する必要があります。ネットワークの設定内容に応じて、印刷サーバ(CUPS、LPD、SMB、またはIPX)に印刷したり、ネットワークプリンタに直接印刷(TCP経由を推奨)することができます。YaSTのプリンタモジュールの左ペインで<guimenu>ネットワーク経由で印刷する</guimenu>を選択してネットワーク印刷の設定画面にアクセスします。
  </para>
  <sect2 xml:id="sec-yast-hw-print-network-cups">
   <title>CUPSの使用</title>
   <para>
    Linux環境では、ネットワークを介した印刷に、CUPSが使用されます。最も簡単なセットアップは、すべてのクライアントが直接アクセスできる1つのCUPSサーバだけを使用する印刷です。複数のCUPSサーバによる印刷では、リモートCUPSサーバと通信するCUPSデーモンが稼動中であることが必要です。
   </para>
   <important>
    <title>ネットワーク印刷キューの参照</title>
    <para>
     CUPSサーバでは、ネットワークを介して印刷キューをアナウンスする際に、従来のCUPS参照プロトコルまたはBonjour/DNS-SDが使用されます。ユーザが自分の印刷ジョブをどのプリンタに送信するかを選択できるようにクライアントでこれらのリストを参照する必要があります。ネットワーク印刷キューを参照するには、<systemitem class="resource">cups-filters-cups-browsed</systemitem>パッケージに付属する<systemitem class="daemon">cups-browsed</systemitem>サービスを、CUPSサーバを介して印刷するすべてのクライアントで実行する必要があります。<systemitem class="daemon">cups-browsed</systemitem>は、YaSTでネットワーク印刷を設定すると自動的に起動します。
    </para>
    <para>
     <systemitem class="daemon">cups-browsed</systemitem>を起動してもブラウズできない場合は、CUPSサーバがBonjour/DNS-SDを介してネットワーク印刷キューをアナウンスしている可能性があります。この場合、<systemitem class="resource">avahi</systemitem>パッケージを追加インストールし、すべてのクライアントに対して<command>sudo systemctl start avahi-daemon</command>を実行することで、関連するサービスを起動する必要があります。
    </para>
   </important>
   <procedure>
    <title>1つのCUPSサーバを介して印刷する</title>
    <step>
     <para>
      <menuchoice>
      <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
     </para>
    </step>
    <step>
     <para>
      左側のペインで、<guimenu>ネットワーク経由で印刷する</guimenu>を選択します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>すべての印刷を1つのCUPSサーバ経由で直接行う</guimenu>をオンにして、サーバの名前またはIPアドレスを指定します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>テストサーバ</guimenu>をクリックして、正しい名前またはIPアドレスが選択されていることを確認します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>OK</guimenu>をクリックして、<guimenu>プリンタ設定</guimenu>画面に戻ります。これで、CPUSサーバを介して利用できるすべてのプリンタが一覧されます。
     </para>
    </step>
   </procedure>
   <procedure>
    <title>複数のCUPSサーバを介して印刷する</title>
    <step>
     <para>
      <menuchoice>
      <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
     </para>
    </step>
    <step>
     <para>
      左側のペインで、<guimenu>ネットワーク経由で印刷する</guimenu>を選択します。
     </para>
    </step>
    <step>
     <para>
      <guimenu>CUPSサーバからのプリンタアナウンスメントを受け入れる</guimenu>を選択します。
     </para>
    </step>
    <step>
     <para>
      <literal>General Settings</literal>の下で、使用するサーバを指定します。すべての使用可能なネットワーク、または特定のホストからの接続を受け入れることができます。最後のオプションを選択する場合は、ホスト名またはIPアドレスを指定する必要があります。
     </para>
    </step>
    <step>
     <para>
      ローカルCUPSサーバの起動を要求されたら、<guimenu>OK</guimenu>をクリックし、次に<guimenu>はい</guimenu>をクリックします。サーバが起動すると、YaSTの画面は<guimenu>プリンタ設定</guimenu>画面に戻ります。<guimenu>一覧を更新</guimenu>をクリックして、これまでに検出されたプリンタを参照します。
     </para>
    </step>
   </procedure>
  </sect2>
  <sect2 xml:id="sec-yast-hw-print-network-other">
   <title>CUPS以外の印刷サーバの使用</title>
   <para>
    CUPS以外の印刷サーバから印刷サービスを提供しているネットワークでは、<menuchoice>
    <guimenu>ハードウェア</guimenu><guimenu>プリンタ</guimenu></menuchoice>の順に選択してYaSTのプリンタモジュールを起動し、左ペインから<guimenu>ネットワーク経由で印刷する</guimenu>を選択します。<guimenu>接続ウィザード</guimenu>を起動し、該当する<guimenu>接続タイプ</guimenu>を選択します。ご利用の環境でのネットワークプリンタの設定については、ネットワーク管理者にお問い合わせください。
   </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-yast-hw-print-share">
  <title>ネットワーク上のプリンタ共有</title>
  <para>
   ローカルCUPSデーモンが管理するプリンタは、ネットワーク上で共有できます。その場合、実質的にローカルコンピュータがCUPSサーバになります。プリンタを共有するには、CUPSのいわゆる<quote>ブラウジングモード</quote>を有効にします。ブラウジングを有効にした場合は、リモートCUPSデーモンをリッスンするために、ローカル印刷キューがネットワーク上で利用可能になります。また、専用のCUPSサーバをセットアップして、そのサーバですべての印刷キューを管理し、リモートクライアントをそのサーバに直接アクセスさせることも可能です。この場合、ブラウジングを有効にする必要はありません。
  </para>
  <procedure>
   <title>プリンタを共有する</title>
   <step>
    <para>
     <menuchoice>
     <guimenu>ハードウェア</guimenu> <guimenu>プリンタ</guimenu> </menuchoice>の順に選択して、YaSTのプリンタモジュールを起動します。
    </para>
   </step>
   <step>
    <para>
     左側のペインから<guimenu>プリンタの共有</guimenu>を選択します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>リモートアクセスを許可する</guimenu>を選択します。<guimenu>ローカルネットワーク内のコンピュータ向け</guimenu>を選択します。さらに、<guimenu>既定でローカルネットワーク内にプリンタを公開</guimenu>も選択して参照モードを有効にします。
    </para>
   </step>
   <step>
    <para>
     <guimenu>OK</guimenu>をクリックしてCUPSサーバを再起動し、<guimenu>プリンタ設定</guimenu>画面に戻ります。
    </para>
   </step>
   <step>
    <para>
     CUPSと ファイアウォールの設定については、<link xlink:href="https://en.opensuse.org/SDB:CUPS_and_SANE_Firewall_settings"/>を参照してください。
    </para>
   </step>
  </procedure>
 </sect1>
</chapter>
