<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="grub2.xml" id="cha.grub2">
 <title>開機載入程式 GRUB 2</title><indexterm> <primary>開機</primary> <secondary>GRUB 2</secondary></indexterm><indexterm> <primary>GRUB 2</primary></indexterm>
 <abstract>
  <para>
   本章介紹如何設定 <phrase role="productname"><phrase os="sled">SUSE® Linux Enterprise Desktop</phrase></phrase> 中使用的開機載入程式 GRUB 2。GRUB 2 是傳統 GRUB 開機載入程式 (現在稱做<quote>GRUB 2 Legacy</quote>) 的後繼產品。從 <phrase role="productname"><phrase os="sled">SUSE® Linux Enterprise Desktop</phrase></phrase> 12 版本開始，使用 GRUB 2 做為預設的開機載入程式。產品中提供了一個 YaST 模組來進行最重要的設定。整個開機程序簡述於<xref linkend="cha.boot"/>。如需關於 UEFI 機器安全開機支援的詳細資訊，請參閱<xref linkend="cha.uefi"/>。
  </para>
 </abstract>
 <sect1 id="sec.grub2.new.features">
  <title>GRUB Legacy 與 GRUB 2 之間的主要差異</title>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     組態儲存在不同的檔案中。
    </para>
   </listitem>
   <listitem>
    <para>
     支援更多的檔案系統 (例如 Btrfs)。
    </para>
   </listitem>
   <listitem>
    <para>
     可以直接讀取 LVM 或 RAID 裝置上儲存的檔案。
    </para>
   </listitem>
   <listitem>
    <para>
     使用者介面可翻譯，並可以改變主題。
    </para>
   </listitem>
   <listitem>
    <para>
     包含一套用於載入模組的機制，以支援諸如檔案系統等的其他功能。
    </para>
   </listitem>
   <listitem>
    <para>
     自動搜尋及產生其他核心與作業系統 (例如 Windows) 的開機項目。
    </para>
   </listitem>
   <listitem>
    <para>
     包含一個類似於 Bash 的精簡主控台。
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 id="sec.grub2.file_structure">
  <title>組態檔案結構</title>

  <para>
   GRUB 2 的組態以下列檔案為基礎：
  </para>

  <variablelist>
   <varlistentry>
    <term><filename>/boot/grub2/grub.cfg</filename> <indexterm> <primary>GRUB 2</primary> <secondary>grub.cfg</secondary></indexterm></term>
    <listitem>
     <para>
      此檔案包含 GRUB 2 功能表項目的組態。它取代了 GRUB Legacy 中的 <filename>menu.lst</filename>。<filename>grub.cfg</filename> 由 <xref linkend="vle.grub2.mkconfig"/> 指令自動產生，不應該對其進行編輯。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/boot/grub2/custom.cfg</filename> <indexterm> <primary>GRUB 2</primary> <secondary>custom.cfg</secondary></indexterm></term>
    <listitem>
     <para>
      這個可選用檔案在開機時由 <filename>grub.cfg</filename> 直接獲取，可用於將自定項目新增至開機功能表。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/default/grub</filename> <indexterm> <primary>GRUB 2</primary> <secondary>/etc/default/grub</secondary></indexterm></term>
    <listitem>
     <para>
      此檔案控制 GRUB 2 的使用者設定，通常包含背景和主題等額外的環境設定。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/grub.d/</filename> 下的程序檔<indexterm> <primary>GRUB 2</primary> <secondary>/etc/grub.d/</secondary></indexterm></term>
    <listitem>
     <para>
      在執行 <xref linkend="vle.grub2.mkconfig"/> 指令期間，將會讀取此目錄中的程序檔。主要組態檔案 <filename>/boot/grub/grub.cfg</filename> 中整合了這些程序檔的指示。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.grub2.sysconfig">
    <term><filename>/etc/sysconfig/bootloader</filename> <indexterm> <primary>GRUB 2</primary> <secondary>sysconfig/bootloader</secondary></indexterm></term>
    <listitem>
     <para>
      在使用 YaST 設定開機載入程式以及每次安裝新核心時，會用到此組態檔案。它將經過 perl-bootloader 的評估，後者會相應地修改開機載入程式組態檔案 (例如，GRUB 2 對應的組態檔案 <filename>/boot/grub 2/grub.cfg</filename>)。<filename>/etc/sysconfig/bootloader</filename> 不是特定於 GRUB 2 的組態檔案，其值會套用於 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 上安裝的任何開機載入程式。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename arch="x86_64">/boot/grub2/x86_64-efi、</filename>
     
    </term>
    <listitem>
     <para>
      這些組態檔案包含特定於架構的選項。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   可以透過多種方式控制 GRUB 2。現有組態啟動項目，可以從圖形功能表選取 (開頭顯示畫面)。組態從基於其他組態檔案編譯的檔案 <filename>/boot/grub2/grub.cfg</filename> 載入 (參閱下文)。所有 GRUB 2 組態檔案都被視為系統檔案，編輯這些組態檔案需要有 <systemitem class="username">root</systemitem> 權限。
  </para>

  <note>
   <title>啟用組態變更</title>
   <para>
    手動編輯 GRUB 2 組態檔案後，您需要執行 <xref linkend="vle.grub2.mkconfig"/> 才能啟用變更。但使用 YaST 變更組態時就不需要如此，因為 YaST 會自動執行 <xref linkend="vle.grub2.mkconfig"/>。
   </para>
  </note>

  <sect2 id="sec.grub2.cfg">
   <title>檔案 <filename>/boot/grub2/grub.cfg</filename></title><indexterm> <primary>組態檔案</primary> <secondary>grub.cfg</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>開機功能表</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>grub.cfg</secondary></indexterm>
   <para>
    帶有開機功能表的圖形開頭顯示畫面內容由 GRUB 2 組態檔案 <filename>/boot/grub2/grub.cfg</filename> 控制，該檔案包含關於可以透過功能表開機之所有分割區或作業系統的資訊。
   </para>
   <para>
    系統每次開機時，GRUB 2 會直接從檔案系統載入功能表檔案。因此，在變更組態檔案後不需要重新安裝 GRUB 2。安裝或移除核心後，系統會自動重建 <filename>grub.cfg</filename>。
   </para>
   <para>
    <filename>grub.cfg</filename> 由 <xref linkend="vle.grub2.mkconfig"/> 基於檔案 <filename>/etc/default/grub</filename> 以及 <filename>/etc/grub.d/</filename> 目錄中的程序檔編譯。因此，切勿手動編輯該檔案，而應該編輯相關的來源檔案，或者依照<xref linkend="sec.grub2.yast2.config"/>中所述，使用 YaST 的<guimenu>開機載入程式</guimenu>模組來修改組態。
   </para>
  </sect2>

  <sect2 id="sec.grub2.etc_default_grub">
   <title>檔案 <filename>/etc/default/grub</filename></title><indexterm> <primary>組態檔案</primary> <secondary>/etc/default/grub</secondary></indexterm><indexterm> <primary>GRUB 2</primary> <secondary>/etc/default/grub</secondary></indexterm>
   <para>
    此檔案包含 GRUB 2 的更多一般選項，例如，顯示功能表的時間，或者要開機的預設作業系統。若要列出所有可用選項，請查看以下指令的輸出：
   </para>
<screen>grep "export GRUB_DEFAULT" -A50 /usr/sbin/grub2-mkconfig | grep GRUB_</screen>
   <para>
    除了已定義的變數外，使用者還可以引入自己的變數，日後在 <filename>/etc/grub.d</filename> 目錄下的程序檔內使用。
   </para>
   <para>
    編輯 <filename>/etc/default/grub</filename> 後，請執行 <xref linkend="vle.grub2.mkconfig"/> 以更新主要組態檔案。
   </para>
   <note>
    <title>範圍</title>
    <para>
     此檔案中設定的所有選項都是會影響所有開機項目的一般選項。透過 GRUB_*_XEN_* 組態選項可以設定 Xen 核心或 Xen 監管程式的特定選項。如需詳細資訊，請參閱下文。
    </para>
   </note>
   <variablelist>
    <varlistentry>
     <term><literal>GRUB_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       設定預設會啟動的開機功能表項目。它的值可以是數值、功能表項目的完整名稱，或者<quote>saved</quote>。
      </para>
      <para>
       <literal>GRUB_DEFAULT=2</literal> 會啟動第三個 (從零開始計數) 開機功能表項目。
      </para>
      <para>
       <literal>GRUB_DEFAULT="2&gt;0"</literal> 會啟動第三個頂層功能表項目的第一個子功能表項目。
      </para>
      <para>
       <literal>GRUB_DEFAULT="Example boot menu entry"</literal> 會啟動名為<quote>Example boot menu entry</quote>的功能表項目。
      </para>
      <para>
       <literal>GRUB_DEFAULT=saved</literal> 會啟動 <command>grub2-reboot </command> 或 <command>grub2-set-default </command> 指令指定的項目。<command>grub2-reboot</command> 只設定下一次重新開機的預設開機項目，而 <command>grub2-set-default</command> 設定發生變更之前的預設開機項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_HIDDEN_TIMEOUT</literal>
     </term>
     <listitem>
      <para>
       等待使用者按某個鍵的指定秒數。在此期間，除非使用者按下某個鍵，否則不顯示功能表。如果使用者在指定的時間內未按任何鍵，控制權將移交給 <literal>GRUB_TIMEOUT</literal>。<literal>GRUB_HIDDEN_TIMEOUT=0</literal> 首先會檢查是否按下了 <keycap function="shift"/>，如果是，則顯示開機功能表，否則會立即啟動預設的功能表項目。如果 GRUB 2 只識別了一個可開機作業系統，則預設行為就是如此。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_HIDDEN_TIMEOUT_QUIET</literal>
     </term>
     <listitem>
      <para>
       如果指定 <literal>false</literal>，那麼當啟動了 <literal>GRUB_HIDDEN_TIMEOUT</literal> 功能時，系統會在一個空白螢幕上顯示倒數計時器。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_TIMEOUT</literal>
     </term>
     <listitem>
      <para>
       在自動啟動預設開機項目之前，開機功能表顯示的時間期限，以秒為單位。如果按下某個鍵，則會取消逾時，GRUB 2 將等待您手動完成選擇。如果指定 <literal>GRUB_TIMEOUT=-1</literal>，則在您手動選取開機項目之前，功能表會一直顯示。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX</literal>
     </term>
     <listitem>
      <para>
       此行中的項目將新增到正常和復原模式之開機項目的末尾。使用它可以將核心參數新增至開機項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       與 <literal>GRUB_CMDLINE_LINUX</literal> 一樣，但只能在正常模式下附加項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_RECOVERY</literal>
     </term>
     <listitem>
      <para>
       與 <literal>GRUB_CMDLINE_LINUX</literal> 一樣，但只能在復原模式下附加項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_XEN_REPLACE</literal>
     </term>
     <listitem>
      <para>
       此項目將徹底取代所有 Xen 開機項目的 <literal>GRUB_CMDLINE_LINUX</literal> 參數。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_LINUX_XEN_REPLACE_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       與 <literal>GRUB_CMDLINE_LINUX_XEN_REPLACE</literal> 一樣，但它只會取代 <literal>GRUB_CMDLINE_LINUX_DEFAULT</literal> 的參數。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_XEN</literal>
     </term>
     <listitem>
      <para>
       此項目只為 Xen 客體核心指定核心參數 — 工作原理與 <literal>GRUB_CMDLINE_LINUX</literal> 相同。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_CMDLINE_XEN_DEFAULT</literal>
     </term>
     <listitem>
      <para>
       與 <literal>GRUB_CMDLINE_XEN</literal> 一樣 — 工作原理與 <literal>GRUB_CMDLINE_LINUX_DEFAULT</literal> 相同。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_TERMINAL</literal>
     </term>
     <listitem>
      <para>
       啟用並指定輸入/輸出終端機裝置。可以是 <literal>console</literal> (PC BIOS 和 EFI 主控台)、<literal>serial</literal> (序列終端機)、<literal>ofconsole</literal> (開放韌體主控台) 或預設值 <literal>gfxterm</literal> (圖形模式輸出)。用引號括住所需的多個選項可以啟用多個裝置，例如 <literal>GRUB_TERMINAL="console serial"</literal>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_GFXMODE</literal>
     </term>
     <listitem>
      <para>
       <literal>gfxterm</literal> 圖形終端機使用的解析度。請注意，您只能使用您的圖形卡 (VBE) 支援的模式。預設值為「auto」，即嘗試選取偏好的解析度。在 GRUB 2 指令行中輸入 <command>vbeinfo</command> 可以顯示 GRUB 2 可用的螢幕解析度。當 GRUB 2 開機功能表螢幕顯示時，輸入 <keycap>c</keycap> 可存取指令行。
      </para>
      <para>
       您還可以在解析度設定後面附加一個值來指定色彩深度，例如 <literal>GRUB_GFXMODE=1280x1024x24</literal>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_BACKGROUND</literal>
     </term>
     <listitem>
      <para>
       設定 <literal>gfxterm</literal> 圖形終端機的背景影像。該影像必須是 GRUB 2 在開機時可讀的檔案，並且必須以 <literal>.png</literal>、<literal>.tga</literal>、<literal>.jpg</literal> 或 <literal>.jpeg</literal> 字尾結尾。必要時，系統會縮放該影像以適合螢幕大小。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>GRUB_DISABLE_OS_PROBER</literal>
     </term>
     <listitem>
      <para>
       如果將此選項設定為 <literal>true</literal>，將會停用自動搜尋其他作業系統的功能。系統只會偵測 <filename>/boot/</filename> 中的核心影像，以及 <filename>/etc/grub.d/</filename> 中您自己的程序檔內的選項。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>SUSE_BTRFS_SNAPSHOT_BOOTING</literal>
     </term>
     <listitem>
      <para>
       如果將此選項設定為 <literal>true</literal>，GRUB 2 可直接開機至 Snapper 快照。如需詳細資訊，請參閱<xref linkend="sec.snapper.snapshot-boot"/>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <note>
    <para>
     所有 <literal>*_DEFAULT</literal> 參數都可以手動或者使用 YaST 處理。
    </para>
   </note>
   <para>
    如需選項的完整清單，請參閱 <ulink url="http://www.gnu.org/software/grub/manual/grub.html#Simple-configuration">GNU GRUB 手冊</ulink>。如需可能參數的完整清單，請參閱 <ulink url="http://en.opensuse.org/Linuxrc"/>。
   </para>
  </sect2>

  <sect2 id="sec.grub2.etc_grub_d">
   <title><filename>/etc/grub.d</filename> 中的程序檔</title>
   <para>
    系統在執行 <xref linkend="vle.grub2.mkconfig"/> 指令期間，將讀取此目錄中的程序檔，這些程序檔的指示都整合到 <filename>/boot/grub2/grub.cfg</filename> 中。<filename>grub.cfg</filename> 中功能表項目的順序由此目錄中檔案的執行順序來決定。具有前置編號的檔案先執行，從最小的編號開始。<filename>00_header</filename> 在 <filename>10_linux</filename> 之前執行，而後者又在 <filename>40_custom</filename> 之前執行。如果存在採用字母名稱的檔案，這些檔案將在採用編號命名的檔案之後執行。在執行 <command>grub2-mkconfig</command> 期間，只有可執行檔才能在 <filename>grub.cfg</filename> 中產生輸出。依預設，<filename>/etc/grub.d</filename> 目錄中的所有檔案都是可執行檔。最重要的程序檔包括：
   </para>
   <variablelist>
    <varlistentry>
     <term><filename>00_header</filename>
     </term>
     <listitem>
      <para>
       設定環境變數，例如系統檔案位置、顯示設定、主題和以前儲存的項目。它還可以輸入 <filename>/etc/default/grub</filename> 中儲存的優先設定。通常，您不需要變更此檔案。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>10_linux</filename>
     </term>
     <listitem>
      <para>
       識別根裝置上的 Linux 核心，並建立相關的功能表項目，其中包括關聯的復原模式選項 (如果已啟用)。主功能表頁面中只顯示最新核心，其他核心包含在子功能表中。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>30_os-prober</filename>
     </term>
     <listitem>
      <para>
       此程序檔使用 <command>OS-prober</command> 來搜尋 Linux 和其他作業系統，並將結果放入 GRUB 2 功能表。其中的某些區段用於識別其他特定作業系統，例如 Windows 或 OS X。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>40_custom</filename>
     </term>
     <listitem>
      <para>
       使用此檔案可以方便地在 <filename>grub.cfg</filename> 中包含自定開機項目。切勿變更開頭的 <literal>exec tail -n +3 $0</literal> 部分。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>90_persistent</filename>
     </term>
     <listitem>
      <para>
       這是一個特殊程序檔，它可以複製 <filename>grub.cfg</filename> 檔案的相應部分，並依原樣輸出其內容。這樣，您便可以直接修改 <filename>grub.cfg</filename> 的相應部分，並且所做的變更在執行 <xref linkend="vle.grub2.mkconfig"/> 後可以保留下來。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    處理順序依據前置編號確定，編號最小的程序檔最先執行。如果多個程序檔的前置編號相同，則按整個名稱的字母順序來決定執行順序。
   </para>
  </sect2>

  <sect2 id="sec.grub2.map">
   <title>BIOS 磁碟機與 Linux 裝置之間的映射</title><indexterm> <primary>GRUB 2</primary> <secondary>device.map</secondary></indexterm>
   <para>
    在 GRUB Legacy 中，<filename>device.map</filename> 組態檔案用於依據 BIOS 磁碟機代號衍生 Linux 裝置名稱。不一定總能猜對 BIOS 磁碟機與 Linux 裝置之間的映射。例如，如果在 BIOS 組態中交換了 IDE 和 SCSI 驅動器的開機順序，那麼 GRUB Legacy 就會使用錯誤的順序。
   </para>
   <para>
    GRUB 2 在產生 <filename>grub.cfg</filename> 時使用裝置 ID 字串 (UUID) 或檔案系統標籤，因此避免了此問題。GRUB 2 公用程式會即時建立一個暫存裝置映射，這通常足以滿足需要，在單磁碟系統中更是如此。
   </para>
   <para>
    但是，如果您需要覆寫 GRUB 2 的自動裝置映射機制，請建立自定映射檔案 <filename>/boot/grub2/device.map</filename>。下面的範例將變更映射，使 <literal>DISK 3</literal> 成為開機磁碟。請注意，GRUB 2 分割區編號以 <literal>1</literal> 開始，而不是像 GRUB Legacy 中那樣以 <literal>0</literal> 開始。
   </para>
<screen>(hd1)  /dev/disk-by-id/<replaceable>DISK3 ID</replaceable>
(hd2)  /dev/disk-by-id/<replaceable>DISK1 ID</replaceable>
(hd3)  /dev/disk-by-id/<replaceable>DISK2 ID</replaceable></screen>
  </sect2>

  <sect2 id="sec.grub2.menu_change">
   <title>在開機程序期間編輯功能表項目</title><indexterm> <primary>GRUB 2</primary> <secondary>功能表編輯器</secondary></indexterm>
   <para>
    當系統由於組態錯誤而不再能夠開機時，如果能夠直接編輯功能表項目，就會很有幫助。使用功能表編輯器還可以在不變更系統組態的情況下測試新設定。
   </para>
   <procedure>
    <step performance="required">
     <para>
      在圖形開機功能表中，使用方向鍵選取要編輯的項目。
     </para>
    </step>
    <step performance="required">
     <para>
      按 <keycap>E</keycap> 開啓文字型編輯器。
     </para>
    </step>
    <step performance="required">
     <para>
      使用方向鍵移到您要編輯的行。
     </para>
     <figure id="fig.grub2.boot.editor">
      <title>GRUB 2 開機編輯器</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="grub2_edit_config.png" width="75%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="grub2_edit_config.png" width="75%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      現在，您可以採取以下兩種做法：
     </para>
     <substeps performance="required">
      <step performance="required">
       <para>
        將用空格分隔的參數新增到以 <literal>linux</literal> 或 <literal>linuxefi</literal> 開頭的行的末尾，以編輯核心參數。<ulink url="http://en.opensuse.org/Linuxrc"/> 上提供了完整的參數清單。
       </para>
      </step>
      <step performance="required">
       <para>
        或者編輯一般選項，以變更核心版本等。按 <keycap function="tab"/> 鍵會顯示所有可能的補齊建議。
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      按 <keycap>F10</keycap> 使用您所做的變更將系統開機，或者按 <keycap function="escape"/> 放棄您的編輯，並返回 GRUB 2 功能表。
     </para>
    </step>
   </procedure>
   <para>
    透過這種方式進行的變更只會套用到目前的開機過程，而不會永久儲存。
   </para>
   <important>
    <title>開機程序期間的鍵盤配置</title>
    <para>
     US 鍵盤配置是啟動時唯一可以使用的鍵盤配置。請參閱<xref linkend="fig.trouble.install.keyboard_us"/>。
    </para>
   </important>
   <note arch="x86_64">
    <title>安裝媒體中的開機載入程式</title>
    <para>
     在使用傳統 BIOS 的系統上，安裝媒體的開機載入程式仍是 GRUB Legacy。若要新增開機選項，請選取一個項目，然後開始輸入。在安裝開機項目中新增的內容將永久儲存在安裝的系統中。
    </para>
   </note>
   
  </sect2>

  <sect2 id="sec.grub2.password">
   <title>設定啟動密碼</title><indexterm> <primary>GRUB 2</primary> <secondary>開機密碼</secondary></indexterm>
   <para>
    即使是在作業系統開機之前，GRUB 2 也支援對檔案系統的存取。沒有 root 許可權的使用者可以存取 Linux 系統中的檔案，而在系統開機後，他們將無權存取這些檔案。若要阻擋此類型的存取，或防止使用者啟動特定的功能表項目，請設定開機密碼。
   </para>
   <important>
    <title/>
    <para>
     如果設定了開機密碼，則每次開機時都需要輸入該密碼，這意味著系統不會自動開機。
    </para>
   </important>
   <para>
    按如下步驟設定開機密碼。或者使用 YaST (<xref linkend="vle.grub2.yast2.boot.password"/>)。
   </para>
   <procedure>
    <step performance="required">
     <para>
      使用 <command>grub2-mkpasswd-pbkdf2</command> 來加密密碼：
     </para>
<screen><prompt role="user">tux &gt; </prompt> sudo grub2-mkpasswd-pbkdf2
Password: ****
Reenter password: ****
PBKDF2 hash of your password is grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...
</screen>
    </step>
    <step performance="required">
     <para>
      將產生的字串連同 <command>set superusers</command> 指令一起貼到檔案 <filename>/etc/grub.d/40_custom</filename> 中。
     </para>
<screen>set superusers="root"
password_pbkdf2 root grub.pbkdf2.sha512.10000.9CA4611006FE96BC77A...</screen>
    </step>
    <step performance="required">
     <para>
      執行 <xref linkend="vle.grub2.mkconfig"/> 以將變更輸入到主要組態檔案中。
     </para>
     <para>
      在重新開機後，當您嘗試啟動某個功能表項目時，系統會提示您輸入使用者名稱和密碼。輸入 <literal>root</literal> 以及您在執行 <command>grub2-mkpasswd-pbkdf2</command> 指令期間輸入的密碼。如果身分證明正確，系統將啟動選定的開機項目。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="grub2_yast_i.xml" parse="xml"/>
 <sect1 id="sec.grub2.zseries">
  <title>System z 上終端機使用方式的差異</title>

  <para>
   在 3215 和 3270 終端機上，游標的移動方式以及在 GRUB 2 中發出編輯指令的方式存在一些差異和限制。
  </para>

  <sect2 id="sec.grub2.zseries.limitations">
   <title>限制</title>
   <variablelist>
    <varlistentry>
     <term>互動</term>
     <listitem>
      <para>
       互動性存在嚴重的限制。輸入時通常不能獲得直觀的回饋。若要查看游標所在的位置，請輸入底線 (<keycap>_</keycap>)。
      </para>
      <note>
       <para>
        與 3215 終端機相比，3270 終端機在顯示和重新整理螢幕方面要好得多。
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>游標移動方式</term>
     <listitem>
      <para>
       無法進行<quote>傳統的</quote>游標移動操作。<keycap function="alt"/>、<keycap function="meta"/>、<keycap function="control"/> 和游標鍵不起作用。若要移動游標，請使用<xref linkend="sec.grub2.zseries.keys"/>中列出的按鍵組合。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>插入記號</term>
     <listitem>
      <para>
       插入記號 (<keycap>^</keycap>) 用做控制字元。若要輸入文字 <keycap>^</keycap> 後再輸入一個字母，請依序輸入 <keycap>^</keycap>、<keycap>^</keycap> 和<replaceable>字母</replaceable>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>輸入</term>
     <listitem>
      <para>
       <keycap function="enter"/> 鍵不起作用，請改為使用 <keycombo><keycap>^</keycap> <keycap>j</keycap></keycombo>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 id="sec.grub2.zseries.keys">
   <title>按鍵組合</title>
   <informaltable>
    <tgroup cols="3">
     <tbody>
      <row>
       <entry morerows="2" valign="top">
        <para>
         常用的替代按鍵︰
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap> <keycap>J</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         確認 (<quote>Enter</quote>)
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>L</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         中止，返回前一<quote>狀態</quote>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>I</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         Tab 鍵補齊 (在編輯模式與外圍程序模式下)
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="8" valign="top">
        <para>
         功能表模式下可用的按鍵：
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到第一個項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到最後一個項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到上一個項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到下一個項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>G</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向上一頁
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>C</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向下一頁
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         啟動選定的項目或進入子功能表 (與 <keycombo><keycap>^</keycap><keycap>J</keycap></keycombo> 相同)
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         編輯選定的項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>c</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         進入 GRUB-Shell
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="13" valign="top">
        <para>
         編輯模式下可用的按鍵：
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向上移動一行
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向下移動一行
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>B</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向左移動一格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向右移動一格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到行首
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到行尾
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>H</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         退格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>D</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         刪除
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>K</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         刪除到行尾
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>Y</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         恢復刪除
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>O</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         插入新行
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>L</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         重新整理螢幕
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>X</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         開機項目
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>C</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         進入 GRUB-Shell
        </para>
       </entry>
      </row>
      <row>
       <entry morerows="10" valign="top">
        <para>
         指令行模式下可用的按鍵：
        </para>
       </entry>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>P</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         上一個指令
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>N</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         歷程中的下一個指令
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>A</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到行首
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>E</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         到行尾
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>B</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向左移動一格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>F</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         向右移動一格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>H</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         退格
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>D</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         刪除
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>K</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         刪除到行尾
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>U</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         刪除行
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <keycombo><keycap>^</keycap><keycap>Y</keycap></keycombo>
        </para>
       </entry>
       <entry>
        <para>
         恢復刪除
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect2>
 </sect1>
 <sect1 id="sec.grub2.commands">
  <title>有用的 GRUB 2 指令</title>

  <variablelist>
   <varlistentry id="vle.grub2.mkconfig">
    <term><command>grub2-mkconfig</command>
    </term>
    <listitem>
     <para>
      依據 <filename>/etc/default/grub</filename> 以及 <filename>/etc/grub.d/</filename> 中的程序檔產生新的 <filename>/boot/grub2/grub.cfg</filename>。
     </para>
     <example>
      <title>grub2-mkconfig 用法</title>
<screen>grub2-mkconfig -o /boot/grub2/grub.cfg</screen>
     </example>
     <tip>
      <title>語法檢查</title>
      <para>
       執行不帶任何參數的 <command>grub2-mkconfig</command> 會將組態列印至 STDOUT 以供使用者檢查。在寫入 <filename>/boot/grub2/grub.cfg</filename> 後使用 <xref linkend="vle.grub2.script_check"/> 可以檢查其語法。
      </para>
     </tip>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.grub2.mkrescue">
    <term><command>grub2-mkrescue</command>
    </term>
    <listitem>
     <para>
      為安裝的 GRUB 2 組態建立一個可開機的救援影像。
     </para>
     <example>
      <title>grub2-mkrescue 用法</title>
<screen>grub2-mkrescue -o save_path/name.iso iso</screen>
     </example>
    </listitem>
   </varlistentry>
   <varlistentry id="vle.grub2.script_check">
    <term><command>grub2-script-check</command>
    </term>
    <listitem>
     <para>
      檢查指定檔案中有無語法錯誤。
     </para>
     <example>
      <title>grub2-script-check 用法</title>
<screen>grub2-check-config /boot/grub2/grub.cfg</screen>
     </example>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>grub2-once</command>
    </term>
    <listitem>
     <para>
      僅設定下次開機的預設開機項目。若要取得可用開機項目的清單，請使用 <option>--list</option> 選項。
     </para>
     <example>
      <title>grub2-once 用法</title>
<screen>grub2-once number_of_the_boot_entry</screen>
     </example>
     <tip>
      <para>
       不使用任何選項呼叫該程式可以取得所有可能選項的完整清單。
      </para>
     </tip>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 id="sec.grub2.info">
  <title>更多資訊</title>

  <para>
   如需關於 GRUB 2 更進一步的資訊，請參閱 <ulink url="http://www.gnu.org/software/grub/"/>。另請參閱 <command>grub</command> info 頁面。您也可以在「技術資訊搜尋」中搜尋關鍵字<quote>GRUB 2</quote>，取得關於特殊問題的資訊，網址是 <ulink url="http://www.suse.com/support"/>。
  </para>
 </sect1>
</chapter>
