<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="net_slp.xml" version="5.0" xml:id="cha-slp">
 <title>SLP</title>
 <info>
  <abstract>
   <para>
    要想設定網路用戶端，需要深入瞭解透過網路提供的服務 (例如列印或 LDAP)。為了簡化在網路用戶端上對此類服務的設定，<quote>服務位置通訊協定</quote> (SLP) 應運而生。SLP 可讓區域網路中的所有用戶端都知道選定服務的可用性和組態資料。支援 SLP 的應用程式可以使用此資訊，以便自動設定。
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase> 支援使用 SLP 所提供的安裝來源進行安裝，並包含許多具有 SLP 整合支援的系統服務。您可以使用 SLP 以提供主要的功能給網路上的用戶端，例如系統上的安裝伺服器、檔案伺服器或是列印伺服器。提供 SLP 支援的服務包括 cupsd、login、ntp、openldap2、postfix、rpasswd、rsyncd、saned、sshd (透過 fish)、vnc 和 ypserv。
 </para>
 <para>
  依預設，系統會安裝在網路用戶端上使用 SLP 服務所需的所有套件。但是，如果要透過 SLP <emphasis>提供</emphasis>服務，請檢查是否已安裝 <systemitem>openslp-server</systemitem> 套件。
 </para>
 <sect1 xml:id="sec-slp-sl-fend">
  <title>SLP 前端 <command>slptool</command></title>

  <para>
   <command>slptool</command> 是一個指令行工具，用於查詢和註冊 SLP 服務。查詢功能對診斷非常有用。下面列出了最重要的 <command>slptool</command> 子指令。<command>slptool</command> <option>--help</option> 會列出所有可用的選項與功能。
  </para>

  <variablelist>
   <varlistentry>
    <term>findsrvtypes</term>
    <listitem>
     <para>
      列出網路上可用的所有服務類型。
     </para>
<screen><prompt>tux &gt; </prompt>slptool findsrvtypes
service:install.suse:nfs
service:install.suse:ftp
service:install.suse:http
service:install.suse:smb
service:ssh
service:fish
service:YaST.installation.suse:vnc
service:smtp
service:domain
service:management-software.IBM:hardware-management-console
service:rsync
service:ntp
service:ypserv</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>findsrvs <replaceable>SERVICE_TYPE</replaceable>
    </term>
    <listitem>
     <para>
      列出提供 <replaceable>SERVICE_TYPE</replaceable> 的所有伺服器
     </para>
<screen><prompt>tux &gt; </prompt>slptool findsrvs service:ntp
service:ntp://ntp.example.com:123,57810
service:ntp://ntp2.example.com:123,57810</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     findattrs <replaceable>SERVICE_TYPE</replaceable>//<replaceable>HOST</replaceable>
    </term>
    <listitem>
     <para>
      列出 <replaceable>HOST</replaceable> 上 <replaceable>SERVICE_TYPE</replaceable> 的屬性
     </para>
<screen><prompt>tux &gt; </prompt>slptool findattrs service:ntp://ntp.example.com
(owner=tux),(email=tux@example.com)</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     register <replaceable>SERVICE type</replaceable>//<replaceable>HOST</replaceable>:<replaceable>PORT</replaceable> "(<replaceable>ATTRIBUTE=VALUE</replaceable>),(<replaceable>ATTRIBUTE=VALUE</replaceable>)"
    </term>
    <listitem>
     <para>
      在 <replaceable>HOST</replaceable> 上使用選擇性屬性清單註冊 <replaceable>SERVICE_TYPE</replaceable>
     </para>
<screen>slptool register service:ntp://ntp.example.com:57810 \
"(owner=tux),(email=tux@example.com)"</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     deregister <replaceable>SERVICE_TYPE</replaceable>//<replaceable>host</replaceable>
    </term>
    <listitem>
     <para>
      在 <replaceable>HOST</replaceable> 上取消註冊 <replaceable>SERVICE_TYPE</replaceable>
     </para>
<screen>slptool deregister service:ntp://ntp.example.com</screen>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   如需更多資訊，請執行 <command>slptool --help</command>。
  </para>
 </sect1>
 <sect1 xml:id="sec-slp-sl-reg">
  <title>透過 SLP 提供服務</title>

  <para>
   若要提供 SLP 服務，SLP 精靈 (<systemitem class="daemon">slpd</systemitem>) 必須正在執行。就像 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 中的大多數系統服務一樣，<systemitem class="daemon">slpd</systemitem> 透過單獨的啟動程序檔來控制。安裝完成後，依預設此精靈將處於非啟動狀態。若要為目前的工作階段啟用該精靈，請執行 <command>sudo systemctl start slpd</command>。如果 <systemitem class="daemon">slpd</systemitem> 應在系統啟動時啟動，請執行 <command>sudo systemctl enable slpd</command>。
  </para>

  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 中的許多應用程式透過 <literal>libslp</literal> 程式庫已經具有整合的 SLP 支援。如果尚未使用 SLP 支援來編譯服務，請使用下列方式之一來透過 SLP 進行編譯︰
  </para>

  <variablelist>
   <varlistentry>
    <term>使用 <filename>/etc/slp.reg.d</filename> 的靜態註冊
    </term>
    <listitem>
     <para>
      針對每個新的服務建立個別的註冊檔。下面的範例會註冊一個掃描器服務︰
     </para>
<screen>## Register a saned service on this system
## en means english language
## 65535 disables the timeout, so the service registration does
## not need refreshes
service:scanner.sane://$HOSTNAME:6566,en,65535
watch-port-tcp=6566
description=SANE scanner daemon</screen>
     <para>
      在此檔案中最重要的一行為 <emphasis>service URL</emphasis>，它是以 <literal>service:</literal> 開始。這包含服務類型 (<literal>scanner.sane</literal>) 以及位址 (可在其中找到伺服器可用的服務)。<replaceable>$HOSTNAME</replaceable> 會以完整的主機名稱自動取代。接著可以找到相關服務的 TCP 埠名稱，它們之間是以冒號分隔。然後輸入服務應該出現的語言以及註冊期間的秒數。這些都應該使用逗號與服務 URL 分隔。在 <literal>0</literal> 與 <literal>65535</literal> 之間設定註冊期間的值。<literal>0</literal> 會防止註冊。<literal>65535</literal> 會移除所有的限制。
     </para>
     <para>
      註冊檔另外還包含 <systemitem>watch-port-tcp</systemitem> 與 <systemitem>description</systemitem> 兩個變數。<systemitem>watch-port-tcp</systemitem> 將 SLP 服務宣告連結至由 <systemitem class="daemon">slpd</systemitem> 檢查到的服務狀態，即相關服務是否啟用。第二個變數是對顯示在適當瀏覽器中的服務，提供更為精確的描述。
     </para>
     <tip>
      <title>YaST 與 SLP</title>
      <para>
       當您在模組對話方塊中啟動 SLP 時，一些由 YaST 所仲介的服務 (例如安裝伺服器或 YOU 伺服器) 會自動執行此註冊。接著 YaST 就會為這些服務建立註冊檔。
      </para>
     </tip>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>使用 <filename>/etc/slp.reg</filename> 的靜態註冊
    </term>
    <listitem>
     <para>
      此方法與使用 <filename>/etc/slp.reg.d</filename> 的程序的唯一區別在於所有服務都會在中心檔案內分組。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>使用 <command>slptool</command> 的動態註冊
    </term>
    <listitem>
     <para>
      如果要動態註冊服務而不使用組態檔案，請使用 slptool 指令行公用程式。這一公用程式還可用於取消註冊現有服務，而無需重新啟動 <systemitem class="daemon">slpd</systemitem>。如需詳細資料，請參閱<xref linkend="sec-slp-sl-fend"/>。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <sect2 xml:id="sec-slp-sl-reg-install">
   <title>設定 SLP 安裝伺服器</title>
   <para>
    在網路中透過 SLP 宣告安裝資料可簡化網路安裝，因為透過 SLP 查詢會自動要求提供伺服器 IP 位址或安裝媒體路徑等安裝資料。<phrase os="sles;sled">如需指示，請參閱<xref linkend="cha-deployment-instserver"/>。</phrase>
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-slp-info">
  <title>更多資訊</title>

  <variablelist>
   <varlistentry>
    <term>RFC 2608、2609、2610</term>
    <listitem>
     <para>
      RFC 2608 一般會處理 SLP 的定義。RFC 2609 會處理更加詳細的服務 URL 語法，而 RFC 2610 則會透過 SLP 處理 DHCP。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:href="http://www.openslp.org"/>
    </term>
    <listitem>
     <para>
      OpenSLP 計劃的首頁。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/usr/share/doc/packages/openslp</filename>
    </term>
    <listitem>
     <para>
      此目錄包含 <systemitem>openslp-server</systemitem> 套件隨附的 SLP 文件，包括 <filename>README.SuSE</filename> (含有 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 詳細資料)、RFC 以及兩個介紹性的 HTML 文件。要使用 SLP 功能的程式設計師可參閱 SUSE 軟體開發套件隨附的 <systemitem class="resource">openslp-devel</systemitem> <phrase os="sles;sled">套件中的《<emphasis>Programmers Guide</emphasis>》(程式設計指南)，以瞭解詳細資訊。</phrase>
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
</chapter>
