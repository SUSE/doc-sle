<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>

<sect1 version="5.0" xml:id="CreateProfile-Partitioning"
  xmlns="http://docbook.org/ns/docbook"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Partitioning</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

   <para>
    <remark role="fixme">Add a short description</remark>
   </para>

   <sect2 xml:id="CreateProfile-Partitioning-config">
    <title>Drive Configuration</title>
    <para>
     The elements listed below must be placed within the following XML
     structure:
    </para>
<screen>&lt;profile&gt;
  &lt;partitioning config:type="list"&gt;
    &lt;drive&gt;
     ...
    &lt;/drive&gt;
  &lt;/partitioning&gt;
&lt;/profile&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>
          Attribute
         </para>
        </entry>
        <entry>
         <para>
          Values
         </para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>
          <literal>device</literal>
         </para>
        </entry>
        <entry>
         <para>
          The device you want to configure in this &lt;drive&gt;
          section. You can use persistent device names via id, like
          <filename>/dev/disk/by-id/ata-WDC_WD3200AAKS-75L9A0_WD-WMAV27368122</filename>
          or <emphasis>by-path</emphasis>, like
          <filename>/dev/disk/by-path/pci-0001:00:03.0-scsi-0:0:0:0</filename>.
         </para>
<screen>&lt;device&gt;/dev/sda&lt;/device&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. If left out, &ay; tries to guess the device. See
          <xref linkend="ay-partitioning-skip-devices"/> on how to influence
          guessing.
         </para>
         <para>
          If set to <literal>ask</literal>, &ay; will ask the user which device to use
          during installation.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>initialize</literal>
         </para>
        </entry>
        <entry>
         <para>
          If set to <literal>true</literal>, the partition table gets wiped
          out before &ay; starts the partition calculation.
         </para>
<screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. The default is <literal>false</literal>.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>partitions</literal>
         </para>
        </entry>
        <entry>
         <para>
          A list of &lt;partition&gt; entries (see
          <xref linkend="ay-partition-configuration"/>).
         </para>
<screen>&lt;partitions config:type="list"&gt;
  &lt;partition&gt;...&lt;/partition&gt;
  ...
&lt;/partitions&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. If no partitions are specified, &ay; will create a
          reasonable partitioning (see
          <xref linkend="ay-auto-partitioning"/>).
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>pesize</literal>
         </para>
        </entry>
        <entry>
         <para>
          This value only makes sense with LVM.
         </para>
<screen>&lt;pesize&gt;8M&lt;/pesize&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. Default is 4M for LVM volume groups.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>use</literal>
         </para>
        </entry>
        <entry>
         <para>
          Specifies the strategy &ay; will use to partition the hard
          disk.
         </para>
         <para>
          Choose between:
         </para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para>
            <literal>all</literal> (uses the whole device while calculating
            the new partitioning),
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>linux</literal> (only existing Linux partitions are
            used),
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>free</literal> (only unused space on the device is
            used, no other partitions are touched),
           </para>
          </listitem>
          <listitem>
           <para>
            1,2,3 (a list of comma separated partition numbers to use).
           </para>
          </listitem>
         </itemizedlist>
        </entry>
        <entry>
         <para>
          This parameter should be provided.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>type</literal>
         </para>
        </entry>
        <entry>
         <para>
          Specify the type of the <literal>drive</literal>,
         </para>
         <para>
          Choose between:
         </para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para>
            <literal>CT_DISK</literal> for physical hard disks (default).
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>CT_DMMULTIPATH</literal> for Multipath devices (deprecated, implied with CT_DISK).
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>CT_LVM</literal> for LVM volume groups.
           </para>
          </listitem>
         </itemizedlist>
<screen>&lt;type config:type="symbol"&gt;CT_LVM&lt;/type&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. Default is <literal>CT_DISK</literal> for a normal
          physical hard disk.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>disklabel</literal>
         </para>
        </entry>
        <entry>
         <para>
          Describes the type of the partition table.
         </para>
         <para>
          Choose between:
         </para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para>
            <literal>msdos</literal>
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>gpt</literal>
           </para>
          </listitem>
          <listitem>
           <para>
            <literal>none</literal>
           </para>
          </listitem>
         </itemizedlist>
<screen>&lt;disklabel&gt;gpt&lt;/disklabel&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. By default &yast; decides what makes sense. If a partition
          table of a different type already exists, it will be recreated with
          the given type only if it does not include any partition that should
          be kept or reused. To use the disk without creating any partition, set
          this element to <literal>none</literal>.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>keep_unknown_lv</literal>
         </para>
        </entry>
        <entry>
         <para>
          This value only makes sense for type=CT_LVM drives. If you are
          reusing a logical volume group and you set this to
          <literal>true</literal>, all existing logical volumes in that
          group will not be touched unless they are specified in the
          &lt;partitioning&gt; section. So you can keep existing
          logical volumes without specifying them.
         </para>
<screen>&lt;keep_unknown_lv config:type="boolean"
&gt;false&lt;/keep_unknown_lv&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. The default is <literal>false</literal>.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>enable_snapshots</literal>
         </para>
        </entry>
        <entry>
         <para>
          Enables snapshots on Btrfs file systems mounted at <literal>/</literal>
          (does not apply to other file systems, or Btrfs file systems not mounted
          at <literal>/</literal>).
         </para>
<screen>&lt;enable_snapshots config:type="boolean"
&gt;false&lt;/enable_snapshots&gt;</screen>
        </entry>
        <entry>
         <para>
          Optional. The default is <literal>true</literal>.
         </para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
    <tip xml:id="ay-partitioning-skip-devices">
     <title>Skipping Devices</title>
     <para>
      You can influence &ay;'s device-guessing for cases where you do not
      specify a &lt;device&gt; entry on your own. Usually &ay;
      would use the first device it can find that looks reasonable but you
      can configure it to skip some devices like this:
     </para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;
    &lt;skip_list config:type="list"&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that use the usb-storage driver --&gt;
        &lt;skip_key&gt;driver&lt;/skip_key&gt;
        &lt;skip_value&gt;usb-storage&lt;/skip_value&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that are smaller than 1GB --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;1048576&lt;/skip_value&gt;
        &lt;skip_if_less_than config:type="boolean"&gt;true&lt;/skip_if_less_than&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- skip devices that are larger than 100GB --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;104857600&lt;/skip_value&gt;
        &lt;skip_if_more_than config:type="boolean"&gt;true&lt;/skip_if_more_than&gt;
      &lt;/listentry&gt;
    &lt;/skip_list&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     <para>
      For a list of all possible &lt;skip_key&gt;s, run <command>yast2
      ayast_probe</command> on a system that has already been installed.
     </para>
    </tip>
   </sect2>

   <sect2 xml:id="ay-partition-configuration">
    <title>Partition Configuration</title>
    <para>
     The elements listed below must be placed within the following XML
     structure:
    </para>
<screen>&lt;drive&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      ...
    &lt;/partition&gt;
  &lt;/partitions&gt;
&lt;/drive&gt;</screen>
<variablelist xml:id="foofoo">
  <varlistentry><term><literal>create</literal></term>
<listitem><para>
          Specify if this partition or logical volume must be created or if it already exists.
         </para><screen>&lt;create config:type="boolean"&gt;false&lt;/create&gt;</screen><para>
          If set to <literal>false</literal>, you also need to set
          <literal>partition_nr</literal>, <literal>lv_name</literal> or <literal>uuid</literal>
          to tell &ay; which device to use.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>crypt_fs</literal></term>
<listitem><para>
          Partition will be encrypted.
         </para><screen>&lt;crypt_fs config:type="boolean"&gt;false&lt;/crypt_fs&gt;</screen><para>
          Default is <literal>false</literal>.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>crypt_key</literal></term>
<listitem><para>
          Encryption key
         </para><screen>&lt;crypt_key&gt;xxxxxxxx&lt;/crypt_key&gt;</screen><para>
          Needed if <literal>crypt_fs</literal> has been set to <literal>true</literal>,
          as well as to open and reuse an existing encrypted device.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>mount</literal></term>
<listitem><para>
          The mount point of this partition.
         </para><screen>&lt;mount&gt;/&lt;/mount&gt;
&lt;mount&gt;swap&lt;/mount&gt;</screen><para>
          You should have at least a root partition (/) and a swap
          partition.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>fstopt</literal></term>
<listitem><para>
          Mount options for this partition.
         </para><screen>&lt;fstopt&gt;
  ro,noatime,user,data=ordered,acl,user_xattr
&lt;/fstopt&gt;</screen><para>
          See <command>man mount</command> for available mount options.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>label</literal></term>
<listitem><para>
          The label of the partition (useful for the
          <literal>mountby</literal> parameter; see below).
         </para><screen>&lt;label&gt;mydata&lt;/label&gt;</screen><para>
          See <command>man e2label</command> for an example.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>uuid</literal></term>
<listitem><para>
          The uuid of the partition (only useful for the
          <literal>mountby</literal> parameter; see below).
         </para><screen>&lt;uuid&gt;1b4e28ba-2fa1-1d2-883f-b9a761bde3fb&lt;/uuid&gt;</screen><para>
          See <command>man uuidgen</command>.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>size</literal></term>
<listitem><para>
          The size of the partition, for example 4G, 4500M, etc. The /boot
          partition and the swap partition can have <literal>auto</literal>
          as size. Then &ay; calculates a reasonable size. One partition
          can have the value <literal>max</literal> to use all remaining
          space.
         </para><para>
          You can also specify the size in percentage. So 10% will use 10%
          of the size of the hard disk or volume group. You can mix auto,
          max, size, and percentage as you like.
         </para><screen>&lt;size&gt;10G&lt;/size&gt;</screen><para>
          Starting with &productname; 15, all values (including
          <literal>auto</literal> and <literal>max</literal>) can be used for
          resizing partitions as well.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>format</literal></term>
<listitem><para>
          Specify if &ay; should format the partition.
         </para><screen>&lt;format config:type="boolean"&gt;false&lt;/format&gt;</screen><para>
          If you set <literal>create</literal> to <literal>true</literal>,
          then you likely want this option set to <literal>true</literal> as
          well.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>file system</literal></term>
<listitem><para>
          Specify the file system to use on this partition:
         </para><itemizedlist mark="bullet" spacing="normal"><listitem><para><literal>btrfs</literal></para></listitem><listitem><para><literal>ext2</literal></para></listitem><listitem><para><literal>ext3</literal></para></listitem><listitem><para><literal>ext4</literal></para></listitem><listitem><para><literal>fat</literal></para></listitem><listitem><para><literal>xfs</literal></para></listitem><listitem><para><literal>swap</literal></para></listitem></itemizedlist><screen>&lt;filesystem config:type="symbol"&gt;ext3&lt;/filesystem&gt;</screen><para>
          Optional. The default is <literal>btrfs</literal> for the root
          partition (<filename>/</filename>) and <literal>xfs</literal> for
          data partitions.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>mkfs_options</literal></term>
<listitem><para>
          Specify an option string that is added to the mkfs command.
         </para><screen>&lt;mkfs_options&gt;-I 128&lt;/mkfs_options&gt;</screen><para>
          Optional. Only use this when you know what you are doing.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>partition_nr</literal></term>
<listitem><para>
          The partition number of this partition. If you have set
          <literal>create=false</literal> or if you use LVM, then you can
          specify the partition via <literal>partition_nr</literal>. You can
          force &ay; to only create primary partitions by assigning
          numbers below 5.
         </para><screen>&lt;partition_nr config:type="integer"&gt;2&lt;/partition_nr&gt;</screen><para>
          Usually, numbers 1 to 4 are primary partitions while 5 and higher
          are logical partitions.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>partition_id</literal></term>
<listitem><para>
          The <literal>partition_id</literal> sets the id of the partition.
          If you want different identifiers than 131 for Linux partition or
          130 for swap, configure them with partition_id.
         </para><screen>&lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;</screen><para>
          Possible values are:
         </para><simplelist><member>FAT16 (MS-DOS): <literal>6</literal></member><member>NTFS (MS-DOS): <literal>7</literal></member><member>FAT32 (MS-DOS): <literal>12</literal></member><member>Extended FAT16 (MS-DOS): <literal>15</literal></member><member>DIAG, Diagnostics and firmware (MS-DOS, GPT): <literal>18</literal></member><member>PPC PReP Boot partition (MS-DOS, GPT): <literal>65</literal></member><member>Swap (MS-DOS, GPT, DASD, implicit): <literal>130</literal></member><member>Linux (MS-DOS, GPT, DASD): <literal>131</literal></member><member>Intel Rapid Start Technology (MS-DOS, GPT): <literal>132</literal></member><member>LVM (MS-DOS, GPT, DASD): <literal>142</literal></member><member>EFI System Partition (MS-DOS, GPT): <literal>239</literal></member><member>MD RAID (MS-DOS, GPT, DASD): <literal>253</literal></member><member>BIOS boot (GPT): <literal>257</literal></member><member>Windows basic data (GPT): <literal>258</literal></member><member>EFI (GPT): <literal>259</literal></member><member>Microsoft reserved (GPT): <literal>261</literal></member></simplelist><para>
          The default is <literal>131</literal> for Linux partition and
          <literal>130</literal> for swap.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>partition_type</literal></term>
<listitem><para>
          When using an <literal>msdos</literal> partition table, this
          element sets the type of the partition. The value can be
          <literal>primary</literal> or <literal>logical</literal>.
          This value is ignored when using a <literal>gpt</literal>
          partition table, because such a distinction does not exist in
          that case.
         </para><screen>&lt;partition_type&gt;primary&lt;/partition_type&gt;</screen><para>
          Optional. Allowed values are <literal>primary</literal> (default) and
          <literal>logical</literal>.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>mountby</literal></term>
<listitem><para>
          Instead of a partition number, you can tell &ay; to mount a
          partition by <literal>device</literal>, <literal>label</literal>,
          <literal>uuid</literal>, <literal>path</literal> or
          <literal>id</literal>, which are the udev path and udev id (see
          <filename>/dev/disk/...</filename>).
         </para><screen>&lt;mountby config:type="symbol"&gt;label&lt;/mountby&gt;</screen><para>
          See <literal>label</literal> and <literal>uuid</literal>
          documentation above. The default depends on &yast; and usually
          is <literal>id</literal>.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>subvolumes</literal></term>
<listitem><para>
          List of subvolumes to create for a file system of type Btrfs. This
          key only makes sense for file systems of type Btrfs. See
          <xref linkend="ay-btrfs-subvolumes"/> for more information.
         </para><screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var/crash&lt;/path&gt;
  &lt;path&gt;var/lock&lt;/path&gt;
  &lt;path&gt;var/run&lt;/path&gt;
  &lt;path&gt;var/tmp&lt;/path&gt;
  &lt;path&gt;var/spool&lt;/path&gt;
  ...
&lt;/subvolumes&gt;</screen><para>
          If no <tag>subvolumes</tag> section has been defined for a partition
          description, &ay; will create a predefined set of subvolumes for the
          given mount point.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>create_subvolumes</literal></term>
<listitem><para>
          Determine whether Btrfs subvolumes should be created or not.
         </para><para>
          It is set to <literal>true</literal> by default. When set to
          <literal>false</literal>, no subvolumes will be created.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>subvolumes_prefix</literal></term>
<listitem><para>
          Set the Btrfs subvolumes prefix name. If no prefix is wanted,
          it must be set to an empty value:
         </para><screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen><para>
          It is set to <literal>@</literal> by default.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>lv_name</literal></term>
<listitem><para>
          If this partition is on a logical volume in a volume group, specify
          the logical volume name here (see the <literal>type</literal>
          parameter in the drive configuration).
         </para><screen>&lt;lv_name&gt;opt_lv&lt;/lv_name&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>stripes</literal></term>
<listitem><para>
          An integer that configures LVM striping. Specify across how many
          devices you want to stripe (spread data).
         </para><screen>&lt;stripes config:type="integer"&gt;2&lt;/stripes&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>stripesize</literal></term>
<listitem><para>
          Specify the size of each block in KB.
         </para><screen>&lt;stripesize config:type="integer"
&gt;4&lt;/stripesize&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>lvm_group</literal></term>
<listitem><para>
          If this is a physical partition used by (part of) a volume group
          (LVM), you need to specify the name of the volume group here.
         </para><screen>&lt;lvm_group&gt;system&lt;/lvm_group&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>pool</literal></term>
<listitem><para><literal>pool</literal> must be set to <literal>true</literal> if
          the LVM logical volume should be an LVM thin pool.
         </para><screen>&lt;pool config:type="boolean"&gt;false&lt;/pool&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>used_pool</literal></term>
<listitem><para>
          The name of the LVM thin pool that is used as a data store for
          this thin logical volume. If this is set to something non-empty,
          it implies that the volume is a so-called thin logical volume.
         </para><screen>&lt;used_pool&gt;my_thin_pool&lt;/used_pool&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>raid_name</literal></term>
<listitem><para>
          If this physical volume is part of a RAID, specify the name of the
          RAID.
         </para><screen>&lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;</screen><para/></listitem>
</varlistentry>
  <varlistentry><term><literal>raid_options</literal></term>
<listitem><para>
          Specify RAID options, see below.
         </para><screen>&lt;raid_options&gt;...&lt;/raid_options&gt;</screen><para>
          Setting the RAID options at <literal>partition</literal> level is deprecated.
          See <xref linkend="ay-partition-sw-raid"/>.
         </para></listitem>
</varlistentry>
  <varlistentry><term><literal>resize</literal></term>
<listitem><para>
          This boolean must be <literal>true</literal> if an existing
          partition should be resized. In this case, you need to tell &ay;
          to reuse the device (see <literal>create</literal>) and specify
          a <literal>size</literal>.
         </para><screen>&lt;resize config:type="boolean"&gt;false&lt;/resize&gt;</screen><para>
          Starting with &productname; 15 resizing works with physical disk
          partitions and with LVM volumes.
         </para></listitem>
</varlistentry>
</variablelist>

    <important>
     <title>Creating Boot Partitions Automatically</title>
     <para>
      When &ay; determines that a boot partition might be required in order
      to boot properly, it will automatically add one even if it is not specified
      in the profile.
     </para>
     <para>
      However, if for any reason the boot partition does not fit in the current
      partitioning layout, &ay; will just display a warning, allowing the
      installation to proceed.
     </para>
    </important>
   </sect2>

   <sect2 xml:id="ay-btrfs-subvolumes">
     <title>Btrfs subvolumes</title>
     <para>
      As mentioned in <xref linkend="ay-partition-configuration"/>, it is
      possible to define a set of subvolumes for each Btrfs file system. In
      its simplest form, this is just a list of entries:
     </para>

<screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var/crash&lt;/path&gt;
  &lt;path&gt;var/lock&lt;/path&gt;
  &lt;path&gt;var/run&lt;/path&gt;
  &lt;path&gt;var/tmp&lt;/path&gt;
  &lt;path&gt;var/spool&lt;/path&gt;
&lt;/subvolumes&gt;</screen>

     <para>
      &ay; supports disabling copy-on-write for a given subvolume. In that
      case, a slightly more complex syntax should be used:
     </para>

<screen>&lt;subvolumes config:type="list"&gt;
&lt;listentry&gt;tmp&lt;/listentry&gt;
&lt;listentry&gt;opt&lt;/listentry&gt;
&lt;listentry&gt;srv&lt;/listentry&gt;
&lt;listentry&gt;
  &lt;path&gt;var/lib/pgsql&lt;/path&gt;
  &lt;copy_on_write config:type="boolean"&gt;false&lt;/copy_on_write&gt;
&lt;/listentry&gt;
&lt;/subvolumes&gt;</screen>

     <para>
      If there is a default subvolume used for the distribution (for example
      <filename>@</filename> in &productname;), the name of this default
      subvolume is automatically prefixed to the names in this list. This
      behavior can be disabled by setting the
      <literal>subvolumes_prefix</literal>.
     </para>

<screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen>
   </sect2>

   <sect2 xml:id="ay-use-whole-disk">
    <title>Using the Whole Disk</title>

    <note os="sles;sled">
     <title>Available in &productname; 15 via Installer Updates</title>
     <para>
       Support to use whole disks was included in &productname; 15
       as a late feature. To use the feature in this specific version,
       the installer self-update must be enabled. See <xref
       linkend="sec-yast-install-self-update"/> for more information about
       installer updates.
     </para>
    </note>

    <para>
     &ay; allows to use a whole disk without creating any partition by setting
     the <literal>disklabel</literal> to <literal>none</literal> as described
     in <xref linkend="CreateProfile-Partitioning-config"/>. In such cases, the configuration in the first
     <literal>partition</literal> from the <literal>drive</literal> will be
     applied to the whole disk.
    </para>

    <para>
     In the example below, we are using the second disk (<literal>/dev/sdb</literal>)
     as the <literal>/home</literal> file system.
    </para>

    <example>
     <title>Using a Whole Disk as a File System</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;</screen>
    </example>

    <para>
     In addition, the whole disk can be used as an LVM physical volume or as a software RAID
     member. See <xref linkend="ay-partition-lvm"/> and <xref linkend="ay-partition-sw-raid"/>
     for further details about setting up an LVM or a software RAID.
    </para>
   </sect2>

   <sect2 xml:id="ay-auto-partitioning">
    <title>Automated Partitioning</title>
    <para>
     For automated partitioning, you only need to provide the sizes and
     mount points of partitions. All other data needed for successful
     partitioning is calculated during installationâ€”unless provided in the
     control file.
    </para>
    <para>
     If no partitions are defined and the specified drive is also the drive
     where the root partition should be created, the following partitions
     are created automatically:
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       <filename>/boot</filename>
      </para>
      <para>
       The size of the <filename>/boot</filename> partition is determined by
       the architecture of the target system.
      </para>
     </listitem>
     <listitem>
      <para>
       <filename>swap</filename>
      </para>
      <para>
       The size of the swap partition is determined by the amount of memory
       available in the system.
      </para>
     </listitem>
     <listitem>
      <para>
       <filename>/</filename> (root partition)
      </para>
      <para>
       The size of the root partition is determined by the space left after
       creating <filename>swap</filename> and <filename>/boot</filename>.
      </para>
     </listitem>
    </itemizedlist>
    <para>
     Depending on the initial status of the drive and how it was previously
     partitioned, it is possible to create the default partitioning in the
     following ways:
    </para>
    <variablelist>
     <varlistentry>
      <term>Use Free Space</term>
      <listitem>
       <para>
        If the drive is already partitioned, it is possible to create the
        new partitions using the free space on the hard disk. This requires
        the availability of sufficient space for all selected packages in
        addition to swap.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Reuse all available space</term>
      <listitem>
       <para>
        Use this option to delete all existing partitions (Linux and
        non-Linux).
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Reuse all available Linux partitions</term>
      <listitem>
       <para>
        This option deletes all existing Linux partitions. Other partitions
        (for example Windows partitions) remain untouched. Note that this
        works only if the Linux partitions are at the end of the device.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Reuse only specified partitions</term>
      <listitem>
       <para>
        This option allows you to select specific partitions to delete.
        Start the selection with the last available partition.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>
     Repartitioning only works if the selected partitions are neighbors and
     located at the end of the device.
    </para>
    <important>
     <title>Beware of Data Loss</title>
     <para>
      The value provided in the <literal>use</literal> property determines
      how existing data and partitions are treated. The value
      <literal>all</literal> means that the entire disk will be erased. Make
      backups and use the <literal>confirm</literal> property if you need to
      keep some partitions with important data. Otherwise, no pop-ups will
      notify you about partitions being deleted.
     </para>
    </important>
    <para>
     If multiple drives are in the target system, identify all drives with
     their device names and specify how the partitioning should be
     performed.
    </para>
    <para>
     Partition sizes can be given in gigabytes, megabytes or can be set to a
     flexible value using the keywords <literal>auto</literal> and
     <literal>max</literal>. <literal>max</literal> uses all available space
     on a drive, therefore should only be set for the last partition on the
     drive. With <literal>auto</literal> the size of a
     <literal>swap</literal> or <literal>boot</literal> partition is
     determined automatically, depending on the memory available and the
     type of the system.
    </para>
    <para>
     A fixed size can be given as shown below:
    </para>
    <para>
     <literal>1GB</literal>, <literal>1G</literal>,
     <literal>1000MB</literal>, or <literal>1000M</literal> will all create a
     partition of the size 1 Gigabyte.
    </para>
    <example>
     <title>Automated Partitioning</title>
     <para>
      The following is an example of a single drive system, which is not
      pre-partitioned and should be automatically partitioned according to
      the described pre-defined partition plan. If you do not specify the
      device, it will be automatically detected.
     </para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
    <para>
     A more detailed example shows how existing partitions and multiple
     drives are handled.
    </para>
    <example>
     <title>Detailed Automated Partitioning</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;size&gt;1G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;use&gt;free&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;mount&gt;/data1&lt;/mount&gt;
        &lt;size&gt;15G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;mount&gt;/data2&lt;/mount&gt;
        &lt;size&gt;auto&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
   </sect2>

   <sect2 xml:id="ay-partition-advanced">
    <title>Advanced Partitioning Features</title>
    <para>
     <remark role="fixme">Add a short description</remark>
    </para>
    <sect3 xml:id="ay-partition-advanced-wipe">
     <title>Wipe out Partition Table</title>
     <para>
      Usually this is not needed because &ay; can delete partitions one
      by one automatically. But you need the option to let &ay; clear the
      partition table instead of deleting partitions individually.
     </para>
     <para>
      Go to the <literal>drive</literal> section and add:
     </para>
<screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
     <para>
      With this setting &ay; will delete the partition table before it
      starts to analyze the actual partitioning and calculates its partition
      plan. Of course this means, that you cannot keep any of your existing
      partitions.
     </para>
    </sect3>
    <sect3 xml:id="ay-partition-advanced-mount">
     <title>Mount Options</title>
     <para>
      By default a file system to be mounted is identified in
      <filename>/etc/fstab</filename> by the device name. This
      identification can be changed so the file system is found by searching
      for a UUID or a volume label. Note that not all file systems can be
      mounted by UUID or a volume label. To specify how a partition is to be
      mounted, use the <literal>mountby</literal> property which has the
      <literal>symbol</literal> type. Possible options are:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <literal>device</literal> (default)
       </para>
      </listitem>
      <listitem>
       <para>
        <literal>label</literal>
       </para>
      </listitem>
      <listitem>
       <para>
        <literal>UUID</literal>
       </para>
      </listitem>
     </itemizedlist>
     <para>
      If you choose to mount the partition using a label, the name entered
      for the <literal>label</literal> property is used as the volume label.
     </para>
     <para>
      Add any valid mount option in the fourth field of
      <filename>/etc/fstab</filename>. Multiple options are separated by
      commas. Possible fstab options:
     </para>
     <variablelist>
      <varlistentry>
       <term>Mount read-only (<literal>ro</literal>)</term>
       <listitem>
        <para>
         No write access to the file system. Default is
         <literal>false</literal>.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>No access time (<literal>noatime</literal>)</term>
       <listitem>
        <para>
         Access times are not updated when a file is read. Default is
         <literal>false</literal>.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Mountable by User (<literal>user</literal>)</term>
       <listitem>
        <para>
         The file system can be mounted by a normal user. Default is
         <literal>false</literal>.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>
        Data Journaling Mode (<literal>ordered</literal>,
        <literal>journal</literal>, <literal>writeback</literal>)
       </term>
       <listitem>
        <variablelist>
         <varlistentry>
          <term><literal>journal</literal>
          </term>
          <listitem>
           <para>
            All data is committed to the journal prior to being written to
            the main file system.
           </para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>ordered</literal>
          </term>
          <listitem>
           <para>
            All data is directly written to the main file system before its
            metadata is committed to the journal.
           </para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>writeback</literal>
          </term>
          <listitem>
           <para>
            Data ordering is not preserved.
           </para>
          </listitem>
         </varlistentry>
        </variablelist>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Access Control List (<literal>acl</literal>)</term>
       <listitem>
        <para>
         Enable access control lists on the file system.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Extended User Attributes (<literal>user_xattr</literal>)</term>
       <listitem>
        <para>
         Allow extended user attributes on the file system.
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <example>
      <title>Mount Options</title>
<screen>&lt;partitions config:type="list"&gt;
  &lt;partition&gt;
    &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
    &lt;format config:type="boolean"&gt;true&lt;/format&gt;
    &lt;fstopt&gt;ro,noatime,user,data=ordered,acl,user_xattr&lt;/fstopt&gt;
    &lt;mount&gt;/local&lt;/mount&gt;
    &lt;mountby config:type="symbol"&gt;uuid&lt;/mountby&gt;
    &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
    &lt;size&gt;10G&lt;/size&gt;
  &lt;/partition&gt;
&lt;/partitions&gt;
</screen>
     </example>

    <note>
     <title>
      Check Supported File System Options
     </title>
     <para>
      Different file system types support different options.
      Check the documentation carefully before setting them.
     </para>
    </note>
    </sect3>
    <sect3 xml:id="ay-partition-advanced-keep">
     <title>Keeping Specific Partitions</title>
     <para>
      In some cases you should leave partitions untouched and only format
      specific target partitions, rather than creating them from scratch.
      For example, if different Linux installations coexist, or you have
      another operating system installed, likely you do not want to wipe
      these out. You may also want to leave data partitions untouched.
     </para>
     <para>
      Such scenarios require specific knowledge about the target systems and
      hard disks. Depending on the scenario, you might need to know the
      exact partition table of the target hard disk with partition IDs,
      sizes and numbers. With this data, you can tell &ay; to keep certain
      partitions, format others and create new partitions if needed.
     </para>
     <para>
      The following example will keep partitions 1, 2 and 5 and delete
      partition 6 to create two new partitions. All remaining partitions
      will only be formatted.
      <remark>emap 2011-11-05: Not the best example for the scenarios two paras up with coexisting operating systems or data partitions. Who'd want to format those?</remark>
     </para>
     <example>
      <title>Keeping partitions</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdc&lt;/device&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/&lt;/mount&gt;
          &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;false&lt;/format&gt;
          &lt;partition_nr config:type="integer"&gt;2&lt;/partition_nr&gt;
          &lt;mount&gt;/space&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
          &lt;partition_nr config:type="integer"&gt;5&lt;/partition_nr&gt;
          &lt;mount&gt;swap&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space2&lt;/mount&gt;
          &lt;size&gt;5G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space3&lt;/mount&gt;
          &lt;size&gt;max&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
    &lt;use&gt;6&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>
     <para>
      The last example requires exact knowledge of the existing partition
      table and the partition numbers of those partitions that should be
      kept. In some cases however, such data may not be available,
      especially in a mixed hardware environment with different hard disk
      types and configurations. The following scenario is for a system with
      a non-Linux OS with a designated area for a Linux installation.
     </para>
     <figure xml:id="partitioning-keep1">
      <title>Keeping partitions</title>
      <mediaobject>
       <imageobject role="html">
        <imagedata fileref="partitioning-keep1.png"/>
       </imageobject>
       <imageobject role="fo">
        <imagedata fileref="partitioning-keep1.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      In this scenario, shown in figure
      <xref linkend="partitioning-keep1"/>, &ay; will not create new
      partitions. Instead it searches for certain partition types on the
      system and uses them according to the partitioning plan in the control
      file. No partition numbers are given in this case, only the mount
      points and the partition types (additional configuration data can be
      provided, for example file system options, encryption and file system
      type).
     </para>
     <example>
      <title>Auto-detection of partitions to be kept.</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;partition_id config:type="integer"&gt;130&lt;/partition_id&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>

     <note>
      <title>Keeping Encrypted Devices</title>
      <para>
       When &ay; is probing the storage devices, the partitioning
       section from the profile is not yet analyzed. In some scenarios,
       it is not clear which key should be used to unlock a device. For
       example, this can happen when more than one encryption key is
       defined. To solve this problem, &ay; will try all defined keys
       on all encrypted devices until a working key is found.
      </para>
     </note>
    </sect3>
   </sect2>

   <sect2 xml:id="ay-partition-lvm">
    <title>Logical Volume Manager (LVM)</title>
    <para>
     To configure LVM, first create a physical volume using the normal
     partitioning method described above.
    </para>
    <example>
     <title>Create LVM Physical Volume</title>
     <para>
      The following example shows how to prepare for LVM in the
      <literal>partitioning</literal> resource. A non-formatted partition is
      created on device <filename>/dev/sda1</filename> of the type
      <literal>LVM</literal> and with the volume group
      <literal>system</literal>. This partition will use all space available
      on the drive.
     </para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;partition_id config:type="integer"&gt;142&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
    <example>
     <title>LVM Logical Volumes</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/system&lt;/device&gt;
      &lt;type config:type="symbol"&gt;CT_LVM&lt;/type&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;user_lv&lt;/lv_name&gt;
          &lt;mount&gt;/usr&lt;/mount&gt;
          &lt;size&gt;15G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;opt_lv&lt;/lv_name&gt;
          &lt;mount&gt;/opt&lt;/mount&gt;
          &lt;size&gt;10G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;var_lv&lt;/lv_name&gt;
          &lt;mount&gt;/var&lt;/mount&gt;
          &lt;size&gt;1G&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
      &lt;pesize&gt;4M&lt;/pesize&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
    <para>
     It is possible to set the <literal>size</literal> to
     <literal>max</literal> for the logical volumes. Of course, you can only
     use <literal>max</literal> for one(!) logical volume. You cannot set
     two logical volumes in one volume group to <literal>max</literal>.
    </para>
   </sect2>

   <sect2 xml:id="ay-partition-sw-raid">
    <title>Software RAID</title>
    <note os="sles;sled">
     <title>Available in &productname; 15 via Installer Updates</title>
       <para>
         <remark>taroth 2018-11-05: enable the following sentence as soon as we start to work on SP1
            in 'develop': The support for software RAID devices has been greatly improved in
            &productname; 15 SP1.</remark> Enhanced support for software RAID devices
            is available for &productname; 15. To use the feature in this specific version, the
            installer self-update feature must be enabled. See  <xref linkend="sec-yast-install-self-update"/>
            for more information about installer updates.
     </para>
     <para>
      If needed, see <xref linkend="ay-partition-sw-raid-deprecated"/> to find
      out further details about the old way of specifying a software RAID,
      which is still supported for backward compatibility.
     </para>
    </note>

    <para>
     Using &ay;, you can create and assemble software RAID devices. The
     supported RAID levels are the following:
    </para>
    <variablelist>
     <varlistentry>
      <term>RAID 0</term>
      <listitem>
       <para>
        This level increases your disk performance. There is
        <emphasis>no</emphasis> redundancy in this mode. If one of the
        drives crashes, data recovery will not be possible.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 1</term>
      <listitem>
       <para>
        This mode offers the best redundancy. It can be used with two or
        more disks. An exact copy of all data is maintained on all disks. As
        long as at least one disk is still working, no data is lost. The
        partitions used for this type of RAID should have approximately the
        same size.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 5</term>
      <listitem>
       <para>
        This mode combines management of a larger number of disks and still
        maintains some redundancy. This mode can be used on three disks or
        more. If one disk fails, all data is still intact. If two disks fail
        simultaneously, all data is lost.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Multipath</term>
      <listitem>
       <para>
        This mode allows access to the same physical device via multiple
        controllers for redundancy against a fault in a controller card.
        This mode can be used with at least two devices.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>
     Similar to LVM, a software RAID definition in an &ay; profile is composed
     of two different parts:
    </para>

    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       Determining which disks or partitions are going to be used as RAID
       members.  In order to do that, you need to set the
       <literal>raid_name</literal> element in such devices.
      </para>
     </listitem>
     <listitem>
      <para>
       Defining the RAID itself by using a dedicated <literal>drive</literal>
       section.
      </para>
     </listitem>
    </itemizedlist>

    <para>
     The following example shows a RAID1 configuration that uses a partition from the first disk
     and another one from the second disk as RAID members:
    </para>
    <example>
     <title>RAID1 Configuration</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;20G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md/0&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
        &lt;size&gt;40G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;/srv&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;raid_options&gt;
      &lt;chunk_size&gt;4&lt;/chunk_size&gt;
      &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
      &lt;raid_type&gt;raid1&lt;/raid_type&gt;
    &lt;/raid_options&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>

    <para>
     If you do not want to create partitions in the software RAID, set
     the <literal>disklabel</literal> to <literal>none</literal> as you would
     do for a regular disk. In the example below, only the RAID
     <literal>drive</literal> section is shown for simplicity's sake:
    </para>

    <example>
     <title>RAID1 Without Partitions</title>
<screen>&lt;drive&gt;
  &lt;device&gt;/dev/md/0&lt;/device&gt;
  &lt;disklabel&gt;none&lt;/disklabel&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      &lt;mount&gt;/home&lt;/mount&gt;
      &lt;size&gt;40G&lt;/size&gt;
    &lt;/partition&gt;
  &lt;/partitions&gt;
  &lt;raid_options&gt;
    &lt;chunk_size&gt;4&lt;/chunk_size&gt;
    &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
    &lt;raid_type&gt;raid1&lt;/raid_type&gt;
  &lt;/raid_options&gt;
  &lt;use&gt;all&lt;/use&gt;
&lt;/drive&gt;</screen>
    </example>

   <sect3 xml:id="ay-partition-sw-raid-deprecated">
    <title>Using the Deprecated Syntax</title>
    <para>
     If the installer self-update feature is enabled, it is possible to partition a software RAID
     for &productname; 15. However, that scenario was not supported in previous versions and hence
     the way to define a software RAID was slightly different.
    </para>

    <para>
     This section defines what the old-style configuration looks like because
     it is still supported for backward compatibility.
    </para>

    <para>
     Keep the following in mind when configuring a RAID using this deprecated
     syntax:
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       The device for RAID is always <filename>/dev/md</filename>.
      </para>
     </listitem>
     <listitem>
      <para>
       The property <literal>partition_nr</literal> is used to determine the
       MD device number. If <literal>partition_nr</literal> is equal to 0,
       then <filename>/dev/md/0</filename> is configured. Adding several
       <literal>partition</literal> sections means that you want to have
       multiple software RAIDs (<filename>/dev/md/0</filename>,
       <filename>/dev/md/1</filename>, etc.).
      </para>
     </listitem>
     <listitem>
      <para>
       All RAID-specific options are contained in the <literal>raid_options</literal> resource.
      </para>
     </listitem>
    </itemizedlist>

    <example>
     <title>Old Style RAID1 Configuration</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;raid_type&gt;raid&lt;/raid_type&gt;
        &lt;size&gt;4G&lt;/size&gt;
      &lt;/partition&gt;

        &lt;!-- Insert a configuration for the regular partitions located on
                /dev/sda here (for example / and swap) --&gt;

    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;size&gt;4gb&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/space&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;0&lt;/partition_nr&gt;
        &lt;raid_options&gt;
          &lt;chunk_size&gt;4&lt;/chunk_size&gt;
          &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
        &lt;/raid_options&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
   </sect3>

   <sect3 xml:id="ay-raid-configuration">
    <title>RAID Options</title>
    <para>
     The following elements must be placed within the following XML
     structure:
    </para>
    <screen>&lt;partition&gt;
     &lt;raid_options&gt;
     ...
     &lt;/raid_options&gt;
     &lt;/partition&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>
          Attribute
         </para>
        </entry>
        <entry>
         <para>
          Values
         </para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>
          <literal>chunk_size</literal>
         </para>
        </entry>
        <entry>
         <para/>
         <screen>&lt;chunk_size&gt;4&lt;/chunk_size&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>parity_algorithm</literal>
         </para>
        </entry>
        <entry>
         <para>
          Possible values are:
         </para>
         <para>
          <literal>left_asymmetric</literal>, <literal>left_symmetric,
           right_asymmetric</literal>, <literal>right_symmetric</literal>.
         </para>
         <para>
          For RAID6 and RAID10 the following values can be used:
         </para>
         <para>
          <literal>parity_first</literal>, <literal>parity_last</literal>,
          <literal>left_asymmetric_6, left_symmetric_6</literal>,
          <literal>right_asymmetric_6</literal>,
          <literal>right_symmetric_6</literal>,
          <literal>parity_first_6</literal>, <literal>n2</literal>,
          <literal>o2</literal>, <literal>f2</literal>,
          <literal>n3</literal>, <literal>o3</literal>,
          <literal>f3</literal>
         </para>
         <screen>&lt;parity_algorithm
          &gt;left_asymmetric&lt;/parity_algorithm&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>raid_type</literal>
         </para>
        </entry>
        <entry>
         <para>
          Possible values are: <literal>raid0</literal>,
          <literal>raid1</literal>, <literal>raid5</literal>,
          <literal>raid6</literal> and <literal>raid10</literal>.
         </para>
         <screen>&lt;raid_type&gt;raid1&lt;/raid_type&gt;</screen>
        </entry>
        <entry>
         <para>
          The default is <literal>raid1</literal>.
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>device_order</literal>
         </para>
        </entry>
        <entry>
         <para>
          This list contains the order of the physical devices:
         </para>
         <screen>&lt;device_order config:type="list"&gt;
          &lt;device&gt;/dev/sdb2&lt;/device&gt;
          &lt;device&gt;/dev/sda1&lt;/device&gt;
          ...
          &lt;/device_order&gt;</screen>
        </entry>
        <entry>
         <para>
          This is optional and the default is alphabetical order.
         </para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect3>
  </sect2>

   <sect2 xml:id="ay-partition-s390">
    <title>&zseries; Specific Configuration</title>
    <para/>
    <sect3 xml:id="ay-partition-s390-dasd">
     <title>Configuring DASD Disks</title>
     <para>
      The elements listed below must be placed within the following XML
      structure:
     </para>
<screen>&lt;dasd&gt;
 &lt;devices config:type="list"&gt;
  &lt;listentry&gt;
   ...
  &lt;/listentry&gt;
 &lt;/devices&gt;
&lt;/dasd&gt;</screen>
     <para>
      tags in the &lt;profile&gt; section. Each disk needs to be
      configured in a separate &lt;listentry&gt; ...
      &lt;/listentry&gt; section.
     </para>
     <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>
           Attribute
          </para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>
           Values
          </para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para>
           <literal>device</literal>
          </para>
         </entry>
         <entry>
          <para>
           <literal>DASD</literal> is the only value allowed
          </para>
<screen>&lt;device
&gt;DASD&lt;/dev_name&gt;</screen>
         </entry>
         <entry>
          <para/>
         </entry>
        </row>
        <row>
         <entry>
          <para>
           <literal>dev_name</literal>
          </para>
         </entry>
         <entry>
          <para>
           The device (<literal>dasd<replaceable>N</replaceable></literal>)
           you want to configure in this section.
          </para>
<screen>&lt;dev_name
&gt;/dev/dasda&lt;/dev_name&gt;</screen>
         </entry>
         <entry>
          <para>
           Optional but recommended. If left out, &ay; tries to guess the
           device.
          </para>
         </entry>
        </row>
        <row>
         <entry>
          <para>
           <literal>channel</literal>
          </para>
         </entry>
         <entry>
          <para>
           Channel by which the disk is accessed.
          </para>
<screen>&lt;channel&gt;0.0.0150&lt;/channel&gt;</screen>
         </entry>
         <entry>
          <para>
           Mandatory.
          </para>
         </entry>
        </row>
        <row>
         <entry>
          <para>
           <literal>diag</literal>
          </para>
         </entry>
         <entry>
          <para>
           Enable or disable the use of <literal>DIAG</literal>. Possible
           values are <literal>true</literal> (enable) or
           <literal>false</literal> (disable).
          </para>
<screen>&lt;diag
config:type="boolean"&gt;true&lt;/diag&gt;</screen>
         </entry>
         <entry>
          <para>
           Optional.
          </para>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </informaltable>
    </sect3>
    
    <sect3 xml:id="ay-partition-s390-zfcp">
     <title>Configuring zFCP disks</title>
     <para>
      The following elements must be placed within the following XML
      structure:
     </para>
<screen>&lt;profile&gt;
  &lt;zfcp&gt;
    &lt;devices config:type="list"&gt;
      &lt;listentry&gt;
        ...
      &lt;/listentry&gt;
    &lt;/devices&gt;
  &lt;/zfcp&gt;
&lt;profile&gt;</screen>
     <para>
      Each disk needs to be configured in a separate
      <literal>listentry</literal> section.
     </para>

     <variablelist>
      <varlistentry>
       <term>controller_id</term>
       <listitem>
       <para>
        Channel number
       </para>
<screen>&lt;controller_id&gt;0.0.fc00&lt;/controller_id&gt;</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     
     <para>
       The <literal>controller_id</literal> element is required.
     </para>
     <para>
       There are two optional elements, <literal>wwpn</literal> 
       (Worldwide Port Number, the target port through which the SCSI device 
       is attached), and <literal>fcp_lun</literal>
       (logical unit number of the SCSI device). It is not necessary to 
       specify these for FCP devices running in NPIV (Node Port ID 
       Virtualization) mode, and when the zfcp module parameter 
       <literal>allow_lun_scan</literal> is set to 1 (the default setting), 
       which enables automatic LUN scanning by the zfcp device driver.
     </para>
     <para>
       If automatic LUN scanning is not available, set the 
       <literal>wwpn</literal> and <literal>fcp_lun</literal> options 
       manually.
     </para>

     <variablelist>
      <varlistentry>
        <term>wwpn</term>
       <listitem>
       <para>
        Worldwide port number
       </para>
<screen>&lt;wwpn&gt;0x500507630300c562&lt;/wwpn&gt;</screen>
       </listitem>
      </varlistentry>
      <varlistentry>
        <term>fcp_lun</term>
       <listitem>
       <para>
        Logical unit number
       </para>
<screen>&lt;fcp_lun&gt;0x4010403200000000&lt;/fcp_lun&gt;</screen>
       </listitem>
      </varlistentry>
     </variablelist>
     
     <para>
       See the IBM documentation for more information,
       <link xlink:href=" https://www.ibm.com/docs/en/linux-on-systems?topic=wsd-configuring-devices"/>.
     </para>
    </sect3>
    
   </sect2>
  </sect1>