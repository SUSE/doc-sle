msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2018-08-18 22:25+0200\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. Put one translator per line, in the form NAME <EMAIL>, YEAR1, YEAR2
msgctxt "_"
msgid "translator-credits"
msgstr ""

#. (itstool) path: chapter/title
#. (itstool) path: sect1/title
#: xml/selinux.xml:9
#: xml/selinux.xml:525
msgid "Configuring SELinux"
msgstr ""

#. (itstool) path: chapter/para
#: xml/selinux.xml:15
msgid "In this chapter, you will learn how to set up and manage SELinux on <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>. The following topics are covered:"
msgstr ""

#. (itstool) path: listitem/para
#. (itstool) path: sect1/title
#: xml/selinux.xml:21
#: xml/selinux.xml:42
msgid "Why Use SELinux?"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:26
msgid "Understanding SELinux"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:31
msgid "Setting Up SELinux"
msgstr ""

#. (itstool) path: listitem/para
#. (itstool) path: sect1/title
#: xml/selinux.xml:36
#: xml/selinux.xml:607
msgid "Managing SELinux"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:44
msgid "SELinux was developed as an additional Linux security solution that uses the security framework in the Linux kernel. The purpose was to allow for a more granular security policy that goes beyond what is offered by the default existing permissions of Read, Write, and Execute, and beyond assigning permissions to the different capabilities that are available on Linux. SELinux does this by trapping all system calls that reach the kernel, and denying them by default. This means that on a system that has SELinux enabled and nothing else configured, nothing will work. To allow your system to do anything, as an administrator you will need to write rules and put them in a policy."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:57
msgid "An example explains why a solution such as SELinux (or its counterpart <phrase>AppArmor</phrase>) is needed:"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:62
msgid "<quote>One morning, I found out that my server was hacked. The server was running a fully patched SLES installation. A firewall was configured on it and no unnecessary services were offered by this server. Further analysis revealed that the hacker had come in through a vulnerable PHP script that was a part of one of the Apache virtual hosts that were running on this server. The intruder had managed to get access to a shell, using the <systemitem class=\"username\">wwwrun</systemitem> account that was used by the Apache Web server. As this <systemitem class=\"username\">wwwrun</systemitem> user, the intruder had created several scripts in the <filename>/var/tmp</filename> and the <filename>/tmp</filename> directories, which were a part of a botnet that was launching a Distributed Denial of Service attack against several servers.</quote>"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:78
msgid "The interesting thing about this hack is that it occurred on a server where nothing was really wrong. All permissions where set OK, but the intruder had managed to get into the system. What becomes clearly evident from this example is that in some cases additional security is neededâ€”a security that goes beyond what is offered by using SELinux. As a less complete and less complex alternative, <phrase>AppArmor</phrase> can be used."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:88
msgid "<phrase>AppArmor</phrase> confines specific processes in their abilities to read/write and execute files (and other things). Its view is mostly that things that happen inside a process cannot escape."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:94
msgid "SELinux instead uses labels attached to objects (for example, files, binaries, network sockets) and uses them to determine privilege boundaries, thereby building up a level of confinement that can span more than a process or even the whole system."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:101
msgid "SELinux was developed by the US National Security Agency (NSA), and since the beginning Red Hat has been heavily involved in its development. The first version of SELinux was offered in the era of <trademark>Red Hat Enterprise Linux 4</trademark>, around the year 2006. In the beginning it offered support for essential services only, but over the years it has developed into a system that offers many rules that are collected in policies to offer protection to a broad range of services."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:111
msgid "SELinux was developed in accordance with some certification standards like Common Criteria and FIPS 140. Because some customers specifically requested solutions that met these standards, SELinux rapidly became relatively popular."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:118
msgid "As an alternative to SELinux, Immunix, a company that was purchased by Novell in 2005, had developed <phrase>AppArmor</phrase>. <phrase>AppArmor</phrase> was built on top of the same security principles as SELinux, but took a completely different approach, where it was possible to restrict services to exactly what they needed to do by using an easy to use wizard-driven procedure. Nevertheless, <phrase>AppArmor</phrase> has never reached the same status as SELinux, even if there are some good arguments to secure a server with <phrase>AppArmor</phrase> rather than with SELinux."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:128
msgid "Because many organizations are requesting SELinux to be in the Linux distributions they are using, SUSE is offering support for the SELinux framework in <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>. This does not mean that the default installation of <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase> will switch from <phrase>AppArmor</phrase> to SELinux in the near future."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:137
msgid "Support Status"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:138
msgid "The SELinux framework is supported on <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>. This means that <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SLES</phrase><phrase os=\"sled\">SLED</phrase><phrase os=\"slerte\">SUSE Linux Enterprise RT</phrase></phrase> offers all binaries and libraries you need to be able to use SELinux on your server. You may however miss some software that you may be familiar with from other Linux distributions."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:144
msgid "SELinux support is at a fairly early stage in <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>, which means that unexpected behavior may occur. To limit this risk as much as possible, it is best to use only the binaries that have been provided by default on <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:153
msgid "Understanding SELinux Components"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:154
msgid "Before starting the configuration of SELinux, you should know a bit about how SELinux is organized. Three components play a role:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:160
msgid "The security framework in the Linux kernel"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:165
msgid "The SELinux libraries and binaries"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:170
msgid "The SELinux policy"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:175
msgid "The default kernel of <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase> supports SELinux and the tools that are needed to manage it. The most important part of the work of the administrator with regard to SELinux is managing the policy."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:180
msgid "In the SELinux policy, security labels are applied to different objects on a Linux server. These objects typically are users, ports, processes and files. Using these security labels, rules are created that define what is and what is not allowed on a server. Remember, by default SELinux denies everything, and by creating the appropriate rules you can allow the access that is strictly necessary. Rules should therefore exist for all programs that you want to use on a system. Alternatively, you should configure parts of a system to run in unconfined mode, which means that specific ports, programs, users, files and directories are not protected by SELinux. This mode is useful if you only want to use SELinux to protect some essential services, while you are not specifically worried about other services. To get a really secure system, you should avoid this."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:195
msgid "To ensure the appropriate protection of your system, you need an SELinux policy. This must be a tailor-made policy in which all files are provided with a label, and all services and users have a security label as well to express which files and directories can be accessed by which user and processed on the server. Developing such a policy is a tremendous amount of work."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:203
msgid "The complexity of SELinux is also one of the main arguments against using it. Because a typical Linux system is so very complex, it is easy to overlook something and leave an opening that intruders can abuse to get into your system. And even if it is set up completely the way it should be, it still is very hard for an administrator to overlook all aspects with SELinux. With regard to the complexity, <phrase>AppArmor</phrase> takes a completely different approach and works with automated procedures that allow the administrator to set up <phrase>AppArmor</phrase> protection and understand exactly what is happening."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:214
msgid "Note that a freely available SELinux policy might work on your server, but is unlikely to offer the same protection as a custom policy. SUSE also does not support third-party policies."
msgstr ""

#. (itstool) path: sect1/title
#: xml/selinux.xml:222
msgid "Policy"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:224
msgid "As mentioned, the policy is the key component in SELinux. It defines rules that specify which objects can access which files, directories, ports and processes on a system. To do this, a security context is defined for all of these. On an SELinux system where the policy has been applied to label the file system, you can use the <command>ls -Z</command> command on any directory to find the security context for the files in that directory. <xref linkend=\"ex.selnx.con.set\" xrefstyle=\"select:label quotedtitle nopage\"/> shows the security context settings for the directories in the <filename>/</filename> directory of a <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase> system with an SELinux-labeled file system."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:239
msgid "Security Context Settings Using <command>ls -Z</command>"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:240
#, no-wrap
msgid ""
"ls -Z\n"
"system_u:object_r:bin_t bin\n"
"system_u:object_r:boot_t boot\n"
"system_u:object_r:device_t dev\n"
"system_u:object_r:etc_t etc\n"
"system_u:object_r:home_root_t home\n"
"system_u:object_r:lib_t lib\n"
"system_u:object_r:lib_t lib64\n"
"system_u:object_r:lost_found_t lost+found\n"
"system_u:object_r:mnt_t media\n"
"system_u:object_r:mnt_t mnt\n"
"system_u:object_r:usr_t opt\n"
"system_u:object_r:proc_t proc\n"
"system_u:object_r:default_t root\n"
"system_u:object_r:bin_t sbin\n"
"system_u:object_r:security_t selinux\n"
"system_u:object_r:var_t srv\n"
"system_u:object_r:sysfs_t sys\n"
"system_u:object_r:tmp_t tmp\n"
"system_u:object_r:usr_t usr\n"
"system_u:object_r:var_t var"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:263
msgid "The most important line in the security context is the context type. This is the part of the security context that ends in _t. It tells SELinux which kind of access the object is allowed. In the policy, rules are specified to define which type of user or which type of role has access to which type of context. For example, this can happen by using a rule like the following:"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:272
#, no-wrap
msgid ""
"allow user_t bin_t:file {read execute gettattr};"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:274
msgid "This example rule states that the user who has the context type <systemitem class=\"username\">user_t</systemitem> (this user is called the source object) is allowed to access objects of class \"file\" with the context type <filename>bin_t</filename> (the target), using the permissions read, execute and getattr."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:282
msgid "The standard policy that you are going to use contains a huge amount of rules. To make it more manageable, policies are often split into modules. This allows administrator to switch protection on or off for different parts of the system."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:289
msgid "When compiling the policy for your system, you will have a choice to either work with a modular policy, or a monolithic policy, where one huge policy is used to protect everything on your system. It is strongly recommended to use a modular policy and not a monolithic policy. Modular policies are much easier to manage."
msgstr ""

#. (itstool) path: sect1/title
#: xml/selinux.xml:298
msgid "Installing SELinux Packages and Modifying GRUBÂ 2"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:300
msgid "The easiest way to make sure that all SELinux components are installed is by using YaST. The procedure described below shows what to do on an installed <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>:"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:308
msgid "Log in to your server as <systemitem class=\"username\">root</systemitem> and start YaST."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:314
msgid "Select <menuchoice> <guimenu>Software</guimenu> <guimenu>Software Management</guimenu> </menuchoice>"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:320
msgid "<menuchoice> <guimenu>Select View</guimenu> <guimenu>Patterns</guimenu> </menuchoice> and select the entire C<guimenu>/C++ Development</guimenu> category for installation."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:326
msgid "<menuchoice> <guimenu>Select View</guimenu> <guimenu>Search</guimenu> </menuchoice> and make sure that <guimenu>Search in Name</guimenu>, <guimenu>Keywords</guimenu> and <guimenu>Summary</guimenu> are selected. Now enter the keyword <literal>selinux</literal> and click <guimenu>Search</guimenu>. You now see a list of packages."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:335
msgid "Make sure that all the packages you have found are selected and click <guimenu>Accept</guimenu> to install them."
msgstr ""

#. (itstool) path: figure/title
#: xml/selinux.xml:343
msgid "Selecting all SELinux Packages in YaST"
msgstr ""

#. (itstool) path: imageobject/imagedata
#. This is a reference to an external file such as an image or video. When
#. the file changes, the md5 hash will change to let you know you need to
#. update your localized copy. The msgstr is not used at all. Set it to
#. whatever you like once you have updated your copy of the file.
#: xml/selinux.xml:346
#: xml/selinux.xml:349
msgctxt "_"
msgid "external ref='selnx_policy_compiler.png' md5='__failed__'"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:354
msgid "After installing the SELinux packages, you need to modify the GRUBÂ 2 boot loader. Do this from YaST, select <menuchoice> <guimenu>System</guimenu> <guimenu>Boot Loader</guimenu> <guimenu>Kernel Parameters</guimenu></menuchoice>. Now add the following parameters to the <guimenu>Optional Kernel Command Line Parameters</guimenu>:"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:362
#, no-wrap
msgid ""
"security=selinux selinux=1 enforcing=0"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:364
msgid "These options are used for the following purposes:"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:370
msgid "<literal>security=selinux</literal>"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:373
msgid "This option tells the kernel to use SELinux and not <phrase>AppArmor</phrase>"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:379
msgid "<literal>selinux=1</literal>"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:382
msgid "This option switches on SELinux"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:388
msgid "<literal>enforcing=0</literal>"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:391
msgid "This option puts SELinux in permissive mode. In this mode, SELinux is fully functional, but does not enforce any of the security settings in the policy. Use this mode for configuring your system. To switch on SELinux protection, when the system is fully operational, change the option to <literal>enforcing=1</literal> and add <literal>SELINUX=enforcing</literal> in <filename>/etc/selinux/config</filename>."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:404
msgid "After installing the SELinux packages and enabling the SELinux GRUBÂ 2 boot options, reboot your server to activate the configuration."
msgstr ""

#. (itstool) path: sect1/title
#: xml/selinux.xml:410
msgid "SELinux Policy"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:412
msgid "The policy is an essential component of SELinux. <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase> <phrase role=\"productnumber\"><phrase os=\"osuse\">42.3</phrase><phrase os=\"sles;sled;slerte\">12 SP3</phrase></phrase> includes the <emphasis>minimum</emphasis> SELinux reference policy in the package <package>selinux-policy-minimum</package>. The examples in this chapter refer to this policy if not stated otherwise."
msgstr ""

#. (itstool) path: tip/para
#: xml/selinux.xml:420
msgid "To install a different policy, you need to download it from <link xlink:href=\"https://build.opensuse.org/package/binaries/security:SELinux/selinux-policy?repository=SLE_12\"/> and install:"
msgstr ""

#. (itstool) path: tip/screen
#: xml/selinux.xml:424
#, no-wrap
msgid ""
"sudo zypper in selinux-policy-targeted-<replaceable>VERSION_NUMBER</replaceable>.noarch.rpm"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:427
msgid "After installing the policy, you are ready to start file system labeling. Run"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:432
#, no-wrap
msgid ""
"restorecon -Rp /"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:434
msgid "to start the <command>/sbin/setfiles</command> command to label all files on your system. The <filename>/etc/selinux/minimum/contexts/files/file_contexts</filename> input file is used. The <filename>file_contexts</filename> file needs to match your actual file system as much as possible. Otherwise, it can lead to a completely unbootable system. If that happens, modify the records in <filename>file_contexts</filename> with the <command>semanage fcontext</command> command to match the real structure of the file system your server is using. For example"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:446
#, no-wrap
msgid ""
"semanage fcontext -a -t samba_share_t /etc/example_file"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:448
msgid "changes the file type from the default <literal>etc_t</literal> to <literal>samba_share_t</literal> and adds the following record to the related <filename>file_contexts.local</filename> file:"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:454
#, no-wrap
msgid ""
"/etc/example_file    unconfined_u:object_r:samba_share_t:s0"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:456
msgid "Then run"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:460
#, no-wrap
msgid ""
"restorecon -v /etc/example_file"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:462
msgid "for the type change to take effect."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:466
msgid "Before doing this, make sure to read the rest of this chapter, so you fully understand how context type is applied to files and directories. Do not forget to make a backup of the <filename>file_contexts</filename> file before starting."
msgstr ""

#. (itstool) path: note/title
#: xml/selinux.xml:474
msgid "The User <systemitem class=\"username\">nobody</systemitem>"
msgstr ""

#. (itstool) path: note/para
#: xml/selinux.xml:475
msgid "While using <command>semanage</command>, you may get a message that complains about the home directory of <systemitem class=\"username\">nobody</systemitem>. In this case, change the login shell of user <systemitem class=\"username\">nobody</systemitem> to <filename>/sbin/nologin</filename>. Then the settings of <systemitem class=\"username\">nobody</systemitem> match the current policy settings."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:486
msgid "After another reboot SELinux should be operational. To verify this, use the command <command>sestatus -v</command>. It should give you an output similar to <xref linkend=\"ex.selnx.sestatus\" xrefstyle=\"select:label quotedtitle nopage\"/>."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:494
msgid "Verifying that SELinux is functional"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:495
#, no-wrap
msgid ""
"sestatus -v\n"
"SELinux status:                 enabled\n"
"SELinuxfs mount:                /selinux\n"
"Current mode:                   permissive\n"
"Mode from config file:          permissive\n"
"Policy version:                 26\n"
"Policy from config file:        minimum\n"
"\n"
"Process contexts:\n"
"Current context:                root:staff_r:staff_t\n"
"Init context:                   system_u:system_r:init_t\n"
"/sbin/mingetty                  system_u:system_r:sysadm_t\n"
"/usr/sbin/sshd                  system_u:system_r:sshd_t\n"
"\n"
"File contexts:\n"
"Controlling term:               root:object_r:user_devpts_t\n"
"/etc/passwd                     system_u:object_r:etc_t\n"
"/etc/shadow                     system_u:object_r:shadow_t\n"
"/bin/bash                       system_u:object_r:shell_exec_t\n"
"/bin/login                      system_u:object_r:login_exec_t\n"
"/bin/sh                         system_u:object_r:bin_t -&gt; system_u:object_r:shell_exec_t\n"
"/sbin/agetty                    system_u:object_r:getty_exec_t\n"
"/sbin/init                      system_u:object_r:init_exec_t\n"
"/sbin/mingetty                  system_u:object_r:getty_exec_t\n"
"/usr/sbin/sshd                  system_u:object_r:sshd_exec_t\n"
"/lib/libc.so.6                  system_u:object_r:lib_t -&gt; system_u:object_r:lib_t\n"
"/lib/ld-linux.so.2              system_u:object_r:lib_t -&gt; system_u:object_r:ld_so_t"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:527
msgid "At this point you have a completely functional SELinux system and it is time to further configure it. In the current status, SELinux is operational but not in enforcing mode. This means that it does not limit you in doing anything, it logs everything that it should be doing if it were in enforcing mode. This is good, because based on the log files you can find what it is that it would prevent you from doing. As a first test, put SELinux in enforcing mode and find out if you can still use your server after doing so: check that the option <option>enforcing=1</option> is set in the GRUBÂ 2 configuration file, while <option>SELINUX=enforcing</option> is set in <filename>/etc/selinux/config</filename>. Reboot your server and see if it still comes up the way you expect it to. If it does, leave it like that and start modifying the server in a way that everything works as expected. However, you may not even be able to boot the server properly. In that case, switch back to the mode where SELinux is not enforcing and start tuning your server."
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:548
msgid "Before you start tuning your server, verify the SELinux installation. You have already used the command <command>sestatus -v</command> to view the current mode, process, and file contexts. Next, run"
msgstr ""

#. (itstool) path: sect1/screen
#. (itstool) path: sect2/screen
#: xml/selinux.xml:553
#: xml/selinux.xml:952
#, no-wrap
msgid ""
"semanage boolean -l"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:554
msgid "which lists all Boolean switches that are available, and at the same time verifies that you can access the policy. <xref linkend=\"ex.selnx.ls.bool\"/> shows part of the output of this command."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:561
msgid "Getting a List of Booleans and Verifying Policy Access"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:562
#, no-wrap
msgid ""
"semanage boolean -l\n"
"SELinux boolean                          Description\n"
"ftp_home_dir                   -&gt; off   ftp_home_dir\n"
"mozilla_read_content           -&gt; off   mozilla_read_content\n"
"spamassassin_can_network       -&gt; off   spamassassin_can_network\n"
"httpd_can_network_relay        -&gt; off   httpd_can_network_relay\n"
"openvpn_enable_homedirs        -&gt; off   openvpn_enable_homedirs\n"
"gpg_agent_env_file             -&gt; off   gpg_agent_env_file\n"
"allow_httpd_awstats_script_anon_write -&gt; off   allow_httpd_awstats_script_anon_write\n"
"httpd_can_network_connect_db   -&gt; off   httpd_can_network_connect_db\n"
"allow_ftpd_full_access         -&gt; off   allow_ftpd_full_access\n"
"samba_domain_controller        -&gt; off   samba_domain_controller\n"
"httpd_enable_cgi               -&gt; off   httpd_enable_cgi\n"
"virt_use_nfs                   -&gt; off   virt_use_nfs"
msgstr ""

#. (itstool) path: example/para
#: xml/selinux.xml:576
msgid "Another command that outputs useful information at this stage is"
msgstr ""

#. (itstool) path: example/screen
#. (itstool) path: sect2/screen
#: xml/selinux.xml:579
#: xml/selinux.xml:778
#, no-wrap
msgid ""
"semanage fcontext -l"
msgstr ""

#. (itstool) path: example/para
#: xml/selinux.xml:580
msgid "It shows the default file context settings as provided by the policy (see <xref linkend=\"ex.selnx.fcon\" xrefstyle=\"select:label quotedtitle nopage\"/> for partial output of this command)."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:588
msgid "Getting File Context Information"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:589
#, no-wrap
msgid ""
"semanage fcontext -l\n"
"/var/run/usb(/.*)?                                 all files          system_u:object_r:hotplug_var_run_t\n"
"/var/run/utmp                                      regular file       system_u:object_r:initrc_var_run_t\n"
"/var/run/vbe.*                                     regular file       system_u:object_r:hald_var_run_t\n"
"/var/run/vmnat.*                                   socket             system_u:object_r:vmware_var_run_t\n"
"/var/run/vmware.*                                  all files          system_u:object_r:vmware_var_run_t\n"
"/var/run/vpnc(/.*)?                                all files          system_u:object_r:vpnc_var_run_t\n"
"/var/run/watchdog\\.pid                             regular file       system_u:object_r:watchdog_var_run_t\n"
"/var/run/winbindd(/.*)?                            all files          system_u:object_r:winbind_var_run_t\n"
"/var/run/wnn-unix(/.*)                             all files          system_u:object_r:canna_var_run_t\n"
"/var/run/wpa_supplicant(/.*)?                      all files          system_u:object_r:NetworkManager_var_run_t\n"
"/var/run/wpa_supplicant-global                     socket             system_u:object_r:NetworkManager_var_run_t\n"
"/var/run/xdmctl(/.*)?                              all files          system_u:object_r:xdm_var_run_t\n"
"/var/run/yiff-[0-9]+\\.pid                          regular file       system_u:object_r:soundd_var_run_t"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:609
msgid "The base SELinux configuration is now operational and it can now be configured to secure your server. In SELinux, an additional set of rules is used to define exactly which process or user can access which files, directories, or ports. To do this, SELinux applies a context to every file, directory, process, and port. This context is a security label that defines how this file, directory, process, or port should be treated. These context labels are used by the SELinux policy, which defines exactly what should be done with the context labels. By default, the policy blocks all non-default access, which means that, as an administrator, you need to enable all features that are non-default on your server."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:624
msgid "Viewing the Security Context"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:625
msgid "As already mentioned, files, directories, and ports can be labeled. Within each label, different contexts are used. To be able to perform your daily administration work, the type context is what you are most interested in. As an administrator, you will mostly work with the type context. Many commands allow you to use the <option>-Z</option> option to list current context settings. In <xref linkend=\"ex.selnx.def.con\" xrefstyle=\"select:label quotedtitle nopage\"/> you can see what the context settings are for the directories in the root directory."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:637
msgid "The default context for directories in the root directory"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:638
#, no-wrap
msgid ""
"ls -Z\n"
"dr-xr-xr-x. root root system_u:object_r:bin_t:s0       bin\n"
"dr-xr-xr-x. root root system_u:object_r:boot_t:s0      boot\n"
"drwxr-xr-x. root root system_u:object_r:cgroup_t:s0    cgroup\n"
"drwxr-xr-x+ root root unconfined_u:object_r:default_t:s0 data\n"
"drwxr-xr-x. root root system_u:object_r:device_t:s0    dev\n"
"drwxr-xr-x. root root system_u:object_r:etc_t:s0       etc\n"
"drwxr-xr-x. root root system_u:object_r:home_root_t:s0 home\n"
"dr-xr-xr-x. root root system_u:object_r:lib_t:s0       lib\n"
"dr-xr-xr-x. root root system_u:object_r:lib_t:s0       lib64\n"
"drwx------. root root system_u:object_r:lost_found_t:s0 lost+found\n"
"drwxr-xr-x. root root system_u:object_r:mnt_t:s0       media\n"
"drwxr-xr-x. root root system_u:object_r:autofs_t:s0    misc\n"
"drwxr-xr-x. root root system_u:object_r:mnt_t:s0       mnt\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 mnt2\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 mounts\n"
"drwxr-xr-x. root root system_u:object_r:autofs_t:s0    net\n"
"drwxr-xr-x. root root system_u:object_r:usr_t:s0       opt\n"
"dr-xr-xr-x. root root system_u:object_r:proc_t:s0      proc\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 repo\n"
"dr-xr-x---. root root system_u:object_r:admin_home_t:s0 root\n"
"dr-xr-xr-x. root root system_u:object_r:bin_t:s0       sbin\n"
"drwxr-xr-x. root root system_u:object_r:security_t:s0  selinux\n"
"drwxr-xr-x. root root system_u:object_r:var_t:s0       srv\n"
"-rw-r--r--. root root unconfined_u:object_r:swapfile_t:s0 swapfile\n"
"drwxr-xr-x. root root system_u:object_r:sysfs_t:s0     sys\n"
"drwxrwxrwt. root root system_u:object_r:tmp_t:s0       tmp\n"
"-rw-r--r--. root root unconfined_u:object_r:etc_runtime_t:s0 tmp2.tar\n"
"-rw-r--r--. root root unconfined_u:object_r:etc_runtime_t:s0 tmp.tar\n"
"drwxr-xr-x. root root system_u:object_r:usr_t:s0       usr\n"
"drwxr-xr-x. root root system_u:object_r:var_t:s0       var"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:670
msgid "In the listing above, you can see the complete context for all directories. It consists of a user, a role, and a type. The s0 setting indicates the security level in Multi Level Security environments. These environments are not discussed here. In such an environment, make sure that s0 is set. The Context Type defines what kind of activity is permitted in the directory. Compare, for example, the <filename>/root</filename> directory, which has the <filename>admin_home_t</filename> context type, and the <filename>/home</filename> directory, which has the <filename>home_root_t</filename> context type. In the SELinux policy, different kinds of access are defined for these context types."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:683
msgid "Security labels are not only associated with files, but also with other items, such as ports and processes. In <xref linkend=\"ex.selnx.set.proc\" xrefstyle=\"select:label quotedtitle nopage\"/> for example you can see the context settings for processes on your server."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:691
msgid "Showing SELinux settings for processes with <command>ps Zaux</command>"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:692
#, no-wrap
msgid ""
"ps Zaux\n"
"LABEL                           USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\n"
"system_u:system_r:init_t        root         1  0.0  0.0  10640   808 ?        Ss   05:31   0:00 init [5]\n"
"system_u:system_r:kernel_t      root         2  0.0  0.0      0     0 ?        S    05:31   0:00 [kthreadd]\n"
"system_u:system_r:kernel_t      root         3  0.0  0.0      0     0 ?        S    05:31   0:00 [ksoftirqd/0]\n"
"system_u:system_r:kernel_t      root         6  0.0  0.0      0     0 ?        S    05:31   0:00 [migration/0]\n"
"system_u:system_r:kernel_t      root         7  0.0  0.0      0     0 ?        S    05:31   0:00 [watchdog/0]\n"
"system_u:system_r:sysadm_t      root      2344  0.0  0.0  27640   852 ?        Ss   05:32   0:00 /usr/sbin/mcelog --daemon --config-file /etc/mcelog/mcelog.conf\n"
"system_u:system_r:sshd_t        root      3245  0.0  0.0  69300  1492 ?        Ss   05:32   0:00 /usr/sbin/sshd -o PidFile=/var/run/sshd.init.pid\n"
"system_u:system_r:cupsd_t       root      3265  0.0  0.0  68176  2852 ?        Ss   05:32   0:00 /usr/sbin/cupsd\n"
"system_u:system_r:nscd_t        root      3267  0.0  0.0 772876  1380 ?        Ssl  05:32   0:00 /usr/sbin/nscd\n"
"system_u:system_r:postfix_master_t root   3334  0.0  0.0  38320  2424 ?        Ss   05:32   0:00 /usr/lib/postfix/master\n"
"system_u:system_r:postfix_qmgr_t postfix  3358  0.0  0.0  40216  2252 ?        S    05:32   0:00 qmgr -l -t fifo -u\n"
"system_u:system_r:crond_t       root      3415  0.0  0.0  14900   800 ?        Ss   05:32   0:00 /usr/sbin/cron\n"
"system_u:system_r:fsdaemon_t    root      3437  0.0  0.0  16468  1040 ?        S    05:32   0:00 /usr/sbin/smartd\n"
"system_u:system_r:sysadm_t      root      3441  0.0  0.0  66916  2152 ?        Ss   05:32   0:00 login -- root\n"
"system_u:system_r:sysadm_t      root      3442  0.0  0.0   4596   800 tty2     Ss+  05:32   0:00 /sbin/mingetty tty2"
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:713
msgid "Selecting the SELinux Mode"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:714
msgid "In SELinux, three different modes can be used:"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:719
msgid "Enforcing:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:721
msgid "This is the default mode. SELinux protects your server according to the rules in the policy, and SELinux logs all of its activity to the audit log."
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:729
msgid "Permissive:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:731
msgid "This mode is useful for troubleshooting. If set to Permissive, SELinux does not protect your server, but it still logs everything that happens to the log files."
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:739
msgid "Disabled:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:741
msgid "In this mode, SELinux is switched off completely and no logging occurs. The file system labels however are not removed from the file system."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:749
msgid "You have already read how you can set the current SELinux mode from GRUBÂ 2 while booting using the enforcing boot parameter."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:756
msgid "Modifying SELinux Context Types"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:757
msgid "An important part of the work of an administrator is setting context types on files to ensure appropriate working of SELinux."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:761
msgid "If a file is created within a specific directory, it inherits the context type of the parent directory by default. If, however, a file is moved from one location to another location, it retains the context type that it had in the old location."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:767
msgid "To set the context type for files, you can use the <command>semanage fcontext</command> command. With this command, you write the new context type to the policy, but it does not change the actual context type immediately! To apply the context types that are in the policy, you need to run the <command>restorecon</command> command afterward."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:774
msgid "The challenge when working with <command>semanage fcontext</command> is to find out which context you actually need. You can use"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:779
msgid "to list all contexts in the policy, but it may be a bit hard to find out the actual context you need from that list as it is rather long (see <xref linkend=\"ex.selnx.semanage\" xrefstyle=\"select:label quotedtitle nopage\"/>)."
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:786
msgid "Viewing Default File Contexts"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:787
#, no-wrap
msgid ""
"semanage fcontext -l | less\n"
"SELinux fcontext                                   type               Context\n"
"\n"
"/                                                  directory          system_u:object_r:root_t:s0\n"
"/.*                                                all files          system_u:object_r:default_t:s0\n"
"/[^/]+                                             regular file       system_u:object_r:etc_runtime_t:s0\n"
"/\\.autofsck                                        regular file       system_u:object_r:etc_runtime_t:s0\n"
"/\\.autorelabel                                     regular file       system_u:object_r:etc_runtime_t:s0\n"
"/\\.journal                                         all files          X:&gt;&gt;None&gt;&gt;\n"
"/\\.suspended                                       regular file       system_u:object_r:etc_runtime_t:s0\n"
"/a?quota\\.(user|group)                             regular file       system_u:object_r:quota_db_t:s0\n"
"/afs                                               directory          system_u:object_r:mnt_t:s0\n"
"/bin                                               directory          system_u:object_r:bin_t:s0\n"
"/bin/.*                                            all files          system_u:object_r:bin_t:s0"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:802
msgid "There are three ways to find out which context settings are available for your services:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:808
msgid "Install the service and look at the default context settings that are used. This is the easiest and recommended option."
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:814
msgid "Consult the man page for the specific service. Some services have a man page that ends in <literal>_selinux</literal>, which contains all the information you need to find the correct context settings."
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:819
msgid "When you have found the right context setting, apply it using <command>semanage fcontext</command>. This command takes <option>-t</option> context type as its first argument, followed by the name of the directory or file to which you want to apply the context settings. To apply the context to everything that already exists in the directory where you want to apply the context, you add the regular expression <literal>(/.*)?</literal> to the name of the directory. This means: optionally, match a slash followed by any character. The examples section of the <command>semanage</command> man page has some useful usage examples for <command>semanage</command>. For more information on regular expressions, see for example the tutorial at <link xlink:href=\"http://www.regular-expressions.info/\"/>."
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:835
msgid "Display a list of all context types that are available on your system:"
msgstr ""

#. (itstool) path: listitem/screen
#: xml/selinux.xml:838
#, no-wrap
msgid ""
"seinfo -t"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:839
msgid "Since the command by itself outputs an overwhelming amount of information, it should be used in combination with <command>grep</command> or a similar command for filtering."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:849
msgid "Applying File Contexts"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:850
msgid "To help you apply the SELinux context properly, the following procedure shows how to set a context using <command>semanage fcontext</command> and <command>restorecon</command>. You will notice that at first attempt, the Web server with a non-default document root does not work. After changing the SELinux context, it will:"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:858
msgid "Create the <filename>/web</filename> directory and then change to it:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:861
#, no-wrap
msgid ""
"sudo mkdir /web  &amp;&amp; cd /web"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:864
msgid "Use a text editor to create the file <filename>/web/index.html</filename> that contains the text welcome to my Web site."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:871
msgid "Open the file <filename>/etc/apache2/default-server.conf</filename> with an editor, and change the DocumentRoot line to <literal>DocumentRoot /web</literal>"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:878
msgid "Start the Apache Web server:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:881
#, no-wrap
msgid ""
"sudo systemctl start apache2"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:884
msgid "Open a session to your local Web server:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:887
#, no-wrap
msgid ""
"w3m localhost"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:888
msgid "You will receive a <emphasis>Connection refused</emphasis> message. Press <keycap function=\"enter\"/>, and then <command>q</command> to quit w3m."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:895
msgid "Find the current context type for the default Apache <literal>DocumentRoot</literal>, which is <filename>/srv/www/htdocs</filename>. It should be set to <filename>httpd_sys_content_t</filename>:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:901
#, no-wrap
msgid ""
"ls -Z /srv/www"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:904
msgid "Set the new context in the policy and press <keycap function=\"enter\"/>:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:908
#, no-wrap
msgid ""
"semanage fcontext -a -f \"\" -t httpd_sys_content_t '/web(/.*) ?'"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:911
msgid "Apply the new context type:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:914
#, no-wrap
msgid ""
"restorecon /web"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:917
msgid "Show the context of the files in the directory <filename>/web</filename>. You will see that the new context type has been set properly to the <filename>/web</filename> directory, but not to its contents."
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:923
#, no-wrap
msgid ""
"ls -Z /web"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:926
msgid "Apply the new context recursively to the <filename>/web</filename> directory. The type context has now been set correctly."
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:930
#, no-wrap
msgid ""
"restorecon -R /web"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:933
msgid "Restart the Web server:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:936
#, no-wrap
msgid ""
"sudo systemctl restart apache2"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:937
msgid "You should now be able to access the contents of the <filename>/web</filename> directory."
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:946
msgid "Configuring SELinux Policies"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:947
msgid "The easiest way to change the behavior of the policy is by working with Booleans. These are on-off switches that you can use to change the settings in the policy. To find out which Booleans are available, run"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:953
msgid "It will show a long list of Booleans, with a short description of what each of these Booleans will do for you. When you have found the Boolean you want to set, you can use <command>setsebool -P</command>, followed by the name of the Boolean that you want to change. It is important to use the <option>-P</option> option at all times when using <command>setsebool</command>. This option writes the setting to the policy file on disk, and this is the only way to make sure that the Boolean is applied automatically after a reboot."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:963
msgid "The procedure below gives an example of changing Boolean settings"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:968
msgid "List Booleans that are related to FTP servers."
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:970
#, no-wrap
msgid ""
"semanage boolean -l | grep ftp"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:973
msgid "Turn the Boolean off:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:976
#, no-wrap
msgid ""
"setsebool allow_ftpd_anon_write off"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:977
msgid "Note that it does not take much time to write the change. Then verify that the Boolean is indeed turned off:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:980
#, no-wrap
msgid ""
"semanage boolean -l|grep ftpd_anon"
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:983
msgid "Reboot your server."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:988
msgid "Check again to see if the <literal>allow_ftpd_anon_write</literal> Boolean is still turned on. As it has not yet been written to the policy, you will notice that it is off."
msgstr ""

#. (itstool) path: step/para
#: xml/selinux.xml:995
msgid "Switch the Boolean and write the setting to the policy:"
msgstr ""

#. (itstool) path: step/screen
#: xml/selinux.xml:998
#, no-wrap
msgid ""
"setsebool -P allow_ftpd_anon_write"
msgstr ""

#. (itstool) path: sect2/title
#: xml/selinux.xml:1004
msgid "Working with SELinux Modules"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1005
msgid "By default, SELinux uses a modular policy. This means that the policy that implements SELinux features is not just one huge policy, but it consists of many smaller modules. Each module covers a specific part of the SELinux configuration. The concept of the SELinux module was introduced to make it easier for third party vendors to make their services compatible with SELinux. To get an overview of the SELinux modules, you can use the <command>semodule -l</command> command. This command lists all current modules in use by SELinux and their version numbers."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1016
msgid "As an administrator, you can switch modules on or off. This can be useful if you want to disable only a part of SELinux and not everything to run a specific service without SELinux protection. Especially in the case of <phrase role=\"productname\"><phrase os=\"osuse\">openSUSE Leap</phrase><phrase os=\"sles\">SUSE Linux Enterprise Server</phrase><phrase os=\"sled\">SUSE Linux Enterprise Desktop</phrase><phrase os=\"slerte\">SUSE Linux Enterprise Real Time Extension</phrase></phrase>, where there is not a completely supported SELinux policy yet, it can make sense to switch off all modules that you do not need so that you can focus on the services that really do need SELinux protection. To switch off an SELinux module, use"
msgstr ""

#. (itstool) path: sect2/screen
#: xml/selinux.xml:1025
#, no-wrap
msgid ""
"semodule -d <replaceable>MODULENAME</replaceable>"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1026
msgid "To switch it on again, you can use"
msgstr ""

#. (itstool) path: sect2/screen
#: xml/selinux.xml:1029
#, no-wrap
msgid ""
"semodule -e modulename"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1112
msgid "As an administrator, you do not typically change the contents of the policy files that come from the SELinux Policy RPM. You would rather use <command>semanage fcontext</command> to change file contexts. If you are using <command>audit2allow</command> to generate policies for your server, you should change the policy files after all."
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1119
msgid "To change the contents of any of the policy module files, compile the changes into a new policy module file. To do this, first install the <systemitem>selinux-policy-devel</systemitem> package. Then, in the directory where the files created by <command>audit2allow</command> are located, run:"
msgstr ""

#. (itstool) path: sect2/screen
#: xml/selinux.xml:1126
#, no-wrap
msgid ""
"make -f /usr/share/selinux/devel/Makefile"
msgstr ""

#. (itstool) path: sect2/para
#: xml/selinux.xml:1127
msgid "When <command>make</command> has completed, you can manually load the modules into the system, using <command>semodule -i</command>."
msgstr ""

#. (itstool) path: sect1/title
#: xml/selinux.xml:1134
msgid "Troubleshooting"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1136
msgid "By default, if SELinux is the reason something is not working, a log message to this effect is sent to the <filename>/var/log/audit/audit.log</filename> file. That is, if the auditd service is running. If you see an empty <filename>/var/log/audit</filename>, start the auditd service using"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:1144
#, no-wrap
msgid ""
"sudo systemctl start auditd"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1146
msgid "and enable it in the targets of your system, using"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:1150
#, no-wrap
msgid ""
"sudo systemctl enable auditd"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1152
msgid "In <xref linkend=\"ex.selnx.li.auditlog\" xrefstyle=\"select:label quotedtitle nopage\"/> you can see a partial example of the contents of <filename>/var/log/audit/audit.log</filename>"
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:1160
msgid "Example Lines from <filename>/etc/audit/audit.log</filename>"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:1161
#, no-wrap
msgid ""
"type=DAEMON_START msg=audit(1348173810.874:6248): auditd start, ver=1.7.7 format=raw kernel=3.0.13-0.27-default auid=0 pid=4235 subj=system_u:system_r:auditd_t res=success\n"
"type=AVC msg=audit(1348173901.081:292): avc:  denied  { write } for  pid=3426 comm=\"smartd\" name=\"smartmontools\" dev=sda6 ino=581743 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=dir\n"
"type=AVC msg=audit(1348173901.081:293): avc:  denied  { remove_name } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state~\" dev=sda6 ino=582390 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=dir\n"
"type=AVC msg=audit(1348173901.081:294): avc:  denied  { unlink } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state~\" dev=sda6 ino=582390 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:295): avc:  denied  { rename } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582373 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:296): avc:  denied  { add_name } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state~\" scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=dir\n"
"type=AVC msg=audit(1348173901.081:297): avc:  denied  { create } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state\" scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:298): avc:  denied  { write open } for  pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582390 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:299): avc:  denied  { getattr } for  pid=3426 comm=\"smartd\" path=\"/var/lib/smartmontools/smartd.WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582390 scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.309:300): avc:  denied  { append } for  pid=1316"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1173
msgid "At first look, the lines in <filename>audit.log</filename> are a bit hard to read. However, on closer examination they are not that hard to understand. Every line can be broken down into sections. For example, the sections in the last line are:"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1182
msgid "<literal>type=AVC</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1184
msgid "every SELinux-related audit log line starts with the type identification <literal>type=AVC</literal>"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1191
msgid "<literal>msg=audit(1348173901.309:300)</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1193
msgid "This is the time stamp, which unfortunately is written in epoch time, the number of seconds that have passed since Jan 1, 1970. You can use <command>date -d</command> on the part up to the dot in the epoch time notation to find out when the event has happened:"
msgstr ""

#. (itstool) path: listitem/screen
#: xml/selinux.xml:1199
#, no-wrap
msgid ""
"date -d @1348173901\n"
"Thu Sep 20 16:45:01 EDT 2012"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1204
msgid "<literal>avc: denied { append }</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1206
msgid "the specific action that was denied. In this case the system has denied the appending of data to a file. While browsing through the audit log file, you can see other system actions, such as write open, getattr and more."
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1215
msgid "<literal>for pid=1316</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1217
msgid "the process ID of the command or process that initiated the action"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1223
msgid "<literal>comm=\"rsyslogd\"</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1225
msgid "the specific command that was associated with that PID"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1231
msgid "<literal>name=\"smartmontools\"</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1233
msgid "the name of the subject of the action"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1239
msgid "<literal>dev=sda6 ino=582296</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1241
msgid "the block device and inode number of the file that was involved"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1247
msgid "<literal>scontext=system_u:system_r:syslogd_t</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1249
msgid "the source context, which is the context of the initiator of the action"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1256
msgid "<literal>tclass=file</literal>:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1258
msgid "a class identification of the subject"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1265
msgid "Instead of interpreting the events in audit.log yourself, there is another approach. You can use the <command>audit2allow</command> command, which helps analyze the cryptic log messages in <filename>/var/log/audit/audit.log</filename>. An audit2allow troubleshooting session always consists of three different commands. First, you would use <command>audit2allow -w -a</command> to present the audit information in a more readable way. The <command>audit2allow -w -a</command> by default works on the audit.log file. If you want to analyze a specific message in the audit.log file, copy it to a temporary file and analyze the file with:"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:1278
#, no-wrap
msgid ""
"audit2allow -w -i <replaceable>FILENAME</replaceable>"
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:1281
msgid "Analyzing Audit Messages"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:1282
#, no-wrap
msgid ""
"audit2allow -w -i testfile\n"
"type=AVC msg=audit(1348173901.309:300): avc:  denied  { append } for  pid=1316\n"
"comm=\"rsyslogd\" name=\"acpid\" dev=sda6 ino=582296\n"
"scontext=system_u:system_r:syslogd_t tcontext=system_u:object_r:apmd_log_t tclass=file"
msgstr ""

#. (itstool) path: varlistentry/term
#: xml/selinux.xml:1290
msgid "This was caused by:"
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1292
msgid "Missing type enforcement (TE) allow rule."
msgstr ""

#. (itstool) path: listitem/para
#: xml/selinux.xml:1295
msgid "To generate a loadable module to allow this access, run"
msgstr ""

#. (itstool) path: listitem/screen
#: xml/selinux.xml:1298
#, no-wrap
msgid ""
"audit2allow"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1303
msgid "To find out which specific rule has denied access, you can use <command>audit2allow -a</command> to show the enforcing rules from all events that were logged to the <filename>audit.log </filename> file, or <command>audit2allow -i <replaceable>FILENAME</replaceable></command> to show it for messages that you have stored in a specific file:"
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:1312
msgid "Viewing Which Lines Deny Access"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:1313
#, no-wrap
msgid ""
"audit2allow -i testfile\n"
"#============= syslogd_t ==============\n"
"allow syslogd_t apmd_log_t:file append;"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1318
msgid "To create an SELinux module with the name <literal>mymodule</literal> that you can load to allow the access that was previously denied, run"
msgstr ""

#. (itstool) path: sect1/screen
#: xml/selinux.xml:1323
#, no-wrap
msgid ""
"audit2allow -a -R -M mymodule"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1325
msgid "If you want to do this for all events that have been logged to the audit.log, use the <option>-a -M</option> command arguments. To do it only for specific messages that are in a specific file, use <option>-i -M</option> as in the example below:"
msgstr ""

#. (itstool) path: example/title
#: xml/selinux.xml:1333
msgid "Creating a Policy Module Allowing an Action Previously Denied"
msgstr ""

#. (itstool) path: example/screen
#: xml/selinux.xml:1334
#, no-wrap
msgid ""
"audit2allow -i testfile -M example\n"
"******************** IMPORTANT ***********************\n"
"To make this policy package active, execute:\n"
"\n"
"semodule -i example.pp"
msgstr ""

#. (itstool) path: sect1/para
#: xml/selinux.xml:1341
msgid "As indicated by the <command>audit2allow</command> command, you can now run this module by using the <command>semodule -i</command> command, followed by the name of the module that <command>audit2allow</command> has created for you (<filename>example.pp</filename> in the above example)."
msgstr ""

