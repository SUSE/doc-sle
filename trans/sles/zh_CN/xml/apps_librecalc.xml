<?xml version="1.0"?>
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="apps_librecalc.xml" id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <para>
  Calc 是 LibreOffice 电子表格和数据绘图模块。电子表格由一组表格构成，包含可用元素（如文本、数字或公式）填充的单元格。公式可以操纵其他单元格中的数据，从而为插入它的单元格生成值。Calc 还允许您定义范围、对数据进行过滤和排序、或根据数据创建图表，以便用图形方式来呈现数据。借助 DataPilots，您可以合并、分析或比较大量数据。
 </para>
 <para>
  与整个 LibreOffice 套件搭配使用时，Calc 可以跨各种平台加以应用。它可提供多种交换格式（包括导出到 PDF 文档），还能读取 Microsoft Excel 格式的文件以及将文件另存为该格式。其互操作性处于持续改进中。
 </para>
 <para>
  本章仅介绍一些最基本的 Calc 功能。有关详细信息和完整说明，请参见 LibreOffice 帮助或<xref linkend="sec.oo.oview.help"/>中列出的资源。
 </para>
 <note>
  <title>VBA 宏</title>
  <para>
   Calc 可以处理 Excel 文档中的许多 VBA 宏；但是对 VBA 宏还不完全支持。当打开大量使用宏的 Excel 电子表格时，可能会发现其中一些不起作用。
  </para>
 </note>
 <sect1 id="sec.oo.calc.createnew">
  <title>新建文档</title>

  <para>
   可以通过两种方法来创建新 Calc 文档：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>全新</title>
     <para>
      要全新创建文档，请单击<menuchoice> <guimenu>文件</guimenu> <guimenu>新建</guimenu> <guimenu>电子表格</guimenu> </menuchoice>，一个新的空 Calc 文档随即创建。
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>模板</title>
     <para>
      要使用模板，请单击<menuchoice> <guimenu>文件</guimenu> <guimenu>新建</guimenu> <guimenu>模板和文档</guimenu> </menuchoice>并打开<guimenu>财务</guimenu>。可以看到电子表格模板的列表。选择适合您的需要的一个模板，随即将根据所选模板的样式创建新文档。
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   通过单击窗口底部的相应选项卡可访问单张表格。
  </para>

  <para>
   根据需要在单元格中输入数据。要调整外观，请使用<guimenu>格式设置</guimenu>工具栏或<guimenu>格式</guimenu>菜单；或者按<xref linkend="sec.oo.calc.styles"/>中所述定义样式。使用<guimenu>文件</guimenu>菜单或工具栏中的相关按钮可打印和保存文档。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.styles">
  <title>在 Calc 中使用格式设置和样式</title>

  <para>
   Calc 带有一些内置的单元格和页面样式以改进电子表格和报告的外观。尽管这些内置样式对于许多用途已经足够，但可能发现创建自己常用的格式设置自选选项很有用。
  </para>

  <procedure id="pro.oo.calc.createstyle">
   <title>创建样式</title>
   <step performance="required">
    <para>
     单击<menuchoice><guimenu>格式</guimenu><guimenu>样式和格式</guimenu></menuchoice>。
    </para>
   </step>
   <step performance="required">
    <para>
     在<guimenu>样式和格式设置</guimenu>窗口中，单击顶部的<guimenu>单元样式</guimenu>或<guimenu>页面样式</guimenu>图标。
    </para>
   </step>
   <step performance="required">
    <para>
     右键单击<guimenu>样式和格式设置</guimenu>窗口，然后单击<guimenu>新建</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     为样式指定一个名称，并使用各个选项卡设置所需的格式设置选项。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>确定</guimenu>。
    </para>
   </step>
  </procedure>

  <procedure>
   <title>修改样式</title>
   <step performance="required">
    <para>
     单击<menuchoice><guimenu>格式</guimenu><guimenu>样式和格式</guimenu></menuchoice>。
    </para>
   </step>
   <step performance="required">
    <para>
     在<guimenu>格式设置和样式</guimenu>窗口中，单击<guimenu>单元格样式</guimenu>或<guimenu>页面样式</guimenu>图标。
    </para>
   </step>
   <step performance="required">
    <para>
     右键单击希望更改的样式的名称，然后单击<guimenu>修改</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     更改所需的格式设置选项。
    </para>
   </step>
   <step performance="required">
    <para>
     单击“确定”。
    </para>
   </step>
  </procedure>

  <para>
   要对特定单元格应用样式，请选择要进行格式设置的单元格。然后在<guimenu>样式和格式设置</guimenu>窗口中双击要应用的样式。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.sheets">
  <title>处理表格</title>

  <para>
   表格是组织计算的好方法。例如，如果为每个月创建一张表格，企业会计账目会清楚得多。
  </para>

  <para>
   要在电子表格中插入一个新表格，请执行以下操作：
  </para>

  <procedure>
   <title>插入新表格</title>
   <step performance="required">
    <para>
     从主菜单中选择<menuchoice> <guimenu>插入</guimenu> <guimenu>表格</guimenu> </menuchoice>。将打开一个对话框。
    </para>
   </step>
   <step performance="required">
    <para>
     确定新表格应放在所选表格之前还是之后。
    </para>
   </step>
   <step performance="required">
    <para>
     如果要创建新表格，请确保<guimenu>新建表格</guimenu>单选按钮已激活。输入表格数和表格名称。跳过下一步。
    </para>
   </step>
   <step performance="required">
    <para>
     如果要从其他文件导入表格，请执行以下操作，否则请跳过这一步：
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       选择<guimenu>从文件</guimenu>并单击<guimenu>浏览</guimenu>
      </para>
     </step>
     <step performance="required">
      <para>
       选择文件名并单击<guimenu>确定</guimenu>确认操作。所有表格名称随即显示在列表中。
      </para>
     </step>
     <step performance="required">
      <para>
       通过按 <keycap function="shift"/> 键选择要导入的表格名称。
      </para>
     </step>
     <step performance="required">
      <para>
       单击<guimenu>确定</guimenu>确认以导入所选的表格名称。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   要重命名表格，请在表格选项卡中右键单击此表格，并选择<guimenu>重命名表格</guimenu>。
  </para>

  <para>
   要删除当前表格，请选择<menuchoice> <guimenu>编辑</guimenu> <guimenu>表格</guimenu> <guimenu>删除</guimenu> </menuchoice>并单击<guimenu>删除表格</guimenu>确认操作。通过按住 <keycap function="shift"/> 键并在表格选项卡中选择要删除的表格可以删除多个表格。右键单击并选择<guimenu>删除表格</guimenu>，也会显示同样的对话框。单击<guimenu>删除表格</guimenu>确认操作。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.condformat">
  <title>条件格式设置</title>

  <para>
   条件格式设置是在电子表格中高亮显示特定值的有用功能。例如，定义一个条件，如果此条件为 True，则将对满足此条件的每个单元格应用一种样式。
  </para>

  <note>
   <title>启用自动计算</title>
   <para>
    应用条件格式设置之前，请选择<menuchoice> <guimenu>工具</guimenu> <guimenu>单元格内容</guimenu> <guimenu>自动计算</guimenu> </menuchoice>。在<guimenu>自动计算</guimenu>前面应显示一个复选标记。
   </para>
  </note>

  <para>
   按如下所示继续：
  </para>

  <procedure id="pro.oo.calc.condformat">
   <title>使用条件格式设置</title>
   <step performance="required">
    <para>
     首先定义样式。此样式将在条件为 True 时应用于每个单元格。使用<menuchoice> <guimenu>格式</guimenu> <guimenu>样式和格式设置</guimenu> </menuchoice>或按 <keycap>F11</keycap>。有关详细信息，请参见<xref linkend="pro.oo.calc.createstyle"/>。单击<guimenu>确定</guimenu>进行确认。
    </para>
   </step>
   <step performance="required">
    <para>
     选择要应用条件的单元格范围。
    </para>
   </step>
   <step performance="required">
    <para>
     从主菜单中选择<menuchoice> <guimenu>格式</guimenu> <guimenu>条件格式设置</guimenu> <guimenu>条件格式设置</guimenu></menuchoice>。随即打开一个对话框。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>添加</guimenu>，然后确定您的条件。最多可定义三个条件。可单独启用或禁用这三个条件中的任何一个。可以在<quote>单元格模式</quote>或<quote>公式模式</quote>下操作条件：
    </para>
    <variablelist>
     <varlistentry>
      <term>单元格模式</term>
      <listitem>
       <para>
        如果条件与特定单元格值匹配，则将测试此条件。在第一个下拉菜单旁边，您可以选择操作符，如等于、小于、大于等。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>公式模式</term>
      <listitem>
       <para>
        如果特定公式返回 True，则将测试此条件。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step performance="required">
    <para>
     根据具体模式，请相应地输入：
    </para>
    <substeps performance="required">
     <step performance="required">
      <formalpara>
       <title>单元格模式</title>
       <para>
        选择操作符和单元格的值。
       </para>
      </formalpara>
     </step>
     <step performance="required">
      <formalpara>
       <title>公式模式</title>
       <para>
        选择要测试的函数。
       </para>
      </formalpara>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     选择当条件为 True 时要应用的样式，或单击<guimenu>新建样式</guimenu>以定义新外观。
    </para>
   </step>
   <step performance="required">
    <para>
     如果需要定义更多条件，请重复之前的步骤。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>确定</guimenu>进行确认。
    </para>
   </step>
  </procedure>

  <para>
   现在，单元格的样式已更改。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.grouping">
  <title>对单元格分组和取消分组</title>

  <para>
   对单元格范围进行分组有助于将电子表格折叠成几部分。这将使电子表格更易阅读，因为您可以仅显示目前感兴趣的部分。可以对行或列进行分组，以及在其他组中嵌套组。
  </para>

  <para>
   要对一个范围进行分组，请执行以下操作：
  </para>

  <procedure>
   <title>对所选单元格范围进行分组</title>
   <step performance="required">
    <para>
     在电子表格中选择一个单元格范围。
    </para>
   </step>
   <step performance="required">
    <para>
     选择<menuchoice> <guimenu>数据</guimenu> <guimenu>分组和轮廓</guimenu> <guimenu>分组</guimenu> </menuchoice>。将显示一个对话框。
    </para>
   </step>
   <step performance="required">
    <para>
     确定是要按行还是按列对所选范围进行分组。单击<guimenu>确定</guimenu>进行确认。
    </para>
   </step>
  </procedure>

  <para>
   对所选单元格进行分组后，左上页边空白中将出现一条线，指示已分组的单元格范围。使用 <guimenu>+</guimenu> 和 <guimenu>-</guimenu> 图标可折叠或展开此单元格范围。页边空白中的数字显示组的深度，并且也可单击。
  </para>

  <para>
   要对单元格范围取消分组，请单击属于某个组的单元格并依次选择<menuchoice> <guimenu>数据</guimenu> <guimenu>分组和轮廓</guimenu> <guimenu>取消分组</guimenu> </menuchoice>。页边空白中的线随即消失。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.freezing">
  <title>将行或列作为标题冻结</title>

  <para>
   如果电子表格包含大量数据，滚动操作通常会使标题消失。LibreOffice 可锁定行和/或列，以便在您滚动电子表格时仍然显示标题。
  </para>

  <para>
   要冻结单个行或单个列，请执行以下操作：
  </para>

  <procedure>
   <title>冻结单个行或单个列</title>
   <step performance="required">
    <para>
     要冻结某一行，请在左长条中单击该行的标题。
    </para>
    <para>
     要冻结某一列，请单击该列的标题。列标题是图标栏下方的长条，其标签为 A、B、C 等。
    </para>
   </step>
   <step performance="required">
    <para>
     选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>。随即显示一条黑线，指示保留行或列的位置。
    </para>
   </step>
  </procedure>

  <para>
   也可以同时冻结行和列。按如下所示继续：
  </para>

  <procedure>
   <title>冻结行和列</title>
   <step performance="required">
    <para>
     单击要冻结的列右侧和行下方的单元格。例如，如果标题占据从 A1 到 B3 的单元格，则请单击单元格 C4。
    </para>
   </step>
   <step performance="required">
    <para>
     选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>。随即显示一条黑线，指示保留行或列的位置。
    </para>
   </step>
  </procedure>

  <para>
   如果要取消冻结，请选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>，复选标记随即消失。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.moreinfo">
  <title>更多信息</title>

  <para>
   <ulink url="http://www.libreoffice.org/get-help/documentation/"/>
  </para>
 </sect1>
</chapter>
