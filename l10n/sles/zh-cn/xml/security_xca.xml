<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="security_xca.xml" version="5.0" xml:id="cha-security-xca">

<title>使用 XCA、X 证书和密钥管理器管理 PKI</title>
  <info>
    <abstract>
      <para>
        传统上，您自己的公共密钥基础架构 (PKI) 是使用 <command>openssl</command> 实用程序管理的。对于偏好使用图形工具的管理员，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP5</phrase></phrase> 提供了 XCA，即 X 证书和密钥管理工具 (<link xlink:href="http://hohnstaedt.de/xca"/>)。
      </para>
      <para>
        XCA 可创建和管理 X.509 证书、证书请求、RSA、DSA 和 EC 私用密钥、智能卡以及证书吊销列表 (CRL)。XCA 会为您提供创建和管理自己的证书颁发机构 (CA) 所需的一切支持。XCA 包含可用于生成证书或请求的可自定义模板。本章将介绍基本设置。
      </para>
    </abstract>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker>
        </dm:bugtracker>
	<dm:translation>yes</dm:translation>
      </dm:docmanager>
  </info>

<sect1 xml:id="sec-security-xca-install">
  <title>安装 XCA</title>
  <para>
    XCA 由 <package>xca</package> 软件包提供：
  </para>
  <screen><prompt>&gt; </prompt><command>sudo</command> zypper in xca</screen>
</sect1>

<sect1 xml:id="sec-security-xca-start">
  <title>创建新 PKI</title>
  <para>XCA 将所有加密数据都储存在数据库中。当您首次使用 XCA 创建新 PKI 时，首先必须单击<guimenu>文件 &gt; 新建数据库</guimenu>创建一个新数据库（<xref linkend="fig-xca-newdb"/>）。
  </para>
  <figure xml:id="fig-xca-newdb">
 <title>创建新 XCA 数据库</title>
 <mediaobject>
  <imageobject role="html">
   <imagedata fileref="sec-xca-2.png" width="80%"/>
  </imageobject>
  <imageobject role="fo">
   <imagedata fileref="sec-xca-2.png" width="80%"/>
  </imageobject>
  <textobject role="description">
   <phrase>创建新 XCA 数据库</phrase>
  </textobject>
 </mediaobject>
</figure>

<sect2 xml:id="sec-security-root-ca">
 <title>创建新的根 CA</title>
 <para>
  以下步骤说明如何创建新的根 CA。
 </para>
  <procedure xml:id="pro-create-root-ca">
 <step>
   <para>
     单击<guimenu>证书</guimenu>选项卡。
   </para>
 </step>
 <step>
   <para>
     单击<guimenu>新建证书</guimenu>按钮。
   </para>
 </step>
 <step>
   <para>
     单击<guimenu>源</guimenu>选项卡。在窗口底部的<guimenu>新证书的模板</guimenu>下，选择 <guimenu>[默认] CA</guimenu> 模板，然后单击<guimenu>全部应用</guimenu>。
   </para>
 </step>
 <step>
   <para>
     单击<guimenu>主体</guimenu>选项卡。创建一个<guimenu>内部名称</guimenu>用于在内部标识新的根 CA（仅在 XCA 内部）。
   </para>
   <para>
      填写<guimenu>判别名</guimenu>部分中的字段。使用<guimenu>添加</guimenu>按钮添加任何其他元素（如果需要）。
    </para>
  </step>
  <step>
    <para>
      在<guimenu>私用密钥</guimenu>下拉列表中选择您的首选私用密钥（如果有），或者生成一个新密钥。
    </para>
  </step>
  <step>
    <para>
      单击<guimenu>扩展</guimenu>选项卡。根据需要编辑任何属性。默认<guimenu>时间范围</guimenu>为 10 年。证书吊销列表分发点将成为颁发的证书的一部分。最好为所有证书使用一个通用 URL，例如 <replaceable>http://www.example.com/crl/crl.der</replaceable>。完成后，单击<guimenu>确定</guimenu>按钮。
    </para>
  </step>
</procedure>
</sect2>

<sect2 xml:id="sec-security-signed-host-cert">
  <title>创建已签名的主机证书</title>
  <para>
    下一步是创建由新证书颁发机构签名的主机证书。
  </para>
  <procedure>
    <step>
      <para>
        单击<guimenu>证书</guimenu>选项卡，然后单击<guimenu>新建证书</guimenu>按钮。
      </para>
    </step>
    <step>
      <para>
        在<guimenu>源</guimenu>选项卡上选择 <guimenu>[默认] TLS_server</guimenu>，然后单击<guimenu>全部应用</guimenu>按钮。这样会在<guimenu>扩展</guimenu>、<guimenu>密钥用途</guimenu>和 <guimenu>Netscape</guimenu> 选项卡中输入相应的值。在<guimenu>签名</guimenu>部分，选择在<xref linkend="sec-security-root-ca"/>中创建的证书。
      </para>
    </step>
    <step>
      <para>
        单击<guimenu>主体</guimenu>选项卡。创建一个用于在 XCA 中显示的内部名称。最好使用主机名或完全限定的域名。然后填写<guimenu>判别名</guimenu>部分中的字段。对于主机证书，通用名必须是您的用户使用的 FQDN。此名称可以是主机的规范名称，也可以是别名。例如，如果 jupiter.example.com 是您的 Web 服务器，并且它具有 DNS CNAME 项 www.example.com，那么，您可以使用 www.example.com 作为证书中的 <guimenu>commonName</guimenu> 值。要在判别名中添加任何其他组成部分，请使用下拉框和“添加”按钮。选择所需的私用密钥，或生成一个新密钥。
      </para>
    </step>
    <step>
      <para>
        单击<guimenu>扩展</guimenu>选项卡。默认<guimenu>时间范围</guimenu>为 1 年。如果您更改了此设置，请单击<guimenu>应用</guimenu>按钮。
      </para>
    </step>
    <step>
      <para>
        建议指定证书吊销列表位置。此根证书的位置必须是唯一的。XCA 以 PEM 或 DER 格式导出 CRL 并会添加相应的后缀，因此在选择 URL 时应考虑到这点，例如，选择 <replaceable>http://www.example.com/crl/crl.der</replaceable> 这样的 URL。在 <guimenu>CRL 分发点</guimenu>行中，单击<guimenu>编辑</guimenu>按钮。键入您的 URI，然后单击<guimenu>添加</guimenu>。单击<guimenu>验证</guimenu>和<guimenu>应用</guimenu>。
      </para>
      <para>
        单击<guimenu>确定</guimenu>按钮。
      </para>
    </step>
    </procedure>
  </sect2>

  <sect2 xml:id="sec-security-revoke-cert">
    <title>吊销证书</title>
    <procedure>
      <step>
        <para>
          单击<guimenu>证书</guimenu>选项卡。
        </para>
      </step>
      <step>
        <para>
          右键单击您要吊销的证书，然后单击<guimenu>吊销</guimenu>。
        </para>
      </step>
      <step>
        <para>
          右键单击为您要吊销的证书签名的 CA 证书。单击 <guimenu>CA &gt; 生成 CRL</guimenu>。
        </para>
        <para>
          在<guimenu>创建 CRL</guimenu> 对话框中单击<guimenu>确定</guimenu>按钮。
        </para>
      </step>
      <step>
        <para>
          在主窗口中单击<guimenu>吊销列表</guimenu>选项卡。右键单击刚刚生成的 CRL 并选择<guimenu>导出</guimenu>。选择所需的格式 (DER)，然后单击<guimenu>确定</guimenu>。
        </para>
        <para>
          将导出的 CRL 复制到所颁发证书的 <guimenu>CRL 分发点</guimenu>中发布的位置。
        </para>
     </step>
   </procedure>
  </sect2>
 </sect1>
</chapter>
