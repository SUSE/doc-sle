<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec.zseries.prep">
 <title>インストールの準備</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  このセクションでは、インストールに使用するデータをアクセス可能にする方法、さまざまな手段による<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストール方法、および<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムのIPLを準備して使用する方法について説明します。また、ネットワーク設定とネットワークインストールについても説明します。
 </para>

 <sect2 xml:id="sec.prep.makeavail">
  <title>インストールデータを利用できるようにする</title>
  <para>
   このセクションでは、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のIBM z Systems向けインストールデータをインストール時にアクセス可能にする方法について詳しく説明します。コンピュータとシステム環境に応じて、NFSまたはFTPによるインストールを選択します。Microsoft Windowsワークステーションを実行している環境では、Windowsネットワーク(SMBプロトコルを含めて)を使用して、IBM z Systemsシステムに<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をインストールすることもできます。
  </para>
  <tip>
   <title>DVDからのIPL</title>
   <para>
    SUSE Linux Enterprise Server Version 10のService Pack 1以降は、DVDからのIPLが可能になり、DVDをインストールメディアとして使用できるようになっています。これは、ネットワークを介してインストールメディアを提供するインストールサーバを設定することに制約がある場合に、非常に便利です。前提条件はFCP接続SCSI DVDドライブです。
   </para>
  </tip>
  <note>
   <title><quote>ハードディスクから</quote>のインストールに非対応</title>
   <para>
    DVDのコンテンツをDASDのパーティションに格納することでハードディスクからインストールすることは不可能です。
   </para>
  </note>
  <sect3 xml:id="sec.prep.makeavail.linuxws">
   <title>Linuxワークステーションまたは<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVDの使用</title>
   <para>
    コンピュータ環境でLinuxワークステーションを実行している場合は、そのワークステーションを使用して、NFS経由またはFTP経由でインストールデータをIBM z Systemsインストールプロセスで使用できるようにします。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>でLinuxワークステーションを実行している場合は、<xref linkend="sec.deployment.instserver.sles9"/>の説明にあるようにYaSTの<guimenu>インストールサーバ</guimenu>モジュールを使用して、インストールサーバ(NFSまたはFTP)を設定できます。
   </para>
   <sect4 xml:id="sec.prep.makeavail.linuxws.nfs">
    <title>NFS経由</title>
    <para>
     NFS(ネットワークファイルシステム)を使用して、インストールメディアを使用できるようにします。
    </para>
    <important>
     <title>マウントされたデバイスのNFSを使用するエクスポート</title>
     <para>
      ファイルシステムのroot(<filename>/</filename>)をエクスポートしても、DVDなどのマウントされたデバイスのエクスポートが暗示指定されるわけではありません。次のように、<filename>/etc/exports</filename>でマウントポイントを明示的に指定します。
     </para>
<screen>/media/dvd  *(ro)</screen>
     <para>
      このファイルを変更した後、<command>sudo systemctl restart nfsserver</command>コマンドを使用してNFSサーバを再起動します。
     </para>
    </important>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.ftp">
    <title>FTP経由</title>
    <para>
     LinuxシステムでのFTPサーバの設定には、
     <package>pure-ftpd</package>
     または
     <package>vsftpdなどのサーバソフトウェア自体のインストールと、</package>
     その他の関連する設定作業が含まれます。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>を使用している場合は、インストール手順について<xref linkend="cha.ftp"/>を参照してください。匿名ログインを使用したインストールデータのダウンロードはサポートされていないため、ユーザ認証がサポートされるようにFTPサーバを設定する必要があります。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.oncd">
    <title>DVDに収録された<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
    <para>
     IBM z Systems対応の<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVD1には、Intelベースのワークステーション向けのブート可能なLinuxイメージおよびz Systems向けのイメージが収録されています。
    </para>
    <para>
     Intelベースのワークステーションの場合はこのDVDからブートし、使用する言語とキーボード配列に関する質問に答えて、<guimenu>レスキューシステムを開始する</guimenu>を選択します。この操作には64MB以上のRAMが必要です。レスキューシステム全体がワークステーションのRAMに常駐するため、ディスク領域は必要ありません。この方法では、ワークステーションのネットワークキングを手動で設定する必要があるため、Linuxとネットワーキングに関する経験が要求されます。
    </para>
    <para>
     z Systemsの場合は、<xref linkend="sec.prep.ipling.lpar.dvd"/>で説明しているとおり、このDVDからLPAR/VMゲストをIPL処理します。ネットワークパラメータを入力したら、インストールシステムはDVDをインストールデータのソースとして処理します。z Systemsでは、X11対応の端末を直接接続できないので、VNCによるインストールまたはSSHによるインストールを選択します。SSHはまた、<command>ssh -X</command>でX接続をSSHにトンネルさせることで、グラフィカルインストールを提供します。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.windowsws">
   <title>Microsoft Windowsワークステーションの使用</title>
   <para>
    ネットワーク内でMicrosoft Windowsワークステーションが使用可能な場合は、そのコンピュータを使用して、インストールメディアを使用できるようにします。その最も簡単な方法は、Windowsオペレーティングシステムにすでに含まれているSMBプロトコルを使用することです。必ず<guimenu>SMB over TCP/IP</guimenu>を有効にしてください。この機能によって、SMBパッケージをTCP/IPパッケージにカプセル化できるようになります。詳細については、Windowsオンラインヘルプ、またはネットワーキングを対象にしたその他のWindows関連マニュアルを参照してください。もう1つのオプションは、FTPを使用することです。この場合は、Windows用のサードパーティソフトウェアも必要です。
   </para>
   <sect4 xml:id="sec.prep.makeavail.windowsws.smb">
    <title>SMBを使用する</title>
    <para>
     SMBを使用してインストールメディアを使用可能にするには、WindowsワークステーションのDVDドライブに<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVD1を挿入します。次に、DVD-ROMドライブの文字を使用して新しい共有を作成し、ネットワーク内のどのユーザでも使用できるようにします。
    </para>

    <para>
     YaSTでのインストールパスは次のとおりです。
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     各プレースホルダは次のような意味です。
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable>
      </term>
      <listitem>
       <para>
        ワークグループまたはActive Directoryのドメイン(オプション)。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable>
      </term>
      <term><replaceable>PW</replaceable>
      </term>
      <listitem>
       <para>
        このサーバとその共有にアクセスできるユーザのオプションのユーザ名およびパスワード。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable>
      </term>
      <listitem>
       <para>
        共有をホストするサーバの名前。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable>
      </term>
      <listitem>
       <para>
        共有へのパス。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>


    <para/>

   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.nfs">
    <title>NFSを使用する</title>
    <para>
     Windowsワークステーション用にNFSサーバサービスを有効にするサードパーティ製品のマニュアルを参照してください。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVDが含まれているDVD-ROMドライブを、使用可能なNFSパスで指定する必要があります。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.ftp">
    <title>FTPを使用する</title>
    <para>
     Windowsワークステーション用にFTPサーバサービスを有効にするサードパーティ製品のマニュアルを参照してください。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVDが含まれているDVD-ROMドライブを、使用可能なFTPパスで指定する必要があります。
    </para>
    <para>
     Microsoft Windowsの一部のリリースにバンドルされているFTPサーバは、FTPコマンドセットのサブセットのみを実装するので、インストールデータの提供には適しません。この制約がWindowsワークステーションにも当てはまる場合は、必要な機能を提供するサードパーティのFTPサーバを使用します。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.scsi">
    <title>FCP接続SCSI DVDドライブの使用</title>
    <para>
     <xref linkend="sec.info.iplopt.dvd"/>の説明に従ってSCSI DVDからIPLすると、インストールシステムによってDVDがインストールメディアとして使用されます。この場合、FTP、NFS、またはSMBサーバにはインストールメディアは必要ありません。ただし、VNCまたはXによるグラフィカルインストールを実行するには、インストールの際にネットワークを設定する必要があるので、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のネットワーク設定データは必要です。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.zpxe_cobbler">
   <title>zPXE用のCobblerサーバの使用</title>
   <para>
    ネットワークからのIPLingでは、カーネル、initrd、インストールデータを提供するためのCobblerサーバが必要です。Cobblerサーバを準備するには、次の4つのステップを実行する必要があります。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      インストールデータのインポート
     </para>
    </listitem>
    <listitem>
     <para>
      配布の追加
     </para>
    </listitem>
    <listitem>
     <para>
      プロファイルの追加
     </para>
    </listitem>
    <listitem>
     <para>
      システムの追加
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.import">
    <title>インストールデータのインポート</title>
    <para>
     メディアをインポートするには、DVDまたはネットワークソースにあるインストールソースをCobblerサーバ上で使用できるようにする必要があります。次のコマンドを実行してデータをインポートします。
    </para>
<screen>cobbler import --path=<replaceable>PATH</replaceable><co xml:id="cobbler.import.path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.import.dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="cobbler.import.path">
      <para>
       インストールデータのマウントポイント。
      </para>
     </callout>
     <callout arearefs="cobbler.import.dirname">
      <para>
       インポートした製品を識別する文字列(例: <quote>sles12_s390x</quote>)。 この文字列は、インストールデータのコピー先のサブディレクトリとして使用されます。SUSE Linux Enterprise上で稼動しているCobblerサーバの場合は、この文字列として<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>を使用します。Cobblerが別のオペレーティングシステムで実行されている場合、これは別のパスになる可能性があります。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.add_distro">
    <title>配布の追加</title>
    <para>
     配布を追加することで、IPLに必要なカーネルとinitrdをzPXEを介して提供するよう、Cobblerに指示します。Cobblerサーバ上で次のコマンドを実行して、IBM z Systems対応の<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>を追加します。
    </para>
<screen>cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.identifier"/> \
  --os-version=sles12<co xml:id="cobbler.add.os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="cobbler.add.initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="cobbler.add.kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.server"/>
    </screen>
    <calloutlist>
     <callout arearefs="cobbler.add.identifier">
      <para>
       配布のカスタム識別子(<quote>SLES <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP2</phrase></phrase> z Systems</quote>など)。一意にする必要があります。
      </para>
     </callout>
     <callout arearefs="cobbler.add.os">
      <para>
       オペレーティングシステムの識別子。<literal>sles12</literal>を使用します。
      </para>
     </callout>
     <callout arearefs="cobbler.add.initrd">
      <para>
       initrdへのパス。パスの最初の部分(<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>)は、Cobblerによってデータがインポートされた場所と、インストールデータのインポート時に選択したサブディレクトリ名によって異なります。
      </para>
     </callout>
     <callout arearefs="cobbler.add.kernel">
      <para>
       カーネルへのパス。パスの最初の部分(<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>)は、Cobblerによってデータがインポートされた場所と、インストールデータのインポート時に選択したサブディレクトリ名によって異なります。
      </para>
     </callout>
     <callout arearefs="cobbler.add.server">
      <para>
       Cobblerサーバ上のインストールディレクトリへのURI。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.profile">
    <title>プロファイルの調整</title>
    <para>
     配布パッケージを追加するとき(<xref linkend="sec.prep.makeavail.zpxe_cobbler.add_distro"/>を参照)、対応する<replaceable>IDENTIFIER</replaceable>を持つプロファイルが自動的に生成されます。次のコマンドを使用して、必要な調整を行います。
    </para>
<screen>cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.profile.name"/> --os-version=sles10<co xml:id="cobbler.profile.os"/> --ksmeta=""<co xml:id="cobbler.profile.meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.profile.opts"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.profile.name">
      <para>
       プロファイルの識別子。配布パッケージを追加したときに指定した同じ文字列を使用します。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.os">
      <para>
       オペレーティングシステムのバージョン. プロファイルの適用先の配布。ここのインポートステップでは、<option>--name=<replaceable>IDENTIFIER</replaceable></option>で指定した文字列を使用する必要があります。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.meta">
      <para>
       キックスタートファイルのテンプレートに必要なオプション。SUSEでは使用しないため、例で指定したように空の値を設定します。
      </para>
     </callout>
     <callout arearefs="cobbler.profile.opts">
      <para>
       カーネルパラメータのスペース区切りのリスト。例に示すように、少なくとも<literal>install</literal>パラメータが含まれている必要があります。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.system">
    <title>システムの追加</title>
    <para>
     最後に必要なステップは、Cobblerサーバへのシステムの追加です。zPXEを介して起動するz Systemsゲストごとにシステムを追加する必要があります。ゲストは、z/VMのユーザIDによって識別されます(次の例では、<quote>linux01</quote>というIDが想定されています)。このIDの文字列は小文字でなければならないことに注意してください。システムを追加するには、次のコマンドを実行します。
    </para>
<screen>cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     <option>--kopts</option>オプションを使用して、通常はparmfile内で指定するカーネルとインストールパラメータを指定できます。パラメータは、<replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>という形式のスペース区切りリストで入力します。欠落しているパラメータがあれば、インストーラにプロンプトが表示されます。完全な自動インストールを実現するには、ネットワークやDASDに対するすべてのパラメータを指定し、AutoYaSTファイルを用意する必要があります。次に、上記と同じネットワークパラメータを使用してOSAインタフェースを装備したゲストの例を示します。
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.dvd_usb_hmc">
   <title>DVDまたはHMCのフラッシュディスクからのインストール</title>
   <para>
    IBM z Systemsサーバ上でSUSE Linux Enterprise Serverをインストールするには、通常、ネットワーク用のインストールソースが必要になります。ただし、一部の環境では、この要件を満たせないことがあります。SUSE Linux Enterprise Server 11 SP2では、LPAR上でのインストール用のインストールソースとして、既存のDVDやハードウェア管理コンソール(HMC)のフラッシュディスクを使用できます。
   </para>
   <para>
    DVDのメディアまたはHMCのフラッシュディスクからインストールするには、次の手順に従います。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      
     </para>
     <para>
      <option>install=hmc:/</option>
     </para>
     <para>
      を<filename>parmfile</filename>(<xref linkend="sec.appdendix.parm"/>を参照)またはカーネルオプションに追加します。
     </para>
     <para/>
    </listitem>
    <listitem>
     <para>
      または、手動モードで、<filename>linuxrc</filename>の次の項目を選択します。
     </para>
     <para>
      ［Start Installation (インストールの開始)］<emphasis role="italic"/>、
     </para>
     <para>
      ［インストール］<emphasis role="italic"/>、
     </para>
     <para>
      ［Hardware Management Console (ハードウェア管理コンソール)］<emphasis role="italic"/>。
     </para>
     <para>
      インストールメディアは、HMCに挿入する必要があります。
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>ネットワークの設定</title>
    <para>
     インストールを開始する前に、<filename>linuxrc</filename>で必ずネットワークを設定してください。後でブートパラメータを渡す手段がないにもかかわらず、ネットワークアクセスが必要になる可能性が高いからです。<filename>linuxrc</filename>で、［Start Installation (インストールの開始)］<emphasis role="italic"/>をクリックし、［ネットワーク設定］<emphasis role="italic"/>を選択します。
    </para>
   </important>
   <important>
    <title>Linuxシステムを最初にブートする必要性</title>
    <para>
     Linuxシステムがブートするのを待ってから、DVDまたはHMCのフラッシュディスクのメディアへのアクセスを許可するようにしてください。IPL処理を行うと、HMCとLPARとの間の接続に支障が生じる可能性があります。すでに説明した方法を最初に試行して失敗した場合は、アクセス権を付与して<option>HMC</option>オプションで再試行できます。
    </para>
   </important>
   <note>
    <title>Installation Repository</title>
    <para>
     アクセス権の割り当ては一時的なものであるため、DVDやフラッシュディスクファイルをインストール用のリポジトリとして使用し続けることはできません。インストールリポジトリが必要な場合は、オンラインリポジトリを登録して使用してください。
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.inst_types">
  <title>インストールタイプ</title>
  <para>
   このセクションでは、それぞれのインストールモードで<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をインストールする際に必要な手順および適切な情報の入手方法について説明します。これまでに説明した準備を完了したうえで、目的のインストールモードでのインストールの概要を確認し、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をシステムにインストールします。
  </para>
  <para>
   <xref linkend="sec.prep.makeavail"/>で説明したように、Linux on IBM z Systemsのインストールモードには、次の3種類があります。
  </para>
  <itemizedlist>
   <listitem>
    <para>
     LPARによるインストール
    </para>
   </listitem>
   <listitem>
    <para>
     z/VMのインストール
    </para>
   </listitem>
   <listitem>
    <para>
     KVMゲストのインストール
    </para>
   </listitem>
  </itemizedlist>
  <procedure xml:id="pro.prep.inst_types.lpar">
   <title>LPARインストールの概要</title>
   <step>
    <para>
     インストールに必要なデバイスを準備します。<xref linkend="sec.prep.prep_ipl.natlpar"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールシステムをIPL処理します。<xref linkend="sec.prep.ipling.lpar"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     ネットワークを設定します。<xref linkend="sec.prep.netcfg"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムに接続します。詳細については、<xref linkend="sec.prep.connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。詳細については、<xref linkend="cha.inst"/>を参照してください。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.vm">
   <title>z/VMインストールの概要</title>
   <step>
    <para>
     インストールに必要なデバイスを準備します。<xref linkend="sec.prep.prep_ipl.vm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールシステムをIPL処理します。<xref linkend="sec.prep.ipling.vm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     ネットワークを設定します。<xref linkend="sec.prep.netcfg"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムに接続します。詳細については、<xref linkend="sec.prep.connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。詳細については、<xref linkend="cha.inst"/>を参照してください。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.kvm">
   <title>KVMゲストのインストールの概要</title>
   <step>
    <para>
     仮想ディスクイメージを作成し、ドメインXMLファイルを作成します。詳細については、<xref linkend="sec.prep.prep_ipl.kvm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     インストールターゲットを準備し、VMゲストのIPL処理を実行します。詳細については、<xref linkend="sec.prep.ipling.kvm"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec.prep.netcfg.data"/>。
    </para>
   </step>
   <step>
    <para>
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムに接続します。詳細については、<xref linkend="sec.prep.connect"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     YaSTを使用してインストールを開始し、インストールしたシステムをIPL処理します。詳細については、<xref linkend="cha.inst"/>を参照してください。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.prep.prep_ipl">
  <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムのIPLの準備</title>
  <para/>
  <sect3 xml:id="sec.prep.prep_ipl.natlpar">
   <title>LPARインストールのIPLの準備</title>
   <para>
    適切な有効化プロファイルとIOCDSを使用して、ESA/S390モードまたはLinux専用モードで起動するようにIBM z Systemsを設定します。この方法の詳細については、IBMのマニュアルを参照してください。<xref linkend="sec.prep.ipling.lpar"/>に従って手順を進めます。
   </para>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.vm">
   <title>z/VMインストールのIPLの準備</title>
   <para/>
   <sect4 xml:id="sec.prep.prep_ipl.vm.linux_guest">
    <title>Linuxゲストの追加</title>
    <para>
     最初の手順として、z/VM環境のLinuxゲストによって使用されるシステム内の1つ以上のDASDを接続してフォーマットします。次に、z/VMでの新しいユーザを作成します。この例は、パスワード<literal>LINPWD</literal>を使用するユーザ<literal>LINUX1</literal>のディレクトリ、1GBのメモリ(2GBまで拡張可能)、32MBの拡張RAM(XSTORE)、複数のミニディスク(MDISK)、2つのCPU、およびOSA QDIOデバイスを示しています。
    </para>
    <tip>
     <title>z/VMゲストへのメモリの割り当て</title>
     <para>
      メモリをz/VMゲストに割り当てるときは、メモリサイズが、優先的に選択するインストールタイプのニーズに適していることを確認します。詳細については、<xref linkend="sec.info_sysreq.sysreq.hw.mem"/>を参照してください。メモリサイズを1GBに設定するには、<command>CP DEFINE STORAGE 1G</command>コマンドを使用します。インストールが完了したら、メモリサイズを必要な値に戻します。
     </para>
    </tip>
    <example xml:id="ex.prep.prep_ipl.vm.linux_guest.config">
     <title>z/VMディレクトリの設定</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     この例では、ミニディスク201を、ゲストのホームディスクとして使用します。200のシリンダを持つミニディスク150は、Linux swapデバイスです。また、2800のシリンダを持つディスク151は、Linuxインストールデータを保持するメディアです。
    </para>
    <para>
     ここで、<command>DIRM FOR LINUX1 ADD</command>を使用して、(<systemitem class="username">MAINT</systemitem>ユーザとして)ゲストをユーザディレクトリに追加します。ゲストの名前(<literal>LINUX1</literal>)を入力して、<keycap>F5</keycap>キーを押します。次のように、ユーザの環境を設定します。
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     最後のコマンドは、リーダファイル番号を返します。次に示すように、この番号は、次のコマンドを実行するのに必要です。
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     ユーザ <systemitem class="username">LINUX1 </systemitem>として、ゲスト上でログインできるようになります。
    </para>
    <para>
     <literal>dirmaint</literal>オプションが使用できない場合は、IBMのドキュメントを参照してこのユーザを設定してください。
    </para>
    <para>
     に従って手順を進めます。<xref linkend="sec.prep.ipling.vm"/>
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.kvm">
   <title>KVMゲストインストールのIPLの準備</title>
   <para>
    KVMゲストインストールの前提条件として、仮想マシンを定義するドメインXMLファイルと、インストールに使用される最低1つの仮想ディスクイメージを用意しておく必要があります。
   </para>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.disk">
    <title>仮想ディスクイメージの作成</title>
    <para>
     デフォルトでは、libvirtはVMホストサーバ上の<filename>/var/lib/libvirt/images/</filename>でディスクイメージを検索します。イメージは、ファイルシステム上の他の任意の場所に保存することもできますが、管理を容易にするため、1つの場所にすべてのイメージを保存することをお勧めします。次の例では、<filename>/var/lib/libvirt/images/</filename>に10GBのqcow2イメージを作成します。詳細については、<xref linkend="cha.qemu.guest_inst.qemu-img"/>を参照してください。
    </para>
    <procedure>
     <step>
      <para>
       KVMホストサーバにログインします。
      </para>
     </step>
     <step>
      <para>
       次のコマンドを実行してイメージを作成します。
      </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.domain">
    <title>ドメインXMLファイルの作成</title>
    <para>
     ドメインXMLファイルは、VMゲストの定義に使用します。ドメインXMLファイルを作成するには、エディタで空白ファイル<filename>s12-1.xml</filename>を開き、次の例のようなファイルを作成します。
    </para>
    <example>
     <title>サンプルのドメインXMLファイル</title>
     <para>
      次の例では、単一のCPU、1GBのRAM、および前のセクション(<xref linkend="sec.prep.prep_ipl.kvm.disk"/>)で作成した仮想ディスクイメージを持ったVMゲストを作成します。仮想サーバが接続されているホストネットワークインタフェースは、<literal>bond0</literal>であると想定しています。使用するネットワークのセットアップと一致するようにソースデバイス要素を変更します。
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s12-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE Sles12&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s12-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s12-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s12lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.ipling">
  <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムのIPL処理</title>
  <para/>
  <sect3 xml:id="sec.prep.ipling.lpar">
   <title>LPARインストールでのIPL処理</title>
   <para>
    LPARに対して<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をIPL処理するにはさまざまな方法があります。推奨されているのは、SEまたはHMCの<guimenu>Load from CD-ROM or server</guimenu>機能を使用する方法です。
   </para>
   <sect4 xml:id="sec.prep.ipling.lpar.cdrom">
    <title>DVD-ROMからのIPL</title>
    <para>
     インストールするLPARをマークして、<guimenu>Load from CD-ROM or server</guimenu>を選択します。ファイルの場所を指定するフィールドを空白のままにするか、最初のCD ROMのルートディレクトリへのパスを入力して、［続行］を選択します。表示されるオプションのリストで、デフォルトの選択を指定します。ここで、<guimenu>Operating system messages</guimenu>によって、カーネルブートメッセージが表示されます。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.lpar.dvd">
    <title>FCP接続SCSI DVDからのIPL</title>
    <para>
     <guimenu>SCSI</guimenu>を<guimenu>Load type</guimenu>として選択し、<guimenu>LOAD</guimenu>手順を使用して、SCSIからのIPLを実行できます。SCSIブリッジまたはSCSIストレージで指定されているWWPN (Worldwide port name)とLUN (Logical unit number)を入力します。これは16桁の数字ですが、末尾のゼロを省略しないようにします。ブートプログラムセレクタは2にする必要があります。FCPアダプタを<guimenu>Load address</guimenu>として使用し、IPLを実行します。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.vm">
   <title>z/VMインストールでのIPL処理</title>
   <para>
    このセクションでは、z/VMシステムにIBM z Systems対応の<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をインストールするようにインストールシステムをIPL処理する方法について説明します。
   </para>
   <sect4 xml:id="sec.prep.ipling.vm.reader">
    <title>z/VMリーダからのIPL</title>
    <para>
     FTPを介してインストールシステムを転送するには、新規に定義されたz/VMゲスト内では、有効なTCP/IP接続とFTPクライアントプログラムが必要です。z/VM用のTCP/IPの設定は、このマニュアルの範囲を超えています。適切なIBMマニュアルを参照してください。
    </para>
    <para>
     z/VM Linuxゲストとしてログインし、IPLを実行します。IBM z Systems対応の<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のDVD 1にある<filename>/boot/s390x</filename>ディレクトリの内容を、ネットワークのFTPで使用できるようにします。このディレクトリから、<filename>linux</filename>、<filename>initrd</filename>、<filename>parmfile</filename>、および<filename>sles12.exec</filename>の各ファイルを取得します。80文字の固定ブロックサイズでファイルを転送します。サイズを指定するには、FTPコマンド <command>locsite fix 80 </command>を使用します。<filename>linux</filename> (Linuxカーネル)と<filename>initrd</filename> (インストールイメージ)はバイナリファイルとしてコピーする必要があるので、<literal>バイナリ</literal>転送モードを使用します。<filename>parmfile</filename>と<filename>sles12.exec</filename>はASCIIモードで転送する必要があります。
    </para>
    <para>
     この例は、必要な手順を示しています。この例では、IPアドレス<literal>192.168.0.3</literal>を指定して、FTPサーバから、必要なファイルにアクセスできます。ログインは<systemitem class="username">lininst</systemitem>です。実際のネットワークでは異なる場合があります。
    </para>
    <example xml:id="ex.prep.ipling.vm.reader.ftp.ftptrans">
     <title>FTP経由のバイナリ転送</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles12.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles12.exec sles12.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles12.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     ダウンロードしたREXXスクリプトsles12.execを使用して、LinuxインストールシステムのIPLを実行します。このスクリプトは、次のように、カーネル、parmfile、およびRAMディスクを、IPL用のリーダにロードします。
    </para>
    <example xml:id="sex.prep.ipling.vm.reader.startscript.slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     このスクリプトでは、<command>sles12</command>コマンドを使用して、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムのIPLを実行できます。Linuxカーネルが起動し、そのブートメッセージが表示されます。
    </para>
    <para>
     インストールを続行するには、<xref linkend="sec.prep.netcfg"/>の説明に従います。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.dvd">
    <title>FCP接続SCSI DVDからのIPL</title>
    <para>
     z/VMでIPLを実行するには、次のように、 SET LOADDEV パラメータを使用して、SCSI IPLプロセスを準備します。
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     たとえば、適切な値でLOADDEVパラメータを設定したら、FCPアダプタのIPLを実行します。
    </para>
<screen>IPL FC00</screen>
    <para>
     インストールを続行するには、 <xref linkend="sec.prep.netcfg"/>に従って処理を行います。
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.zpxe">
    <title>zPXEによるCobblerサーバからのIPL</title>
    <para>
     zPXEによってCobblerサーバからIPLを実行するには、Cobblerサーバからz/VMゲストに対して、FTP経由で<filename>zpxe.rexx</filename>スクリプトを転送する必要があります。z/VMゲストでは、TCP/IP接続とFTPクライアントプログラムが機能している必要があります。
    </para>
    <para>
     z/VM LinuxゲストとしてIPLにログインし、ASCIIモードの80文字の固定サイズでスクリプトを転送します(例は、<xref linkend="ex.prep.ipling.vm.reader.ftp.ftptrans"/>を参照)。<filename>zpxe.rexx</filename>スクリプトは、Cobblerサーバ上の<filename>/usr/share/doc/packages/s390-tools/</filename>にあります。
    </para>
    <para>
     ご使用のゲストの<filename>PROFILE EXEC</filename>が<filename>zpxe.rexx</filename>に置き換わることになります。既存の<filename>PROFILE EXEC</filename>のバックアップコピーを作成し、<filename>ZPXE REXX</filename>から<filename>PROFILE EXEC</filename>に名前を変更します。または、<filename>'ZPXE REXX'</filename>というコンテンツを含む新しい行を使用して、既存の<filename>PROFILE EXEC</filename>から<literal>ZPXE REXX</literal>を呼び出します。
    </para>
    <para>
     最後のステップでは、設定ファイル<filename>ZPXE CONF</filename>を作成し、そこで接続先のCobblerサーバとIPLの実行対象とするディスクを<filename>ZPXE REXX</filename>に対して指定します。<command>xedit zpxe conf a</command>を実行して、次のコンテンツで<filename>ZPXE CONF</filename>を作成します(それに応じて例のデータを置き換えます)。
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     次にz/VMゲストにログインすると、Cobblerサーバに接続します。Cobblerサーバ上でインストールがスケジュールされている場合は、それが実行されます。インストールをスケジュールするには、Cobblerサーバで次のコマンドを実行します。
    </para>
<screen>cobbler system edit --name <replaceable>ID</replaceable><co xml:id="cobbler.sysedit.id"/> --netboot-enabled 1<co xml:id="cobbler.sysedit.netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="cobbler.sysedit.profile"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.sysedit.id">
      <para>
       z/VMのユーザID。
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.netboot">
      <para>
       ネットワークからのIPLingを有効にします。
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.profile">
      <para>
       既存のプロファイルの名前(<xref linkend="sec.prep.makeavail.zpxe_cobbler.profile"/>を参照)。
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.kvm">
   <title>KVMゲストインストールでのIPL処理</title>
   <para>
    ゲストインストールを開始するには、まず<xref linkend="sec.prep.prep_ipl.kvm.disk"/>で定義されているVMゲストを起動する必要があります。そのための前提条件として、最初に、IPL処理で必要とされるカーネルとinitrdを使用できるようにします。
   </para>
   <sect4 xml:id="sec.prep.ipling.kvm.prep">
    <title>インストールソースの準備</title>
    <para>
     インストールシステムへのVMゲストのIPLを実行するには、インストールシステムのカーネルとinitrdをVMホストサーバにコピーする必要があります。
    </para>
    <procedure>
     <step>
      <para>
       KVMホストにログインし、インストールソースを提供するリモートホストやデバイスに接続できることを確認します。
      </para>
     </step>
     <step>
      <para>
       次の2つのファイルを、インストールソースから<filename>/var/lib/libvirt/images/</filename>にコピーします。リモートホストからデータが提供される場合は、<command>ftp</command>、<command>sftp</command>、または<command>scp</command>を使用してファイルを転送します。
      </para>
      <simplelist>
       <member><filename>/boot/s390x/initrd</filename> </member> <member><filename>/boot/s390x/cd.ikr</filename> </member>
      </simplelist>
     </step>
     <step>
      <para>
       KVMホスト上のファイルの名前を変更します。
      </para>
<screen>cd /var/lib/libvirt/images/
mv initrd s12-initrd.boot
 mv cd.ikr s12-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.kvm.">
    <title>VMゲストのIPLの実行</title>
    <para>
     VMゲストのIPLを実行するには、KVMホストにログインし、次のコマンドを実行します。
    </para>
<screen>virsh  create s12-1.xml --console</screen>
    <para>
     VMゲストの起動が完了したら、インストールシステムが起動し、次のメッセージが表示されます。
    </para>
<screen>Domain s12-1 started
Connected to domain s12-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     <guimenu>2) いいえ</guimenu>と答え、次のステップで<guimenu>インストール</guimenu>を選択します。<xref linkend="sec.prep.netcfg.data"/>の説明に従って、作業を行ってください。
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.netcfg">
  <title>ネットワーク設定</title>
  <para>
   カーネルがその起動ルーチンを完了するまで待機します。基本モードまたはLPARでインストールを行う場合は、HMCまたはSEの<guimenu>Operating System Messages</guimenu>を開きます。
  </para>
  <para>
   最初に、linuxrcのメインメニューで<guimenu>Start Installation </guimenu>を選択し、次に<guimenu>Start Installation or Update</guimenu>を選択してインストールプロセスを開始します。<guimenu>Network</guimenu>をインストールメディアとして選択し、インストールに使用するネットワークプロトコルの種類を選択します。<xref linkend="sec.prep.makeavail"/>には、さまざまなタイプのネットワーク接続でインストールデータを使用できるようにする方法が説明されています。現在は、<guimenu>FTP</guimenu>、<guimenu>HTTP</guimenu>、<guimenu>NFS</guimenu>、<guimenu>SMB/CIFS</guimenu>(Windowsファイル共有)がサポートされています。
  </para>
  <para>
   インストールデータを受け取る際に使用するネットワークデバイスとして、使用可能なデバイスのリストからOSAまたはHiperSocketsを選択します。このリストにはCTC、ESCON、またはIUCVデバイスも挙げられていることがありますが、これらは<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>ではサポート対象外となっています。
  </para>
  <sect3 xml:id="sec.prep.netcfg.hypersockets">
   <title>HiperSocketsインタフェースの設定</title>
   <para>
    ネットワークデバイスのリストからHipersocketデバイスを選択します。続いて、次のように読み取りチャネル、書き込みチャネル、およびデータチャネルの各番号を入力します。
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.types">
    <title>サポートされているネットワーク接続の種類とドライバパラメータ</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.800]&gt; 0.0.800

Device address for write channel. (Enter '+++' to abort).
[0.0.801]&gt; 0.0.801

Device address for data channel. (Enter '+++' to abort).
[0.0.802]&gt; 0.0.802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.osa">
   <title>OSA Expressデバイスの設定</title>
   <para>
    ネットワークデバイスのリストからOSA Expressデバイスを選択し、ポート番号を指定します。続いて、読み取りチャネル、書き込みチャネル、およびデータチャネルの各番号を該当の有無に応じて入力します。OSIレイヤ2のサポートを有効にするかどうかを選択します。
   </para>
   <para>
    新しい2ポートのOSA Express 3ネットワークデバイスをサポートするポート番号が追加されます。OSA Express 3デバイスを使用しない場合は、「<literal>0</literal>」を入力します。OSA Expressカードにはまた、<quote>OSI layer 2 support</quote>モードで実行したり、もっと一般的な従来の<quote>layer 3</quote>モードを使用するオプションもあります。カードのモードは、他のLPAR上のシステムを含むデバイスを共有するすべてのシステムに影響します。不明な場合は、z/VMやz/OSなどの他のオペレーティングシステムで使用するデフォルトモードとの互換性を確保するために「<literal>2</literal>」を指定します。これらのオプションに関する詳細については、ハードウェア管理者にご相談ください。
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.gigabit.param">
    <title>ネットワークデバイスドライバのパラメータ</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.data">
   <title>ネットワークの設定とインストールソースの選択</title>
   <para>
    ネットワークデバイスのすべてのパラメータを入力すると、該当のドライバがインストールされ、対応するカーネルメッセージが表示されます。
   </para>
   <para>
    次に、ネットワークインタフェースパラメータの設定に、DHCP自動設定を使用するかどうかを決定すします。DHCPは、設定可能なデバイスが少なく、特殊なハードウェア設定が必要なため、ここでは、<guimenu>NO </guimenu>を選択する可能性が高くなります。このようにすると、以下の各ネットワークパラメータの入力を求められます。
   </para>
   <itemizedlist>
    <listitem>
     <para>
      インストールするシステムのIPアドレス
     </para>
    </listitem>
    <listitem>
     <para>
      対応するネットマスク(IPアドレスで指定していない場合に入力)
     </para>
    </listitem>
    <listitem>
     <para>
      サーバにアクセスするためのゲートウェイのIPアドレス
     </para>
    </listitem>
    <listitem>
     <para>
      ドメイン名サーバ(DNS)で扱う検索ドメインのリスト
     </para>
    </listitem>
    <listitem>
     <para>
      ドメイン名サーバのIPアドレス
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex.prep.netcfg.vm.network_setup">
    <title>ネットワークパラメータ</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    最後にインストールサーバの詳細情報の入力を求められます。この情報として、IPアドレス、インストールデータを格納しているディレクトリ、ログインアカウント情報などがあります。必要な情報をすべて入力すると、インストールシステムがロードされます。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.connect">
  <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムへの接続</title>
  <para>
   インストールシステムをロードしたlinuxrcでは、インストール手順の制御に使用するディスプレイの種類を指定する必要があります。可能な選択肢は、<literal>X11</literal> (X Window System)、<literal>VNC</literal> (Virtual Network Computingプロトコル)、<literal>SSH</literal> (テキストモード、またはSecure Shellを介したX11インストール)、または<literal>ASCII Console</literal>です。<literal>VNC</literal>または<literal>SSH</literal>の使用をお勧めします。
  </para>
  <para>
   <literal>ASCII Console</literal>を選択すると、YaSTがテキストモードで起動するので、端末で直接インストールを実行できます。YaSTをテキストモードで使用する方法については、<xref linkend="cha.yast.text"/>を参照してください。<literal>ASCII Console</literal>は、LPARにインストールする場合にのみ役に立ちます。
  </para>
  <note>
   <title>ASCII Console用端末エミュレーション</title>
   <para>
    テキストモードでYaSTを操作できるようにするには、VT220/Linuxエミュレーションを備えた端末(<literal>ASCII console</literal>ともいいます)でYaSTを実行する必要があります。3270端末などでYaSTを使用することはできません。
   </para>
  </note>
  <sect3 xml:id="sec.inst.connect.vnc_inst">
   <title>VNCでのインストールの開始</title>
   <procedure>
    <step>
     <para>
      インストールオプション<literal>VNC</literal>を選択すると、VNCサーバが起動します。コンソールに表示される短いメッセージは、vncviewerとの接続にどのIPアドレスとディスプレイ番号が必要かを示します。または、Java対応ブラウザに移動して、インストールシステムに接続するためのURLが表示されます。
     </para>
    </step>
    <step>
     <para>
      クライアントシステム上のVNCクライアントアプリケーションを起動します。vncviewerまたはVNC JavaクライアントとJava対応Webブラウザを使用します。
     </para>
    </step>
    <step>
     <para>
      <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールシステムのIPアドレスとディスプレイ番号の入力を求められた場合は、これらの値を入力します。
     </para>
     <para>
      Java対応ブラウザを使用して接続する場合は、次の形式で、インストールシステムのIPアドレスと適切なポート番号が含まれているURLを入力します。
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      接続が確立された後、YaSTを使用して<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のインストールを開始します。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.x">
   <title>X Window Systemでのインストールの開始</title>
   <important>
    <title>X認証メカニズム</title>
    <para>
     X Window Systemを使用する直接インストールでは、ホスト名に基づくプリミティブな認証メカニズムに依存します。現在のバージョンの<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では、このメカニズムが無効になっています。SSHまたはVNCによるインストールが推奨されています。
    </para>
   </important>
   <procedure>
    <step>
     <para>
      Xサーバを使用してクライアント(インストールされるシステム)の接続が可能なことを確認します。<command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command>変数を<filename>/etc/sysconfig/displaymanager</filename>ファイル内で設定します。その後に、Xサーバを再起動し、コマンド <command>xhost &lt;client IP address &gt;</command>を使用して、サーバへのクライアントのバインドを行うことができるようにします。
     </para>
    </step>
    <step>
     <para>
      インストールシステムで入力するように指示されたら、Xサーバが稼働するコンピュータのIPアドレスを入力します。
     </para>
    </step>
    <step>
     <para>
      YaSTが起動されるまで待機してから、インストールを開始します。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.ssh">
   <title>SSHでのインストールの開始</title>
   <para>
    名前が<literal>earth</literal>であるインストールシステムにSSHを使用して接続するには、<command>ssh -X earth</command>を実行します。Microsoft Windows上で実行しているワークステーションでは、SSH、telnetクライアント、および<link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/>から入手できるターミナルエミュレータPuttyを使用します。<menuchoice><guimenu>接続</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu></menuchoice>の順に選択して、Puttyで<guimenu>Enable X11 forwarding (X11転送を有効にする)</guimenu>を設定します。別のオペレーティングシステムを使用する場合は、<command>ssh -X earth</command>を実行して、<systemitem>earth</systemitem>という名前のインストールシステムに接続します。ローカルXサーバが使用可能な場合は、SSHのX転送がサポートされます。使用可能でない場合は、YaSTによって、ncursesのテキストインタフェースが表示されます。
   </para>
   <para>
    ログインプロンプトが表示されます。「 <literal>root </literal>」と入力し、パスワードを使用してログインします。「<command>yast.ssh</command>」と入力してYaSTを起動します。その後、YaSTの指示に従ってインストール手順を実行します。
   </para>
   <para>
    <xref linkend="cha.inst"/>に記載されているインストール処理手順の詳細な説明に従って、処理を行います。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.boot_procedure">
  <title>IBM z Systemsでの<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>のブート手順</title>
  <para>
   SLES 10および11のブートプロセスは、以下に示したスキームに従っています。詳しくは、<link xlink:href="http://www.ibm.com/developerworks/linux/linux390/documentation_suse.html"/>の資料を参照してください。
  </para>
  <orderedlist>
   <listitem>
    <para>
     カーネルを指定します。
    </para>
   </listitem>
   <listitem>
    <para>
     指定されたカーネルのinitrdを入力または作成します。
    </para>
   </listitem>
   <listitem>
    <para>
     initrdとカーネルの正しいパスを<filename>/etc/zipl.conf</filename>に指定します。
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>/etc/zipl.conf</filename>に指定された設定をシステムにインストールします。
    </para>
   </listitem>
  </orderedlist>
  <para>
   SLES 12では、IBM z Systemsで<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>をブートする方法が変わりました。この変更にはいくつかの理由があります。
  </para>
  <itemizedlist>
   <listitem>
    <para>
     他のアーキテクチャとの整合性: 管理者の観点から、SLESシステムの動作はすべてのアーキテクチャで同一であるべきです。
    </para>
   </listitem>
   <listitem>
    <para>
     Btrfs: ziplブートローダは、SLESの新しいデフォルトのルートファイルシステム、Btrfsと技術的に互換性がありません(<xref linkend="sec.filesystems.major.btrfs"/>を参照)。
    </para>
   </listitem>
   <listitem>
    <para>
     Snapperによるシステムロールバックのサポート:  Snapperは、Btrfsと組み合わせて使用することで、システムロールバックに使用可能な、ブート可能システムスナップショットを提供します(<xref linkend="cha.snapper"/>を参照)。
    </para>
   </listitem>
  </itemizedlist>
  <para>
   このような理由から、SLES 12以降、z Systems<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for z Systemsでは、ziplがGRUB 2に置き代わりました。AMD64/Intel 64アーキテクチャのGRUB 2では、ファイルシステムにアクセスするために、ファームウェアレベルのデバイスドライバが用意されています。メインフレームにはファームウェアがないため、GRUB 2への<literal>ccw</literal>の追加は、大変な作業であり、GRUB 2にziplを再実装することになります。そのため、<phrase role="productname"><phrase os="sles">SUSE Linux Enter rise Server</phrase></phrase>は、2段階のアプローチを使用します。
  </para>
  <variablelist>
   <varlistentry>
    <term>第1段階:</term>
    <listitem>
     <para>
      カーネルとinitrdを含む別のパーティションが<filename>/boot/zipl</filename>(UEFIプラットフォームにおける <filename>/boot/efi</filename>のようなもの)にマウントされます。このカーネルとinitrdは、<filename>/boot/zipl/config</filename>の設定を使用して、ziplを介してロードされます。
     </para>
     <para>
      この設定は、<literal>initgrub</literal>というキーワードをカーネルコマンドラインに追加します。カーネルとinitrdがロードされたら、initrdは、ルートファイルシステムをマウントするために必要なデバイスを有効化します(<filename>/boot/zipl/active_devices.txt</filename>を参照)。その後、GRUB 2ユーザ領域プログラムが開始され、<filename>/boot/grub2/grub.cfg</filename>を読み込みます。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>第2段階:</term>
    <listitem>
     <para>
      <filename>/boot/grub2/grub.cfg</filename>に指定されたカーネルとinitrdは、<command>kexec</command>を使用して始動されます。<filename>/boot/zipl/active_devices.txt</filename>にリストされたすべてのデバイスがアクティブになり、ルートファイルシステムがマウントされます。ブートの手順が他のアーキテクチャと同じように進みます。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>
</sect1>
