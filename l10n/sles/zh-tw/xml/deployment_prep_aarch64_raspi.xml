<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_aarch64_raspi.xml" version="5.0" xml:id="sec-aarch64-deprpi">
 <title>Raspberry Pi</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>是</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  SUSE® Linux Enterprise Server 是支援價格低廉型 Raspberry Pi* 單板電腦的第一款企業 Linux 套裝作業系統。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP3</phrase></phrase> 支援以下型號：
 </para>
 <itemizedlist>
  <listitem>
   <para>
    Raspberry Pi 3 Model A+
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 3 Model B
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 3 Model B+
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi 4 Model B
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi Compute Module 3
   </para>
  </listitem>
  <listitem>
   <para>
    Raspberry Pi Compute Module 3+
   </para>
  </listitem>
 </itemizedlist>

 <para>
  Raspberry Pi 與其他傳統伺服器機器在許多方面有所不同。首先且最重要的是，它不附帶可用於載入作業系統的開機載入程式。為了彌補這項差距，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 隨附了額外的開機載入程式軟體。
 </para>

 <sect2 xml:id="sec-aarch64-deprpi-boot">
  <title>開機程序</title>
  <para>
   Raspberry Pi 系統單晶片 (SoC) 上的主要處理器是 Broadcom VideoCore 圖形處理器 (GPU)，而不是 Arm 中央處理器 (CPU)。該 GPU 從晶片上開機唯讀記憶體 (開機 ROM) 中的第一階段開機載入程式開始啟始化硬體。只有一部分組態選項可能會影響開機 ROM；請參閱<xref linkend="sec-aarch64-deprpi-otp"/>。
  </para>
  <para>
   Raspberry Pi 3 硬體不包含任何內建韌體。機器每次開機時，都會從開機媒體載入 Raspberry Pi 3 的第二階段開機載入程式韌體 <literal>bootcode.bin</literal>。而該韌體又會載入第三階段開機載入程式 <literal>start.elf</literal>。
  </para>
  <para>
   Raspberry Pi 4 硬體為第二階段開機載入程式包含了一個小型的電子抹除式可程式化唯讀記憶體 (EEPROM)。除此之外，它的開機順序也與 Raspberry Pi 3 相似，會從開機媒體載入第三階段開機載入程式 <literal>start4.elf</literal>。
  </para>
  <warning>
   <title>Raspberry Pi 4 上的 EEPROM 更新</title>
   <para>
    可以透過從專門準備的 microSD 記憶卡開機，來執行第二階段開機載入程式的更新。
   </para>
   <para>
    請僅插入您信任的開機媒體，並確認未意外出現名為 <literal>recovery.bin</literal> 的檔案。
   </para>
  </warning>
  <para>
   如果 <literal>armstub8.bin</literal> 檔案存在，則會在 AArch64 例外層級 3 (EL3) 將此檔案載入為第四階段開機載入程式。否則，將使用精簡的整合式虛設常式。
  </para>
  <note>
   <title>EL3 安全性注意事項</title>
   <para>
    為 EL3 (通常稱做 BL31) 載入的代碼常駐在記憶體中，Linux 在整個執行時期都可以嘗試對 EL3 進行超級呼叫。
   </para>
   <para>
    請確認您的開機媒體中未意外地包含 <literal>armstub8.bin</literal> 檔案。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <phrase role="productnumber"><phrase os="sles;sled">15 SP3</phrase></phrase> 不包含此檔案。
   </para>
   <para>
    請注意，Raspberry Pi 的 SoC 不提供 TrustZone 安全記憶體。CPU 上的作業系統以及 GPU 上的任何軟體都可以存取 Raspberry Pi 的 RAM。因此，Raspberry Pi 不適合用於 EL0-s 加密應用程式。出於此原因，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 不提供 EL1-s 可信執行環境 (TEE)。
   </para>
  </note>
  <para>
   適用於 Raspberry Pi 的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 設定為載入稱做 <literal>Das U-Boot</literal> 的第五階段開機載入程式。
  </para>

  <sect3 xml:id="sec-aarch64-deprpi-configtxt">
   <title>Config.txt</title>
   <para>
    沒有任何非揮發性記憶體保存組態資訊。這意味著，不會在任何傳統設定中調整開機裝置順序、時間和日期等。
   </para>
   <para>
    而是由開機載入程式從開機媒體中讀取組態檔案 <literal>config.txt</literal>。不應修改 SUSE 提供的 <literal>config.txt</literal>。允許使用者選擇性地提供 <literal>extraconfig.txt</literal> 檔案，該檔案可視需要覆寫 <literal>config.txt</literal> 中的任何設定。如此，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 便可以視需要更新 <literal>config.txt</literal> 檔案，而不會覆寫任何使用者設定。
   </para>
  </sect3>

  <sect3 xml:id="sec-aarch64-deprpi-otp">
   <title>OTP 記憶體</title>
   <para>
    SoC 還提供極少量的一次性可程式化記憶體 (OTP 記憶體)。使用此記憶體可以指定某些設定，例如，開機 ROM 是要嘗試透過 USB 裝置還是乙太網路開機。
   </para>
   <para>
    Raspberry Pi Foundation 網站上已介紹此 OTP 記憶體：<link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/otpbits.md"/>
   </para>
   <warning>
    <title>僅可程式化一次</title>
    <para>
     寫入 OTP 記憶體中的組態設定無法保留。
    </para>
   </warning>
   <para>
    OTP 記憶體的最常見使用案例是在 Raspberry Pi 3 Model B 或 Compute Module 3 上啟用 USB 開機。
   </para>
  </sect3>

  <sect3>
   <title>為 Raspberry Pi 3 Model B 啟用 USB 開機模式</title>
   <para>
    若要永久允許從 Raspberry Pi 3 Model B 上連接的 USB 大量儲存裝置以及從其板載 USB 乙太網路進行開機，請根據<xref linkend="sec-aarch64-deprpi-img"/>中所述準備一張 microSD 記憶卡。在卸載或退出該記憶卡並從中開機之前，請使用以下設定，在其 FAT 分割區中新增一個文字檔 <literal>extraconfig.txt</literal> (<xref linkend="sec-aarch64-deprpi-configtxt"/>)：
   </para>
   <screen>program_usb_boot_mode=1</screen>
   <para>
    然後，像平時一樣繼續從修改後的 microSD 記憶卡開機。看到 U-Boot、GRUB 開機載入程式或 Linux 核心傳回的輸出後，可以依次取出電源和 microSD 卡。現在，您的裝置應該可以從 USB 開機 (<xref linkend="sec-aarch64-deprpi-usb"/>)。
   </para>
   <para>
    請注意，為 Raspberry Pi 3 Model B 啟用 USB 開機模式後，不再可以停用 USB 開機模式 (<xref linkend="sec-aarch64-deprpi-otp"/>)。
   </para>
   <para>
    如需更多詳細資料，請參閱 Raspberry Pi Foundation 網站：<link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/msd.md"/>
   </para>
   <para>
    對於 Raspberry Pi Compute Module 3，所需的設定相同，但修改後的影像的部署過程要略微複雜一些。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-rtc">
  <title>缺少即時時鐘</title>
  <para>
   Raspberry Pi 本身不提供電池後備的即時時鐘 (RTC)。
  </para>
  <note>
   <title>時間同步</title>
   <para>
    缺少即時時鐘意味著，需將 Raspberry Pi 裝置設定為透過網路時間通訊協定從網路伺服器擷取時間。
   </para>
  </note>
  <para>
   但是，Raspberry Pi Compute Module 的主機板可能帶有 RTC。
  </para>
  <para>
   此外，還可以使用 Hardware Attached on Top (頂層加裝硬體，HAT) 或其他延伸板，透過 GPIO 連接器來連接 RTC。
  </para>
  <para>
   無論使用哪種方式，都請檢查 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 是否支援相應的 RTC 晶片組。需要透過裝置樹疊加向作業系統描述連接的 RTC (<xref linkend="sec-aarch64-deprpi-configtxt"/>)。例如，MyPi 主機板可能使用：
  </para>
  <screen>dtparam=i2c1=on
dtoverlay=i2c-rtc,ds1307</screen>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-img">
  <title>部署裝置影像</title>
  <para>
   將作業系統部署到 Raspberry Pi 硬體的最常用方法是將預先安裝的系統影像複製到某個開機媒體 (通常是 microSD 記憶卡)。這是最簡易的方法。
  </para>
  <para>
   SUSE 為 Raspberry Pi 硬體提供預先設定的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 可開機影像。此影像附帶了 Btrfs 檔案系統，並啟用了壓縮，以提高效能並減輕 microSD 媒體的損耗。
  </para>
  <para>
   建議使用最少有 8 GB 空間的 microSD 記憶卡。記憶卡的速度越快，系統效能就越好。首次開機時，作業系統會自動擴充檔案系統，以填充該記憶卡。這意味著，首次開機的速度要比後續開機慢得多。
  </para>
  <para>
   《<link xlink:href="https://documentation.suse.com/sles-15/html/SLES-rpi-quick/art-rpiquick.html"><citetitle>Raspberry Pi Quick Start</citetitle></link>》(Raspberry Pi 快速入門) 中介紹了將記憶卡影像寫入 microSD 媒體的程序。
  </para>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-usb">
  <title>從 USB 媒體安裝</title>
  <para>
   Raspberry Pi 的某些型號允許從 USB 大量儲存裝置開機。然後，您可以像在伺服器平台上那樣，在 Raspberry Pi 上部署 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。
  </para>
  <para>
   可以從抽取式 USB 媒體 (例如記憶棒) 安裝到機器內部插槽中的 microSD 記憶卡。或者，可以從一個抽取式 USB 媒體安裝到另一個 USB 媒體 (例如，透過 USB 連接的硬碟)。
  </para>
  <note>
   <title>USB 頻寬限制</title>
   <para>
    請注意，Raspberry Pi 3 上的乙太網路控制器連接到裝置的板載 USB 2.0 匯流排。
   </para>
   <para>
    因此，從透過 USB 連接的磁碟所執行的作業系統，必須共用 USB 2.0 控制器的總共 480 Mbps 頻寬。這會給系統效能造成限制，並可能會明顯影響網路效能。
   </para>
   <para>
    Raspberry Pi 4 不存在這種限制。
   </para>
  </note>
  <para>
   包含 BCM2837 B0 矽晶片 (銀晶片而非黑晶片) 的 Raspberry Pi 3 較新型號，包括 Raspberry Pi 3 Model B+ 和 Compute Module 3+，預設允許從透過 USB 連接的儲存裝置進行開機。
  </para>
  <para>
   在較舊型號，例如 Raspberry Pi 3 Model B 或 Compute Module 3 上，可以透過從專門準備的 microSD 記憶卡開機一次來實現 USB 開機。如需指示，請參閱<xref linkend="sec-aarch64-deprpi-otp"/>。
  </para>
 </sect2>

 <sect2 xml:id="sec-aarch64-deprpi-net">
  <title>從網路安裝</title>
  <para>
   由於硬體缺少板載韌體 (<xref linkend="sec-aarch64-deprpi-boot"/>)，使用 PXE 從網路將 Raspberry Pi 開機比在更傳統的電腦上開機要複雜一些。
  </para>
  <para>
   SUSE 最佳實務文件 <link xlink:href="https://documentation.suse.com/sbp/all/html/SBP-Multi-PXE-Install/index.html"><citetitle>How to Set Up a Multi-PXE Installation Server</citetitle></link> (如何設定多重 PXE 安裝伺服器) 介紹了為 x86 和 Arm 設定 PXE 開機伺服器的程序。
  </para>
  <para>
   Raspberry Pi Foundation 發佈了有關如何使用 PXE 從一個Raspberry Pi 將另一個 Raspberry Pi 開機的資訊：<link xlink:href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/net_tutorial.md"/>
  </para>
 </sect2>

 <sect2>
  <title>詳細資訊</title>
  <para>
   如需詳細資訊，請參閱以下資源：
  </para>
  <variablelist>
   <varlistentry>
    <term>
     SUSE Linux Enterprise Server 15 SP3 Release Notes (SUSE Linux Enterprise Server 15 SP3 版本說明)
    </term>
    <listitem>
     <para>
      如需硬體相容性，以及在 Raspberry Pi 硬體上執行時支援的選項和功能的詳細資訊，請參閱《SUSE Linux Enterprise Server Release Notes》(SUSE Linux Enterprise Server 15 SP2 版本說明) 的「<citetitle>Boot and Driver Enablement for Raspberry Pi</citetitle>」(為 Raspberry Pi 啟用開機和驅動程式) 一節：
     </para>
     <para>
      <link xlink:href="https://www.suse.com/releasenotes/aarch64/SUSE-SLES/15-SP3/#aarch64-rpi"/>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     <citetitle>Raspberry Pi Quick Start</citetitle> (Raspberry Pi 快速入門)
    </term>
    <listitem>
     <para>
      <link xlink:href="https://documentation.suse.com/sles-15/html/SLES-rpi-quick/art-rpiquick.html"/>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     openSUSE Hardware Compatibility List: Raspberry Pi 3 (openSUSE 硬體相容性清單：Raspberry Pi 3)
    </term>
    <listitem>
     <para>
      openSUSE 專案還提供了有關安裝和設定 Raspberry Pi 硬體的資訊。其中的許多資訊同樣適用於 SUSE Linux Enterprise。
     </para>
     <para>
      請參閱<link xlink:href="https://en.opensuse.org/HCL:Raspberry_Pi3"/>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
     Das U-Boot
    </term>
    <listitem>
     <para>
      可以在該專案的 GitHub 頁面 (<link xlink:href="https://github.com/u-boot/u-boot"/>) 找到有關 <literal>Das U-Boot</literal> 開機載入程式的詳細資訊。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>

</sect1>
