<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="lvm.xml" id="sec.yast2.system.lvm">
 <title>Configurazione di LVM</title><indexterm> <primary>YaST</primary><secondary>LVM</secondary></indexterm><indexterm><primary>LVM</primary><secondary>YaST</secondary></indexterm><indexterm><primary>Logical Volume Manager</primary><see>LVM</see></indexterm>

 <para>
  Questa sezione descrive brevemente i principi alla base di Logical Volume Manager (LVM) e le sue funzioni. Per informazioni su come configurare LVM con YaST, vedere <xref linkend="sec.yast2.system.lvm.yast"/>.
 </para>

 <warning>
  <title>backup dei dati</title>
  <para>
   L'uso di LVM può talvolta aumentare i rischi compresi quelli relativi all'eventuale perdita di dati. I rischi comprendono anche arresti delle applicazioni, interruzioni nell'alimentazione e comandi errati. Prima di implementare LVM o di riconfigurare i volumi, è sempre opportuno salvare i dati. Ricordarsi sempre di effettuare un backup prima di effettuare qualunque operazione.
  </para>
 </warning>

 <sect2 id="sec.yast2.system.lvm.explained">
  <title>Gestore dei volumi logici</title>
  <para>
   LVM consente di distribuire lo spazio su disco in modo flessibile su più file system. Questa applicazione è stata sviluppata per far fronte alla necessità di modificare la segmentazione del disco rigido solo dopo la partizione iniziale effettuata al momento dell'installazione. Poiché è difficile modificare le partizioni su un sistema in esecuzione, LVM offre un pool virtuale (gruppo di volumi o VG) di spazio di memoria che può essere usato per creare i volumi logici (LV) necessari. Il sistema operativo accede a questi volumi logici anziché alle partizioni fisiche. I gruppi di volumi possono occupare più dischi, quindi più dischi o parti di essi possono costituire un unico volume logico. LVM fornisce una sorta di immagine astratta dello spazio fisico su disco che consente di modificare la segmentazione in modo molto più semplice e veloce rispetto a una nuova suddivisione in partizioni fisiche. Per informazioni generali sulla creazione di partizioni fisiche, vedere <xref linkend="sec.IB.part.typen"/> e <xref linkend="sec.yast2.i_y2_part_expert"/>.
  </para>
  <figure id="fig.lvm.explained.schematic">
   <title>Differenze tra la suddivisione in partizioni e il gestore di volumi logici</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="lvm.svg" width="75%" format="SVG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="lvm.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   <xref linkend="fig.lvm.explained.schematic"/> confronta le partizioni fisiche (a sinistra) con la segmentazione LVM (a destra). Sul lato sinistro un disco è stato diviso in tre partizioni fisiche (PART), ciascuna con un punto di montaggio (MP) in modo che il sistema operativo possa accedervi. Sul lato destro due dischi sono stati divisi rispettivamente in due e tre partizioni. Sono stati definiti due gruppi di volumi LVM (VG 1 e VG 2). VG 1 contiene due partizioni del DISCO 1 e una partizione del DISCO 2. VG2 contiene le due restanti partizioni del DISCO 2. In LVM, le partizioni fisiche sono raggruppate in un gruppo di volumi chiamati volumi fisici (PV). All'interno dei gruppi dei volumi, sono stati definiti quattro volumi logici (da LV1 a LV4), che possono essere utilizzati dal sistema operativo tramite i punti di montaggio associati. Non è necessario che il bordo tra i diversi volumi logici sia allineato a un bordo di partizione. Vedere il bordo tra LV 1 e LV 2 nell'esempio.
  </para>
  <para>
   Funzioni di LVM:
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Consente di combinare più dischi rigidi o partizioni in un unico volume di grandi dimensioni.
    </para>
   </listitem>
   <listitem>
    <para>
     Se la configurazione lo consente, è possibile ingrandire un volume logico (come <filename>/usr</filename>) quando lo spazio libero su disco è esaurito.
    </para>
   </listitem>
   <listitem>
    <para>
     Con LVM è possibile aggiungere dischi rigidi o volumi logici a un sistema in esecuzione. Ciò richiede tuttavia l'uso di componenti hardware collegabili.
    </para>
   </listitem>
   <listitem>
    <para>
     È possibile attivare una "modalità di striping" che distribuisce il flusso di dati di un volume logico su più volumi fisici. Se questi volumi fisici risiedono su dischi diversi, le prestazioni in lettura e scrittura risultano migliorate, come con il RAID 0.
    </para>
   </listitem>
   <listitem>
    <para>
     La funzione di snapshot consente di effettuare backup coerenti (soprattutto per i server) mentre il sistema è in funzione.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Queste funzioni rendono LVM immediatamente utilizzabile anche per i PC per uso domestico o i server di piccole dimensioni utilizzati intensamente. LVM è particolarmente indicato per gli utenti con uno stock di dati in continua crescita (come i database, gli archivi di musica o le directory utente), perché consente di gestire file system di dimensioni maggiori rispetto al disco rigido fisico. Un altro vantaggio di LVM deriva dal fatto che consente di aggiungere un massimo di 256 volumi logici. Tuttavia, le modalità di utilizzo di LVM sono diverse da quelle delle normali partizioni. Per istruzioni e ulteriori informazioni sulla configurazione di LVM, vedere il documento LVM HOWTO ufficiale alla pagina Web <ulink url="http://tldp.org/HOWTO/LVM-HOWTO/"/>.
  </para>
  <para>
   Per i Kernel a partire dalla versione 2.6, è possibile usare la versione 2 di LVM, che è compatibile con tutte le versioni precedenti di LVM e consente di gestire i gruppi di volumi esistenti. Quando si creano nuovi gruppi di volumi è necessario specificare se utilizzare il nuovo formato oppure una versione compatibile con il formato precedente. LVM 2 non richiede patch del kernel specifiche. Sfrutta il mapper del dispositivo integrato nel kernel 2.6. Questo kernel supporta solo LVM versione 2. Pertanto, quando si parla di LVM, in questa sezione si fa riferimento sempre a LVM versione 2.
  </para>
  <sect3 id="sec.yast2.system.lvm.explained.thin">
   <title>Thin provisioning</title>
   <para>
    A partire dalla versione 3.4 del kernel, LVM supporta il thin provisioning. Un volume soggetto al thin provisioning ha una capacità virtuale e una capacità reale. La capacità <emphasis>virtuale</emphasis> è la capacità memorizzazione del volume disponibile in un host. La capacità <emphasis>reale</emphasis> è la capacità di memorizzazione allocata a una copia del volume da un pool di memorizzazione. In un volume completamente allocato, la capacità virtuale e quella reale sono uguali. In un volume soggetto a thin provisioning, tuttavia, la capacità virtuale può essere molto più grande di quella reale. Se la capacità reale di un volume soggetto a thin provisioning non è sufficiente per un'operazione di scrittura, il volume viene messo offline e viene registrato un errore.
   </para>
   <para>
    Per ulteriori informazioni generali, vedere <ulink url="http://wikibon.org/wiki/v/Thin_provisioning"/>.
   </para>
  </sect3>
 </sect2>

 <sect2 id="sec.yast2.system.lvm.yast">
  <title>Configurazione di LVM con YaST</title>
  <para>
   È possibile accedere alla configurazione LVM di YaST tramite la Modalità di partizionamento per esperti YaST (vedere <xref linkend="sec.yast2.i_y2_part_expert"/>) nella voce <guimenu>Gestione volume</guimenu> del riquadro <guimenu>Vista sistema</guimenu>. La Modalità di partizionamento per esperti consente di modificare e cancellare le partizioni esistenti, nonché di crearne di nuove da utilizzare con LVM. Il primo task consiste nella creazione di volumi fisici che forniscano spazio a un gruppo di volumi:
  </para>
  <procedure>
   <step performance="required">
    <para>
     Selezionare un disco rigido da <guimenu>Dischi rigidi</guimenu>
    </para>
   </step>
   <step performance="required">
    <para>
     Passare alla scheda <guimenu>Partizioni</guimenu>.
    </para>
   </step>
   <step performance="required">
    <para>
     Fare clic su <guimenu>Aggiungi</guimenu> e immettere la dimensione desiderata per il volume fisico sul disco.
    </para>
   </step>
   <step performance="required">
    <para>
     Utilizzare <guimenu>Non formattare la partizione</guimenu> e modificare il valore del <guimenu>File system ID</guimenu> in <guimenu>0x8E Linux LVM</guimenu>. Non montare questa partizione.
    </para>
   </step>
   <step performance="required">
    <para>
     Ripetere questa procedura finché non si sono definiti tutti i volumi fisici desiderati dei dischi disponibili.
    </para>
   </step>
  </procedure>
  <sect3 id="sec.yast2.system.lvm.yast.volume_groups">
   <title>Creazione di gruppi di volumi</title>
   <para>
    Se nel sistema non esistono ancora gruppi di volumi, è necessario aggiungerne uno (vedere <xref linkend="fig.lvm.yast.volgrp"/>). È possibile creare gruppi aggiuntivi facendo clic su <guimenu>Gestione volume</guimenu> nel riquadro <guimenu>Vista sistema</guimenu> e successivamente su <guimenu>Aggiungi gruppo di volumi</guimenu>. Generalmente è sufficiente un solo gruppo di volumi.
   </para>
   <procedure>
    <step performance="required">
     <para>
      Immettere un nome per il gruppo di volumi, ad esempio <literal>system</literal>.
     </para>
    </step>
    <step performance="required">
     <para>
      Selezionare le <guimenu>dimensioni dell'estensione fisica</guimenu> desiderate. Questo valore definisce la dimensione di un blocco fisico nel gruppo di volumi. Tutto lo spazio su disco del gruppo di volumi viene gestito utilizzando blocchi della dimensione specificata.
     </para>
    </step>
    <step performance="required">
     <para>
      Aggiungere i volumi fisici preparati al gruppo di volumi selezionando il dispositivo e facendo clic su <guimenu>Aggiungi</guimenu>. Per selezionare più dispositivi, tenere premuto il tasto <keycap function="control"/> durante la selezione.
     </para>
    </step>
    <step performance="required">
     <para>
      Selezionare <guimenu>Fine</guimenu> per rendere il gruppo di volumi disponibile per le operazioni di configurazione.
     </para>
    </step>
   </procedure>
   <figure id="fig.lvm.yast.volgrp">
    <title>Creazione di un gruppo di volumi</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm4.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm4.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Se sono stati definiti più gruppi di volumi e si desidera aggiungere o rimuovere volumi fisici, selezionare il gruppo di volumi nell'elenco <guimenu>Gestione volume</guimenu>, quindi fare clic su <guimenu>Ridimensiona</guimenu>. Nella seguente finestra, è possibile aggiungere o rimuovere volumi fisici al/dal gruppo di volumi.
   </para>
  </sect3>
  <sect3 id="sec.yast2.system.lvm.yast.logical_vol">
   <title>Configurazione dei volumi logici</title>
   <para>
    Una volta aggiunto il volume fisico al gruppo di volumi, definire il volume logico che il sistema operativo deve utilizzare nella finestra di dialogo successiva. Scegliere il gruppo di volumi corrente e passare alla scheda <guimenu>Volumi logici</guimenu>. <guimenu>Aggiungere</guimenu>, <guimenu>modificare</guimenu>, <guimenu>ridimensionare</guimenu> e <guimenu>cancellare</guimenu> i volumi logici in base alle esigenze fino a quando tutto lo spazio nel gruppo di volumi non si esaurisce. Assegnare almeno un volume logico a ciascun gruppo di volumi.
   </para>
   <figure id="fig.lvm.yast.mgmt">
    <title>Gestione dei volumi logici</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm6.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm6.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Fare clic su <guimenu>Aggiungi</guimenu> e procedere con le operazioni richieste nella finestra popup simile a una procedura guidata che viene visualizzata.
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      Immettere il nome del volume logico. Per una partizione da montare nel percorso <filename>/home</filename>, è possibile utilizzare un nome come <literal>HOME</literal>.
     </para>
    </listitem>
    <listitem>
     <para>
      Selezionare il tipo di volume logico tra <guimenu>Volume normale</guimenu>, <guimenu>Pool leggero</guimenu> o <guimenu>Volume leggero</guimenu>. È necessario creare prima un pool leggero che sia in grado di memorizzare singoli volumi leggeri.
     </para>
    </listitem>
    <listitem>
     <para>
      Selezionare la dimensione e il numero di stripe del volume logico. Se si dispone di un solo volume fisico, non risulta utile selezionare più stripe.
     </para>
     <tip>
      <para>
       Il grande vantaggio offerto da un thin provisioning è che la somma totale di tutti i volumi leggeri memorizzati in un pool leggero può superare le dimensioni del pool stesso.
      </para>
     </tip>
    </listitem>
    <listitem>
     <para>
      Scegliere il file system da utilizzare nel volume logico nonché il punto di montaggio.
     </para>
    </listitem>
   </orderedlist>
   <para>
    L'utilizzo delle stripe consente di distribuire il flusso di dati del volume logico tra più volumi fisici (striping). Lo striping di un volume può tuttavia essere eseguito solo su volumi fisici diversi, ciascuno dei quali fornisce almeno la quantità di spazio del volume. Il numero massimo di segmenti corrisponde a quello di volumi fisici. Il valore "1" indica "nessuno striping". Lo striping ha senso solo per volumi fisici presenti su dischi rigidi diversi, in caso contrario si avrebbe una riduzione delle prestazioni.
   </para>
   <warning>
    <title>striping</title>
    <para>
     A questo punto, YaST non è in grado di verificare la correttezza delle voci relative agli stripe. Quindi, gli eventuali errori saranno visibili solo successivamente, quando LVM viene implementato sul disco.
    </para>
   </warning>
   <para>
    Se si è già configurato LVM sul sistema, è possibile utilizzare anche i volumi logici esistenti. Prima di continuare, assegnare punti di montaggio appropriati a tali volumi logici. <guimenu>Fine</guimenu> consente di tornare alla Modalità di partizionamento per esperti YaST, per completare il lavoro.
   </para>
  </sect3>
 </sect2>


</sect1>
