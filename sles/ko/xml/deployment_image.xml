<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_image.xml" version="5.0" role="General" xml:id="cha-deployment-clone-image">
 <title>디스크 이미지 복제</title>
 <info>
  <abstract>
   <para>
    이 장에서는 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 설치를 위한 복제된 이미지 사용 방법을 설명합니다. 가상화된 환경에서 대부분 이를 사용합니다.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>예</dm:translation>
  </dm:docmanager>
 </info>
 <sect1 xml:id="sec-deployment-clone-image-overview">
  <title>개요</title>
  <para>
   <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>는 각 설치에 대한 고유한 구성을 정리하기 위한 스크립트를 제공합니다. <systemitem class="daemon">systemd</systemitem>의 도입으로 고유 시스템 식별자가 사용되며 다양한 위치와 파일에 설정됩니다. 따라서 복제는 시스템 이미지를 빌드하는 데 더 이상 권장되는 방식이 아닙니다. 이미지는 KIWI를 사용하여 생성할 수 있습니다. <link xlink:href="https://doc.opensuse.org/projects/kiwi/doc/"/> 항목을 참조하십시오.
  </para>
  <para>
   시스템의 디스크를 복제하려면 가상화 환경의 문서를 참조하십시오.
  </para>
 </sect1>
 <sect1 xml:id="sec-deployment-clone-image-clean">
  <title>고유 시스템 식별자 정리</title>
  <warning>
   <title>중요한 구성 손실</title>
   <para>
    다음 절차를 실행하면 중요한 시스템 구성 데이터가 영구적으로 삭제됩니다. 복제본의 소스 시스템을 프로덕션에 사용하는 경우 복제된 이미지에서 정리 스크립트를 실행하십시오.
   </para>
  </warning>
  <para>
   모든 고유 시스템 식별자를 정리하려면 디스크 이미지를 복제하기 전이나 후에 다음 절차를 실행하십시오. 복제본에서 실행하는 경우 이 절차를 각 복제본에서 실행해야 합니다. 따라서 프로덕션에서 사용하지 않고 새 복제본의 소스로만 제공되는 <literal>골든 이미지</literal>를 생성하는 것이 좋습니다. 골든 이미지는 이미 정리되어 있으며 복제본을 즉시 사용할 수 있습니다.
  </para>
  <para>
   <command>clone-master-clean-up</command> 명령은 예를 들어 다음 항목을 제거합니다.
  </para>
  <itemizedlist>
   <listitem>
    <para>스왑 파일</para>
   </listitem>
   <listitem>
    <para>Zypper 리포지토리</para>
   </listitem>
   <listitem>
    <para>SSH 호스트 및 클라이언트 키</para>
   </listitem>
   <listitem>
    <para>임시 디렉토리(예: <filename>/tmp/*</filename>)</para>
   </listitem>
   <listitem>
    <para>Postfix 데이터</para>
   </listitem>
   <listitem>
    <para>HANA 방화벽 스크립트</para>
   </listitem>
   <listitem>
    <para>systemd 저널</para>
   </listitem>
  </itemizedlist>
  <procedure>
   <step>
    <para>
     <command>zypper</command>를 사용하여 <package>clone-master-clean-up을 설치합니다</package>:
    </para>
    <screen><prompt>tux &gt; </prompt><command>sudo</command> <command>zypper</command> install clone-master-clean-up</screen>
   </step>
   <step>
    <para>
     <filename>/etc/sysconfig/clone-master-clean-up</filename>을 편집하여 <command>clone-master-clean-up</command>의 동작을 구성합니다. 이 구성 파일은 1000보다 큰 UID, <filename>/etc/sudoers</filename> 파일, Zypper 리포지토리 및 Btrfs 스냅샷이 있는 사용자를 제거해야 하는지 여부를 정의합니다.
    </para>
   </step>
   <step>
    <para>
     스크립트를 실행하여 기존 구성 및 고유 식별자를 제거합니다.
    </para>
    <screen><prompt>tux &gt; </prompt><command>sudo</command> <command>clone-master-clean-up</command></screen>
   </step>
  </procedure>
 </sect1>
</chapter>
