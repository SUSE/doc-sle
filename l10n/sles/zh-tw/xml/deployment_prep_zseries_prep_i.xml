<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec-zseries-prep">
 <title>安裝準備工作</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  本章介紹如何使安裝程式能夠存取資料、如何使用不同的方法安裝 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，以及如何準備和使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統的 IPL。本章還提供有關網路組態和網路安裝的資訊。
 </para>

 <sect2 xml:id="sec-prep-makeavail">
  <title>提供安裝資料</title>
  <para>
   本節詳細介紹如何提供安裝所需的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> IBM Z 安裝資料。請依據您的電腦和系統環境，選擇 NFS 或 FTP 安裝。如果您的環境中執行的是 Microsoft Windows 工作站，您可以使用包含 SMB 通訊協定的 Windows 網路，將 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝在 IBM Z 系統上。
  </para>
  <tip>
   <title>從 DVD 執行 IPL</title>
   <para>
    可以從 DVD 執行 IPL，並使用 DVD 做為安裝媒體。若您在設定透過網路提供安裝媒體的安裝伺服器方面有限制，使用此方法將會很方便。先決條件是要有連接 FCP 的 SCSI DVD 光碟機。
   </para>
  </tip>
  <note>
   <title>無法從硬碟安裝</title>
   <para>
    不能透過將 DVD 內容放入 DASD 上的分割區，來從硬碟執行安裝。
   </para>
  </note>
  <sect3 xml:id="sec-prep-makeavail-linuxws">
   <title>使用 Linux 工作站或 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> DVD</title>
   <para>
    可以在電腦環境中使用一個 Linux 工作站，以透過 NFS 或 FTP 將安裝資料提供給 IBM Z 安裝程序。<phrase os="sles">如果 Linux 工作站執行 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，您可以依<xref linkend="sec-deployment-instserver-sles9"/>中所述，使用 YaST <guimenu>安裝伺服器</guimenu>模組來設定安裝伺服器 (NFS 或 FTP)。</phrase>
   </para>
   <important>
    <title>透過 NFS 輸出掛接的裝置</title>
    <para>
     輸出檔案系統根目錄 (<filename>/</filename>) 不會自動輸出掛接的裝置 (例如 DVD)。因此，需要在 <filename>/etc/exports</filename> 中明確命名掛接點：
    </para>
<screen>/media/dvd  *(ro)</screen>
    <para>
     變更此檔案之後，使用指令 <command>sudo systemctl restart nfsserver</command> 重新啟動 NFS 伺服器。
    </para>
   </important>
   <para>
    若要在 Linux 系統上設定 FTP 伺服器，需要安裝並設定伺服器軟體，例如 <package>vsftpd</package>.<phrase os="sles">如果您使用的是 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，請參閱<xref linkend="cha-ftp"/>以瞭解安裝指示。</phrase>不支援透過匿名登入的方式下載安裝資料，因此您需要設定 FTP 伺服器，以便為使用者驗證提供支援。
   </para>
   <sect4 xml:id="sec-prep-makeavail-linuxws-oncd">
    <title>DVD 中的 <phrase role="productname"><phrase os="sles"></phrase></phrase>SUSE Linux Enterprise Server</title>
    <para>
     <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z 的第一個安裝媒體中包含用於 Intel 工作站的可開機 Linux 影像，以及 IBM Z 的影像。
    </para>
    <para>
     對於 Intel 工作站，請從此媒體開機。出現提示時，請選取所需的回答語言和鍵盤配置，然後選取<guimenu>啟動救援系統</guimenu>。您至少需要 64 MB RAM 才能執行這個作業。由於整個救援系統都位於工作站的 RAM 中，因此無需提供磁碟空間。此方法需要手動設定工作站的網路。
    </para>
    <para>
     對於 IBM Z，請依<xref linkend="sec-prep-ipling-lpar-dvd"/>所述從此媒體對 LPAR/VM 客體執行 IPL。輸入網路參數後，安裝系統會將該媒體視為安裝資料的來源。由於 IBM Z 無法直接連接具有 X11 功能的終端機，因此請選擇要執行 VNC 還是 SSH 安裝。SSH 也提供圖形安裝，方法是使用 <command>ssh -X</command> 打開 X 到 SSH 的通道。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-windowsws">
   <title>使用 Microsoft Windows 工作站</title>
   <para>
    可以使用網路中的 Microsoft Windows 工作站來使安裝媒體可用。為此，最簡單的方法是使用 SMB 通訊協定。請務必啟用 <guimenu>SMB over TCP/IP</guimenu>，這會將 SMB 套件封裝至 TCP/IP 套件。如需詳細資訊，請參閱 Windows 線上說明或其他討論網路的 Windows 相關文件。
   </para>
   <sect4 xml:id="sec-prep-makeavail-windowsws-smb">
    <title>使用 SMB</title>
    <para>
     若要使安裝媒體可以配合 SMB 使用，請將包含 SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso 的 USB 隨身碟插入 Windows 工作站的 USB 連接埠。然後使用 USB 隨身碟的代號建立新共用，並提供此共用給網路中的任何人。
    </para>
    
    <para>
     在 YaST 中，安裝路徑可能為：
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     其中預留位置表示：
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable></term>
      <listitem>
       <para>
        選擇性的工作群組或使用中的目錄網域。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable></term>
      <term><replaceable>PW</replaceable></term>
      <listitem>
       <para>
        可以存取此伺服器及其共享之使用者的選擇性使用者名稱及密碼。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable></term>
      <listitem>
       <para>
        代管共享之伺服器的名稱。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable></term>
      <listitem>
       <para>
        要共享的路徑。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para/>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-nfs">
    <title>使用 NFS</title>
    <para>
     請參閱啟用 Windows 工作站的 NFS 伺服器服務之協力廠商產品隨附的文件。包含 SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso 媒體的 USB 隨身碟必須位於可用的 NFS 路徑。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-ftp">
    <title>使用 FTP</title>
    <para>
     請參閱啟用 Windows 工作站的 FTP 伺服器服務之協力廠商產品隨附的文件。包含 SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso 媒體的 USB 隨身碟必須位於可用的 FTP 路徑。
    </para>
    <para>
     某些 Microsoft Windows 版本中綁定的 FTP 伺服器只會執行一部分 FTP 指令，因此不適用於提供安裝資料。在這種情況下，請使用能夠提供所需功能的協力廠商 FTP 伺服器。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-scsi">
    <title>使用透過 FCP 連接的 SCSI DVD 磁碟機</title>
    <para>
     依據<xref linkend="sec-prep-ipling-lpar-dvd"/> 中的說明從 SCSI DVD 執行 IPL 後，安裝系統會將 DVD 用做安裝媒體。在此情況下，FTP、NFS 或 SMB 伺服器上不需要安裝媒體。但需要 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的網路組態資料，因為在安裝期間必須設定網路以透過 VNC 或 X 執行圖形安裝。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-zpxe-cobbler">
   <title>針對 zPXE 使用 Cobbler 伺服器</title>
   <para>
    從網路進行 IPL 需要一個 Cobbler 伺服器，用以提供核心、initrd 與安裝資料。Cobbler 伺服器的準備工作包括以下步驟：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-import"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-system"/>
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-import">
    <title>輸入安裝資料</title>
    <para>
     若要輸入媒體，在 Cobbler 伺服器上必須可以使用安裝來源，不論該來源是 USB 隨身碟還是網路來源。執行下列指令輸入資料：
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler import --path=<replaceable>PATH</replaceable><co xml:id="co-cobbler-import-path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-import-dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="co-cobbler-import-path">
      <para>
       安裝資料的掛接點。
      </para>
     </callout>
     <callout arearefs="co-cobbler-import-dirname">
      <para>
       識別所匯入產品的字串，例如 <quote>sles15_s390x</quote>。此字串用做複製了安裝資料之子目錄的名稱。在執行於 SUSE Linux Enterprise 上的 Cobbler 伺服器中，該目錄為 <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>。如果 Cobbler 在其他作業系統上執行，則此路徑可能有所不同。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-add-distro">
    <title>新增套裝作業系統</title>
    <para>
     新增套裝作業系統可讓 Cobbler 透過 zPXE 提供所需的核心和 initrd 來執行 IPL。在 Cobbler 伺服器上執行下面的指令，可新增 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z：
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-identifier"/> \
  --os-version=<phrase os="sles;sled">sles15</phrase><co xml:id="co-cobbler-add-os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="co-cobbler-add-initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="co-cobbler-add-kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-server"/>
    </screen>    
    <calloutlist>
     <callout arearefs="co-cobbler-add-identifier">
      <para os="sles;sled;osuse">
       套裝作業系統的唯一識別碼，例如 <quote>SLES <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase> IBM Z</quote>。
      </para>
      
     </callout>
     <callout arearefs="co-cobbler-add-os">
      <para>
       作業系統識別碼。請使用 <literal>sles15</literal>。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-initrd">
      <para>
       initrd 的路徑。該路徑的第一部分 (<filename>/srv/www/cobbler/ks_mirror/<replaceable>識別碼</replaceable>/</filename>) 取決於輸入資料的位置，以及您在輸入安裝資料時選取的子目錄名稱。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-kernel">
      <para>
       核心的路徑。該路徑的第一部分 (<filename>/srv/www/cobbler/ks_mirror/<replaceable>識別碼</replaceable>/</filename>) 取決於輸入資料的位置，以及您在輸入安裝資料時選取的子目錄名稱。
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-server">
      <para>
       Cobbler 伺服器上安裝目錄的 URL。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-profile">
    <title>調整設定檔</title>
    <para>
     新增套裝作業系統 (請參閱<xref linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>) 會自動產生具有相應<replaceable>識別碼</replaceable>的設定檔。使用以下指令可以做出一些所需的調整：
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-profile-name"/> --os-version=sles10<co xml:id="co-cobbler-profile-os"/> --ksmeta=""<co xml:id="co-cobbler-profile-meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-profile-opts"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-profile-name">
      <para>
       設定檔的識別碼。使用新增套裝作業系統時指定的字串。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-os">
      <para>
       作業系統版本.應套用設定檔的套裝作業系統。使用輸入步驟中 <option>--name=<replaceable>識別碼</replaceable></option>所指定的字串。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-meta">
      <para>
       用於建立 Kickstart 檔案範本的選項。在 SUSE 中不使用此選項，因此請將其保留空白。
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-opts">
      <para>
       核心參數的空格分隔清單。它必須至少包含 <literal>install</literal> 參數。
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-system">
    <title>新增系統</title>
    <para>
     最後一步是將系統新增至 Cobbler 伺服器。必須針對應透過 zPXE 開機的每個 IBM Z 客體執行此步驟。客體按照其 z/VM 使用者 ID 來識別 (在以下範例中，ID 為 <quote>linux01</quote>)。請注意，該 ID 必須小寫。若要新增系統，請執行下列指令：
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     使用 <option>--kopts</option> 選項可以指定通常在 parmfile 中指定的核心和安裝參數。使用以下格式指定參數：<replaceable>PARAMETER1=VALUE1 PARAMETER2=VALUE2</replaceable>。安裝程式將提示您指定缺少的參數。若要進行完全自動化的安裝，您需要指定網路連接與 DASD 的所有參數，並提供 AutoYaST 檔案。下面是一個客體範例，該客體配有 OSA 介面，且使用上述相同的網路參數。
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-dvd-usb-hmc">
   <title>從 HMC 的 USB 隨身碟安裝</title>
   <para>
    在 IBM Z 伺服器上安裝 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 通常需要一個網路安裝來源。如果無法符合此要求，SUSE Linux Enterprise Server 允許您使用硬體管理主控台 (HMC) 的 USB 隨身碟作為安裝來源，在 LPAR 上完成安裝。
   </para>
   <para>
    若要從 HMC 的 USB 隨身碟執行安裝，請執行以下操作：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      將 <option>install=hmc:/</option> 新增至 <filename>parmfile</filename> (請參閱<xref linkend="sec-appdendix-parm"/>) 或核心選項。
     </para>
    </listitem>
    <listitem>
     <para>
      在使用 <filename>linuxrc</filename> 的手動模式安裝中，依次選擇<emphasis role="italic">開始安裝</emphasis>、<emphasis role="italic">安裝</emphasis>、<emphasis role="italic">硬體管理主控台</emphasis>。安裝媒體必須在 HMC 中。
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>設定網路</title>
    <para>
     開始安裝之前，請在 <filename>linuxrc</filename> 中指定網路組態。無法透過開機參數執行此操作，並且您很可能需要存取網路。在 <filename>linuxrc</filename> 中，移至<emphasis role="italic">啟動安裝</emphasis>，然後選擇<emphasis role="italic">網路設定</emphasis>。
    </para>
   </important>
   <important>
    <title>Linux 系統必須先開機</title>
    <para>
     請先等到 Linux 系統開機，再授予對 HMC 的 USB 隨身碟中媒體的存取權限。IPLing 可能會中斷 HMC 與 LPAR 之間的連接。如果首次嘗試使用所述的方法失敗，您可以授予存取權限並重新嘗試選項 <option>HMC</option>。
    </para>
   </important>
   <note>
    <title>安裝儲存庫</title>
    <para>
     USB 隨身碟不會做為安裝儲存庫保留，因為安裝是一次性的程序。如果您需要安裝儲存庫，請註冊並使用線上儲存庫。
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-inst-types">
  <title>安裝類型</title>
  <para>
   本節介紹每種安裝模式的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝步驟。完成前面章節所述的準備步驟後，請遵循所需安裝模式的綜覽。
  </para>
  <para>
   如<xref linkend="sec-prep-makeavail"/>中所述，IBM Z 上的 Linux 有三種不同的安裝模式：LPAR、z/VM 和 KVM 客體安裝。
  </para>
  <procedure xml:id="pro-prep-inst-types-lpar">
   <title>LPAR 安裝綜覽</title>
   <step>
    <para>
     準備安裝所需的裝置。請參閱<xref linkend="sec-prep-prep-ipl-natlpar"/>。
    </para>
   </step>
   <step>
    <para>
     對安裝系統執行 IPL。請參閱<xref linkend="sec-prep-ipling-lpar"/>。
    </para>
   </step>
   <step>
    <para>
     設定網路。請參閱<xref linkend="sec-prep-netcfg"/>。
    </para>
   </step>
   <step>
    <para>
     連接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統。請參閱<xref linkend="sec-prep-connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 啟動安裝，並對安裝好的系統執行 IPL。請參閱<xref linkend="cha-install"/>。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-vm">
   <title>z/VM 安裝綜覽</title>
   <step>
    <para>
     準備安裝所需的裝置。請參閱<xref linkend="sec-prep-prep-ipl-vm-linux-guest"/>。
    </para>
   </step>
   <step>
    <para>
     對安裝系統執行 IPL。請參閱<xref linkend="sec-prep-ipling-vm"/>。
    </para>
   </step>
   <step>
    <para>
     設定網路。請參閱<xref linkend="sec-prep-netcfg"/>。
    </para>
   </step>
   <step>
    <para>
     連接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統。請參閱<xref linkend="sec-prep-connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 啟動安裝，並對安裝好的系統執行 IPL。請參閱<xref linkend="cha-install"/>。
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-kvm">
   <title>KVM 客體安裝綜覽</title>
   <step>
    <para>
     建立虛擬磁碟影像並寫入網域 XML 檔案。請參閱<xref linkend="sec-prep-prep-ipl-kvm"/>。
    </para>
   </step>
   <step>
    <para>
     準備安裝目標並對 VM 客體執行 IPL。請參閱<xref linkend="sec-prep-ipling-kvm"/>。
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec-prep-netcfg-data"/>。
    </para>
   </step>
   <step>
    <para>
     連接到 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統。請參閱<xref linkend="sec-prep-connect"/>。
    </para>
   </step>
   <step>
    <para>
     使用 YaST 啟動安裝，並對安裝好的系統執行 IPL。請參閱<xref linkend="cha-install"/>。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-prep-prep-ipl">
  <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統的 IPL 準備工作</title>
  <para/>
  <sect3 xml:id="sec-prep-prep-ipl-natlpar">
   <title>LPAR 安裝的 IPL 準備工作</title>
   <para>
    透過適用的啟用設定檔和 IOCDS，將 IBM Z 系統設定為以 ESA/S390 模式或僅限 Linux 模式啟動。如需更多資訊，請參閱 IBM 文件。如<xref linkend="sec-prep-ipling-lpar"/>中所述繼續操作。
   </para>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-vm">
   <title>z/VM 安裝的 IPL 準備工作</title>
   <para/>
   <sect4 xml:id="sec-prep-prep-ipl-vm-linux-guest">
    <title>使用 dirMaint 新增 Linux 客體</title>
    <para>
     第一步是連接及格式化系統中的一或多個 DASD，以便用於 z/VM 中的 Linux 訪客。接著，在 z/VM 中建立新使用者。該範例顯示了 <literal>LINUX1</literal> 使用者 (密碼為 <literal>LINPWD</literal>) 的目錄、1 GB 記憶體 (最大可擴充至 2 GB)、數個迷你磁碟 (MDISK)、兩個 CPU 以及一個 OSA QDIO 裝置。
    </para>
    <tip>
     <title>指派記憶體給 z/VM 客體</title>
     <para>
      為 z/VM 客體指定記憶體時，請確定記憶體大小對於偏好的安裝類型足夠。<phrase os="sles">請參閱<xref linkend="sec-zseries-requirements-hw-mem"/>。</phrase>若要將記憶體大小設定為 1 GB，請使用 <command>CP DEFINE STORAGE 1G</command> 指令。完成安裝後，請將記憶體大小重設為所需值。
     </para>
    </tip>
    <example xml:id="ex-prep-prep-ipl-vm-linux-guest-config">
     <title>z/VM 目錄的組態</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     本範例使用迷你磁碟 201 做為訪客的主要磁碟。包含 200 個磁柱的迷你磁碟 150 是 Linux 交換裝置。Linux 安裝位於包含 2800 個磁柱的磁碟 151 中。
    </para>
    <para>
     以使用者 <systemitem class="username">MAINT</systemitem> 的身分，使用 <command>DIRM FOR LINUX1 ADD</command> 將客體新增至使用者目錄。輸入訪客名稱 (<literal>LINUX1</literal>) 並按 <keycap>F5</keycap>。設定使用者環境如下：
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     最後一個指令會傳回讀取器檔案號碼。下一個指令需要使用此號碼：
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     您現在可以使用者 <systemitem class="username">LINUX1</systemitem> 的訪客身分登入。
    </para>
    <para>
     如果 <literal>dirmaint</literal> 選項不可用，請參閱 IBM 文件瞭解如何設定此使用者。
    </para>
    <para>
     繼續執行<xref linkend="sec-prep-ipling-vm"/>。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-kvm">
   <title>KVM 客體安裝的 IPL 準備工作</title>
   <para>
    進行 KVM 客體安裝需要使用一個用於指定虛擬機器的網域 XML 檔案，以及至少一個用於安裝的虛擬磁碟影像。
   </para>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-disk">
    <title>建立虛擬磁碟影像</title>
    <para>
     依預設，libvirt 會搜尋 VM 主機伺服器上的 <filename>/var/lib/libvirt/images/</filename> 中的磁碟影像。雖然影像可以儲存在檔案系統上的任何位置，但建議您將所有影像都儲存在同一個位置，以方便維護。若要建立影像，請登入 KVM 主機伺服器並執行以下指令：
    </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
    <para>
     這會在 <filename>/var/lib/libvirt/images/</filename> 中建立一個大小為 10 GB 的 qcow2 影像。<phrase os="sles">如需詳細資訊，請參閱<xref linkend="cha-qemu-guest-inst-qemu-img"/>。</phrase>
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-domain">
    <title>編寫網域 XML 檔案</title>
    <para>
     網域 XML 檔案用於定義 VM 客體。若要建立網域 XML 檔案，請使用編輯器開啟空白檔案 <filename>s15-1.xml</filename>，並建立如下例中所示的檔案。
    </para>
    <example>
     <title>網域 XML 檔案範例</title>
     <para>
      以下範例建立了一個包含一個 CPU、1 GB RAM 以及上一節 (<xref linkend="sec-prep-prep-ipl-kvm-disk"/>) 中建立的虛擬磁碟影像的 VM 客體，假設虛擬伺服器已掛接到主機網路介面 <literal>bond0</literal>。變更來源裝置元素，以便與您的網路設定相符。
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s15-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE SLES15&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s15-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s15-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s15lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-ipling">
  <title>對 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統執行 IPL</title>
  <para/>
  <sect3 xml:id="sec-prep-ipling-lpar">
   <title>對 LPAR 安裝執行 IPL</title>
   <para>
    執行 IPL 將 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 載入至 LPAR 的方法有很多。優先選擇是使用 SE 或 HMC 的<guimenu>從 CD-ROM 或伺服器載入</guimenu>功能。
   </para>
   <sect4 xml:id="sec-prep-ipling-lpar-cdrom">
    <title>從 DVD-ROM 執行 IPL</title>
    <para>
     標示要安裝的 LPAR，並選取<guimenu>從 CD-ROM 或伺服器載入</guimenu>。將檔案位置欄位留空白，或輸入第一個 DVD-ROM 的根目錄路徑，然後選取<guimenu>繼續</guimenu>。保留顯示的選項清單中的預設選擇。<guimenu>作業系統訊息</guimenu>現在應該會顯示核心開機訊息。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-lpar-dvd">
    <title>從透過 FCP 連接的 SCSI DVD 執行 IPL</title>
    <para>
     您可以透過選取<guimenu>SCSI</guimenu>做為<guimenu>載入類型</guimenu>以從 SCSI 執行 IPL 來使用<guimenu>載入</guimenu>程序。輸入 SCSI 橋接器或儲存 (16 位數 - 不要省略尾部零) 所提供的 WWPN (全球連接埠名稱) 與 LUN (邏輯單位編號)。開機程式選擇器必須為 2。請使用您的 FCP 介面卡做為<guimenu>載入位址</guimenu>並執行 IPL。
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-vm">
   <title>對 z/VM 安裝執行 IPL</title>
   <para>
    本節介紹如何對安裝系統執行 IPL，以便在 z/VM 系統上安裝 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z。
   </para>
   <sect4 xml:id="sec-prep-ipling-vm-reader">
    <title>從 z/VM 讀取器執行 IPL</title>
    <para>
     在新定義的 z/VM 客體中，需要有運作中的 TCP/IP 連接和 FTP 用戶端程式，以透過 FTP 傳輸安裝系統。為 z/VM 設定 TCP/IP 不在本手冊討論的範圍內。請參閱適當的 IBM 文件。
    </para>
    <para>
     以 z/VM Linux 訪客的身分登入以執行 IPL。在網路中，透過 FTP 提供整合安裝程式 (媒體 1) 的 <filename>/boot/s390x</filename> 目錄內容。從此目錄取得檔案 <filename>linux</filename>、<filename>initrd</filename>、<filename>parmfile</filename> 和 <filename>sles.exec</filename>。以 80 字元的固定區塊大小傳輸檔案。使用 FTP 指令 <command>locsite fix 80</command> 加以指定。<filename>linux</filename> (Linux 核心) 和 <filename>initrd</filename> (安裝影像) 必須以二進位檔格式複製，因此請使用 <literal>binary</literal> 傳輸模式。<filename>parmfile</filename> 和 <filename>sles.exec</filename> 需要使用 ASCII 模式進行傳輸。
    </para>
    <para>
     以下範例說明了所需的步驟。此特定案例假設可以從位址為 <literal>192.168.0.3</literal>、登入名稱為 <systemitem class="username">lininst</systemitem> 的 FTP 伺服器存取所需檔案。
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-ftp-ftptrans">
     <title>透過 FTP 傳輸二進位檔。</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles15.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles.exec sles.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     使用下載的 REXX 程序檔 sles.exec 對 Linux 安裝系統執行 IPL。此程序檔會將核心、parmfile 和啟始 RAM 磁碟載入至讀取器以便執行 IPL。
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-startscript-slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     使用該程序檔可以透過指令 <command>sles12</command> 對 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統執行 IPL。然後，Linux 核心會啟動並輸出其開機訊息。
    </para>
    <para>
     若要繼續安裝，請繼續<xref linkend="sec-prep-netcfg"/>。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-dvd">
    <title>從透過 FCP 連接的 SCSI DVD 執行 IPL</title>
    <para>
     若要在 z/VM 中執行 IPL，請使用 SET LOADDEV 參數準備 SCSI IPL 進程：
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     將 LOADDEV 參數設定為適當值之後，對 FCP 介面卡執行 IPL，例如：
    </para>
<screen>IPL FC00</screen>
    <para>
     若要繼續安裝，請繼續<xref linkend="sec-prep-netcfg"/>。
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-zpxe">
    <title>使用 zPXE 從 Cobbler 伺服器執行 IPL</title>
    <para>
     若要使用 zPXE 從 Cobbler 伺服器執行 IPL，您需要透過 FTP 將 <filename>zpxe.exec</filename> 程序檔從 Cobbler 伺服器傳輸到 z/VM 客體。為此，z/VM 客體需要使用運作中的 TCP/IP 連接和 FTP 用戶端程式。
    </para>
    <para>
     以 z/VM Linux 訪客身分登入進行 IPL，然後在 ASCII 模式下傳輸固定大小為 80 個字元的程序檔 (如需範例，請參閱<xref linkend="ex-prep-ipling-vm-reader-ftp-ftptrans"/>)。<filename>zpxe.rexx</filename> 程序檔已放在整合安裝程式 DVD (<filename>/boot/s390x/zpxe.rexx</filename>) 或 SLE Cobbler 伺服器 (<filename>/usr/share/doc/packages/s390-tools/zpxe.rexx</filename>) 中。
    </para>
    <para>
     <filename>zpxe.rexx</filename> 預設會取代您客體的 <filename>PROFILE EXEC</filename>。請備份現有的 <filename>PROFILE EXEC</filename> 並將 <filename>ZPXE REXX</filename> 重新命名為 <filename>PROFILE EXEC</filename>。或者，透過在現有 <filename>PROFILE EXEC</filename> 中新增 <literal>&apos;ZPXE REXX&apos;</literal> 行，從該程序檔呼叫 <filename>ZPXE REXX</filename>。
    </para>
    <para>
     最後一步是建立組態檔案 <filename>ZPXE CONF</filename>，指示 <filename>ZPXE REXX</filename> 連接哪個 Cobbler 伺服器以及對哪個磁碟執行 IPL。執行 <command>xedit zpxe conf a</command> 並建立具有下列內容的 <filename>ZPXE CONF</filename> (相應地取代範例資料)：
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     這樣，您下次登入 z/VM 客體時，就會連接 Cobbler 伺服器。如果排程在 Cobbler 伺服器上執行安裝，將會執行安裝。若要排程安裝，請在 Cobbler 伺服器上執行下列指令：
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system edit --name <replaceable>ID</replaceable><co xml:id="co-cobbler-sysedit-id"/> --netboot-enabled 1<co xml:id="co-cobbler-sysedit-netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="co-cobbler-sysedit-profile"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-sysedit-id">
      <para>
       z/VM 使用者 ID。
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-netboot">
      <para>
       啟用從網路進行 IPL。
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-profile">
      <para>
       現有設定檔的名稱，請參閱<xref linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>。
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-kvm">
   <title>對 KVM 客體安裝執行 IPL</title>
   <para>
    若要啟動客體安裝，則必須先啟動 VM 客體，如<xref linkend="sec-prep-prep-ipl-kvm-disk"/>中所定義。在開始之前，請確定核心和 initrd 可用於 IPL。
   </para>
   <sect4 xml:id="sec-prep-ipling-kvm-prep">
    <title>準備安裝來源</title>
    <para>
     必須將安裝系統的核心與 initrd 複製到虛擬機器主機伺服器，才能將虛擬機器客體 IPL 至安裝系統。
    </para>
    <procedure>
     <step>
      <para>
       登入 KVM 主機，並確定您可以連接到提供安裝來源的遠端主機或裝置。
      </para>
     </step>
     <step>
      <para>
       將以下兩個檔案從安裝來源複製到 <filename>/var/lib/libvirt/images/</filename>。若資料從遠端主機提供，請使用 <command>ftp</command>、<command>sftp</command> 或 <command>scp</command> 傳輸檔案：
      </para>
      <simplelist><member><filename>/boot/s390x/initrd</filename></member><member><filename>/boot/s390x/cd.ikr</filename></member>
      </simplelist>
     </step>
     <step>
      <para>
       重新命名 KVM 主機上的檔案：
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cd /var/lib/libvirt/images/
<prompt>&gt; </prompt><command>sudo</command> mv initrd s15-initrd.boot
<prompt>&gt; </prompt><command>sudo</command> mv cd.ikr s15-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-kvm-guest">
    <title>對 VM 客體執行 IPL</title>
    <para>
     若要對 VM 客體執行 IPL，請登入 KVM 主機並執行以下指令：
    </para>
<screen><prompt>&gt; </prompt>virsh  create s15-1.xml --console</screen>
    <para>
     當 VM 客體啟動並執行時，安裝程序將會開始，您會看到以下訊息：
    </para>
<screen>Domain s15-1 started
Connected to domain s15-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     回答 <guimenu>2) No</guimenu> 並在下一步中選擇<guimenu>安裝</guimenu>。依 <xref linkend="sec-prep-netcfg-data"/> 所述進行。
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-netcfg">
  <title>網路組態</title>
  <para>
   等候核心完成啟動常式。如果您以基本模式或在 LPAR 中執行安裝，請在 HMC 或 SE 上開啟<guimenu>作業系統訊息</guimenu>。
  </para>
  <para>
   首先，在 <filename>linuxrc</filename> 主功能表中選擇<guimenu>開始安裝</guimenu>。然後選擇<guimenu>開始安裝或更新</guimenu>以啟動安裝程序。選取<guimenu>網路</guimenu>做為安裝媒體，然後選取用於安裝的網路通訊協定類型。<xref linkend="sec-prep-makeavail"/> 將描述如何為各種類型的網路連接提供安裝資料。目前支援<guimenu>FTP</guimenu>、<guimenu>HTTP</guimenu>、<guimenu>NFS</guimenu>和<guimenu>SMB/CIFS</guimenu>(Windows 檔案共享)。
  </para>
  <para>
   在可用裝置的清單中，選擇用於接收安裝資料的 OSA 或 HiperSockets 網路裝置。儘管該清單可能包含 CTC、ESCON 或 IUCV 裝置，但 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 不再支援這些裝置。
  </para>
  <sect3 xml:id="sec-prep-netcfg-hypersockets">
   <title>設定 HiperSockets 介面</title>
   <para>
    從網路裝置清單中選取 HiperSocket 裝置。然後，輸入讀取、寫入和資料通道的值：
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-types">
    <title>支援的網路連接類型和驅動程式參數</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.0800]&gt; 0.0.0800

Device address for write channel. (Enter '+++' to abort).
[0.0.0801]&gt; 0.0.0801

Device address for data channel. (Enter '+++' to abort).
[0.0.0802]&gt; 0.0.0802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-osa">
   <title>設定 OSA Express 裝置</title>
   <para>
    從網路裝置清單中選取一個 OSA Express 裝置，並指定連接埠號。輸入讀取、寫入和資料通道的值。選擇是否啟用 OSI 第二層支援。
   </para>
   <para>
    新的雙連接埠 OSA Express 3 網路裝置需要連接埠號。如果您使用的不是 OSA Express 3 裝置，請輸入 <literal>0</literal>。OSA Express 網路卡還可以在 <quote>OSI 第二層支援</quote>模式或較舊但更常用的<quote>第三層</quote>模式下執行。網路卡模式會影響所有共享裝置的系統，包括其他 LPAR 上的系統。如果不清楚，請指定 <literal>2</literal> 以便與其他作業系統 (如 z/VM 和 z/OS) 使用的預設模式相容。有關這些選項的進一步資訊，請向硬體管理員資詢。
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-gigabit-param">
    <title>網路裝置驅動程式參數</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-data">
   <title>設定網路並選取安裝來源</title>
   <para>
    輸入所有網路裝置參數後，相關的驅動程式即會安裝到系統中，而您將看到相應的核心訊息。
   </para>
   <para>
    接下來，需要指定是否使用 DHCP 自動組態來設定網路介面參數。由於 DHCP 僅適用於幾個裝置，而且需要特殊硬體組態設定，因此請選擇<guimenu>否</guimenu>。然後，系統會提示您指定以下網路參數：
   </para>
   <itemizedlist>
    <listitem>
     <para>
      要安裝的系統的 IP 位址
     </para>
    </listitem>
    <listitem>
     <para>
      對應的網路遮罩 (如果未隨 IP 位址指定)
     </para>
    </listitem>
    <listitem>
     <para>
      進入伺服器的閘道 IP 位址
     </para>
    </listitem>
    <listitem>
     <para>
      網域名稱伺服器 (DNS) 涵蓋的搜尋網域清單
     </para>
    </listitem>
    <listitem>
     <para>
      網域名稱伺服器的 IP 位址
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex-prep-netcfg-vm-network-setup">
    <title>網路參數</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    最後，請提供有關安裝伺服器的所需資訊，例如 IP 位址、包含安裝資料的目錄，以及登入身分證明。提供所需的資訊後，即會載入安裝系統。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-connect">
  <title>連接至 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統</title>
  <para>
   載入安裝系統後，linuxrc 會提示您選擇用來控制安裝程序的顯示類型。可用的選項包括 <literal>Remote X11</literal> (X Window 系統)、<literal>VNC</literal> (虛擬網路運算通訊協定)、<literal>SSH</literal> (文字模式或透過安全外圍程序的 X11 安裝)、<literal>文字型使用者介面</literal>和<literal>圖形使用者介面</literal>。最後一個選項會在本地圖形顯示器 (如存在) 上以圖形模式啟動 YaST。在 s390x 架構上，可以使用 QEMU 和 <systemitem>virtio-gpu</systemitem> 驅動程式來實作本地圖形顯示器。
   </para>
   <para>
   建議的選項是 <literal>VNC</literal> 或 <literal>SSH</literal>。
   </para>
  <para>
   如果選取了<literal>文字型使用者介面</literal>選項，YaST 將在文字模式下啟動，您可以直接在終端機中執行安裝。<phrase os="sles">如需有關如何在文字模式下使用 YaST 的指示，請參閱<xref linkend="cha-yast-text"/>。</phrase>只有在安裝到 LPAR 中時，<literal>文字型使用者介面</literal>選項才可用。
  </para>
  <note>
   <title>文字型使用者介面的終端機模擬</title>
   <para>
    若要在文字模式下使用 YaST，需要在具有 VT220/Linux 模擬功能 (也稱為<literal>文字型使用者介面</literal>) 的終端機中執行該程式。
   </para>
  </note>
  <sect3 xml:id="sec-inst-connect-vnc-inst">
   <title>啟始化 VNC 安裝</title>
   <para>
    若要透過 VNC 從遠端控制安裝，請執行以下步驟：
   </para>
   <procedure>
    <step>
     <para>
      選取 <literal>VNC</literal> 選項會啟動 VNC 伺服器。主控台中的簡短說明顯示了用於連接 vncviewer 的 IP 位址和顯示編號。
     </para>
    </step>
    <step>
     <para>
      出現提示時，輸入 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統的 IP 位址和顯示編號。
     </para>
    </step>
    <step>
     <para>
      出現提示後，輸入 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安裝系統的 IP 位址和顯示編號。
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      建立連接後，使用 YaST 來安裝 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-x">
   <title>啟始化 X Window 系統安裝</title>
   <important>
    <title>X 驗證機制</title>
    <para>
     X Window 系統的直接安裝需仰賴以主機名稱為基礎的驗證機制。此機制在目前的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 版本中已停用。我們建議使用 SSH 或 VNC 執行安裝。
    </para>
   </important>
   <para>
    若要透過 X 轉遞從遠端控制安裝，請執行以下步驟：
   </para>
   <procedure>
    <step>
     <para>
      請確定 X 伺服器允許用戶端 (安裝的系統) 進行連接。設定檔案 <filename>/etc/sysconfig/displaymanager</filename> 中的變數 <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN=&quot;yes&quot;</command>。重新啟動 X 伺服器，並允許用戶端使用 <command>xhost <replaceable>用戶端 IP 位址</replaceable></command>繋結到伺服器。
     </para>
    </step>
    <step>
     <para>
      在安裝系統出現提示時，請輸入執行 X 伺服器之機器的 IP 位址。
     </para>
    </step>
    <step>
     <para>
      等候 YaST 開啟，然後開始安裝。
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-ssh">
   <title>啟始化 SSH 安裝</title>
   <para>
    若要透過 SSH 連接到名為 <literal>earth</literal> 的安裝系統，請使用 <command>ssh -X earth</command> 指令。如果您的工作站在 Microsoft Windows 上執行，請使用 <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/> 中提供的 Putty 工具。在 Putty 中的<menuchoice>
    <guimenu>連接</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu>
    </menuchoice> 下設定<guimenu>啟用 X11 轉遞</guimenu>。
   </para>
   <para>
    若您使用其他作業系統，請執行 <command>ssh -X </command> 以連接到名稱為 <systemitem>earth</systemitem>earth 的安裝系統。若您擁有本地 X 伺服器，則支援透過 SSH 的 X 轉遞。否則，YaST 會在 ncurses 上提供文字介面。
   </para>
   <para>
    出現提示時，請輸入 <literal>root</literal> 使用者名稱，然後使用密碼登入。輸入 <command>yast.ssh</command> 啟動 YaST。接著 YaST 會引導您執行安裝。
   </para>
   <important>
    <title>解決透過 SSH 執行 YaST 時的問題</title>
    <para>
     在某些情況下，使用 X 轉遞透過 SSH 執行 YaST 的 GUI 版本可能會失敗，並顯示以下錯誤訊息：
    </para>
<screen>XIO: fatal IO error 11 (Resource temporarily unavailable) on X server "localhost:11.0"</screen>
    <para>
     在這種情況下，您有兩種選擇：
    </para>
    <itemizedlist>
     <listitem>
      <para>
       使用 <option>QT_XCB_GL_INTEGRATION=none</option> 選項執行 YaST，例如：
      </para>
<screen>QT_XCB_GL_INTEGRATION=none yast.ssh
QT_XCB_GL_INTEGRATION=none yast2 disk</screen>
     </listitem>
     <listitem>
      <para>
       透過停用 X 轉遞或將 ncurses 指定為所需 UI，來執行 YaST 應用程式的 ncurses 版本。若要執行後一種操作，請使用 <command>yast2 disk --ncurses</command> 或 <command>YUI_PREFERED_BACKEND=ncurses yast2 disk</command> 指令。
      </para>
     </listitem>
    </itemizedlist>
   </important>
   <para>
    繼續執行<xref linkend="cha-install"/>中所述的安裝程序。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-boot-procedure">
  <title>IBM Z 上的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 開機程序</title>
  <para>
   在 SLES 10 和 11 上，開機程序由 zipl 開機載入程式處理。為了從 Btrfs 分割區開機並支援使用 Snapper 進行系統復原，IBM Z 上的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 開機方式已有變更。
  </para>
  <para>
   GRUB 2 取代了 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> for IBM Z 上的 zipl。AMD64/Intel 64 架構上的 GRUB 2 包含韌體層級的裝置驅動程式，用於存取檔案系統。大型主機上沒有韌體，將 <literal>ccw</literal> 新增至 GRUB 2 不僅任務繁重，而且還需要在 GRUB 2 中重新實作 zipl。因此，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 使用兩階段方案：
  </para>
  <variablelist>
   <varlistentry>
    <term>階段一：</term>
    <listitem>
     <para>
      將一個包含核心和 initrd 的單獨分割區掛接到 <filename>/boot/zipl</filename>。使用 <filename>/boot/zipl/config</filename> 中的組態透過 zipl 載入此核心和 initrd。
     </para>
     <para>
      此組態會將關鍵字 <literal>initgrub</literal> 新增到核心指令行。載入核心與 initrd 後，initrd 將啟動掛接根檔案系統所需的裝置 (參閱 <filename>/boot/zipl/active_devices.txt</filename>)。然後，GRUB 2 使用者空間程式將會啟動，該程式會讀取 <filename>/boot/grub2/grub.cfg</filename>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>階段二：</term>
    <listitem>
     <para>
      透過 <filename>kexec</filename> 啟動 <command>/boot/grub2/grub.cfg</command> 中指定的核心與 initrd。然後啟用 <filename>/boot/zipl/active_devices.txt</filename> 中所列的，用於啟動磁碟中系統的裝置。該清單中的其他裝置將會加入白名單，但未列出的裝置將被忽略。如同在其他架構中一樣，將會掛接根檔案系統，開機程序將會繼續。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para os="sles">
   如需開機程序的詳細資料，請參閱<xref linkend="cha-boot"/>。
  </para>
 </sect2>
</sect1>
