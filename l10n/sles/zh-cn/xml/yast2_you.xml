<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="yast2_you.xml" version="5.0" xml:id="cha-onlineupdate-you">
 <title>YaST 联机更新</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  SUSE 持续为您的产品提供软件安全更新。默认使用更新小程序来确保系统处于最新状态。有关更新小程序的更多信息请参考<xref linkend="sec-updater"/>。本章介绍用于更新软件包的备用工具：YaST 联机更新。
 </para>
 <para>
  更新软件源提供了 <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase> 的最新补丁。<phrase os="sles;sled">如果安装时已注册您的产品，则更新软件源已配置。如果您尚未注册 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>，可通过在 YaST 中启动<guimenu>产品注册</guimenu>来完成注册。</phrase>或者，可以从信任的源中手动添加更新软件源。要添加或去除软件源，请使用 YaST 中的<menuchoice> <guimenu>软件</guimenu>
  <guimenu>软件源</guimenu> </menuchoice>来启动软件源管理器。请在<xref linkend="sec-yast-software-instsource"/>中了解更多有关软件源管理器的内容。
 </para>
 <note os="sles;sled">
  <title>访问更新编目时出错</title>
  <para>
   如果您不能访问更新编目，可能是由于订阅已过期。通常，<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 会附带一年或三年的订阅，在此期间您可以访问更新编目。订阅结束后，将拒绝您访问更新编目。
  </para>
  <para>
   如果访问更新编目时遭到拒绝，您将看到一条警告消息，提示您访问 SUSE Customer Center 并查看您的订阅。可通过 <link xlink:href="https://scc.suse.com//"/> 访问 SUSE Customer Center。
  </para>
 </note>
 <note os="sles;sled">
 <title>用于接收更新的防火墙设置</title>
 <para>
  <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 上的防火墙默认只阻止传入连接。如果系统受到会阻止传出流量的另一个防火墙的保护，请确保允许通过端口 80 和 443 连接至 <link xlink:href="https://scc.suse.com/"/> 和 <link xlink:href="https://updates.suse.com"/>，以便接收更新。
 </para>
</note>
 <para>
  SUSE 提供了不同相关级别的更新：
 </para>
 <variablelist>
  <varlistentry>
   <term>安全性更新</term>
   <listitem>
    <para>
     修复严重的安全性危害，请务必安装。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>推荐更新</term>
   <listitem>
    <para>
     修复可能危及计算机安全的问题。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>可选更新</term>
   <listitem>
    <para>
     修复非安全性相关的问题或提供增强功能。
    </para>
   </listitem>
  </varlistentry>
 </variablelist>
 <sect1 xml:id="sec-onlineupdate-you-overview">
  <title>联机更新对话框</title>

  <para>
   要打开 YaST <guimenu>联机更新</guimenu>对话框，请启动 YaST 并选择<menuchoice> <guimenu>软件</guimenu> <guimenu>联机更新</guimenu> </menuchoice>。也可以从命令行输入 <command>yast2 online_update</command> 来启动该对话框。
  </para>

  <para>
   <guimenu>联机更新</guimenu>窗口由四部分组成。
  </para>

  <figure>
   <title>YaST 联机更新</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_you.png" width="75%" os="sles;sled"/>
     
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_you.png" width="75%" os="sles;sled"/>
     
    </imageobject>
   </mediaobject>
  </figure>

  <para>
   左侧的<guimenu>摘要</guimenu>部分列出了 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 可用的补丁。补丁按安全相关性（<literal>安全性</literal>、<literal>推荐</literal>和<literal>可选</literal>）排序。您可以从<guimenu>显示补丁类别</guimenu>中选择以下某个选项来更改<guimenu>摘要</guimenu>部分的视图：
  </para>

  <variablelist>
   <varlistentry>
    <term><guimenu>必需的补丁</guimenu>（默认视图）</term>
    <listitem>
     <para>
      当前未安装的适用于系统上已安装的软件包的补丁。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>不必需的补丁</guimenu>
    </term>
    <listitem>
     <para>
      适用于系统上未安装的软件包的补丁，或要求已满足的补丁（因为已从另一源对相关软件包进行了更新）。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>所有补丁</guimenu>
    </term>
    <listitem>
     <para>
      <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 的所有可用补丁。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   <guimenu>摘要</guimenu>部分的每个列表项都由符号和补丁名称组成。如需了解可能符号及其含义的概述，请按 <keycombo> <keycap function="shift"/> <keycap>F1</keycap>
   </keycombo>。<literal>安全性</literal>和<literal>建议</literal>补丁需要的操作是自动预设置的。这些操作有<guimenu>自动安装</guimenu>、<guimenu>自动更新</guimenu>和<guimenu>自动删除</guimenu>。
  </para>

  <para>
   如果从非更新软件源的某个软件源安装最新软件包，此安装可能满足此软件包的某个补丁的要求。在这种情况下，在补丁摘要前会显示一个复选标记。该补丁将显示在列表中，直到将其标记用于安装。这实际上不会安装补丁（因为该软件包已经是最新的），而是将该补丁标记为已安装。
  </para>

  <para>
   在<guimenu>摘要</guimenu>部分选择一个项，可在对话框左下角的<guimenu>补丁描述</guimenu>中查看简短描述。右上部分列出所选补丁中包含的软件包（一个补丁可以由多个软件包组成）。单击右上部分中的项可以查看有关补丁中包含的各个软件包的细节。
  </para>
 </sect1>
 <sect1 xml:id="sec-onlineupdate-you-install">
  <title>安装补丁</title>

  <para>
   在 YaST 的“联机更新”对话框中，您可以一次性安装所有可用的补丁，也可以手动选择所需的补丁。还可以还原已应用于系统的补丁。
  </para>

  <para>
   默认情况下，您的系统当前可用的所有新补丁（<literal>可选</literal>补丁除外）都已标记为可安装。一旦您单击<guimenu>接受</guimenu>或<guimenu>应用</guimenu>，将自动应用它们。如果一个或多个补丁需要重引导系统，在开始安装补丁之前，系统会发出相关通知。此时，您可以选择继续安装所选补丁、跳过需要重引导的所有补丁的安装并安装剩余的补丁，或者返回补丁手动选择屏幕。
  </para>

  <procedure>
   <title>使用 YaST 联机更新应用补丁</title>
   <step>
    <para>
     启动 YaST 并选择<menuchoice> <guimenu>软件</guimenu>
     <guimenu> 联机更新</guimenu> </menuchoice>。
    </para>
   </step>
   <step>
    <para>
     要自动应用您的系统当前可用的所有新补丁（<literal>可选</literal>补丁除外），请单击<guimenu>应用</guimenu>或<guimenu>接受</guimenu>。
    </para>
   </step>
   <step>
    <para>
     首先请修改要应用的补丁选择：
    </para>
    <substeps performance="required">
     <step>
      <para>
       使用界面中提供的相应过滤器和视图。有关细节，请参见<xref linkend="sec-onlineupdate-you-overview"/>。
      </para>
     </step>
     <step>
      <para>
       根据您的需要和喜好选择或取消选择补丁，方法是右键单击补丁并从上下文菜单中选择相应操作。
      </para>
      <important>
       <title>始终应用安全更新</title>
       <para>
        除非很有必要，否则请不要取消选择任何<literal>安全性</literal>相关的补丁。因为这些补丁可修复严重的安全性危害，防止系统遭受攻击。
       </para>
      </important>
     </step>
     <step>
      <para>
       多数补丁包含几个软件包的更新。要更改对单个软件包执行的操作，请在包视图中右键单击某个软件包，并选择一项操作。
      </para>
     </step>
     <step>
      <para>
       要确认您的选择并应用所选补丁，请单击<guimenu>应用</guimenu>或<guimenu>接受</guimenu>以继续。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     安装完成后，单击<guimenu>完成</guimenu>退出 YaST <guimenu>联机更新</guimenu>。您的系统现在已经是最新的。
    </para>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec-onlineupdate-retracted-patches">
  <title>查看已撤回的补丁</title> 
  
  <para>
    维护更新会经过仔细测试，以最大限度地降低引入 Bug 的风险。如果发现某个补丁包含 Bug，将会自动撤回该补丁。一个新的更新（版本号更高）将会发布以还原有 Bug 的补丁，并会阻止再次安装该补丁。可以在<guimenu>软件包分类</guimenu>选项卡上查看已撤回的补丁及其历史记录。
  </para>
  <figure>
   <title>查看已撤回的补丁和历史记录</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_retracted_patches.png" width="75%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_retracted_patches.png" width="75%"/>
    </imageobject>
   </mediaobject>
  </figure>  
</sect1>

 <sect1 xml:id="sec-onlineupdate-you-automatically">
  <title>自动联机更新</title>

  <para>
   您可以使用 YaST 配置每日、每周或每月的自动更新。安装 <systemitem class="resource">yast2-online-update-configuration</systemitem> 软件包。
  </para>

  <para>
   默认情况下，更新将以增量 RPM 的形式供您下载。由于基于增量 RPM 重构建 RPM 软件包需要占用大量内存和处理器资源，出于性能考虑，某些设置或硬件配置可能要求您禁用增量 RPM。
  </para>

  <para>
   某些补丁（如需要许可协议的内核更新或软件包）需要用户交互，这可能会导致自动更新过程停止。您可以配置以跳过需要用户交互的补丁。
  </para>
  
  <para>
      使用 YaST <guimenu>软件</guimenu>模块中的<guimenu>补丁</guimenu>选项卡可以查看可用的及已安装的补丁，包括 Bug 报告和 CVE 公告的参考内容。
  </para>

  <procedure>
   <title>配置自动联机更新</title>
   <step>
    <para>
     安装后，启动 YaST 并选择<menuchoice>
     <guimenu>软件</guimenu> <guimenu>联机更新</guimenu>
     </menuchoice>。选择<menuchoice><guimenu>配置</guimenu>
     <guimenu>联机更新</guimenu></menuchoice>。如果未安装 <package>yast2-online-update-configuration</package>，系统将提示您加以安装。
    </para>
      <figure>
   <title>YaST 联机更新配置</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_autoupdate.png" width="75%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_autoupdate.png" width="75%"/>
    </imageobject>
   </mediaobject>
  </figure>
    <para>
     也可以从命令行输入 <command>yast2 online_update_configuration</command> 来启动该模块。
    </para>
    
   </step>
   <step>
    <para>
     选择更新间隔：<guimenu>每日</guimenu>、<guimenu>每周</guimenu>或<guimenu>每月</guimenu>。
    </para>
   </step>
   <step>
    <para>
     有时，补丁可能需要引起管理员的注意，例如，在重启动关键服务时。而此补丁可能是适用于 Docker 开放源代码引擎的更新，运行此更新需要重启动所有容器。在安装补丁之前，系统会向用户告知此操作的后果，并要求他们确认是否安装该补丁。此类补丁称为<quote>交互式补丁</quote>。
    </para>
    <para>
     自动安装补丁时，系统会假设您已确认要安装交互式补丁。如果您希望在安装之前先检查这些补丁，请选中<guimenu>跳过交互式补丁</guimenu>。在这种情况下，自动增补期间会跳过交互式补丁。请确保定期运行手动联机更新，以检查是否有交互式补丁正在等待安装。
    </para>
   </step>
   <step>
    <para>
     要自动接受任何许可协议，请激活<guimenu>同意许可证</guimenu>。
    </para>
   </step>
   <step>
    <para>
     要自动安装更新包推荐的所有软件包，请激活<guimenu>包含推荐的软件包</guimenu>。
    </para>
   </step>

   <step>
    <para>
     要禁用增量 RPM（出于性能方面的考虑），请取消选中<guimenu>使用增量 RPM</guimenu>。
    </para>
   </step>
   <step>
    <para>
     要按照类别（例如安全性或推荐）过滤补丁，请选中<guimenu>按类别过滤</guimenu>，并从列表中添加适当的补丁类别。只会安装选中类别的补丁，合理的做法是仅启用自动<guimenu>安全</guimenu>更新，并手动检查所有其他更新。增补操作通常比较可靠，但您可能想要测试非安全性补丁，并在遇到任何问题时进行回滚。 
    </para>
    <itemizedlist>
        <listitem>
            <para><guimenu>Packagemanager 和 YaST</guimenu> 提供的补丁用于软件包管理以及 YaST 功能和模块。
            </para>
        </listitem>
        <listitem>
            <para><guimenu>安全性</guimenu>补丁提供至关重要的更新和 Bug 修复。
            </para>
        </listitem>
        <listitem>
            <para><guimenu>推荐</guimenu>补丁提供可选的 Bug 修复和增强功能。
            </para>
        </listitem>
        <listitem>
            <para><guimenu>可选</guimenu>表示新软件包。</para>
        </listitem>
        <listitem>
            <para><guimenu>其他</guimenu>相当于杂项。
                </para>
        </listitem>
        <listitem>
            <para><guimenu>文档</guimenu>不可用。
            </para>
        </listitem>
    </itemizedlist>            
    
   </step>
   <step>
    <para>
     单击<guimenu>确定</guimenu>确认您的配置。
    </para>
   </step>
  </procedure>

  <para>
   之后，自动联机更新将不会自动重启动系统。如果有的软件包更新需要重引导系统，您需要手动重引导。
  </para>
 </sect1>
</chapter>
