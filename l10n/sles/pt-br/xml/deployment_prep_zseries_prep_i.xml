<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec-zseries-prep">
 <title>Preparando para a instalação</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  Este capítulo explica como tornar os dados acessíveis para instalação, instalar o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> usando métodos diferentes, preparar e usar a reinicialização (IPL) do sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Ele também inclui informações sobre a configuração e a instalação de rede.
 </para>

 <sect2 xml:id="sec-prep-makeavail">
  <title>Disponibilizando os dados de instalação</title>
  <para>
   Esta seção apresenta informações detalhadas sobre como tornar os dados de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para IBM Z acessíveis para instalação. Dependendo do seu computador e ambiente de sistema, escolha entre a instalação via NFS ou FTP. Se estiver executando estações de trabalho do Microsoft Windows no ambiente, você também poderá usar a rede do Windows (inclusive o protocolo SMB) para instalar o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> no sistema IBM Z.
  </para>
  <tip>
   <title>Reinicialização (IPL) do DVD</title>
   <para>
    É possível fazer a reinicialização (IPL) de um DVD e usar o DVD como meio de instalação. Isso é muito prático quando você tem restrições de configuração do servidor de instalação que fornece as mídias de instalação pela rede. O pré-requisito é uma unidade de DVD SCSI conectada a FCP.
   </para>
  </tip>
  <note>
   <title>Sem instalação do disco rígido</title>
   <para>
    Não é possível fazer a instalação de um disco rígido inserindo o conteúdo do DVD em uma partição no DASD.
   </para>
  </note>
  <sect3 xml:id="sec-prep-makeavail-linuxws">
   <title>Usando uma estação de trabalho Linux ou o DVD do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
   <para>
    Você pode usar uma estação de trabalho Linux em seu ambiente do computador para enviar os dados de instalação ao processo de instalação do IBM Z por NFS ou FTP.<phrase os="sles"> Se a estação de trabalho Linux executa o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, você pode configurar um servidor de instalação (NFS ou FTP) usando o módulo <guimenu>Servidor de Instalação</guimenu> do YaST, conforme descrito na <xref linkend="sec-deployment-instserver-sles9"/>&#x002E;</phrase>
   </para>
   <important>
    <title>Exportando dispositivos montados com NFS</title>
    <para>
     A exportação da raiz do sistema de arquivos (<filename>/</filename>) não exporta automaticamente os dispositivos montados, como DVD. Portanto, você precisa nomear explicitamente o ponto de montagem em <filename>/etc/exports</filename>:
    </para>
<screen>/media/dvd  *(ro)</screen>
    <para>
     Após mudar esse arquivo, reinicie o servidor NFS com o comando <command>sudo systemctl restart nfsserver</command>.
    </para>
   </important>
   <para>
    A configuração de um servidor FTP em um sistema Linux envolve a instalação e configuração do software do servidor, como <package>vsftpd</package>.<phrase os="sles"> Se você usa o<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, consulte o <xref linkend="cha-ftp"/> para obter instruções de instalação.</phrase> O download dos dados de instalação com login anônimo não é suportado, portanto, você precisa configurar o servidor FTP para suportar a autenticação do usuário.
   </para>
   <sect4 xml:id="sec-prep-makeavail-linuxws-oncd">
    <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> no DVD</title>
    <para>
     O primeiro meio de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para IBM Z contém uma imagem do Linux inicializável para estações de trabalho baseadas em Intel e uma imagem para IBM Z.
    </para>
    <para>
     Para estações de trabalho baseadas em Intel, inicialize usando esse meio. Quando solicitado, escolha o idioma de resposta e o layout de teclado desejados e selecione <guimenu>Iniciar sistema de recuperação</guimenu>. Você precisa de pelo menos 64 MB de RAM para isso. Nenhum espaço em disco é necessário porque todo o sistema de recuperação reside na RAM da estação de trabalho. Essa abordagem exige a configuração manual da rede da estação de trabalho.
    </para>
    <para>
     Para o IBM Z, reinicialize (IPL) seu convidado LPAR/VM por esse meio, conforme descrito na <xref linkend="sec-prep-ipling-lpar-dvd"/>. Após digitar seus parâmetros de rede, o sistema de instalação tratará o meio como a fonte dos dados de instalação. Como o IBM Z não pode ter um terminal compatível com X11 diretamente conectado, escolha entre a instalação por VNC ou SSH. O SSH também oferece uma instalação gráfica através do túnel da conexão X por meio de SSH com <command>ssh -X</command>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-windowsws">
   <title>Usando uma estação de trabalho Microsoft Windows</title>
   <para>
    Você pode usar uma estação de trabalho Microsoft Windows na rede para disponibilizar a mídia de instalação. A maneira mais fácil de fazer isso é usando o protocolo SMB. Verifique se você ativou <guimenu>SMB over TCP/IP</guimenu> (SMB sobre TCP/IP), já que isso habilita o encapsulamento de pacotes SMB em pacotes TCP/IP. Os detalhes podem ser encontrados na ajuda online do Windows ou em outra documentação relacionada ao Windows que aborde redes.
   </para>
   <sect4 xml:id="sec-prep-makeavail-windowsws-smb">
    <title>Usando SMB</title>
    <para>
     Para disponibilizar a mídia de instalação com o SMB, insira a unidade flash USB com SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso na porta USB da estação de trabalho Windows. Em seguida, crie um novo compartilhamento usando a letra da unidade flash USB e disponibilize-o para todos na rede.
    </para>
    
    <para>
     O caminho de instalação no YaST pode ser:
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     Em que os marcadores significam:
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMÍNIO</replaceable></term>
      <listitem>
       <para>
        Grupo de trabalho opcional ou domínio de diretório ativo.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USUÁRIO</replaceable></term>
      <term><replaceable>Senha</replaceable></term>
      <listitem>
       <para>
        Nome de usuário e senha opcionais de um usuário com acesso ao servidor e seu compartilhamento.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable></term>
      <listitem>
       <para>
        O nome do servidor que hospeda o(s) compartilhamento(s).
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable></term>
      <listitem>
       <para>
        O caminho para o(s) compartilhamento(s).
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para/>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-nfs">
    <title>Com NFS</title>
    <para>
     Consulte a documentação fornecida com o produto de terceiros que habilita os serviços do servidor NFS para a estação de trabalho do Windows. A unidade flash USB que contém o meio SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso deve estar no caminho do NFS disponível.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-ftp">
    <title>Usando FTP</title>
    <para>
     Consulte a documentação fornecida com o produto de terceiros que habilita os serviços do servidor FTP na estação de trabalho Windows. A unidade flash USB que contém o meio SLE-15-SP4-Online-<replaceable>ARCH</replaceable>-GM-media1.iso deve estar no caminho do FTP disponível.
    </para>
    <para>
     O servidor FTP que acompanha determinadas versões do Microsoft Windows implementa apenas um subconjunto de comandos do FTP e não é adequado para fornecimento dos dados de instalação. Neste caso, use um servidor FTP de terceiros que ofereça a funcionalidade necessária.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-windowsws-scsi">
    <title>Usando uma unidade de DVD SCSI conectada por FCP</title>
    <para>
     Depois que você preparar a IPL do DVD SCSI conforme descrito na <xref linkend="sec-prep-ipling-lpar-dvd"/>, o sistema de instalação usará o DVD como a mídia de instalação. Neste caso, você não precisa da mídia de instalação em um servidor FTP, NFS ou SMB. Entretanto, você precisa dos dados de configuração de rede para o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, pois deve configurar a rede durante a instalação para realizar uma instalação gráfica por VNC ou por X.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-zpxe-cobbler">
   <title>Usando um servidor Cobbler para zPXE</title>
   <para>
    A reinicialização (IPL) da rede requer um servidor Cobbler para fornecer o kernel, o initrd e os dados de instalação. A preparação do servidor Cobbler requer as seguintes etapas:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-import"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref xrefstyle="select:label nopage" linkend="sec-prep-makeavail-zpxe-cobbler-system"/>
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-import">
    <title>Importando os dados de instalação</title>
    <para>
     A importação da mídia exige que a fonte de instalação esteja disponível no servidor Cobbler, seja da unidade flash USB ou de uma fonte de rede. Execute o seguinte comando para importar os dados:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler import --path=<replaceable>PATH</replaceable><co xml:id="co-cobbler-import-path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-import-dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="co-cobbler-import-path">
      <para>
       Ponto de montagem dos dados de instalação.
      </para>
     </callout>
     <callout arearefs="co-cobbler-import-dirname">
      <para>
       Uma string que identifica o produto importado, por exemplo <quote>sles15_s390x</quote>. Essa string é usada como o nome do subdiretório no qual os dados da instalação são copiados. No servidor Cobbler executado no SUSE Linux Enterprise, trata-se do <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFICADOR</replaceable></filename>. Esse caminho poderá ser diferente se o Cobbler for executado em outro sistema operacional.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-add-distro">
    <title>Adicionando uma distribuição</title>
    <para>
     A adição de uma distribuição permite que o Cobbler forneça o kernel e o initrd necessários para reinicialização (IPL) via zPXE. Execute o seguinte comando no servidor Cobbler para adicionar o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para IBM Z:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-identifier"/> \
  --os-version=<phrase os="sles;sled">sles15</phrase><co xml:id="co-cobbler-add-os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="co-cobbler-add-initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="co-cobbler-add-kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-add-server"/>
    </screen>    
    <calloutlist>
     <callout arearefs="co-cobbler-add-identifier">
      <para os="sles;sled;osuse">
       Identificador exclusivo para a distribuição, por exemplo, <quote>SLES <phrase role="productnumber"><phrase os="sles;sled">15 SP4</phrase></phrase> IBM Z</quote>.
      </para>
      
     </callout>
     <callout arearefs="co-cobbler-add-os">
      <para>
       Identificador do sistema operacional. Use <literal>sles15</literal>.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-initrd">
      <para>
       Caminho para o initrd. A primeira parte do caminho (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFICADOR</replaceable>/</filename>) depende do local dos dados importados e do nome do subdiretório escolhido na hora de importar os dados de instalação.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-kernel">
      <para>
       Caminho para o kernel. A primeira parte do caminho (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFICADOR</replaceable>/</filename>) depende do local dos dados importados e do nome do subdiretório escolhido na hora de importar os dados de instalação.
      </para>
     </callout>
     <callout arearefs="co-cobbler-add-server">
      <para>
       URL para o diretório de instalação no servidor Cobbler.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-profile">
    <title>Ajustando o perfil</title>
    <para>
     A adição de uma distribuição (consulte a <xref linkend="sec-prep-makeavail-zpxe-cobbler-add-distro"/>) gera automaticamente um perfil com o <replaceable>IDENTIFICADOR</replaceable> correspondente. Use o seguinte comando para fazer alguns ajustes necessários:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="co-cobbler-profile-name"/> --os-version=sles10<co xml:id="co-cobbler-profile-os"/> --ksmeta=""<co xml:id="co-cobbler-profile-meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="co-cobbler-profile-opts"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-profile-name">
      <para>
       Identificador do perfil. Use a string especificada quando a distribuição foi adicionada.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-os">
      <para>
       Versão do sistema operacional. Distribuição à qual o perfil deve se aplicar. Use a string especificada com <option>--name=<replaceable>IDENTIFICADOR</replaceable></option> na etapa de importação.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-meta">
      <para>
       Opção necessária para criar gabarito de arquivos Kickstart. Como ela não é usada para SUSE, deixe-a vazia.
      </para>
     </callout>
     <callout arearefs="co-cobbler-profile-opts">
      <para>
       Lista de parâmetros do kernel separados por espaço. Ela deve incluir pelo menos o parâmetro <literal>install</literal>.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec-prep-makeavail-zpxe-cobbler-system">
    <title>Adicionando sistemas</title>
    <para>
     A última etapa é adicionar sistemas ao servidor Cobbler. Essa etapa deve ser executada para cada convidado IBM Z que deve ser inicializado por zPXE. Os convidados são identificados pelo ID de usuário do z/VM (no exemplo a seguir, o ID é <quote>linux01</quote>). Observe que o ID deve estar em letras minúsculas. Para adicionar um sistema, execute o seguinte comando:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     A opção <option>--kopts</option> permite especificar os parâmetros de kernel e de instalação que normalmente são especificados no parmfile. Especifique os parâmetros no seguinte formato: <replaceable>PARÂMETRO1=VALOR1 PARÂMETRO2=VALOR2</replaceable>. O instalador solicita os parâmetros ausentes. Para uma instalação completamente automatizada, você precisa especificar todos os parâmetros para a rede, os DASDs e fornecer um arquivo do AutoYaST. Veja a seguir um exemplo de um convidado equipado com uma interface OSA que usa os mesmos parâmetros de rede mencionados acima.
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-makeavail-dvd-usb-hmc">
   <title>Instalando por meio de uma unidade flash USB do HMC</title>
   <para>
    Normalmente, a instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> em servidores IBM Z requer uma fonte de instalação de rede. Se esse requisito não for atendido, o SUSE Linux Enterprise Server permitirá o uso da unidade flash USB do Console de Gerenciamento de Hardware (HMC, Hardware Management Console) como uma fonte para a instalação em uma LPAR.
   </para>
   <para>
    Para executar a instalação usando a unidade flash USB do HMC, proceda da seguinte maneira:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Adicione <option>install=hmc:/</option> ao <filename>parmfile</filename> (consulte a <xref linkend="sec-appdendix-parm"/>) ou às opções de kernel.
     </para>
    </listitem>
    <listitem>
     <para>
      Na instalação de modo manual que usa o <filename>linuxrc</filename>, escolha <emphasis role="italic">Iniciar instalação</emphasis>, <emphasis role="italic">Instalação</emphasis> e <emphasis role="italic">Console de Gerenciamento de Hardware</emphasis>. O meio de instalação deve estar no HMC.
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>Configurar rede</title>
    <para>
     Antes de iniciar a instalação, especifique uma configuração de rede no <filename>linuxrc</filename>. Isso não pode ser feito usando os parâmetros de boot, e é muito provável que você precise de acesso à rede. No <filename>linuxrc</filename>, vá para <emphasis role="italic">Iniciar Instalação</emphasis> e escolha <emphasis role="italic">Configuração da Rede</emphasis>.
    </para>
   </important>
   <important>
    <title>O sistema Linux deve ser inicializado primeiro</title>
    <para>
     Antes de conceder acesso à mídia na unidade flash USB do HMC, aguarde a inicialização do sistema Linux. A reinicialização (IPL) pode interromper a conexão entre o HMC e a LPAR. Se a primeira tentativa de usar o método descrito falhar, você poderá conceder o acesso e repetir a opção <option>HMC</option>.
    </para>
   </important>
   <note>
    <title>Repositório de instalação</title>
    <para>
     A unidade flash USB não é mantida como um repositório de instalação, pois a instalação é um procedimento único. Se for necessário um repositório de instalação, registre-se e use o repositório online.
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-inst-types">
  <title>Tipos de instalação</title>
  <para>
   Esta seção descreve as etapas de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para cada modo de instalação. Depois de concluídas as etapas de preparação descritas nos capítulos anteriores, siga a visão geral do modo de instalação desejado.
  </para>
  <para>
   Conforme descrito na <xref linkend="sec-prep-makeavail"/>, há três modos de instalação diferentes para Linux no IBM Z: instalação de convidado LPAR, z/VM e KVM.
  </para>
  <procedure xml:id="pro-prep-inst-types-lpar">
   <title>Visão geral de uma instalação de LPAR</title>
   <step>
    <para>
     Prepare os dispositivos necessários para instalação. Consulte o <xref linkend="sec-prep-prep-ipl-natlpar"/>.
    </para>
   </step>
   <step>
    <para>
     Reinicialize (IPL) o sistema de instalação. Consulte o <xref linkend="sec-prep-ipling-lpar"/>.
    </para>
   </step>
   <step>
    <para>
     Configure a rede. Consulte o <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Conecte-se ao sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server. </phrase></phrase> Consulte o <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Inicie a instalação usando o YaST e reinicialize (IPL) o sistema instalado. Consulte o <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-vm">
   <title>Visão geral da instalação do z/VM</title>
   <step>
    <para>
     Prepare os dispositivos necessários para instalação. Consulte o <xref linkend="sec-prep-prep-ipl-vm-linux-guest"/>.
    </para>
   </step>
   <step>
    <para>
     Reinicialize (IPL) o sistema de instalação. Consulte o <xref linkend="sec-prep-ipling-vm"/>.
    </para>
   </step>
   <step>
    <para>
     Configure a rede. Consulte o <xref linkend="sec-prep-netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Conecte-se ao sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server. </phrase></phrase> Consulte o <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Inicie a instalação usando o YaST e reinicialize (IPL) o sistema instalado. Consulte o <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro-prep-inst-types-kvm">
   <title>Visão geral da instalação do convidado KVM</title>
   <step>
    <para>
     Crie uma imagem de disco virtual e grave um arquivo XML de domínio. Consulte o <xref linkend="sec-prep-prep-ipl-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     Prepare o destino da instalação e reinicialize (IPL) o Convidado da VM. Consulte o <xref linkend="sec-prep-ipling-kvm"/>.
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec-prep-netcfg-data"/>.
    </para>
   </step>
   <step>
    <para>
     Conecte-se ao sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server. </phrase></phrase> Consulte o <xref linkend="sec-prep-connect"/>.
    </para>
   </step>
   <step>
    <para>
     Inicie a instalação usando o YaST e reinicialize (IPL) o sistema instalado. Consulte o <xref linkend="cha-install"/>.
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec-prep-prep-ipl">
  <title>Preparando a reinicialização (IPL) do sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec-prep-prep-ipl-natlpar">
   <title>Preparando a reinicialização (IPL) de uma instalação de LPAR</title>
   <para>
    Configure o sistema IBM Z para ser iniciado no modo ESA/S390 ou apenas Linux com o perfil de ativação e IOCDS apropriados. Para obter mais informações, consulte a documentação da IBM. Continue conforme descrito na <xref linkend="sec-prep-ipling-lpar"/>.
   </para>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-vm">
   <title>Preparando a reinicialização (IPL) de uma instalação de z/VM</title>
   <para/>
   <sect4 xml:id="sec-prep-prep-ipl-vm-linux-guest">
    <title>Adicionando um convidado Linux usando o dirMaint</title>
    <para>
     A primeira etapa é anexar e formatar um ou vários DASDs no sistema a ser usado pelo convidado Linux no z/VM. Em seguida, crie um novo usuário no z/VM. O exemplo mostra o diretório para um usuário <literal>LINUX1</literal> com a senha <literal>LINPWD</literal>, 1 GB de memória (extensível até 2 GB), vários minidiscos (MDISK), duas CPUs e um dispositivo OSA QDIO.
    </para>
    <tip>
     <title>Atribuindo memória a convidados z/VM</title>
     <para>
      Ao atribuir memória a um convidado z/VM, verifique se o tamanho da memória é adequado ao tipo de instalação preferido. <phrase os="sles">Consulte a <xref linkend="sec-zseries-requirements-hw-mem"/>&#x002E;</phrase> Para definir o tamanho da memória como 1 GB, use o comando <command>CP DEFINE STORAGE 1G</command>. Após a conclusão da instalação, redefina o tamanho da memória para o valor desejado.
     </para>
    </tip>
    <example xml:id="ex-prep-prep-ipl-vm-linux-guest-config">
     <title>Configuração de um diretório z/VM</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     Este exemplo usa o minidisco 201 como disco pessoal do convidado. O minidisco 150 com 200 cilindros é o dispositivo de troca do Linux. O disco 151 com 2800 cilindros mantém a instalação do Linux.
    </para>
    <para>
     Como usuário <systemitem class="username">MAINT</systemitem>, adicione o convidado ao diretório de usuário com <command>DIRM FOR LINUX1 ADD</command>. Digite o nome do convidado (<literal>LINUX1</literal>) e pressione <keycap>F5</keycap>. Configure o ambiente do usuário com:
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     O último comando retorna um número de arquivo de leitor. Este número é necessário para o próximo comando:
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     Agora, você pode efetuar login no convidado como o usuário <systemitem class="username">LINUX1</systemitem>.
    </para>
    <para>
     Se não tiver a opção <literal>dirmaint</literal> disponível, consulte a documentação da IBM para saber como configurar esse usuário.
    </para>
    <para>
     Avance para o <xref linkend="sec-prep-ipling-vm"/>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-prep-ipl-kvm">
   <title>Preparando a reinicialização (IPL) de uma instalação do convidado KVM</title>
   <para>
    A instalação do convidado KVM requer um arquivo XML de domínio que especifica a máquina virtual e pelo menos uma imagem de disco virtual para a instalação.
   </para>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-disk">
    <title>Criar uma imagem de disco virtual</title>
    <para>
     Por padrão, o libvirt procura imagens de disco em <filename>/var/lib/libvirt/images/</filename> no Servidor de Host de VM. Embora as imagens também possam ser armazenadas em qualquer outro lugar no sistema de arquivos, é recomendável armazenar todas as imagens em um único local para facilitar a manutenção. Para criar uma imagem, efetue login no servidor de host KVM e execute o seguinte comando:
    </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
    <para>
     Isso cria uma imagem qcow2 de 10 GB em <filename>/var/lib/libvirt/images/</filename>.<phrase os="sles"> Para obter mais informações, consulte o <xref linkend="cha-qemu-guest-inst-qemu-img"/>&#x002E;</phrase>
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-prep-ipl-kvm-domain">
    <title>Gravar um arquivo XML de domínio</title>
    <para>
     Um arquivo XML de domínio é usado para definir o Convidado da VM. Para criar o arquivo XML de domínio, abra um arquivo <filename>s15-1.xml</filename> vazio com um editor e crie um arquivo, como no exemplo a seguir.
    </para>
    <example>
     <title>Exemplo de arquivo XML de domínio</title>
     <para>
      O exemplo a seguir cria um Convidado da VM com um única CPU, 1 GB de RAM e a imagem do disco virtual criada na seção anterior (<xref linkend="sec-prep-prep-ipl-kvm-disk"/>). Ele considera que o servidor virtual está conectado à interface de rede do host <literal>bond0</literal>. Mude o elemento dos dispositivos de origem para corresponder à sua configuração de rede.
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s15-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE SLES15&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s15-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s15-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s15lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-ipling">
  <title>Reinicializando (IPL) o sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec-prep-ipling-lpar">
   <title>Reinicializando (IPL) uma instalação no LPAR</title>
   <para>
    Há várias formas de reinicializar (IPL) o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> em um LPAR. A preferida é usar o recurso <guimenu>Carregar do CD-ROM ou do servidor</guimenu> do SE ou do HMC.
   </para>
   <sect4 xml:id="sec-prep-ipling-lpar-cdrom">
    <title>IPL do DVD-ROM</title>
    <para>
     Marque o LPAR para instalação e selecione <guimenu>Carregar do CD-ROM ou do servidor</guimenu>. Deixe o campo referente ao local do arquivo em branco ou insira o caminho para o diretório raiz do primeiro DVD-ROM e selecione <guimenu>Continuar</guimenu>. Mantenha a seleção padrão na lista de opções exibida. <guimenu>Agora, a opção </guimenu>Operating system messages (Mensagens do sistema operacional) deveria mostrar as mensagens de inicialização do kernel.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-lpar-dvd">
    <title>Reinicialização (IPL) do DVD SCSI conectado por FCP</title>
    <para>
     Você pode usar o procedimento <guimenu>Carregar</guimenu>, selecionando <guimenu>SCSI</guimenu> como <guimenu>Tipo de carga</guimenu> para reinicializar (IPL) do SCSI. Digite o nome da porta mundial (WWPN, Worldwide Port Name) e o número da unidade lógica (LUN, Logical Unit Number) fornecidos pelo armazenamento ou ponte SCSI (16 dígitos, sem omitir os 0s à direita). O seletor do programa de boot deve ser 2. Use seu adaptador FCP como <guimenu>Endereço de carregamento</guimenu> e execute uma reinicialização (IPL).
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-vm">
   <title>Reinicializando (IPL) uma instalação no z/VM</title>
   <para>
    Esta seção descreve a reinicialização (IPL) do sistema de instalação para instalar o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para IBM Z em um sistema z/VM.
   </para>
   <sect4 xml:id="sec-prep-ipling-vm-reader">
    <title>Executando o IPL a partir do leitor z/VM</title>
    <para>
     Você precisa de uma conexão TCP/IP ativa e um programa cliente de FTP em seu convidado z/VM recém-definido para transferir o sistema de instalação por FTP. A configuração de TCP/IP para z/VM está fora do escopo deste manual. Consulte a documentação apropriada da IBM.
    </para>
    <para>
     Efetue login como convidado z/VM Linux para IPL. Disponibilize o conteúdo do diretório <filename>/boot/s390x</filename> do Instalador Unificado (meio 1) por FTP na sua rede. Nesse diretório, obtenha os arquivos <filename>linux</filename>, <filename>initrd</filename>, <filename>parmfile</filename> e <filename>sles.exec</filename>. Transfira os arquivos com um tamanho de bloco fixo de 80 caracteres. Especifique-o com o comando FTP <command>locsite fix 80</command>. É importante copiar o <filename>linux</filename> (o kernel do Linux) e o <filename>initrd</filename> (a imagem de instalação) como arquivos binários; portanto, use o modo de transferência <literal>binário</literal>. <filename>parmfile</filename> e <filename>sles.exec</filename> devem ser transferidos no modo ASCII.
    </para>
    <para>
     O exemplo a seguir mostra as etapas necessárias. Este cenário específico considera que os arquivos necessários são acessíveis de um servidor FTP no endereço IP <literal>192.168.0.3</literal> e que o login é <systemitem class="username">lininst</systemitem>.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-ftp-ftptrans">
     <title>Transferindo os binários por FTP</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles15.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles.exec sles.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     Use o script REXX sles.exec do qual você fez download para reinicializar (IPL) o sistema de instalação do Linux. Esse script inicializa o kernel, parmfile e o disco RAM inicial no leitor para IPL.
    </para>
    <example xml:id="ex-prep-ipling-vm-reader-startscript-slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     Ao usar o script, é possível reinicializar (IPL) o sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> com o comando <command>sles12</command>. O kernel do Linux é iniciado e emite suas mensagens de boot.
    </para>
    <para>
     Para continuar a instalação, vá para a <xref linkend="sec-prep-netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-dvd">
    <title>Reinicialização (IPL) do DVD SCSI conectado por FCP</title>
    <para>
     Para reinicializar (IPL) no z/VM, prepare o processo de IPL do SCSI usando o parâmetro SET LOADDEV:
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     Após definir o parâmetro LOADDEV com os valores adequados, reinicialize (IPL) seu adaptador FCP, por exemplo:
    </para>
<screen>IPL FC00</screen>
    <para>
     Para continuar a instalação, continue na <xref linkend="sec-prep-netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-vm-zpxe">
    <title>Reinicialização (IPL) de um servidor Cobbler com o zPXE</title>
    <para>
     Para reinicializar (IPL) de um servidor Cobbler com o zPXE, você precisa transferir o script <filename>zpxe.rexx</filename> por FTP do servidor Cobbler para o convidado z/VM. Para fazer isso, o convidado z/VM precisa de uma conexão TCP/IP ativa e de um programa cliente de FTP.
    </para>
    <para>
     Efetue login como convidado Linux no z/VM para reinicializar (IPL) e transferir o script com um tamanho fixo de 80 caracteres no modo ASCII (consulte o <xref linkend="ex-prep-ipling-vm-reader-ftp-ftptrans"/>). O script <filename>zpxe.rexx</filename> está disponível no DVD do Instalador Unificado em <filename>/boot/s390x/zpxe.rexx</filename> ou em um servidor Cobbler no SLE em <filename>/usr/share/doc/packages/s390-tools/zpxe.rexx</filename>.
    </para>
    <para>
     O <filename>zpxe.rexx</filename> deve substituir o <filename>PROFILE EXEC</filename> do convidado. Faça uma cópia de backup do <filename>PROFILE EXEC</filename> existente e renomeie <filename>ZPXE REXX</filename> para <filename>PROFILE EXEC</filename>. Se preferir, chame <filename>ZPXE REXX</filename> do <filename>PROFILE EXEC</filename> existente adicionando a linha <literal>&apos;ZPXE REXX&apos;</literal> a ele.
    </para>
    <para>
     A última etapa é criar um arquivo de configuração <filename>ZPXE CONF</filename> que informa ao <filename>ZPXE REXX</filename> qual servidor Cobbler deve ser contatado e em qual disco executar a reinicialização (IPL). Execute <command>xedit zpxe conf a</command> e crie <filename>ZPXE CONF</filename> com o seguinte conteúdo (substitua os dados de exemplo de acordo):
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     Isso conectará o servidor Cobbler na próxima vez que você efetuar login no convidado z/VM. Se estiver programada uma instalação no servidor Cobbler, ela será executada. Para programar a instalação, execute o seguinte comando no servidor Cobbler:
    </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cobbler system edit --name <replaceable>ID</replaceable><co xml:id="co-cobbler-sysedit-id"/> --netboot-enabled 1<co xml:id="co-cobbler-sysedit-netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="co-cobbler-sysedit-profile"/></screen>
    <calloutlist>
     <callout arearefs="co-cobbler-sysedit-id">
      <para>
       ID do usuário z/VM.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-netboot">
      <para>
       Habilitar reinicialização (IPL) da rede.
      </para>
     </callout>
     <callout arearefs="co-cobbler-sysedit-profile">
      <para>
       Nome de um perfil existente, consulte a <xref linkend="sec-prep-makeavail-zpxe-cobbler-profile"/>.
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec-prep-ipling-kvm">
   <title>Reinicializando (IPL) uma instalação do convidado KVM</title>
   <para>
    Para iniciar a instalação no convidado, você precisa primeiro iniciar o Convidado da VM definido na <xref linkend="sec-prep-prep-ipl-kvm-disk"/>. Antes de começar, verifique se o kernel e o initrd estão disponíveis para reinicialização (IPL).
   </para>
   <sect4 xml:id="sec-prep-ipling-kvm-prep">
    <title>Preparando a fonte de instalação</title>
    <para>
     O Kernel e o initrd do sistema de instalação precisam ser copiados para o Servidor de Host de VM para reinicializar (IPL) o Convidado da VM no sistema de instalação.
    </para>
    <procedure>
     <step>
      <para>
       Efetue login no host KVM e verifique se você consegue se conectar ao host remoto ou ao dispositivo que funciona como fonte de instalação.
      </para>
     </step>
     <step>
      <para>
       Copie os dois arquivos a seguir da fonte de instalação para <filename>/var/lib/libvirt/images/</filename>. Se os dados são obtidos de um host remoto, use <command>ftp</command>, <command>sftp</command> ou <command>scp</command> para transferir os arquivos:
      </para>
      <simplelist><member><filename>/boot/s390x/initrd</filename></member><member><filename>/boot/s390x/cd.ikr</filename></member>
      </simplelist>
     </step>
     <step>
      <para>
       Renomeie os arquivos no host KVM:
      </para>
<screen><prompt>&gt; </prompt><command>sudo</command> cd /var/lib/libvirt/images/
<prompt>&gt; </prompt><command>sudo</command> mv initrd s15-initrd.boot
<prompt>&gt; </prompt><command>sudo</command> mv cd.ikr s15-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec-prep-ipling-kvm-guest">
    <title>Reinicialização (IPL) do convidado da VM</title>
    <para>
     Para reinicializar (IPL) o Convidado da VM, efetue login no host KVM e execute o seguinte comando:
    </para>
<screen><prompt>&gt; </prompt>virsh  create s15-1.xml --console</screen>
    <para>
     O processo de instalação é iniciado quando o Convidado da VM está ativo e em execução. Você deve ver a seguinte mensagem:
    </para>
<screen>Domain s15-1 started
Connected to domain s15-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     Resposta <guimenu>2) Não</guimenu> e escolha <guimenu>Instalação</guimenu> na etapa seguinte. Prossiga conforme descrito na <xref linkend="sec-prep-netcfg-data"/>.
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-netcfg">
  <title>Configuração de rede</title>
  <para>
   Aguarde até que o kernel tenha realizado as suas rotinas de inicialização. Se você executar a instalação no modo básico ou em uma LPAR, abra as <guimenu>Mensagens do Sistema Operacional</guimenu> no HMC ou no SE.
  </para>
  <para>
   Primeiramente, escolha <guimenu>Iniciar Instalação</guimenu> no menu principal do <filename>linuxrc</filename>. Em seguida, escolha <guimenu>Iniciar Instalação ou Atualização</guimenu> para iniciar o processo de instalação. Selecione <guimenu>Rede</guimenu> como o meio de instalação, depois selecione o tipo de protocolo de rede que será usado para a instalação. A <xref linkend="sec-prep-makeavail"/> descreve como disponibilizar os dados de instalação para os diversos tipos de conexões de rede. Atualmente, <guimenu>FTP</guimenu>, <guimenu>HTTP</guimenu>, <guimenu>NFS</guimenu> e <guimenu>SMB/CIFS</guimenu> (compartilhamento de arquivos do Windows) são aceitos.
  </para>
  <para>
   Na lista de dispositivos disponíveis, escolha um dispositivo de rede OSA ou HiperSockets para receber os dados de instalação. Embora a lista possa incluir dispositivos CTC, ESCON ou IUCV, eles não são mais suportados no <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
  </para>
  <sect3 xml:id="sec-prep-netcfg-hypersockets">
   <title>Configurar uma interface do HiperSocket</title>
   <para>
    Selecione um dispositivo HiperSocket na lista de dispositivos de rede. Em seguida, insira os valores para os canais de leitura, gravação e dados:
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-types">
    <title>Tipos de conexão de rede e parâmetros de driver suportados</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.0800]&gt; 0.0.0800

Device address for write channel. (Enter '+++' to abort).
[0.0.0801]&gt; 0.0.0801

Device address for data channel. (Enter '+++' to abort).
[0.0.0802]&gt; 0.0.0802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-osa">
   <title>Configurar um dispositivo OSA Express</title>
   <para>
    Selecione um dispositivo OSA Express na lista de dispositivos de rede e especifique o número da porta. Insira os valores para os canais de leitura, gravação e dados: Escolha se deseja habilitar o suporte da Camada 2 de OSI.
   </para>
   <para>
    O número da porta é necessário para os novos dispositivos de Rede OSA Express 3 de 2 portas. Se você não estiver usando um dispositivo OSA Express 3, digite <literal>0</literal>. As placas OSA Express também podem ser executadas no modo de <quote>suporte da camada 2 de OSI</quote> ou no modo mais antigo e comum da <quote>camada 3</quote>. O modo da placa afeta todos os sistemas que compartilham o dispositivo, incluindo os sistemas em outras LPARs. Em caso de dúvida, especifique <literal>2</literal> para fins de compatibilidade com o modo padrão usado por outros sistemas operacionais, como z/VM e z/OS. Consulte seu administrador de hardware para obter mais informações sobre essas opções.
   </para>
   <example xml:id="ex-appdendix-inst-netcontypes-gigabit-param">
    <title>Parâmetros de driver do dispositivo de rede</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec-prep-netcfg-data">
   <title>Configurar a rede e selecionar a fonte de instalação</title>
   <para>
    Depois que todos os parâmetros de dispositivo de rede forem inseridos, o respectivo driver será instalado, e você verá as mensagens do kernel correspondentes.
   </para>
   <para>
    Em seguida, você precisará especificar se deseja usar a configuração automática DHCP para configurar os parâmetros de interface de rede. Como o DHCP funciona apenas em alguns dispositivos e requer definições de configuração de hardware especiais, escolha <guimenu>NO</guimenu>. Dessa forma, será solicitado para você especificar os seguintes parâmetros de rede:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      O endereço IP do sistema a ser instalado
     </para>
    </listitem>
    <listitem>
     <para>
      A máscara de rede correspondente (caso não tenha sido especificada com o endereço IP)
     </para>
    </listitem>
    <listitem>
     <para>
      O endereço IP de um gateway para acessar o servidor
     </para>
    </listitem>
    <listitem>
     <para>
      Uma lista dos domínios de pesquisa incluídos no servidor de nomes de domínio (DNS)
     </para>
    </listitem>
    <listitem>
     <para>
      O endereço IP do servidor de nomes de domínio
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex-prep-netcfg-vm-network-setup">
    <title>Parâmetros de projeto de rede</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    Por fim, insira as informações necessárias sobre o servidor de instalação, como endereço IP, diretório com os dados de instalação e credenciais de login. O sistema de instalação é carregado quando as informações necessárias são fornecidas.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-connect">
  <title>Conectando-se ao sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server </phrase></phrase></title>
  <para>
   Após carregar o sistema de instalação, o linuxrc solicitará que você escolha o tipo de tela que será usada para controlar o procedimento de instalação. As opções disponíveis são <literal>Remote X11</literal> (X Window System), <literal>VNC</literal> (protocolo Virtual Network Computing), <literal>SSH</literal> (instalação em modo de texto ou X11 por Secure Shell), <literal>IU baseada em Texto</literal> e <literal>IU Gráfica</literal>. Essa última opção inicia o YaST no modo gráfico em uma tela gráfica local, se houver. Na arquitetura s390x, uma tela gráfica local pode ser implementada usando o QEMU e o driver <systemitem>virtio-gpu</systemitem>.
   </para>
   <para>
   As opções recomendadas são <literal>VNC</literal> ou <literal>SSH</literal>.
   </para>
  <para>
   Se a opção <literal>IU baseada em Texto</literal> foi selecionada, o YaST é iniciado no modo de texto, e você pode executar a instalação diretamente em seu terminal.<phrase os="sles"> Consulte o <xref linkend="cha-yast-text"/> para obter instruções sobre como usar o YaST no modo de texto.</phrase> A opção <literal>IU baseada em Texto</literal> é útil apenas durante a instalação no LPAR.
  </para>
  <note>
   <title>Emulação do terminal para IU baseada em texto</title>
   <para>
    Para trabalhar com o YaST no modo de texto, ele precisa ser executado em um terminal com emulação VT220/Linux (também chamada de <literal>IU baseada em Texto</literal>).
   </para>
  </note>
  <sect3 xml:id="sec-inst-connect-vnc-inst">
   <title>Iniciando a instalação para VNC</title>
   <para>
    Para controlar remotamente uma instalação via VNC, siga estas etapas:
   </para>
   <procedure>
    <step>
     <para>
      Selecione a opção <literal>VNC</literal> para iniciar o servidor VNC. Uma pequena nota no console exibe o endereço IP e o número de exibição para conexão com o vncviewer.
     </para>
    </step>
    <step>
     <para>
      Digite o endereço IP e o número de exibição do sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> quando solicitado.
     </para>
    </step>
    <step>
     <para>
      Quando solicitado, digite o endereço IP e o número de exibição do sistema de instalação do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
     </para>
<screen>http://&lt;IP address of installation system&gt;:5801/</screen>
    </step>
    <step>
     <para>
      Depois que a conexão for estabelecida, instale o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> com o YaST.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-x">
   <title>Iniciando a instalação para o X Window System</title>
   <important>
    <title>Mecanismo de autenticação X</title>
    <para>
     A instalação direta com o X Window System usa um mecanismo de autenticação baseado em nomes de host. Esse mecanismo está desabilitado nas versões atuais do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Recomendamos a execução da instalação com SSH ou VNC.
    </para>
   </important>
   <para>
    Para controlar remotamente uma instalação por meio do encaminhamento X, siga estas etapas:
   </para>
   <procedure>
    <step>
     <para>
      Verifique se o servidor X permite que o cliente (o sistema que está instalado) se conecte. Defina a variável <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN=&quot;sim&quot;</command> no arquivo <filename>/etc/sysconfig/displaymanager</filename>. Reinicie o servidor X e permita que o cliente se vincule ao servidor usando <command>xhost <replaceable>ENDEREÇO_IP_DO_CLIENTE</replaceable></command>.
     </para>
    </step>
    <step>
     <para>
      Ao ser solicitado no sistema de instalação, digite o endereço IP da máquina em que o servidor X está sendo executado.
     </para>
    </step>
    <step>
     <para>
      Espere até que o YaST seja aberto e inicie a instalação.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec-inst-connect-ssh">
   <title>Iniciando a instalação para SSH</title>
   <para>
    Para conectar-se a um sistema de instalação chamado <literal>earth</literal> usando SSH, use o comando <command>ssh -X earth</command>. Se a sua estação de trabalho é executada no Microsoft Windows, use a ferramenta Putty disponível em <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/>. Defina <guimenu>Habilitar o encaminhamento X11</guimenu> no Putty em <menuchoice>
    <guimenu> Conexão</guimenu> <guimenu> SSH</guimenu> <guimenu> X11</guimenu>
    </menuchoice>.
   </para>
   <para>
    Se você usa outro sistema operacional, execute <command>ssh -X </command> para conectar-se a um sistema de instalação com o nome <systemitem>earth</systemitem>earth. O Encaminhamento X via SSH será suportado se você tiver um servidor X local disponível. Do contrário, o YaST fornecerá uma interface de texto desenvolvida por ncurses.
   </para>
   <para>
    Quando solicitado, insira o nome de usuário <literal>root</literal> e efetue login com a sua senha. Digite <command>yast.ssh</command> para iniciar o YaST. O YaST orientará você durante a instalação. 
   </para>
   <important>
    <title>Corrigindo o problema do YaST por SSH</title>
    <para>
     Em determinadas situações, a execução da versão GUI do YaST por SSH com encaminhamento X pode falhar com a seguinte mensagem de erro:
    </para>
<screen>XIO: fatal IO error 11 (Resource temporarily unavailable) on X server "localhost:11.0"</screen>
    <para>
     Nesse caso, você tem duas opções.
    </para>
    <itemizedlist>
     <listitem>
      <para>
       Executar o YaST com a opção <option>QT_XCB_GL_INTEGRATION=none</option>, por exemplo:
      </para>
<screen>QT_XCB_GL_INTEGRATION=none yast.ssh
QT_XCB_GL_INTEGRATION=none yast2 disk</screen>
     </listitem>
     <listitem>
      <para>
       Executar a versão ncurses do aplicativo YaST desabilitando o encaminhamento X ou especificando o ncurses como a IU desejada. Para este último, use o comando <command>yast2 disk --ncurses</command> ou <command>YUI_PREFERED_BACKEND=ncurses yast2 disk</command>.
      </para>
     </listitem>
    </itemizedlist>
   </important>
   <para>
    Continue o procedimento de instalação conforme descrito no <xref linkend="cha-install"/>.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec-prep-boot-procedure">
  <title>Procedimento de boot do <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> no IBM Z</title>
  <para>
   No SLES 10 e 11, o processo de boot foi realizado pelo carregador de boot zipl. Para habilitar a inicialização de partições Btrfs e o suporte a rollbacks de sistema com o Snapper, a maneira como o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> é inicializado no IBM Z mudou.
  </para>
  <para>
   O GRUB 2 substitui o zipl no <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> para IBM Z. O GRUB 2 na arquitetura AMD64/Intel 64 inclui os drivers de dispositivo no nível do firmware para acessar o sistema de arquivos. Não há firmware no mainframe, e adicionar o <literal>ccw</literal> ao GRUB 2, além de ser uma tarefa complexa, exige a reimplementação do zipl no GRUB 2. Portanto, o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> usa uma abordagem de duas fases:
  </para>
  <variablelist>
   <varlistentry>
    <term>Primeira fase:</term>
    <listitem>
     <para>
      Uma partição separada com o kernel e um initrd é montada em <filename>/boot/zipl</filename>. Esse kernel e o initrd são carregados pelo zipl usando a configuração em <filename>/boot/zipl/config</filename>.
     </para>
     <para>
      Essa configuração adiciona a palavra-chave <literal>initgrub</literal> à linha de comando do kernel. Após o carregamento do kernel e do initrd, o initrd ativará os dispositivos necessários para montar o sistema de arquivos raiz (consulte o <filename>/boot/zipl/active_devices.txt</filename>). Na sequência, um programa de espaço de usuário do GRUB 2 é iniciado para ler o <filename>/boot/grub2/grub.cfg</filename>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Segunda fase:</term>
    <listitem>
     <para>
      O kernel e o initrd especificados no <filename>/boot/grub2/grub.cfg</filename> são iniciados por meio do comando <command>kexec</command>. Os dispositivos listados em <filename>/boot/zipl/active_devices.txt</filename> necessários para iniciar o sistema no disco são ativados. Outros dispositivos dessa lista serão incluídos na lista de permissões; mas, do contrário, serão ignorados. O sistema de arquivos raiz é montado, e o procedimento de boot continua como nas outras arquiteturas.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para os="sles">
   Para obter mais detalhes sobre o processo de boot, consulte o <xref linkend="cha-boot"/>.
  </para>
 </sect2>
</sect1>
