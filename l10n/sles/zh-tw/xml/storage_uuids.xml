<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="storage_uuids.xml" version="5.0" xml:id="cha-uuid" xml:lang="zh-tw">
 <title>掛接儲存裝置</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  本章概述在掛接裝置期間會使用哪些裝置識別碼，並提供關於掛接網路儲存裝置的詳細資料。
 </para>
 <sect1 xml:id="sec-uuid-understanduuid">
  <title>瞭解 UUID</title>

  <para>
   UUID (通用唯一識別碼) 是 128 位元的檔案系統編號，在本地系統和其他系統中都是唯一的。它根據系統硬體資訊和時戳 (做為其種子的一部分) 隨機產生。UUID 通常用於唯一標記裝置。
  </para>

  <para>
   使用非永久性的<quote>傳統</quote>裝置名稱 (例如 <filename>/dev/sda1</filename>) 可能會使系統在新增儲存裝置後無法開機。例如，如果將根 (<filename>/</filename>) 指定給 <filename>/dev/sda1</filename>，在連接 SAN 或將其他硬碟加入系統後，系統可能會將根重新指定給 <filename>/dev/sdg1</filename>。在此情況下，需要調整開機載入程式組態和 <filename>/etc/fstab</filename> 檔案，否則系統將無法開機。
  </para>

  <para>
   依預設，開機載入程式以及開機裝置的 <filename>/etc/fstab</filename> 檔案中會使用 UUID。UUID 是檔案系統的內容，在磁碟重新格式化時會發生變更。其他可替代裝置名稱的 UUID 的方法是透過 ID 或標籤識別裝置。
  </para>

  <para>
   您還可以將 UUID 用做組合與啟動軟體 RAID 裝置的準則。建立 RAID 時，<command>md</command> 驅動程式會為該裝置產生一個 UUID，並將該值儲存在 <filename>md</filename> 超級區塊中。
  </para>

  <para>
   您可以在 <filename>/dev/disk/by-uuid</filename> 目錄中找到任何區塊裝置的 UUID。例如，如下所示的 UUID 項目：
  </para>

<screen><prompt>&gt; </prompt>ls -og /dev/disk/by-uuid/
lrwxrwxrwx 1 10 Dec  5 07:48 e014e482-1c2d-4d09-84ec-61b3aefde77a -&gt; ../../sda1</screen>
 </sect1>
 <sect1 xml:id="sec-uuid-udev">
  <title>udev 的永久裝置名稱</title>

  <para>
   從 Linux 核心 2.6 開始，<command>udev</command> 使用永久性裝置命名方式，為動態的 <filename>/dev</filename> 目錄提供了一種使用者空間解決方案。做為 HotPlug 系統的一部分，會在裝置新增至系統或從系統中移除時執行 <command>udev</command>。
  </para>

  <para>
   規則清單用來比對特定的裝置屬性。<command>udev</command> 規則基礎架構 (在 <filename>/etc/udev/rules.d</filename> 目錄中定義) 為所有磁碟裝置提供了穩定的名稱，不會隨識別順序或裝置所使用的連接而改變。<command>udev</command> 工具會檢查核心所建立的每個適當區塊裝置，根據特定匯流排、磁碟機類型或檔案系統套用命名規則。如需有關如何定義自己的 <command>udev</command> 規則的資訊，請參閱 <link xlink:href="https://reactivated.net/writing_udev_rules.html"><citetitle>Writing
   udev Rules</citetitle></link>。
  </para>

  <para>
   除了核心提供的動態裝置節點名稱，<command>udev</command> 還會在 <filename>/dev/disk</filename> 目錄中維護指向該裝置的永久符號連結類別。該目錄進一步細分為 <filename>by-id</filename>、<filename>by-label</filename>、<filename>by-path</filename> 和 <filename>by-uuid</filename> 子目錄。
  </para>

  <note>
   <title>UUID 產生器</title>
   <para>
    除了 <command>udev</command> 之外，其他程式 (如 LVM 或 <command>md</command>) 也可產生 UUID，但它們不在 <filename>/dev/disk</filename> 中列出。
   </para>
  </note>

  <para>
   如需使用 <systemitem>udev</systemitem> 來管理裝置的詳細資訊，請參閱<xref linkend="cha-udev"/>。
  </para>

  <para>
   如需 <systemitem>udev</systemitem> 指令的詳細資訊，請參閱 <command>man 7 udev</command>。
  </para>
 </sect1>
 <sect1 xml:id="sec-netdev-option">
  <title>掛接網路儲存裝置</title>

  <para>
   對於某些類型的儲存裝置，需要為其設定網路並使網路可用，然後 <command>systemd.mount</command> 才會開始掛接這些裝置。若要推遲這種裝置的掛接，請將 <literal>_netdev</literal> 選項新增至每個特定網路儲存裝置的 <filename>/etc/fstab</filename> 檔案。範例如下：
  </para>

<screen>
mars.example.org:/nfsexport  /shared   nfs  defaults,_netdev    0  0
  </screen>
 </sect1>
</chapter>
