<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="adm_support.xml" version="5.0" xml:id="cha-adm-support">
 <title>サポート用システム情報の収集</title>
 <info>
      <abstract>
        <para>
    マシンに関連するすべてのシステム情報の概要をすばやく参照できるよう、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では<systemitem class="systemname">hostinfo</systemitem>パッケージが提供されています。このパッケージは、システム管理者が汚染カーネル(サポートされていません)やサードパーティパッケージがマシンにインストールされていないかどうかを確認する場合にも役立ちます。
   </para>
        <para>
    問題がある場合は、<command>supportconfig</command>コマンドラインツールまたはYaST<guimenu>サポート</guimenu>モジュールで詳細なシステムレポートを作成できます。どちらも、現在のカーネルのバージョン、ハードウェア、インストールされているパッケージ、パーティションセットアップなどのシステム情報を収集します。結果は、複数のファイルのTARアーカイブになります。サービス要求(SR)を開いた後、そのTARアーカイブをグローバルテクニカルサポートにアップロードできます。これは、レポートされた問題を特定したり、問題解決を支援したりするのに役立ちます。
   </para>
        <para>
    また、既知の問題がないかどうか<command>supportconfig</command>の出力を分析することで、問題解決を迅速化できます。このために、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では、<literal>Supportconfig Analysis</literal> (SCA)用のアプライアンスとコマンドラインツールの両方が提供されています。
   </para>
      </abstract>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:bugtracker/>
        <dm:translation>yes</dm:translation>
      </dm:docmanager>
    </info>
    
 <sect1 xml:id="sec-admsupport-hostinfo">
  <title>現在のシステム情報の表示</title>

  <para>
   サーバへのログイン時に関連するすべてのシステム情報をすばやく簡単に参照するには、パッケージ<systemitem class="systemname">hostinfo</systemitem>を使用します。このパッケージをマシンにインストールすると、そのマシンにログインしたすべての<systemitem class="username">root</systemitem>ユーザに対して、コンソールに次の情報が表示されます。
  </para>

  <example xml:id="ex-support-hostinfo">
   <title><systemitem class="username">root</systemitem>としてログインしたときの<command>hostinfo</command>の出力</title>
<screen>Welcome to SUSE Linux Enterprise Server 15 SP2 Snapshot8 (x86_64) - Kernel \r (\l).


Distribution:             SUSE Linux Enterprise Server 15 SP2
Current As Of:            Wed 25 Mar 2020 12:09:20 PM PDT
Hostname:                 localhost
Kernel Version:           5.3.18-8-default
 Architecture:            x86_64
 Installed:               Thu 19 Mar 2020 11:25:13 AM PDT
 Status:                  Not Tainted
Last Installed Package:   Wed 25 Mar 2020 11:42:24 AM PDT
 Patches Needed:          0
 Security:                0
 3rd Party Packages:      219
Network Interfaces
 eth0:                    192.168.2/24 2002:c0a8:20a::/64
Memory
 Total/Free/Avail:        7.4Gi/6.4Gi/6.8Gi (91% Avail)
CPU Load Average:         7 (3%) with 2 CPUs
</screen>
  </example>

  <para>
   この出力でカーネルのステータスが<literal>tainted</literal>と表示される場合、詳細については、<xref linkend="sec-admsupport-kernel"/>を参照してください。
  </para>
 </sect1>
 <sect1 xml:id="sec-admsupport-supportconfig">
  <title>supportconfigによるシステム情報の収集</title>
  <para>
   グローバルテクニカルサポートに引き渡すことができる詳細なシステム情報を含むTARアーカイブを作成するには、次のいずれかを使用します。
  </para>
  <itemizedlist>
   <listitem>
    <para>コマンド<command>supportconfig</command>または、 </para>
   </listitem>
   <listitem>
    <para>YaST <guimenu>サポート</guimenu>モジュール。</para>
   </listitem>
  </itemizedlist>
  <para>
   このコマンドラインツールは、デフォルトでインストールされるパッケージ<systemitem>supportutils</systemitem>によって提供されます。YaST<guimenu>サポート</guimenu>モジュールも、このコマンドラインツールが基になっています。
  </para>
  <para>
   システムにインストールされているパッケージに応じて、これらのパッケージの一部にSupportconfigプラグインが組み込まれています。Supportconfigを実行すると、すべてのプラグインも同様に実行され、アーカイブ用の1つ以上の結果ファイルが作成されます。これには、チェックされるトピックが特定のプラグインを含むものだけになるという利点があります。Supportconfigプラグインは、ディレクトリ<filename>/usr/lib/supportconfig/plugins/</filename>に格納されています。
  </para>

  <sect2 xml:id="sec-admsupport-supportconfig-sr">
   <title>サービス要求番号の作成</title>
   <para>
    Supportconfigアーカイブはいつでも生成できます。ただし、Supportconfigデータをグローバルテクニカルサポートに提出するには、まずサービス要求番号を生成する必要があります。サービス要求番号はアーカイブをサポートにアップロードするために必要です。
   </para>
   <para>
    サービス要求を作成するには、<link xlink:href="https://scc.suse.com/support/requests"/>にアクセスして、画面の指示に従います。サービス要求番号を書き留めます。
   </para>
   <note>
    <title>プライバシーポリシー</title>
    <para>
     SUSEは、システムレポートを機密データとして扱います。プライバシーに関する取り組みの詳細については、<link xlink:href="https://www.suse.com/company/policies/privacy/"/>を参照してください。
    </para>
   </note>
  </sect2>

  <sect2 xml:id="sec-admsupport-supportconfig-upload">
   <title>アップロード先</title>
   <para>
    サービス要求番号を作成したら、Supportconfigアーカイブをグローバルテクニカルサポートにアップロードできます。<xref linkend="pro-admsupport-submit-yast"/>または<xref linkend="pro-admsupport-submit-cli"/>を参照してください。次のいずれかのアップロードターゲットを使用します。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
     
      北米: FTP <link xlink:href="ftp://support-ftp.us.suse.com/incoming/"/>、FTPS <link xlink:href="ftps://support-ftp.us.suse.com/incoming/"/>
     </para>
    </listitem>
    <listitem>
     <para>
      EMEA (ヨーロッパ、中東、およびアフリカ): FTP <link xlink:href="ftp://support-ftp.emea.suse.com/incoming"/>、FTPS <link xlink:href="ftps://support-ftp.emea.suse.com/incoming"/>
     </para>
    </listitem>
   </itemizedlist>
   <para>
    または、サービス要求URL<link xlink:href="https://scc.suse.com/support/requests"/>を使用してTARアーカイブを手動でサービス要求に添付することもできます。
   </para>
  </sect2>

  <sect2 xml:id="sec-admsupport-yast">
   <title>YaSTでのSupportconfigアーカイブの作成</title>
   <para>
    YaSTでシステム情報を収集するには、次の手順に従います。<remark>2008-11-20 toms: YaST asks the user to open a URL as
     root(!). This happens when the users clicks on "Open" (Open
     Support Center/ This will start a browser with
     Support Center Portal). I do not think we should describe this
     and only *use* the above URL as a normal user for security
     reasons.</remark>
   </para>
   <procedure>
    <step>
     <para>
      YaSTを起動して、<guimenu>サポート</guimenu>モジュールを開きます。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2_support_main.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2_support_main.png" width="60%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step>
     <para>
      <guimenu>Create report tarball (レポートtarballを作成)</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      次のウィンドウで、ラジオボタンリストからSupportconfigオプションを1つ選択します。デフォルトでは、<guimenu>Use Custom (Expert) Settings (カスタム(エキスパート)設定を使用します)</guimenu>があらかじめ選択されています。最初にレポート機能をテストしたい場合は、<guimenu>Only gather a minimum amount of info (最小限の情報のみを収集する)</guimenu>を使用します。その他のオプションに関する詳細については、<command>supportconfig</command>のマニュアルページを参照してください。
     </para>
     <para>
      <guimenu>［次へ］</guimenu>をクリックします。
     </para>
    </step>
    <step xml:id="st-supportconfig-contact">
     <para>
      連絡先情報を入力します。この情報は<filename>basic-environment.txt</filename>ファイルに保存され、作成されるアーカイブに組み込まれます。
     </para>
    </step>
    <step xml:id="st-supportconfig-upload-target">
     <para>
      アーカイブをグローバルテクニカルサポートに送信する場合は、必須の<guimenu>情報のアップロード</guimenu>に入力します。YaSTによって自動的にアップロードサーバが提案されます。サーバを変更する場合、利用可能なアップロードサーバの詳細については、<xref linkend="sec-admsupport-supportconfig-upload"/>を参照してください。
     </para>
     <para>
      アーカイブを後で送信するには、<guimenu>情報のアップロード</guimenu>を空のままにします。
     </para>
    </step>
    <step>
     <para>
      <guimenu>次へ</guimenu>をクリックして、情報収集プロセスを開始します。
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2_support_conf.png" width="90%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2_support_conf.png" width="80%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <para>
      プロセスが完了したら、<guimenu>次へ</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      収集されたデータを確認するため、<guimenu>ファイル名</guimenu>から目的のファイルを選択して、そのコンテンツをYaSTで表示します。サポートへの送信前にTARアーカイブからファイルを削除するには、<guimenu>データから削除</guimenu>を使用します。<guimenu>［次へ］</guimenu>をクリックします。
     </para>
    </step>
    <step>
     <para>
      TARアーカイブを保存します。YaSTモジュールを<systemitem class="username">root</systemitem>ユーザとして起動した場合、アーカイブを<filename>/var/log</filename>に保存するよう求められます(そうでない場合はホームディレクトリ)。ファイル名の形式は、<filename>scc_<replaceable>HOST</replaceable>_<replaceable>DATE</replaceable>_<replaceable>TIME</replaceable>.tbz</filename>です。
     </para>
    </step>
    <step>
     <para>
      アーカイブをサポートに直接アップロードする場合は、<guimenu>ログファイルのtarアーカイブをURLへアップロード</guimenu>が有効になっていることを確認します。ここに表示される<guimenu>アップロード先</guimenu>は、<xref linkend="st-supportconfig-upload-target"/>でYaSTによって提案されたものです。アップロード先を変更するには、<xref linkend="sec-admsupport-supportconfig-upload"/>で使用可能なアップロードサーバを確認します。
     </para>
    </step>
    <step>
     <para>
      アップロードをスキップするには、<guimenu>ログファイルのtarアーカイブをURLへアップロード</guimenu>を無効にします。
     </para>
    </step>
    <step>
     <para>
      変更内容を確認し、YaSTモジュールを閉じます。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-admsupport-cli">
   <title>コマンドラインからのsupportconfigアーカイブの作成</title>
   <para>
    次の手順は、Supportconfigアーカイブをサポートに直接送信せずにアーカイブを作成する方法を示しています。アーカイブをアップロードするには、特定のオプションを指定してコマンドを実行する必要があります。<xref linkend="pro-admsupport-submit-cli"/>を参照してください。
   </para>
   <procedure>
    <step>
     <para>
      シェルを開き<systemitem class="username">root</systemitem>になります。
     </para>
    </step>
    <step>
     <para>
      <command>supportconfig</command>を実行します。通常は、このツールをオプションなしで実行するだけで十分です。よく使用される一部のオプションを、次のリストに示します。
     </para>
     <variablelist>
      <varlistentry>
       <term><option>-E <replaceable>MAIL</replaceable></option></term>
       <term><option>-N <replaceable>NAME</replaceable></option></term>
       <term><option>-O <replaceable>COMPANY</replaceable></option></term>
       <term><option>-P <replaceable>PHONE</replaceable></option></term>
       <listitem>
        <para>
         次の連絡先データを設定します: 。電子メールアドレス(<option>-E</option>)、会社名(<option>-O</option>)、名前(<option>-N</option>)、電話番号(<option>-P</option>)。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><option>-i <replaceable>KEYWORDS</replaceable></option></term>
       <term><option>-F</option></term>
       <listitem>
        <para>
         チェックする機能を制限します。プレースホルダ<replaceable>KEYWORDS</replaceable>は、大文字と小文字を区別したキーワードのカンマ区切りのリストです。<command>supportconfig -F</command>ですべてのキーワードのリストを取得します。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><option>-r <replaceable>SRNUMBER</replaceable></option></term>
       <listitem>
        <para>
         生成されたTARアーカイブをアップロードする際のサービス要求番号を定義します。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
    </step>
    <step>
     <para>
      ツールが操作を完了するまで待機します。
     </para>
    </step>
    <step>
     <para>
      デフォルトのアーカイブ場所は<filename>/var/log</filename>で、ファイル名の形式は<filename>scc_<replaceable>HOST</replaceable>_<replaceable>DATE</replaceable>_<replaceable>TIME</replaceable>.tbz</filename>です。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-admsupport-supportconfig-log">
   <title><command>supportconfig</command>の出力の理解</title>
   <para>
    <command>supportconfig</command>をYaSTを介して実行するか直接実行するかにかかわらず、このスクリプトは実行した内容の概要を示します。
   </para>
   <screen>                     Support Utilities - Supportconfig
                          Script Version: 3.0-98 
                          Script Date: 2017 06 01
[...]
Gathering system information
  Data Directory:    /var/log/scc_d251_180201_1525 <co xml:id="co-admsupport-script-datadir"/>

  Basic Server Health Check...                 Done <co xml:id="co-admsupport-script-done"/>
  RPM Database...                              Done <xref linkend="co-admsupport-script-done"/>
  Basic Environment...                         Done <xref linkend="co-admsupport-script-done"/>
  System Modules...                            Done <xref linkend="co-admsupport-script-done"/>
[...]
  File System List...                          Skipped <co xml:id="co-admsupport-script-skipped"/>
[...]
  Command History...                           Excluded <co xml:id="co-admsupport-script-excluded"/>
[...]
  Supportconfig Plugins:                       1 <co xml:id="co-admsupport-script-plugin"/>
    Plugin: pstree...                          Done
[...]
Creating Tar Ball

==[ DONE ]===================================================================
  Log file tar ball: /var/log/scc_d251_180201_1525.txz <co xml:id="co-admsupport-script-archive"/>
  Log file size:     732K
  Log file md5sum:   bf23e0e15e9382c49f92cbce46000d8b
=============================================================================</screen>
   <calloutlist>
    
    <callout arearefs="co-admsupport-script-datadir">
     <para>
      結果を格納する一時データディレクトリ。このディレクトリはtarファイルとしてアーカイブされています。<xref linkend="co-admsupport-script-archive"/>を参照してください。
     </para>
    </callout>
    <callout arearefs="co-admsupport-script-done">
     <para>
      この機能は(デフォルトで、または手動で選択されて)有効化され、正常に実行されました。結果はファイルに保存されます(<xref linkend="tab-admsupport-features-and-filenames"/>参照)。
     </para>
    </callout>
    <callout arearefs="co-admsupport-script-skipped">
     <para>
      1つ以上のRPMパッケージの一部のファイルが変更されたため、この機能はスキップされました。
     </para>
    </callout>
    <callout arearefs="co-admsupport-script-excluded">
     <para>
      この機能は<option>-x</option>オプションで選択解除されたため、除外されました。
     </para>
    </callout>
    <callout arearefs="co-admsupport-script-plugin">
     <para>
      スクリプトは1つのプラグインを見つけました。プラグイン<command>pstree</command>を実行します。このプラグインは、ディレクトリ<filename class="directory">/usr/lib/supportconfig/plugins/</filename>にありました。詳細については、マニュアルページを参照してください。
     </para>
    </callout>
    <callout arearefs="co-admsupport-script-archive">
     <para>
      アーカイブのtarファイル名。デフォルトでは<command>xz</command>で圧縮されています。
     </para>
    </callout>
   </calloutlist>
  </sect2>

  <sect2 xml:id="sec-admsupport-options">
   <title>supportconfigの一般的なオプション</title>
   <para>
    <command>supportconfig</command>ユーティリティは、通常、オプションなしで呼び出されます。<command>supportconfig</command> <option>-h</option>で、すべてのオプションを一覧表示するか、マニュアルページを参照してください。よくある使用事例については、次のリストで簡単に説明します。
   </para>
   <variablelist>
    <varlistentry>
     <term>収集する情報のサイズを削減する</term>
     <listitem>
      <para>
       最小オプション(<option>-m</option>)を使用します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -m</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>情報を特定のトピックに限定する</term>
     <listitem>
      <para>
       特定の領域または機能セットにのみ関係する問題をすでに特定している場合は、<command>supportconfig</command>の次回実行時に収集する情報を特定の領域に限定する必要があります。たとえば、LVMに関する問題を検出し、LVM設定に対して行った最近の変更をテストしたい場合などです。この場合、LVMのみに関する最低限のSupportconfig情報を収集することが理にかなっています。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -i LVM</screen>
      <para>
       追加のキーワードはカンマで区切ることができます。たとえば、追加のディスクテストの場合、次のようになります。
      </para>
      <screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -i LVM,DISK</screen>
      <para>
       収集する情報を特定の領域に限定する場合に使用できる機能のキーワードを網羅したリストについては、次のコマンドを実行します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -F</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>追加の連絡先情報を出力に含める</term>
     <listitem>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -E tux@example.org -N "Tux Penguin" -O "Penguin Inc." ...</screen>
      <para>
       (すべてを1行に記述)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ローテーション済みログファイルの収集</term>
     <listitem>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -l</screen>
      <para>
       これは、大規模なログを行う環境や、再起動後のsyslogによるログファイルのローテーション時にカーネルクラッシュが発生した場合に特に有効です。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
  <sect2 xml:id="sec-admsupport-log">
   <title>アーカイブコンテンツの概要</title>
   <para>
    TARアーカイブには、各種機能のすべての結果が含まれています。選択した内容(すべてまたは小さなセットのみ)に応じて、アーカイブに含まれるファイルの数は変わります。機能のセットは、<option>-i</option>オプションによって制限できます(<xref linkend="sec-admsupport-options"/>を参照)。
   </para>
   <para>
    アーカイブの内容を一覧表示するには、次の<command>tar</command>コマンドを使用します。
   </para>
   <screen><prompt role="root">root # </prompt><command>tar</command> xf /var/log/scc_earth_180131_1545.tbz</screen>
   <para>
    TARアーカイブ内には、次のファイル名のファイルが常にあります。
   </para>
   <variablelist>
    <title>アーカイブ内にある最低限のファイル</title>
    <varlistentry>
     <term><filename>basic-environment.txt</filename></term>
     <listitem>
      <para>このスクリプトが実行された日付と、ディストリビューションのバージョン、ハイパーバイザ情報などのシステム情報が記載されています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>basic-health-check.txt</filename></term>
     <listitem>
      <para>
       アップタイム、仮想メモリ統計、空きメモリとハードディスク、ゾンビプロセスのチェックなどの基本的なヘルスチェックが記載されています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>hardware.txt</filename></term>
     <listitem>
      <para>
       CPUアーキテクチャに関する情報、接続されているすべてのハードウェアのリスト、割り込み、I/Oポート、カーネルブートメッセージなどの基本的なハードウェアチェックが記載されています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>messages.txt</filename></term>
     <listitem>
      <para>
       システムジャーナルからのログメッセージが記載されています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>rpm.txt</filename></term>
     <listitem>
      <para>インストールされているすべてのRPMパッケージのリスト、名前、発信元、およびバージョンが記載されています。</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>summary.xml</filename></term>
     <listitem>
      <para>ディストリビューション、バージョン、製品固有のフラグメントなどのXML形式の情報が記載されています。</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>supportconfig.txt</filename></term>
     <listitem>
      <para>
       <command>supportconfig</command>スクリプト自体に関する情報が記載されています。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>y2log.txt</filename></term>
     <listitem>
      <para>
       特定のパッケージ、設定ファイル、ログファイルなどのYaST固有の情報が記載されています。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    <xref linkend="tab-admsupport-features-and-filenames"/>には、利用可能なすべての機能とそのファイル名が一覧表示されています。プラグインと同様に、追加のサービスパックでリストを拡張することができます。
   </para>
   <table xml:id="tab-admsupport-features-and-filenames">
    <title>TARアーカイブの機能とファイル名の比較</title>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>機能</entry>
       <entry>ファイル名</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry><parameter>APPARMOR</parameter></entry>
       <entry><filename>security-apparmor.txt</filename></entry>
      </row>
      <row>
       <entry><parameter>AUDIT</parameter></entry>
       <entry><filename>security-audit.txt</filename></entry>
      </row>
      <row>
       <entry><parameter>AUTOFS</parameter></entry>
       <entry><filename>fs-autofs.txt</filename></entry>
      </row>
      <row>
       <entry><parameter>BOOT</parameter></entry>
       <entry><filename>boot.txt</filename></entry>
      </row>
      <row>
       <entry><parameter>BTRFS</parameter></entry>
       <entry><filename>fs-btrfs.txt</filename></entry>
      </row>
      <row>
       <entry><parameter>DAEMONS</parameter></entry>
       <entry><filename>systemd.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>CIMOM</parameter></entry>
         <entry><filename>cimom.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>CRASH</parameter></entry>
         <entry><filename>crash.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>CRON</parameter></entry>
         <entry><filename>cron.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>DHCP</parameter></entry>
         <entry><filename>dhcp.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>DISK</parameter></entry>
         <entry><filename>fs-diskio.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>DNS</parameter></entry>
         <entry><filename>dns.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>DOCKER</parameter></entry>
         <entry><filename>docker.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>DRBD</parameter></entry>
         <entry><filename>drbd.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>ENV</parameter></entry>
         <entry><filename>env.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>ETC</parameter></entry>
         <entry><filename>etctxt</filename></entry>
      </row>
      <row>
         <entry><parameter>HA</parameter></entry>
         <entry><filename>ha.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>HAPROXY</parameter></entry>
         <entry><filename>haproxy.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>HISTORY</parameter></entry>
         <entry><filename>shell_history.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>IB</parameter></entry>
         <entry><filename>ib.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>IMAN</parameter></entry>
         <entry><filename>novell-iman.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>ISCSI</parameter></entry>
         <entry><filename>fs-iscsi.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>LDAP</parameter></entry>
         <entry><filename>ldap.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>LIVEPATCH</parameter></entry>
         <entry><filename>kernel-livepatch.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>LVM</parameter></entry>
         <entry><filename>lvm.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>MEM</parameter></entry>
         <entry><filename>memory.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>MOD</parameter></entry>
         <entry><filename>modules.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>MPIO</parameter></entry>
         <entry><filename>mpio.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>NET</parameter></entry>
         <entry><filename>network-*.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>NFS</parameter></entry>
         <entry><filename>nfs.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>NTP</parameter></entry>
         <entry><filename>ntp.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>NVME</parameter></entry>
         <entry><filename>nvme.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>OCFS2</parameter></entry>
         <entry><filename>ocfs2.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>OFILES</parameter></entry>
         <entry><filename>open-files.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>PRINT</parameter></entry>
         <entry><filename>print.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>PROC</parameter></entry>
         <entry><filename>proc.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SAR</parameter></entry>
         <entry><filename>sar.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SLERT</parameter></entry>
         <entry><filename>slert.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SLP</parameter></entry>
         <entry><filename>slp.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SMT</parameter></entry>
         <entry><filename>smt.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SMART</parameter></entry>
         <entry><filename>fs-smartmon.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SMB</parameter></entry>
         <entry><filename>samba.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SRAID</parameter></entry>
         <entry><filename>fs-softraid.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SSH</parameter></entry>
         <entry><filename>ssh.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SSSD</parameter></entry>
         <entry><filename>sssd.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SYSCONFIG</parameter></entry>
         <entry><filename>sysconfig.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>SYSFS</parameter></entry>
         <entry><filename>sysfs.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>TRANSACTIONAL</parameter></entry>
         <entry><filename>transactional-update.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>TUNED</parameter></entry>
         <entry><filename>tuned.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>UDEV</parameter></entry>
         <entry><filename>udev.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>UFILES</parameter></entry>
         <entry><filename>fs-files-additional.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>UP</parameter></entry>
         <entry><filename>updates.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>WEB</parameter></entry>
         <entry><filename>web.txt</filename></entry>
      </row>
      <row>
         <entry><parameter>X</parameter></entry>
         <entry><filename>x.txt</filename></entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  <remark>toms 2018-04-05: Make the table be aware of what packages brings
     what plugin?</remark>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-admsupport-submit">
  <title>グローバルテクニカルサポートへの情報の送信</title>

  <para>
   システム情報をグローバルテクニカルサポートへ送信するには、YaST<guimenu>サポート</guimenu>モジュールまたは<command>supportconfig</command>コマンドラインユーティリティを使用します。サーバに問題がありサポートの支援が必要な場合、まずサービス要求を開く必要があります。詳細については、<xref linkend="sec-admsupport-supportconfig-sr"/>を参照してください。
  </para>

  <para>
   次の例では、実際のサービス要求番号のプレースホルダとして<replaceable>12345678901</replaceable>を使用しています。<replaceable>12345678901</replaceable>は、<xref linkend="sec-admsupport-supportconfig-sr"/>で作成したサービス要求番号に置き換えてください。
  </para>

  <procedure xml:id="pro-admsupport-submit-yast">
   <title>YaSTを使用したサポートへの情報の送信</title>
   <para>
    次の手順は、Supportconfigアーカイブを作成済みであるものの、まだアップロードしていないことを想定しています。<xref linkend="sec-admsupport-yast"/>の<xref linkend="st-supportconfig-contact" xrefstyle="select:label nopage"/>で説明されているように、アーカイブに連絡先情報が含まれていることを確認してください。Supportconfigアーカイブの生成と送信を一度に行う方法については、<xref linkend="sec-admsupport-yast"/>を参照してください。
   </para>
   <step>
    <para>
     YaSTを起動して、<guimenu>サポート</guimenu>モジュールを開きます。
    </para>
   </step>
   <step>
    <para>
     <guimenu>アップロード</guimenu>をクリックします。
    </para>
   </step>
   <step>
    <para>
     既存のSupportconfigアーカイブのパスを<guimenu>Package with log files (ログファイルのあるパッケージ)</guimenu>に指定するか、<guimenu>参照</guimenu>をクリックしてアーカイブを参照します。
    </para>
   </step>
   <step xml:id="st-supportcfg-submit-upltarget">
    <para>
     YaSTによって自動的にアップロードサーバが提案されます。サーバを変更する場合、利用可能なアップロードサーバの詳細については、<xref linkend="sec-admsupport-supportconfig-upload"/>を参照してください。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="yast2_support_conf_upload.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="yast2_support_conf_upload.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <para>
     <remark>taroth 2014-04-11: this does not make sense to me - why does the
      YaST module *not* ask for the SR number now? and lets you continue after
      specifying an upload target (but no RC or customer info)? I would
      expect it to *check* if an SR has been entered and otherwise show an error
      message - filed http://bugzilla.suse.com/show_bug.cgi?id=880943 for this, unfortunately it
      was rejected for technical reasons</remark><guimenu>次へ</guimenu>で続行します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>完了</guimenu>をクリックします。
    </para>
   </step>
  </procedure>

  <procedure xml:id="pro-admsupport-submit-cli">
   <title>コマンドラインからのサポートへの情報の送信</title>
   <para>
    次の手順は、Supportconfigアーカイブを作成済みであるものの、まだアップロードしていないことを想定しています。Supportconfigアーカイブの生成と送信を一度に行う方法については、<xref linkend="sec-admsupport-yast"/>を参照してください。
   </para>
   <step>
    <para>
     インターネット接続のあるサーバの場合
    </para>
    <substeps performance="required">
     <step>
      <para>
       デフォルトのアップロードターゲットを使用するには、次を実行します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -ur <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       安全なアップロードターゲットには、次を使用します。
      </para>

<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -ar <replaceable>12345678901</replaceable></screen>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     インターネット接続の<emphasis>ない</emphasis>サーバの場合
    </para>
    <substeps performance="required">
     <step>
      <para>
       次を実行します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -r <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       <filename>/var/log/scc_<replaceable>SR12345678901</replaceable>*tbz</filename>アーカイブをいずれかのFTPサーバに手動でアップロードします。使用するサーバは世界のどの地域にいるかに応じて異なります。概要については、<xref linkend="sec-admsupport-supportconfig-upload"/>を参照してください。
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     FTPサーバの着信ディレクトリにTARアーカイブが届くと、お客様のサービス要求に自動的に添付されます。
    </para>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec-admsupport-sca">
  <title>システム情報の分析</title>

  <para>
   <command>supportconfig</command>で作成したシステムレポートで既知の問題がないかどうかを分析すると、問題の早期解決に役立ちます。このために、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では、<literal>Supportconfig Analysis</literal> (SCA)用のアプライアンスとコマンドラインツールの両方が提供されています。SCAアプライアンスは非対話型のサーバサイドツールです。SCAツール(パッケージ<package>sca-server-report</package>によって提供される<command>scatool</command>)は、クライアント側で実行され、コマンドラインから実行されます。どちらのツールも、関係するサーバからのSupportconfigアーカイブを分析します。サーバでの初回の分析は、SCAアプライアンス、または<command>scatool</command>が実行されているワークステーションで行われます。分析サイクルは運用サーバ上では実行されません。
  </para>

  <para>
   アプライアンスとコマンドラインツールのどちらにも、関連する製品のSupportconfig出力を分析できるようにする製品固有のパターンが追加で必要になります。各パターンは、特定の既知の問題がないかどうかSupportconfigアーカイブを解析して評価するスクリプトです。パターンはRPMパッケージとして提供されます。
  </para>

  <para>
   独自のパターンを開発することもできます。これについては、<xref linkend="sec-admsupport-sca-patterns"/>で簡単に説明されています。
  </para>

  <sect2 xml:id="sec-admsupport-sca-tool">
   <title>SCAコマンドラインツール</title>
   <para>
    SCAコマンドラインツールでは、<command>supportconfig</command>と、ローカルマシンにインストールされている特定の製品用の分析パターンの両方を使用してローカルマシンを分析できます。分析結果を示すHTMLレポートが作成されます。例については、<xref linkend="fig-scatool-html"/>を参照してください。
   </para>
   <figure xml:id="fig-scatool-html">
    <title>SCAツールによって生成されるHTMLレポート</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    <command>scatool</command>コマンドは<package>sca-server-report</package>パッケージで提供されます。デフォルトではインストールされません。さらに、<package>sca-patterns-base</package>パッケージ、および<command>scatool</command>コマンドを実行するマシンにインストールされている製品に一致する製品固有の<package>sca-patterns-*</package>パッケージも必要です。
   </para>
   <para>
    <command>scatool</command>コマンドは、<systemitem class="username">root</systemitem>ユーザとして実行するか、<command>sudo</command>を使用して実行します。SCAツールを呼び出すときに、既存の<command>supportconfig</command> TARアーカイブを分析するか、新しいアーカイブの生成と分析を同時に行います。このツールには、タブ補完機能を備えた対話型コンソールも用意されています。外部マシン上で<command>supportconfig</command>を実行し、ローカルマシン上でその後の分析を実行することが可能です。
   </para>
   <para>
    次に、コマンドの例をいくつか示します。
   </para>
   <variablelist>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option>
     </term>
     <listitem>
      <para>
       <command>supportconfig</command>を呼び出し、ローカルマシン上に新しいSupportconfigアーカイブを生成します。インストール済み製品に一致するSCA分析パターンを適用して、既知の問題がないかどうかアーカイブを分析します。分析結果から生成されたHTMLレポートのパスが表示されます。レポートは通常、Supportconfigアーカイブのあるディレクトリと同じディレクトリに書き込まれます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option> <option>-o</option> <replaceable>/opt/sca/reports/</replaceable> 
     </term>
     <listitem>
      <para>
       <command>sudo scatool </command> <option>-s</option>と同じですが、HTMLレポートは<option>-o</option>で指定したパスに書き込まれる点が異なります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>PATH_TO_TARBALL_OR_DIR</replaceable> 
     </term>
     <listitem>
      <para>
       指定したSupportconfigアーカイブファイル(またはSupportconfigアーカイブの展開先の指定ディレクトリ)を分析します。生成されたHTMLレポートは、Supportconfigアーカイブまたはディレクトリと同じ場所に保存されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>SLES_SERVER.COMPANY.COM</replaceable> 
     </term>
     <listitem>
      <para>
       外部サーバ<replaceable>SLES_SERVER.COMPANY.COM</replaceable>とのSSH接続を確立し、そのサーバ上で<command>supportconfig</command>を実行します。その後、Supportconfigアーカイブをローカルマシンにコピーし、そこで分析を行います。生成されたHTMLレポートは、デフォルトの<filename>/var/log</filename>ディレクトリに保存されます(<replaceable>SLES_SERVER.COMPANY.COM</replaceable>にはSupportconfigアーカイブのみが作成されます)。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-c</option>
     </term>
     <listitem>
      <para>
       <command>scatool</command>の対話型コンソールを起動します。利用可能なコマンドを参照するには、<keycap function="tab"/>を2回押します。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    他のオプションおよび詳細については、<command>sudo scatool -h</command>を実行するか、<command>scatool</command>のマニュアルページを参照してください。
   </para>
  </sect2>

  <sect2 xml:id="sec-admsupport-sca-appliance">
   <title>SCAアプライアンス</title>
   <para>
    Supportconfigアーカイブの分析にSCAアプライアンスを使用する場合は、専用のサーバ(または仮想マシン)をSCAアプライアンスサーバとして設定します。このSCAアプライアンスサーバを使用して、エンタープライズ内にある、SUSE Linux Enterprise ServerまたはSUSE Linux Enterprise Desktopが稼働するすべてのマシンからのSupportconfigアーカイブを分析できます。Supportconfigアーカイブをアプライアンスサーバにアップロードするだけで分析を行うことができます。対話操作は必要ありません。MariaDBデータベースでは、SCAアプライアンスは、解析済みのSupportconfigアーカイブをすべて追跡します。アプライアンスのWebインタフェースからSCAレポートを直接参照できます。アプライアンスから管理者ユーザに電子メールでHTMLレポートを送信することもできます。詳細については、<xref linkend="sec-admsupport-sca-appliance-config-mail"/>を参照してください。
   </para>
   <sect3 xml:id="sec-admsupport-sca-appliance-installquick">
    <title>インストールのクイックスタート</title>
    <para>
     コマンドラインから短時間でSCAアプライアンスをインストールしてセットアップするには、この手順に従います。この手順は上級者向けで、ベアインストールとセットアップコマンドに焦点を当てています。詳しい説明については、<xref linkend="sec-admsupport-sca-appliance-pre"/>～<xref linkend="sec-admsupport-sca-appliance-install"/>を参照してください。
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <title>前提条件</title>
     <listitem>
      <para>
       WebおよびLAMPパターン
      </para>
     </listitem>
     <listitem>
      <para>
       Webおよびスクリプティングモジュール(このモジュールを選択できるようにするにはマシンを登録する必要があります)
      </para>
     </listitem>
    </itemizedlist>
    <note>
     <title><systemitem class="username">root</systemitem>特権が必要</title>
     <para>
      次のプロシージャのコマンドはすべて<systemitem class="username">root</systemitem>として実行される必要があります。
     </para>
    </note>
    <procedure>
     <title>アップロードに匿名FTPを使用するインストール</title>
     <para>
      アプライアンスをセットアップして稼働させた後は、手動での対話操作は必要ありません。したがって、cronジョブを使用してSupportconfigアーカイブを作成およびアップロードするには、この方法でアプライアンスをセットアップするのが理想的です。
     </para>
     <step>
      <para>
       アプライアンスをインストールするマシンで、コンソールにログインして、次のコマンドを実行します(推奨パッケージを受け入れてください)。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> zypper install sca-appliance-* sca-patterns-* \
vsftpd yast2 yast2-ftp-server
<prompt>tux &gt; </prompt><command>sudo</command> systemctl enable apache2
<prompt>tux &gt; </prompt><command>sudo</command> systemctl start apache2
<prompt>tux &gt; </prompt><command>sudo</command> systemctl enable vsftpd
<prompt>tux &gt; </prompt><command>sudo</command> systemctl start vsftpd
<prompt>tux &gt; </prompt><command>sudo</command> yast ftp-server</screen>
     </step>
     <step>
      <para>
       YaST FTPサーバで、<menuchoice>
       <guimenu>Authentication (認証)</guimenu> <guimenu>Enable Upload (アップロードの有効化)</guimenu>
       <guimenu>Anonymous Can Upload (匿名ユーザのアップロード許可)</guimenu> <guimenu>完了</guimenu>
       <guimenu>はい</guimenu> </menuchoice>の順に選択し、<guimenu>/srv/ftp/upload</guimenu>を作成します。
      </para>
     </step>
     <step>
      <para>
       次のコマンドを実行します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> systemctl enable mysql
<prompt>tux &gt; </prompt><command>sudo</command> systemctl start mysql
<prompt>tux &gt; </prompt><command>sudo</command> mysql_secure_installation
<prompt>tux &gt; </prompt><command>sudo</command> setup-sca -f</screen>
      <para>
       このmysql_secure_installationにより、MariaDBの<systemitem class="username">root</systemitem>パスワードが作成されます。
      </para>
     </step>
    </procedure>
    <procedure>
     <title>アップロードにSCP/tmpを使用するインストール</title>
     <para>
      この方法でアプライアンスをセットアップするには、SSHパスワードを入力する際に手動での対話操作が必要になります。
     </para>
     <step>
      <para>
       アプライアンスをインストールするマシンでコンソールにログインします。
      </para>
     </step>
     <step>
      <para>
       次のコマンドを実行します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> zypper install sca-appliance-* sca-patterns-*
<prompt>tux &gt; </prompt><command>sudo</command> systemctl enable apache2
<prompt>tux &gt; </prompt><command>sudo</command> systemctl start apache2
<prompt>tux &gt; </prompt><command>sudo</command> sudo systemctl enable mysql
<prompt>tux &gt; </prompt><command>sudo</command> systemctl start mysql
<prompt>tux &gt; </prompt><command>sudo</command> mysql_secure_installation
<prompt>tux &gt; </prompt><command>sudo</command> setup-sca</screen>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="sec-admsupport-sca-appliance-pre">
    <title>前提条件</title>
    <para>
     SCAアプライアンスサーバを実行するには、次の前提条件が必要です。
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       すべての<systemitem>sca-appliance-*</systemitem>パッケージ。
      </para>
     </listitem>
     <listitem>
      <para>
       <systemitem class="resource">sca-patterns-base</systemitem>パッケージ。さらに、アプライアンスで分析するSupportconfigアーカイブのタイプに合った、製品固有の<systemitem class="resource">sca-patterns-*</systemitem>。
      </para>
     </listitem>
     <listitem>
      <para>
       Apache
      </para>
     </listitem>
     <listitem>
      <para>
       PHP
      </para>
     </listitem>
     <listitem>
      <para>
       MariaDB
      </para>
     </listitem>
     <listitem>
      <para>
       匿名FTPサーバ(オプション)
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="sec-admsupport-sca-appliance-install">
    <title>インストールと基本セットアップ</title>
    <para>
     <xref linkend="sec-admsupport-sca-appliance-pre"/>に記載されているように、SCAアプライアンスには他のパッケージに対する依存関係がいくつかあります。そのため、SCAアプライアンスサーバをインストールしてセットアップする前に、次の手順で準備を行う必要があります。
    </para>
    <procedure>
     <step>
      <para>
       ApacheおよびMariaDBに対して、<systemitem>Web</systemitem>および<systemitem>LAMP</systemitem>インストールパターンをインストールします。
      </para>
     </step>
     <step>
      <para>
       Apache、MariaDB、および匿名FTPサーバ(オプション)をセットアップします。<phrase os="sles">詳細については、<xref linkend="cha-apache2"/>と<xref linkend="cha-ftp"/>を参照してください。</phrase>
      </para>
     </step>
     <step>
      <para>
       ApacheおよびMariaDBをブート時に起動するように設定します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> systemctl enable apache2 mysql</screen>
     </step>
     <step>
      <para>
       両方のサービスを開始します。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> systemctl start apache2 mysql</screen>
     </step>
    </procedure>
    <para>
     これで、<xref linkend="pro-sca-appl-install"/>の説明に従ってSCAアプライアンスをインストールしてセットアップできます。
    </para>
    <procedure xml:id="pro-sca-appl-install">
     <title>SCAアプライアンスのインストールと設定</title>
     <para>
      パッケージをインストールしたら、<command>setup-sca</command>スクリプトを使用して、SCAアプライアンスが使用するMariaDBの管理およびレポートデータベースの基本設定を行います。
     </para>
     <para>
      このスクリプトを使用して、マシンからSCAアプライアンスにSupportconfigアーカイブをアップロードするための次のオプションを設定できます。
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <command>scp</command>
       </para>
      </listitem>
      <listitem>
       <para>
        匿名FTPサーバ
       </para>
      </listitem>
     </itemizedlist>
     <step>
      <para>
       アプライアンスとSCA基本パターンライブラリをインストールします。
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> zypper install sca-appliance-* sca-patterns-base</screen>
     </step>
     <step>
      <para>
       さらに、分析するSupportconfigアーカイブのタイプに合ったパターンパッケージをインストールします。たとえば、現在の環境にSUSE Linux Enterprise Server 12のサーバとSUSE Linux Enterprise Server 15のサーバがある場合、<systemitem>sca-patterns-sle12</systemitem>パッケージと<systemitem>sca-patterns-sle15</systemitem>パッケージの両方をインストールします。
      </para>
      <para>
       利用可能なすべてのパターンをインストールする
      </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> zypper install sca-patterns-*</screen>
     </step>
     <step>
      <para>
       SCAアプライアンスの基本セットアップには、<command>setup-sca</command>スクリプトを使用します。スクリプトの呼び出し方法は、SupportconfigアーカイブをどのようにSCAアプライアンスサーバにアップロードするかによって異なります。
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         <filename>/srv/ftp/upload</filename>ディレクトリを使用する匿名FTPサーバを設定済みの場合は、<option>-f</option>オプションを指定してセットアップスクリプトを実行します。画面の指示に従います。
        </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> setup-sca -f</screen>
        <note>
         <title>別のディレクトリを使用するFTPサーバ</title>
         <para>
          FTPサーバで<filename>/srv/ftp/upload</filename>以外のディレクトリを使用する場合は、まず、正しいディレクトリを指すように環境設定ファイル<filename>/etc/sca/sdagent.conf</filename>および<filename>/etc/sca/sdbroker.conf</filename>を調整します。
         </para>
        </note>
       </listitem>
       <listitem>
        <para>
         <filename>scp</filename>を使用してSupportconfigファイルをSCAアプライアンスサーバの<command>/tmp</command>ディレクトリにアップロードする場合は、パラメータを指定せずにセットアップスクリプトを呼び出します。画面の指示に従います。
        </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> setup-sca</screen>
       </listitem>
      </itemizedlist>
      <para>
       セットアップスクリプトは要件チェックをいくつか実行し、必要なコンポーネントを設定します。2つのパスワードを入力するようプロンプトが表示されます。1つは、セットアップ済みのMariaDBのMySQL <systemitem class="username">root</systemitem>パスワードで、もう1つは、SCAアプライアンスのWebインタフェースにログインするために使用するWebユーザのパスワードです。
      </para>
     </step>
     <step>
      <para>
       既存のMariaDBの<systemitem class="username">root</systemitem>パスワードを入力します。これにより、SCAアプライアンスがMariaDBに接続できるようになります。
      </para>
     </step>
     <step>
      <para>
       Webユーザのパスワードを定義します。パスワードは<filename>/srv/www/htdocs/sca/web-config.php</filename>に書き込まれ、ユーザ<systemitem class="username">scdiag</systemitem>のパスワードとして設定されます。ユーザ名とパスワードは後で随時変更できます。<xref linkend="sec-admsupport-sca-appliance-config-passwd"/>を参照してください。
      </para>

     </step>
    </procedure>
    <para>
     インストールとセットアップが正常に完了したら、すぐにSCAアプライアンスを使用できます。<xref linkend="sec-admsupport-sca-appliance-use"/>を参照してください。ただし、Webインタフェースのパスワードの変更、SCAパターンのアップデートのソースの変更、アーカイブモードの有効化、電子メール通知の設定など、一部のオプションを変更する必要があります。詳細については、<xref linkend="sec-admsupport-sca-appliance-config"/>を参照してください。
    </para>
    <warning>
     <title>データの保護</title>
     <para>
      SCAアプライアンスサーバのレポートには、セキュリティ関連の情報が含まれているため、SCAアプライアンスサーバ上のデータが不正なアクセスから確実に保護されるようにしてください。
     </para>
    </warning>
   </sect3>
   <sect3 xml:id="sec-admsupport-sca-appliance-use">
    <title>SCAアプライアンスの使用</title>
    <para>
     既存のSupportconfigアーカイブをSCAアプライアンスに手動でアップロードすることも、1つのステップで新しいSupportconfigアーカイブを作成してSCAアプライアンスにアップロードすることもできます。アップロードはFTPまたはSCP経由で行うことができます。どちらの場合も、SCAアプライアンスに接続できるURLが分かっている必要があります。FTP経由でのアップロードの場合、FTPサーバをSCAアプライアンス用に設定する必要があります。<xref linkend="pro-sca-appl-install"/>を参照してください。
    </para>
    <sect4 xml:id="sec-admsupport-sca-appliance-use-upload">
     <title>SCAアプライアンスへのSupportconfigアーカイブのアップロード</title>
     <para/>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Supportconfigアーカイブを作成して(匿名) FTP経由でアップロードするには、次の手順に従います。
       </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -U “ftp://<replaceable>SCA-APPLIANCE.COMPANY.COM</replaceable>/upload”</screen>
      </listitem>
      <listitem>
       <para>
        Supportconfigアーカイブを作成してSCP経由でアップロードするには、次の手順に従います。
       </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> supportconfig -U “scp://<replaceable>SCA-APPLIANCE.COMPANY.COM</replaceable>/tmp”</screen>
       <para>
        SCAアプライアンスが動作しているサーバの<systemitem class="username">root</systemitem>ユーザのパスワードを入力するようプロンプトが表示されます。
       </para>
      </listitem>
      <listitem>
       <para>
        1つまたは複数のアーカイブを手動でアップロードする場合は、既存のアーカイブファイル(通常は<filename>/var/log/scc_*.tbz</filename>にあります)をSCAアプライアンスにコピーします。アップロード先には、アプライアンスサーバの<filename>/tmp</filename>ディレクトリまたは<filename>/srv/ftp/upload</filename>ディレクトリ(FTPがSCAアプライアンスサーバ用に設定されている場合)を使用します。
       </para>
      </listitem>
     </itemizedlist>
    </sect4>
    <sect4 xml:id="sec-admsupport-sca-appliance-use-view">
     <title>SCAレポートの表示</title>
     <para>
      SCAレポートは、ブラウザがインストールされていて、SCAアプライアンスのレポートインデックスページにアクセス可能な任意のマシンから表示できます。
     </para>
     <procedure>
      <step>
       <para>
        Webブラウザを起動し、JavaScriptとCookieが有効なことを確認します。
       </para>
      </step>
      <step>
       <para>
        URLとして、SCAアプライアンスのレポートインデックスページを入力します。
       </para>
<screen>https://sca-appliance.company.com/sca</screen>
       <para>
        不確かな場合は、システム管理者に問い合わせてください。
       </para>
      </step>
      <step>
       <para>
        ログインするためのユーザ名とパスワードを入力するようプロンプトが表示されます。
       </para>
       <figure xml:id="fig-sca-appl-html">
        <title>SCAアプライアンスによって生成されるHTMLレポート</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </step>
      <step>
       <para>
        ログイン後、参照するレポートの日付をクリックします。
       </para>
      </step>
      <step>
       <para>
        最初に<guimenu>Basic Health (基本的なヘルス)</guimenu>カテゴリをクリックして展開します。
       </para>
      </step>
      <step>
       <para>
        <guimenu>Message (メッセージ)</guimenu>列で、個々のエントリをクリックします。SUSE Knowledgebaseの対応する記事が開きます。提案された解決方法を読み、指示に従います。
       </para>
      </step>
      <step>
       <para>
        <guimenu>Supportconfig Analysis Report (Supportconfig分析レポート)</guimenu>の<guimenu>Solutions (解決方法)</guimenu>列に追加エントリが表示されている場合は、それらをクリックします。提案された解決方法を読み、指示に従います。
       </para>
      </step>
      <step>
       <para>
        SCAによって特定された問題に直接関係する結果については、SUSE Knowledgebase (<link xlink:href="https://www.suse.com/support/kb/"/>)を確認してください。問題解決に取り組みます。
       </para>
      </step>
      <step>
       <para>
        問題の再発防止のために事前に対処できる結果がないかどうかを確認します。
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec-admsupport-sca-appliance-config">
    <title>SCAアプライアンスのカスタマイズ</title>
    <para>
     次の項では、Webインタフェースのパスワードを変更する方法、SCAパターンアップデートのソースを変更する方法、アーカイブモードを有効にする方法、および電子メール通知を設定する方法について説明します。
    </para>
    <sect4 xml:id="sec-admsupport-sca-appliance-config-passwd">
     <title>Webインタフェースのパスワード</title>
     <para>
      SCAアプライアンスのWebインタフェースにログインするには、ユーザ名とパスワードが必要です。デフォルトのユーザ名は<literal>scdiag</literal>で、デフォルトのパスワードは<literal>linux</literal>です(特に指定されていない場合。<xref linkend="pro-sca-appl-install"/>を参照してください)。パスワードを保護するため、デフォルトのパスワードはできる限り速やかに変更してください。ユーザ名を変更することもできます。
     </para>
     <procedure xml:id="pro-sca-passwd-change">
      <title>Webインタフェースのユーザ名またはパスワードの変更</title>
      <step>
       <para>
        SCAアプライアンスサーバのシステムコンソールで<systemitem class="username">root</systemitem>ユーザとしてログインします。
       </para>
      </step>
      <step>
       <para>
        エディタで<filename>/srv/www/htdocs/sca/web-config.php</filename>を開きます。
       </para>
      </step>
      <step>
       <para>
        必要に応じて、<literal>$username</literal>および<literal>$password</literal>の値を変更します。
       </para>
      </step>
      <step>
       <para>
        ファイルを保存して終了します。
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec-admsupport-sca-appliance-config-upd">
     <title>SCAパターンのアップデート</title>
     <para>
      デフォルトでは、すべての<systemitem class="resource">sca-patterns-*</systemitem>パッケージは<systemitem class="username">root</systemitem> cronジョブによって定期的にアップデートされます。このジョブは夜間に<filename>sdagent-patterns</filename>スクリプトを実行し、このスクリプトが<command>zypper update sca-patterns-*</command>を実行します。定期的なシステムアップデートにより、SCAアプライアンスおよびパターンのすべてのパッケージがアップデートされます。SCAアプライアンスとパターンを手動でアップデートするには、以下を実行します。
     </para>
<screen><prompt>tux &gt; </prompt><command>sudo</command> zypper update sca-*</screen>
     <para>
      デフォルトでは、アップデートはSUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled">15 SP3</phrase></phrase>のアップデートリポジトリからインストールされます。必要に応じて、アップデートのソースをRMTサーバに変更できます。<filename>sdagent-patterns</filename>は、<command>zypper update sca-patterns-*</command>を実行する際に、現在設定されているアップデートチャネルからアップデートを取得します。このチャネルがRMTサーバにある場合、パッケージはそこから取得されます。
     </para>
     <procedure>
      <title>SCAパターンの自動アップデートの無効化</title>
      <step>
       <para>
        SCAアプライアンスサーバのシステムコンソールで<systemitem class="username">root</systemitem>ユーザとしてログインします。
       </para>
      </step>
      <step>
       <para>

        エディタで<filename>/etc/sca/sdagent-patterns.conf</filename>を開きます。
       </para>
      </step>
      <step>
       <para>
        次のエントリを変更します。
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=1</screen>
       <para>
        次のように変更してください。
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=0</screen>
      </step>
      <step>
       <para>
        ファイルを保存して終了します。変更を適用するためにマシンを再起動する必要はありません。
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec-admsupport-sca-appliance-config-archive">
     <title>アーカイブモード</title>
     <para>
      Supportconfigアーカイブの分析が終了し、その結果がMariaDBデータベースに保存されると、アーカイブはすべてSCAアプライアンスから削除されます。ただし、トラブルシューティングのために、マシンからのSupportconfigアーカイブのコピーを保持しておくと便利です。デフォルトでは、アーカイブモードは無効になっています。
     </para>
     <procedure>
      <title>SCAアプライアンスのアーカイブモードの有効化</title>
      <step>
       <para>
        SCAアプライアンスサーバのシステムコンソールで<systemitem class="username">root</systemitem>ユーザとしてログインします。
       </para>
      </step>
      <step>
       <para>
        エディタで<filename>/etc/sca/sdagent.conf</filename>を開きます。
       </para>
      </step>
      <step>
       <para>
        次のエントリを変更します。
       </para>
<screen>ARCHIVE_MODE=0</screen>
       <para>
        次のように変更してください。
       </para>
<screen>ARCHIVE_MODE=1</screen>
      </step>
      <step>
       <para>
        ファイルを保存して終了します。変更を適用するためにマシンを再起動する必要はありません。
       </para>
      </step>
     </procedure>
     <para>
      アーカイブモードを有効にすると、SCAアプライアンスはSupportconfigファイルを削除せずに、<filename>/var/log/archives/saved</filename>ディレクトリに保存します。
     </para>
    </sect4>
    <sect4 xml:id="sec-admsupport-sca-appliance-config-mail">
     <title>電子メールでのSCAレポートの送信</title>
     <para>
      分析された各SupportconfigのレポートHTMLファイルを、SCAアプライアンスから電子メールで送信できます。デフォルトでは、この機能は無効になっています。有効にすると、レポートの送信先となる電子メールアドレスのリストを定義できます。レポートの送信をトリガするステータスメッセージのレベル(<literal>STATUS_NOTIFY_LEVEL</literal>)を定義します。
     </para>
     <variablelist xml:id="vl-sca-mails-notify-level">
      <title><literal>STATUS_NOTIFY_LEVEL</literal>に指定可能な値</title>
      <varlistentry>
       <term>$STATUS_OFF</term>
       <listitem>
        <para>
         HTMLレポートの送信を無効にします。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_CRITICAL</term>
       <listitem>
        <para>
         CRITICALが含まれるSCAレポートのみを送信します。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_WARNING </term>
       <listitem>
        <para>
         WARNINGまたはCRITICALが含まれるSCAレポートのみを送信します。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_RECOMMEND</term>
       <listitem>
        <para>
         RECOMMEND、WARNING、またはCRITICALが含まれるSCAレポートのみを送信します。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_SUCCESS</term>
       <listitem>
        <para>
         SUCCESS、RECOMMEND、WARNING、またはCRITICALが含まれるSCAレポートを送信します。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <procedure>
      <title>SCAレポートの電子メール通知の設定</title>
      <step>
       <para>
        SCAアプライアンスサーバのシステムコンソールで<systemitem class="username">root</systemitem>ユーザとしてログインします。
       </para>
      </step>
      <step>
       <para>
        エディタで<filename>/etc/sca/sdagent.conf</filename>を開きます。
       </para>
      </step>
      <step>
       <para>
        <systemitem>STATUS_NOTIFY_LEVEL</systemitem>というエントリを探します。デフォルトでは、これは<literal>$STATUS_OFF</literal>に設定されています(電子メール通知は無効です)。
       </para>
      </step>
      <step>
       <para>
        電子メール通知を有効にするには、<literal>$STATUS_OFF</literal>を、電子メールレポートを要求するステータスメッセージのレベルに変更します。次に例を示します。
       </para>
<screen>STATUS_NOTIFY_LEVEL=$STATUS_SUCCESS</screen>
       <para>
        詳細については、<xref linkend="vl-sca-mails-notify-level"/>を参照してください。
       </para>
      </step>
      <step>
       <para>
        レポートの送信先の受信者リストを定義する
       </para>
       <substeps performance="required">
        <step>
         <para>
          <literal>EMAIL_REPORT='root'</literal>というエントリを探します。
         </para>
        </step>
        <step>
         <para>
          <literal>root</literal>を、SCAレポートの送信先電子メールアドレスのリストに置き換えます。複数の電子メールアドレスはそれぞれスペースで区切る必要があります。例:
         </para>
<screen>EMAIL_REPORT='tux@my.company.com wilber@your.company.com'</screen>
        </step>
       </substeps>
      </step>
      <step>
       <para>
        ファイルを保存して終了します。変更を適用するためにマシンを再起動する必要はありません。今後、すべてのSCAレポートは指定したアドレスに電子メールで送信されます。
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec-admsupport-sca-appliance-backup">
    <title>データベースのバックアップと復元</title>
    <para>
     SCAレポートが保存されているMariaDBデータベースをバックアップおよび復元するには、次の説明に従って<command>scadb</command>コマンドを使用します。<command>scadb</command>は、パッケージ<package>sca-appliance-broker</package>によって提供されます。
    </para>
    <procedure>
     <title>データベースのバックアップ</title>
     <step>
      <para>
       SCAアプライアンスが動作しているサーバのシステムコンソールで、<systemitem class="username">root</systemitem>ユーザとしてログインします。
      </para>
     </step>
     <step>
      <para>
       次のコマンドを実行してアプライアンスを保守モードにします。
      </para>
<screen><prompt role="root">root # </prompt>scadb maint</screen>
     </step>
     <step>
      <para>
       次のコマンドを実行してバックアップを開始します。
      </para>
<screen><prompt role="root">root # </prompt>scadb backup</screen>
      <para>
       データはTARアーカイブ<filename>sca-backup-*sql.gz</filename>に保存されます。
      </para>
     </step>
     <step>
      <para>
       パターン作成データベースを使用して独自のパターンを開発している場合は(<xref linkend="sec-admsupport-sca-patterns"/>を参照)、そのデータもバックアップします。
      </para>
<screen><prompt role="root">root # </prompt>sdpdb backup</screen>
      <para>
       データはTARアーカイブ<filename>sdp-backup-*sql.gz</filename>に保存されます。
      </para>
     </step>
     <step>
      <para>
       次のデータを別のマシンまたは外部ストレージメディアにコピーします。
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         <filename>sca-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>sdp-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>/usr/lib/sca/patterns/local</filename> (カスタムパターンを作成している場合にのみ必要)
        </para>
       </listitem>
      </itemizedlist>
     </step>
     <step>
      <para>
       次のコマンドを実行してSCAアプライアンスを再び有効にします。
      </para>
<screen><prompt role="root">root # </prompt>scadb reset agents</screen>
     </step>
    </procedure>
    <procedure>
     <title>データベースの復元</title>
     <para>
      バックアップからデータベースを復元するには、次の手順に従います。
     </para>
     <step>
      <para>
       SCAアプライアンスが動作しているサーバのシステムコンソールで、<systemitem class="username">root</systemitem>ユーザとしてログインします。
      </para>
     </step>
     <step>
      <para>
       最も新しい<filename>sca-backup-*sql.gz</filename>および<filename>sdp-backup-*sql.gz</filename> TARアーカイブをSCAアプライアンスサーバにコピーします。
      </para>
     </step>
     <step>
      <para>
       ファイルを圧縮解除するため、次のコマンドを実行します。
      </para>
<screen><prompt role="root">root # </prompt>gzip -d *-backup-*sql.gz</screen>
     </step>
     <step>
      <para>
       データをデータベースにインポートするため、次のコマンドを実行します。
      </para>
<screen><prompt role="root">root # </prompt>scadb import sca-backup-*sql</screen>
     </step>
     <step>
      <para>
       パターン作成データベースを使用して独自のパターンを開発している場合、次のデータもインポートします。
      </para>
<screen><prompt role="root">root # </prompt>sdpdb import sdp-backup-*sql</screen>
     </step>
     <step>
      <para>
       カスタムパターンを使用している場合は、<filename>/usr/lib/sca/patterns/local</filename>もバックアップデータから復元します。
      </para>
     </step>
     <step>
      <para>
       次のコマンドを実行してSCAアプライアンスを再び有効にします。
      </para>
<screen><prompt role="root">root # </prompt>scadb reset agents</screen>
     </step>
     <step>
      <para>
       データベース内のパターンモジュールを更新します。
      </para>
<screen><prompt role="root">root # </prompt>sdagent-patterns -u</screen>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 xml:id="sec-admsupport-sca-patterns">
   <title>カスタム分析パターンの開発</title>
   <para>
    SCAアプライアンスには、独自のカスタムパターンの開発を可能にする、充実したパターン開発環境(SCA Pattern Database)が付属しています。パターンは、どのプログラム言語でも作成できます。パターンをSupportconfig分析プロセスで利用できるようにするには、<filename>/usr/lib/sca/patterns/local</filename>に保存し、実行可能にする必要があります。SCAアプライアンスとSCAツールのどちらも、分析レポートの一部として、新しいSupportconfigアーカイブに照らしてカスタムパターンを実行します。独自のパターンを作成(およびテスト)する方法の詳細については、<link xlink:href="https://www.suse.com/c/blog/sca-pattern-development/"/>を参照してください。
   </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec-admsupport-install">
  <title>インストール時の情報収集</title>
  <para>
   インストール時には、<command>supportconfig</command>を使用できません。ただし、<command>save_y2logs</command>を使用してYaSTからログファイルを収集することができます。このコマンドにより、<filename>/tmp</filename>ディレクトリに<filename>.tar.xz</filename>アーカイブが作成されます。
  </para>
  
  <para>
   インストールの開始直後に問題が発生したときは、<command>linuxrc</command>で作成したログファイルから情報を収集できる場合があります。<command>linuxrc</command>は、YaSTが起動する前に実行される小さなコマンドです。このログファイルは、<filename>/var/log/linuxrc.log</filename>にあります。
  </para>
  <important>
   <title>インストールログファイルがインストールしたシステムにない</title>
   <para>
    インストール時に使用可能だったログファイルが、インストールしたシステムでは使用できなくなってしまいました。インストーラの実行中に、インストールログファイルを正しく保存してください。
   </para>
  </important>
 </sect1>

 <sect1 xml:id="sec-admsupport-kernel">
  <title>カーネルモジュールのサポート</title>

  <para>
   あらゆるエンタープライズ向けオペレーティングシステムにとって重要な要件は、利用環境に対して受けられるサポートのレベルです。カーネルモジュールは、ハードウェア(<quote>コントローラ</quote>)とオペレーティングシステムを結ぶものの中で最も重要です。SUSE Linux Enterpriseのカーネルモジュールにはすべて<literal>supported</literal>フラグが付いており、これは次の3つの値を取ります。
  </para>

  <itemizedlist mark="bullet" spacing="normal">

   <listitem>
    <para>
     <quote>yes</quote>、したがって<literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote>external</quote>、したがって<literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote/> (空、未設定)、したがって<literal>unsupported</literal>
    </para>
   </listitem>
  </itemizedlist>

  <para>
   次のルールが適用されます。
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     自己再コンパイルしたカーネルのすべてのモジュールには、デフォルトで「unsupported」のマークが付きます。
    </para>
   </listitem>
   <listitem>
    <para>
     SUSEパートナーによってサポートされていて、<literal>SUSE SolidDriverプログラム</literal>を使用して配信されているカーネルモジュールには、<quote>external</quote>のマークが付きます。
    </para>
   </listitem>
   <listitem>
    <para>
     <literal>supported</literal>フラグが設定されていない場合、そのモジュールをロードすると、カーネルが汚染されます。汚染カーネルはサポートされません。サポートされていないカーネルモジュールは、別のRPMパッケージ(<systemitem>kernel-<replaceable>FLAVOR</replaceable>-extra</systemitem>)に含まれています。このパッケージは、SUSE Linux Enterprise DesktopおよびSUSE Linux Enterprise Workstation Extensionでのみ使用できます。デフォルト(<replaceable>FLAVOR</replaceable>=<literal>default</literal>|<literal>xen</literal>|...)では、これらのカーネルはロードされません。さらに、これらのサポート対象外のモジュールはインストーラで利用できず、<systemitem class="resource">kernel-<replaceable>FLAVOR</replaceable>-extra</systemitem>パッケージはSUSE Linux Enterpriseのメディアに含まれていません。
    </para>
   </listitem>
   <listitem>
    <para>
     Linuxカーネルのライセンスと互換性があるライセンスに従って提供されていないカーネルモジュールを使用しても、カーネルが汚染されます。詳細については、<filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename>、および<filename>/proc/sys/kernel/tainted</filename>の状態を参照してください。
    </para>
   </listitem>
  </itemizedlist>

  <sect2 xml:id="sec-admsupport-kernel-background">
   <title>技術的背景</title>
   <para/>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Linuxカーネル: SUSE Linux Enterprise <filename>15 SP3</filename>では、<literal>/proc/sys/kernel/unsupported</literal>の値はデフォルトで<phrase role="productnumber"><phrase os="sles;sled">2</phrase></phrase>に設定されています(<literal>do not warn in syslog when loading unsupported modules (サポート対象外のカーネルのロード時にsyslogで警告しない)</literal>)。このデフォルト値は、インストーラと、インストールしたシステムで使用されます。詳細については、<filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename>を参照してください。
     </para>
    </listitem>
    <listitem>
     <para>
      <command>modprobe</command>: モジュールの依存関係を確認して適切にモジュールをロードするための<command>modprobe</command>ユーティリティは、<literal>supported</literal>フラグの値を確認します。この値が<quote>yes</quote>または<quote>external</quote>であればモジュールはロードされ、他の値の場合はロードされません。この動作を無効にする方法については、<xref linkend="sec-admsupport-kernel-unsupported"/>を参照してください。
     </para>
     <note>
      <title>サポート</title>
      <para>
       SUSEは一般的に、<command>modprobe -r</command>によるストレージモジュールの削除をサポートしていません。
      </para>
     </note>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec-admsupport-kernel-unsupported">
   <title>サポート対象外のモジュールの使用</title>
   <para>
    一般的なサポート性は重要ですが、サポート対象外のモジュールのロードが必要な状況が発生する可能性があります。たとえば、テストまたはデバッグ目的の場合や、ハードウェアベンダーがホットフィックスを提供している場合です。
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      デフォルト値を無効にするには、<filename>/etc/modprobe.d/10-unsupported-modules.conf</filename>を編集して、変数<varname>allow_unsupported_modules</varname>の値を<literal>1</literal>に変更します。initrdでサポート対象外のモジュールが必要な場合は、必ず<command>dracut </command> <option>-f</option>を実行してinitrdをアップデートしてください。
     </para>
     <para>
      モジュールを一度だけロードする場合は、<command>modprobe</command>で<option>--allow-unsupported-modules</option>オプションを使用できます。詳細については、<command>modprobe</command>のマニュアルページを参照してください。
     </para>
    </listitem>
    <listitem>
     <para>
      インストール時に、ドライバアップデートディスクを使用してサポート対象外のモジュールを追加できます。この場合、これらのモジュールはロードされます。ブート時およびそれ以降にサポート対象外のモジュールを強制的にロードするには、カーネルコマンドラインオプション<option>oem-modules</option>を使用します。<systemitem class="resource">suse-module-tools</systemitem>パッケージのインストールおよび初期化時に、カーネルフラグ<literal>TAINT_NO_SUPPORT</literal> (<filename>/proc/sys/kernel/tainted</filename>)が評価されます。カーネルがすでに汚染されている場合は、<literal>allow_unsupported_modules</literal>が有効になります。これにより、インストール中のシステムでサポート対象外のモジュールが失敗しないようにします。インストール時にサポート対象外のモジュールが存在しておらず、もう1つの特殊なカーネルコマンドラインオプション(<option>oem-modules=1</option>)を使用していない場合は、引き続きデフォルトで、サポート対象外のモジュールは許可されません。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    サポート対象外のモジュールをロードおよび実行すると、カーネルとシステム全体がSUSEのサポート対象外になる点に注意してください。
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-admsupport-moreinfo">
  <title>詳細情報</title>

  <para/>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <command>man supportconfig</command>—<command>supportconfig</command>のマニュアルページ
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man supportconfig.conf</command>—Supportconfig環境設定ファイルのマニュアルページ
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scatool</command>—<command>scatool</command>のマニュアルページ
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scadb</command>—<command>scadb</command>のマニュアルページ
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man setup-sca</command>—<command>setup-sca</command>のマニュアルページ
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://mariadb.com/kb/en/"/>—MariaDBのマニュアル
    </para>
   </listitem>
   <listitem os="sles">
    <para>
     <link xlink:href="http://httpd.apache.org/docs/"/>および<xref linkend="cha-apache2"/>—Apache Webサーバのマニュアル
    </para>
   </listitem>
   <listitem os="sles">
    <para>
     <xref linkend="cha-ftp"/>—FTPサーバのセットアップ方法のマニュアル
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://www.suse.com/c/blog/sca-pattern-development/"/>—独自のSCAパターンを作成(およびテスト)する方法
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://www.suse.com/c/blog/basic-server-health-check-supportconfig/"/>—「A Basic Server Health Check with Supportconfig」
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://community.microfocus.com/t5/GroupWise-Tips-Information/Create-Your-Own-Supportconfig-Plugin/ta-p/1783289"/>—「Create Your Own Supportconfig Plugin」
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://www.suse.com/c/blog/creating-a-central-supportconfig-repository/"/>—「Creating a Central Supportconfig Repository」
    </para>
    <para>
     <remark>taroth 2014-04-25: jrecord, should we still refer to the three articles above? </remark>
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
</chapter>
