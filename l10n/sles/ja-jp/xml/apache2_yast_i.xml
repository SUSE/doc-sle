<?xml version="1.0" encoding="UTF-8"?>
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apache2_yast_i.xml" version="5.0" xml:id="sec-apache2-configuration-yast">
 <title>ApacheをYaSTで設定する</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  YaSTを使用してWebサーバを設定するには、YaSTを起動して、<menuchoice> <guimenu>ネットワークサービス</guimenu> <guimenu>HTTPサーバ</guimenu> </menuchoice>の順に選択します。このモジュールを初めて起動するときに、<guimenu>HTTPサーバウィザード</guimenu>が起動して、サーバ管理に関していくつかの基本的な事項を決定するように要求されます。このウィザードの完了後、<guimenu>HTTPサーバ</guimenu>のモジュールを呼び出すたびに、<guimenu>HTTPサーバの環境設定</guimenu>ダイアログが起動します。詳細については、<xref linkend="sec-apache2-configuration-yast-server-configuration"/>を参照してください。
 </para>
 <sect3 xml:id="sec-apache2-configuration-yast-wizard">
  <title>HTTP Server Wizard</title>
  <para>
   HTTP Server Wizardには、5つのステップがあります。ダイアログの最後のステップでは、上級者用の設定モードに入って、さらに詳細に設定できます。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-network-device">
   <title>Network Device Selection (ネットワークデバイスの選択)</title>
   <para>
    ここでは、Apacheが着信リクエストをリスンするために使用する、ネットワークインタフェースとポートを指定します。既存のネットワークインタフェースとそれらに対応するIPアドレスから、任意のものを組み合わせて選択できます。他のサービスによって予約されていないものであれば、3つの範囲(ウェルノウンポート、レジスタードポート、ダイナミックまたはプライベートポート)のうちのどのポートでも使用できます。デフォルトの設定では、ポート<systemitem>80</systemitem>ですべてのネットワークインタフェース(IPアドレス)をリスンします。
   </para>
   <para>
    ファイアウォールでWebサーバがリスンするポートを開くには、<guimenu>ファイアウォールでポートを開く</guimenu>をクリックします。これは、LAN、WAN、または公共のインターネットなど、ネットワーク上でWebサーバを利用可能にする場合には必須です。外部からのWebサーバへのアクセスが不要なテスト段階でのみ、ポートを閉じておくことは有用です。複数のネットワークインタフェースが存在する場合は、<guimenu>ファイアウォールの詳細</guimenu>をクリックして、ポートを開くインタフェースを指定します。
   </para>
   <para>
    <guimenu>次へ</guimenu> をクリックして設定を続けます。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-modules">
   <title>モジュール</title>
   <para>
    <guimenu>モジュール</guimenu>設定オプションによって、Webサーバでサポートされるスクリプト言語の有効化または無効化を設定できます。他のモジュールの有効化または無効化の詳細については、<xref linkend="sec-apache2-configuration-yast-server-configuration-modules"/>を参照してください。<guimenu>次へ</guimenu>をクリックして次のダイアログに進みます。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-default-host">
   <title>Default Host (デフォルトのホスト)</title>
   <para>
    このオプションは、デフォルトのWebサーバに関連しています。<xref linkend="sec-apache2-configuration-manually-vhost"/>で説明されているように、Apacheは、1つの物理的マシンで複数の仮想ホストに使用することができます。設定ファイルで最初に宣言された仮想ホストは通常、「デフォルトのホスト」<emphasis/>と呼ばれます。各仮想ホストは、デフォルトホストの設定を継承します。
   </para>
   <para>
    ホストの設定(<emphasis/>「ディレクティブ」)を編集するには、テーブル内の適切なエントリを選択して、<guimenu>編集</guimenu>をクリックします。新しいディレクティブを追加するには、<guimenu>追加</guimenu>をクリックします。ディレクティブを削除するには、そのアカウントを選択し、<guimenu>削除</guimenu>をクリックします。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-host">
    <title>HTTP Server Wizard:デフォルトホスト</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard3.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard3.png"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    これはサーバのデフォルト設定のリストです。
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>ドキュメントルート</systemitem>
     </term>
     <listitem>
      <para>
       Apacheがこのホストにファイルを送るときに使用されるディレクトリパス。<filename>/srv/www/htdocs</filename>はデフォルトの場所です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>別名</systemitem>
     </term>
     <listitem>
      <para>
       <systemitem>Alias</systemitem>ディレクティブを使えば、URLを物理的なファイルシステムの場所にマップすることができます。このことは、パスのURLエイリアスを行えば、ファイルシステムの<literal>Document Root</literal>の外にあるパスでもアクセスできることを意味しています。
      </para>
      <para>
       デフォルトの<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> <systemitem>では、Alias</systemitem>
       <filename> /icons</filename>が<filename>/usr/share/apache2/icons</filename>を指しています。ここには、ディレクトリのインデックスビューで使用されるApacheのアイコンがあります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>ScriptAlias</systemitem>
     </term>
     <listitem>
      <para>
       <systemitem>Alias</systemitem>ディレクティブと同様に、<systemitem>ScriptAlias</systemitem>ディレクティブはURLをシステム内の場所にマップします。相違点は、<systemitem>ScriptAlias</systemitem>はターゲットディレクトリをCGIの場所として指定するということです。つまり、その場所にあるCGIスクリプトが実行されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>ディレクトリ</systemitem>
     </term>
     <listitem>
      <para>
       <systemitem>ディレクトリ</systemitem>設定を使用して、指定したディレクトリにのみ適用される設定オプションのグループを含めることができます。
      </para>
      <para>
       <filename>/srv/www/htdocs</filename>、<filename>/usr/share/apache2/icons</filename>、<filename>/srv/www/cgi-bin</filename>ディレクトリのアクセスおよび表示オプションをここで設定します。デフォルトを変更する必要はありません。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>対象項目</systemitem>
     </term>
     <listitem>
      <para>
       インクルードにより、他の設定ファイルを指定できます。2つの<systemitem>インクルード</systemitem>ディレクティブが設定済みです。<filename>/etc/apache2/conf.d/</filename>は外部モジュールに付属する設定ファイルを保持するディレクトリです。このディレクティブにより、このディレクトリ内の<filename>.conf</filename>で終わるすべてのファイルが対象となります。もう1つのディレクティブでは、<filename>/etc/apache2/conf.d/apache2-manual.conf</filename>という<filename>apache2-manual</filename>設定ファイルが対象となります。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>サーバ名</systemitem>
     </term>
     <listitem>
      <para>
       クライアントがWebサーバとコンタクトするために使うデフォルトのURLを指定します。<literal>http://<replaceable>FQDN</replaceable>/</literal>にあるWebサーバへの接続用FQDN(完全修飾ドメイン名)か、またはそのIPアドレスを使用します。ここでは任意の名前は選択できません。サーバはこの名前で<quote>認識</quote>されなければなりません。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>Server Administrator E-Mail</systemitem>
     </term>
     <listitem>
      <para>
       サーバ管理者の電子メールアドレス。このアドレスは、Apacheが作成するエラーページなどに表示されます。
      </para>
     </listitem>
    </varlistentry>


   </variablelist>
   <para>
    <guimenu>デフォルトホスト</guimenu>のステップを完了したら、<guimenu>次へ</guimenu>をクリックして、設定を続けます。
   </para>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-virtual-hosts">
   <title>仮想ホスト</title>
   <para>
    このステップでは、ウィザードはすでに設定されている仮想ホストのリストを表示します(<xref linkend="sec-apache2-configuration-manually-vhost"/>を参照)。YaST HTTPウィザードを起動する前に手動で変更を行っていなければ、仮想ホストは表示されません。
   </para>
   <para>
    ホストを追加するには、<guimenu>追加</guimenu>をクリックし、<guimenu>サーバ名</guimenu>、<guimenu>サーバのコンテンツルート</guimenu>(<systemitem>DocumentRoot</systemitem>)、<guimenu>管理者電子メール</guimenu>などホストに関する基本情報を入力するためのダイアログを開きます。<guimenu>サーバ解像度</guimenu>は、ホストの識別方法を決めるために使用されます(名前ベースまたはIPベース)。<guimenu>仮想ホストIDの変更</guimenu>で名前またはIPアドレスを指定します。
   </para>
   <para>
    <guimenu>次へ</guimenu>をクリックして、仮想ホスト設定ダイアログの2番目の部分に進みます。
   </para>
   <para>
    仮想ホスト設定のパート2では、CGIスクリプトを有効にするかどうか、およびこれらのスクリプトを使用するディレクトリを指定できます。また、SSLも有効にできます。SSLを有効化する場合は、証明書のパスも指定する必要があります。SSLおよび証明書の詳細については、<xref linkend="sec-apache2-ssl-configuration"/>を参照してください。<guimenu>ディレクトリインデックス</guimenu>オプションを使用して、クライアントがディレクトリを要求するときに表示するファイルを指定できます(デフォルトでは<filename>index.html</filename>)。ファイルを変更するには、1つ以上のファイル名(スペースで区切る)を追加します。<guimenu>公開HTMLを有効にする</guimenu>で、ユーザのパブリックディレクトリ(<filename>~<replaceable>USER</replaceable>/public_html/</filename>)のコンテンツを、サーバの<literal>http://www.example.com/~<replaceable>USER</replaceable></literal>からアクセスできるようにします。
   </para>
   <important>
    <title>仮想ホストの作成</title>
    <para>
     仮想ホストを自由に追加することはできません。名前ベースの仮想ホストを使用する場合は、各ホスト名がネットワーク内で解決されている必要があります。IPベースの仮想ホストを使用する場合は、使用可能な各IPアドレスに対し1つのホストのみを割り当てることができます。
    </para>
   </important>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-wizard-summary">
   <title>概要</title>
   <para>
    これはウィザードの最後のステップです。ここでは、Apacheサーバをいつ、どのようにして起動するか(ブート時に起動するか、手動で起動するか)を指定します。また、ここまで行った設定の簡単な要約を確認します。この設定でよければ、<guimenu>完了</guimenu>をクリックして、設定を完了します。変更するには、希望のダイアログまで<guimenu>戻る</guimenu>をクリックして戻ります。<guimenu>HTTPサーバのエキスパート環境設定</guimenu>をクリックして、<xref linkend="sec-apache2-configuration-yast-server-configuration"/>で説明しているダイアログを開きます。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-summary">
    <title>HTTP Server Wizard:概要</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_wizard5.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_wizard5.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
 </sect3>
 <sect3 xml:id="sec-apache2-configuration-yast-server-configuration">
  <title>HTTPサーバの設定</title>
  <para>
   <guimenu>HTTPサーバの設定</guimenu>ダイアログでは、ウィザード(Webサーバを最初に設定する場合にのみ実行)よりも詳細に設定を調整できます。このダイアログは、次で説明する4つのタブで構成されています。ここで変更する設定オプションは、すぐには適用されません。変更を適用するには、常に<guimenu>完了</guimenu>をクリックして変更を確認する必要があります。<guimenu>中止</guimenu>をクリックすると、設定モジュールを終了し、変更が破棄されます。
  </para>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-listen">
   <title>待ち受けポートおよびアドレス</title>
   <para>
    <guimenu>HTTPサービス</guimenu>で、Apacheを実行するか(<guimenu>有効にする</guimenu>)、または停止するか(<guimenu>無効</guimenu>)を選択します。<guimenu>Listen on Ports</guimenu>で、サーバが使用可能なアドレスおよびポートについて<guimenu>追加</guimenu>、<guimenu>編集</guimenu>、または<guimenu>削除</guimenu>を選択します。デフォルトでは、ポート<literal>80</literal>ですべてのインタフェースをリスンします。常に<guimenu>ファイアウォールでポートを開く</guimenu>にチェックマークを入れておく必要があります。そうしないと、外部からWebサーバにアクセスできなくなります。外部からのWebサーバへのアクセスが不要なテスト段階でのみ、ポートを閉じておくことは有用です。複数のネットワークインタフェースが存在する場合は、<guimenu>ファイアウォールの詳細</guimenu>をクリックして、ポートを開くインタフェースを指定します。
   </para>
   <para>
    <guimenu>ログファイル</guimenu>で、アクセスログファイルまたはエラーログファイルのいずれかを確認します。これは、設定をテストする場合に便利です。ログファイルは別個のウィンドウに表示されますが、そこから、Webサーバを再起動または再ロードすることも可能です。詳細については、<xref linkend="sec-apache2-start-stop"/>を参照してください。これらのコマンドはすぐに有効になり、ログメッセージもすぐに表示されます。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-listen">
    <title>HTTP Server Configuration:設定:リッスンポートとアドレス</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_listen.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_listen.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-modules">
   <title>サーバモジュール</title>
   <para>
    <guimenu>状態の変更</guimenu>をクリックして、Apache2モジュールのステータス(有効または無効)を変更できます。すでにインストールされているがリストに含まれていない新規モジュールを追加するには、<guimenu>Add Module</guimenu>をクリックします。モジュールの詳細については、<xref linkend="sec-apache2-modules"/>を参照してください。
   </para>
   <figure xml:id="fig-apache2-configuration-yast-server-configuration-modules">
    <title>HTTP Server Configuration:サーバモジュール</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata width="75%" fileref="yast2_apache_config_modules.png"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_apache_config_modules.png"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect4>
  <sect4 xml:id="sec-apache2-configuration-yast-server-configuration-host">
   <title>メインホストまたはホスト</title>
   <para>
    これらのダイアログは、すでに説明したものと同じです。詳細については、<xref linkend="sec-apache2-configuration-yast-wizard-default-host"/>および<xref linkend="sec-apache2-configuration-yast-wizard-virtual-hosts"/>を参照してください。
   </para>
  </sect4>
 </sect3>
</sect2>
