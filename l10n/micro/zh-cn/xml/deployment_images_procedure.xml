<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_images_procedure.xml" version="5.0" xml:id="cha-images-procedure">
 <title>部署 Raw 映像</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase> 提供可直接部署到设备储存（内存卡、USB 闪存盘或硬盘）的 raw 映像。可以将映像部署到哪种类型的设备取决于您的特定硬件 — 请遵照供应商文档选择。
 </para>

 <para>
  要准备设置，您需要两个单独的设备。一个用于存放运行 SLE Micro 的 Raw 磁盘映像，另一个充当配置媒体，例如 USB 磁盘。即使没有配置媒体，您也可以进行基本配置。要进行更复杂的配置，则需要准备配置媒体。 
 </para>

 <para>
  下面的过程列出了将 Raw 映像部署到系统的步骤：
 </para>
<procedure>
  <title>部署 Raw 映像</title>
  <step>
    <para>
      按照<xref linkend="proc-prepare-image"/>中所述准备 Raw 映像
    </para>
  </step>
  <step>
    <para>
      如果需要，请按照<xref linkend="pro-preparing-configuration-device"/>中所述准备配置媒体。
    </para>
  </step>
  <step>
    <para>
      如果您未使用配置媒体，请按<xref linkend="sec-jeos-firstboot"/>中所述操作。
    </para>
  </step>
  <step>
    <para>
  首次引导之后，您可以使用 <command>transactional-update</command> 命令注册 SLE Micro 实例。有关细节，请参见<xref linkend="sec-images-registration"/>。
 </para>
  </step>
  <step>
    <para>
  SLE Micro 提供了多个扩展。要使用其中的一些扩展，您需要从安装的系统将扩展添加到您的订阅中。有关细节，请参见<xref linkend="sec-adding-extension"/>。
 </para> 
  </step>
</procedure>

 <section xml:id="sec-raw-preparation">
  <title>准备 Raw 映像</title>
  <para>
  要准备 raw 映像，请执行以下操作：
 </para> 
 <procedure xml:id="proc-prepare-image">
  <title>准备 raw 磁盘映像</title>
  <step>
   <para>
    下载 raw 映像并将其解压缩：
   </para>
<screen><prompt>&gt; </prompt>xz -d <replaceable>DOWNLOADED_IMAGE.raw.xz</replaceable></screen>
  </step>
  <step>
   <para>
    将解压缩后的映像复制到将运行 SLE Micro 的设备：
   </para>
<screen><prompt>&gt; </prompt>dd if=<replaceable>DOWNLOADED_IMAGE.raw</replaceable> of=/dev/sd<replaceable>X</replaceable></screen>
  </step>
 </procedure>
</section>

<section xml:id="sec-prepare-device">
  <title>准备配置设备</title>
 <para>
  下面的过程说明如何准备配置设备（通常是 USB 闪存盘）。请注意，配置设备需要在运行 SLE Micro 的主机首次引导期间连接到该主机。
 </para>
 <procedure xml:id="pro-preparing-configuration-device">
 <title>准备配置设备</title>
  <step>
   <para>
    将磁盘格式化为 SLE Micro 支持的任何文件系统：Ext3、Ext4 等：
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkfs.ext4 /dev/sd<replaceable>Y</replaceable>
</screen>
  </step>
  <step>
   <para>
    将设备标签设置为 <literal>ignition</literal>（使用 Ignition 或 Combustion 时）或 <literal>combustion</literal>（仅使用 Combustion 时）。对于 Ext4 文件系统：
   </para>
<screen><prompt>&gt; </prompt>sudo e2label /dev/sd<replaceable>Y</replaceable> ignition</screen>
   <para>
    您可以使用您的虚拟化系统或硬件支持的任何类型的配置储存媒体：ISO 映像、USB 闪存盘等。
   </para>
  </step>
  <step>
   <para>
    挂载设备：
   </para>
<screen>
<prompt>&gt; </prompt>sudo mount /dev/sdY /mnt
</screen>
  </step>
  <step>
   <para>
    创建<xref linkend="cha-images-ignition"/>或<xref linkend="cha-images-combustion"/>中所述的目录结构，具体取决于使用的配置工具：
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkdir -p /mnt/ignition/
</screen>
   <para>
    或：
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkdir -p /mnt/combustion/
</screen>
  </step>
  <step>
   <para>
    在首次引导前，准备 <xref linkend="cha-images-ignition" xrefstyle="template:Ignition"/> 或 <xref linkend="cha-images-combustion" xrefstyle="template:Combustion"/> 将要使用的配置的所有元素。要登录系统，您需要提供 <systemitem class="username">root</systemitem> 的口令或设置无口令身份验证，否则首次引导后将无法访问系统。
   </para>
  </step>
</procedure>
  </section>

  <section xml:id="sec-jeos-firstboot">
    <title>极简初始配置</title>
    <para>
      如果您在首次引导 Raw 映像时未挂接任何配置设备，则可以使用 <emphasis>jeos-firstboot</emphasis> 按如下方式执行系统的极简配置：
    </para>
    <procedure>
      <title>使用 <emphasis>jeos-firstboot</emphasis> 配置系统</title>
      <step>
        <para>
          确认配置。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_start.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_start.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>jeos first boot</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
      <step>
        <para>
          选择键盘布局并确认所做的选择。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_keyboard.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_keyboard.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>jeos keyboard selection</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
      <step>
        <para>
          阅读并接受许可协议。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_eula.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_eula.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>jeos EULA</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
      <step>
        <para>
          选择您所在的时区。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_timezone.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_timezone.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>jeos time zone selection</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
      <step>
        <para>
          输入 <systemitem class="username">root</systemitem> 的口令。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_password.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_password.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>root password</phrase>
    </textobject>
     </mediaobject>
   </informalfigure>
   </step>
   <step>
    <para>
      确认 <systemitem class="username">root</systemitem> 口令。
    </para>
    <informalfigure>
    <mediaobject>
      <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_password_confirm.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_password_confirm.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>root password confirmation</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
      <step>
        <para>
          接受关于 SLE Micro 注册的声明。
        </para>
        <informalfigure>
        <mediaobject>
          <imageobject role="fo">
     <imagedata fileref="slemicro_jeos_statement.png" width="100%"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="slemicro_jeos_statement.png" width="100%"/>
    </imageobject>
    <textobject role="description"><phrase>root password</phrase>
    </textobject>
        </mediaobject>
      </informalfigure>
      </step>
    </procedure>
  </section>
</chapter>
