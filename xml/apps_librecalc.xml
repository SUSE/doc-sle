<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha.oo.calc">
 <title>&ooo; Calc</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  Calc is the &ooo; spreadsheet and data plotting module. Spreadsheets consist
  of several sheets, containing cells which can be filled with elements like
  text, numbers, or formulas. A formula can manipulate data from other cells to
  generate a value for the cell in which it is inserted. Calc also allows you
  to define ranges, filter and sort the data or creates charts from the data to
  present it graphically. By using pivot tables, you can combine, analyze or
  compare larger amounts of data.
 </para>
 <para>
  As with the entire &ooo; suite, Calc can be used across a variety of
  platforms. It provides several exchange formats (including export to PDF
  documents), and can also read and save files in Microsoft Excel format. Its
  interoperability is constantly ameliorated.
 </para>
 <para>
  This chapter can only introduce some very basic Calc functionality. For more
  information and for complete instructions, look at the &ooo; help or at the
  sources listed in <xref linkend="sec.oo.oview.help"/>.
 </para>
 <note>
  <title>VBA Macros</title>
  <para>
   Calc can process many VBA macros in Excel documents. However, support for
   VBA macros is not yet complete. When opening an Excel spreadsheet that makes
   heavy use of macros, you might discover that some do not work.
  </para>
 </note>
 <sect1 xml:id="sec.oo.calc.createnew">
  <title>Creating a New Document</title>

  <para>
   There are two ways to create a new Calc document:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>From Scratch</title>
     <para>
      To create a document from scratch, click <menuchoice>
      <guimenu>File</guimenu> <guimenu>New</guimenu>
      <guimenu>Spreadsheet</guimenu> </menuchoice> and a new empty Calc
      document is created.
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>Templates</title>
     <para>
      To use a template, click <menuchoice> <guimenu>File</guimenu>
      <guimenu>New</guimenu> <guimenu>Templates</guimenu> </menuchoice> and
      open <guimenu>Finances</guimenu>. You can see a list of Spreadsheet
      templates. Select the one that fits your needs and your new document is
      created based on the style of your selected template.
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   Access the individual sheets by clicking the respective tabs at the bottom
   of the window.
  </para>

  <para>
   Enter data in the cells as desired. To adjust the appearance, either use the
   <guimenu>Formatting</guimenu> toolbar or the <guimenu>Format</guimenu>
   menu&mdash;or define styles as described in
   <xref linkend="sec.oo.calc.styles"/>. Use the <guimenu>File</guimenu> menu
   or the relevant buttons in the toolbar to print and save your document.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.styles">
  <title>Using Formatting and Styles in Calc</title>

  <para>
   Calc comes with a few built-in cell and page styles to improve the
   appearance of your spreadsheets and reports. Although these built-in styles
   are adequate for many uses, you will probably find it useful to create
   styles for your own frequently used formatting preferences.
  </para>

  <procedure xml:id="pro.oo.calc.createstyle">
   <title>Creating a Style</title>
   <step>
    <para>
     Click <menuchoice> <guimenu>Format</guimenu> <guimenu>Styles and
     Formatting</guimenu> </menuchoice>.
    </para>
   </step>
   <step>
    <para>
     In the <guimenu>Styles and Formatting</guimenu> window, click either the
     <guimenu>Cell Styles</guimenu> or the <guimenu>Page Styles</guimenu> icon
     from the top of the window.
    </para>
   </step>
   <step>
    <para>
     Right-click anywhere in the list of styles in the <guimenu>Styles and
     Formatting</guimenu> window. Then click <guimenu>New</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Specify a name for your style and use the various tabs to set the desired
     formatting options.
    </para>
   </step>
   <step>
    <para>
     Click <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <procedure>
   <title>Modifying a Style</title>
   <step>
    <para>
     Click <menuchoice> <guimenu>Format</guimenu> <guimenu>Styles and
     Formatting</guimenu> </menuchoice>.
    </para>
   </step>
   <step>
    <para>
     In the <guimenu>Formatting and Styles</guimenu> window, click either the
     <guimenu>Cell Styles</guimenu> or the <guimenu>Page Styles</guimenu> icon.
    </para>
   </step>
   <step>
    <para>
     Right-click the name of the style you want to change, then click
     <guimenu>Modify</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Change the desired formatting options.
    </para>
   </step>
   <step>
    <para>
     Click OK.
    </para>
   </step>
  </procedure>

  <para>
   To apply a style to specific cells, select the cells you want to format.
   Then double-click the style you want to apply in the <guimenu>Styles and
   Formatting</guimenu> window.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.sheets">
  <title>Working With Sheets</title>

  <para>
   Sheets are a good method to organize your calculations. For example, if you
   have a business, accounting might be much clearer if you create a sheet for
   each month.
  </para>

  <para>
   To insert a new sheet in your spreadsheet, do the following:
  </para>

  <remark>
   If you just want to add a new sheet, it is actually much easier to
   use the little + button next to the sheet tabs. But then, of course, you
   don't get all the options. --sknorr, 2015-09-17
  </remark>

  <procedure>
   <title>Inserting New Sheets</title>
   <step>
    <para>
     Select <menuchoice> <guimenu>Insert</guimenu> <guimenu>Sheet</guimenu>
     </menuchoice> from the main menu. A dialog opens.
    </para>
   </step>
   <step>
    <para>
     Decide whether the new sheet should be positioned before or after the
     selected sheet.
    </para>
   </step>
   <step>
    <para>
     If you want to create a new sheet, make sure the <guimenu>New
     Sheet</guimenu> radio button is activated. Enter the number of sheets and
     the sheet name. Skip the next step.
    </para>
   </step>
   <step>
    <para>
     If you want to import a sheet from another file, do the following
     otherwise skip this step:
    </para>
    <substeps performance="required">
     <step>
      <para>
       Select <guimenu>From file</guimenu> and click <guimenu>Browse</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Select the file name and confirm with <guimenu>OK</guimenu>. All the
       sheet names are now displayed in the list.
      </para>
     </step>
     <step>
      <para>
       Select the sheet names you want to import by holding the
       <keycap function="shift"/> key.
      </para>
     </step>
     <step>
      <para>
       Confirm with <guimenu>OK</guimenu> to import the sheet names you
       selected.
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   To rename a sheet, right-click a sheet in the sheet tab and select
   <guimenu>Rename Sheet</guimenu>. To rename, you can also double-click the
   sheet tab.
  </para>

  <para>
   To delete the current sheet, select <menuchoice> <guimenu>Edit</guimenu>
   <guimenu>Sheet</guimenu> <guimenu>Delete</guimenu> </menuchoice> and confirm
   with <guimenu>Delete Sheets</guimenu>. It is possible to delete more than
   one sheet by holding the <keycap function="shift"/> key and selecting the
   sheets you want to delete in the sheet tab. Right-click and choose
   <guimenu>Delete Sheet</guimenu> and the same dialog appears. Confirm with
   <guimenu>Delete Sheets</guimenu>.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.condformat">
  <title>Conditional Formatting</title>

  <para>
   Conditional formatting is a useful feature to highlight certain values in
   your spreadsheet. For example, define a condition and if the condition is
   true, a style is applied to each cell that fulfills this condition.
  </para>

  <note>
   <title>Enable AutoCalculate</title>
   <para>
    Before you apply conditional formatting, choose <menuchoice>
    <guimenu>Tools</guimenu> <guimenu>Cell Contents</guimenu>
    <guimenu>AutoCalculate</guimenu> </menuchoice>. You should see a check mark
    in front of <guimenu>AutoCalculate</guimenu>.
   </para>
  </note>

  <procedure xml:id="pro.oo.calc.condformat">
   <title>Using Conditional Formatting</title>
   <step>
    <para>
     Define a style first. This style is applied to each cell when your
     condition is true. Use <menuchoice> <guimenu>Format</guimenu>
     <guimenu>Styles and Formatting</guimenu> </menuchoice> or press
     <keycap>F11</keycap>. For more information, see
     <xref linkend="pro.oo.calc.createstyle"/>. Confirm with
     <guimenu>OK</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Select the cell range where you want to apply your condition.
    </para>
   </step>
   <step>
    <para>
     Select <menuchoice> <guimenu>Format</guimenu> <guimenu>Conditional
     Formatting</guimenu> <guimenu>Condition</guimenu> </menuchoice> from the
     main menu. A dialog opens.
    </para>
   </step>
   <step>
    <para>
     You now see a template for a new condition. Conditions can operate in
     multiple modes:
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>Cell value is</guimenu>
      </term>
      <listitem>
       <para>
        The condition tests if a cell matches a certain value. Beside the first
        pull-down menu, you can select an operator such as <guimenu>equal
        to</guimenu>, <guimenu>less than</guimenu>, or <guimenu>greater
        than</guimenu>.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Formula is</guimenu>
      </term>
      <listitem>
       <para>
        The condition tests if a certain formula returns true.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Date is</guimenu>
      </term>
      <listitem>
       <para>
        The condition tests if a certain date value is reached.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>All Cells</guimenu>
      </term>
      <listitem>
       <remark>
        Imo, this is one of the most interesting LibO features and really needs
        its own procedure. -- sknorr, 2015-09-17
       </remark>
       <para>
        This mode allows creating data visualizations that, similarly to
        <guimenu>Cell value is</guimenu>, depend on the value of a cell.
        However, the difference here is that you can use one condition to apply
        an entire range of styles.
       </para>
<!-- This is becoming too long. - sknorr, 2015-09-17 -->
<!-- <para>
        There are several ways to use this in &libo; Calc:
        Color Scales (cell background color), Data Bars (bars with
        changing width in the cell) and Icon Sets (an icon in the cell).
       </para>
       <para>
        For example, a Color Scale allows you to assign <literal>0</literal>
        a black background and <literal>100</literal> a green background.
        All values in between will be calculated automatically, so that, for
        example <literal>50</literal> receives a dark green background.
       </para> -->
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     For this example, keep the default: <guimenu>Cell value is</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Select an operator and the value of the cell you want to test for.
    </para>
   </step>
   <step>
    <para>
     Choose the style you want to apply when this condition is true or click
     <guimenu>New Style</guimenu> to define a new appearance.
    </para>
   </step>
   <step>
    <para>
     If you need additional conditions, click <guimenu>Add</guimenu>. Then
     repeat the previous steps.
    </para>
   </step>
   <step>
    <para>
     Confirm with <guimenu>OK</guimenu>. Now the style of your cells has
     changed.
    </para>
   </step>
  </procedure>

  <remark>
   We might also want a procedure showing how to use the Manage dialog to remove
   conditions. -- sknorr, 2015-09-17
  </remark>
 </sect1>
 <sect1 xml:id="sec.oo.calc.grouping">
  <title>Grouping and Ungrouping Cells</title>

  <para>
   Grouping a cell range helps to fold your spreadsheet into parts. This makes
   your spreadsheets more readable, as you can hide all the parts you are not
   currently interested in. It is possible to group rows or columns and nest
   groups in other groups.
  </para>

  <para>
   To group a range, proceed as follows:
  </para>

  <procedure>
   <title>Grouping a Selected Cell Range</title>
   <step>
    <para>
     Select a cell range in your spreadsheet.
    </para>
   </step>
   <step>
    <para>
     Select <menuchoice> <guimenu>Data</guimenu> <guimenu>Group and
     Outline</guimenu> <guimenu>Group</guimenu> </menuchoice>. A dialog
     appears.
    </para>
   </step>
   <step>
    <para>
     Decide if you want to group your selected range as row or as column.
     Confirm with <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <para>
   After grouping selected cells, a line indicating the grouped cell range
   appears in the upper-left margin. Fold or unfold the cell range with the
   <guimenu>+</guimenu> and <guimenu>-</guimenu> icons. The numbers at the top
   left of the margins display the depth of your groups and can be clicked too.
  </para>

  <para>
   To ungroup a cell range, click into a cell which belongs to a group and
   select <menuchoice> <guimenu>Data</guimenu> <guimenu>Group and
   Outline</guimenu> <guimenu>Ungroup</guimenu> </menuchoice>. The line in the
   margin disappears. The innermost group is always deleted first.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.freezing">
  <title>Freezing Rows or Columns as Headers</title>

  <para>
   If you have a spreadsheet with lots of data, scrolling makes your header
   usually disappear. &ooo; can lock rows or columns or both, so they remain
   fixed as you scroll around.
  </para>

  <para>
   To freeze a single row or a single column, proceed as follows:
  </para>

  <procedure>
   <title>Freezing a Single Row or Column</title>
   <step>
    <para>
     To create a frozen area before a row, click the header of the row
     (<literal>1</literal>, <literal>2</literal>, <literal>3</literal>, ...).
    </para>
    <para>
     To create a frozen area above a column, click the header of the column
     (<literal>A</literal>, <literal>B</literal>, <literal>C</literal>, ...).
    </para>
   </step>
   <step>
    <para>
     Select <menuchoice> <guimenu>Window</guimenu> <guimenu>Freeze</guimenu>
     </menuchoice>. A dark line appears, indicating which area is frozen.
    </para>
   </step>
  </procedure>

  <para>
   It is also possible to freeze both rows and columns:
  </para>

  <procedure>
   <title>Freezing Row and Column</title>
   <step>
    <para>
     Click into the cell to the right of the column and below the row you want
     frozen. For example, if your header occupies the space from A1 to B3,
     click cell C4.
    </para>
   </step>
   <step>
    <para>
     Select <menuchoice> <guimenu>Window</guimenu> <guimenu>Freeze</guimenu>
     </menuchoice>. A dark line appears, indicating which area is frozen.
    </para>
   </step>
  </procedure>

  <para>
   To unfreeze, select
   <menuchoice><guimenu>Window</guimenu><guimenu>Freeze</guimenu></menuchoice>.
   The check mark in the menu then disappears.
  </para>
 </sect1>
</chapter>
