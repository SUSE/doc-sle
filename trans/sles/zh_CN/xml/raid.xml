<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="raid.xml" id="sec.yast2.system.raid">
 <title>软 RAID 配置</title><indexterm> <primary>YaST</primary><secondary>RAID</secondary></indexterm><indexterm><primary>RAID</primary><secondary>YaST</secondary></indexterm><indexterm><primary>软 RAID</primary><see>RAID</see></indexterm>



 <para>
  RAID（独立磁盘冗余阵列）的用途是将多个硬盘分区合并成一个大的<emphasis>虚拟</emphasis>硬盘，以便优化性能和/或数据安全性。大多数 RAID 控制器使用 SCSI 协议，因为它可以使用比 IDE 协议更高效的方式对更多硬盘寻址。它也更适合于并行命令处理。还有一些支持 IDE 或 SATA 硬盘的 RAID 控制器。软件 RAID 具有 RAID 系统的优势，并且没有硬件 RAID 控制器的额外成本。但是这需要一些 CPU 时间以及内存，所以不适用于高性能的计算机。
 </para>

 <para>
  通过 <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase>，可以将多个硬盘组合到一个软 RAID 系统中。RAID 暗示将多块硬盘合成一个 RAID 系统的多种策略，这些策略的目标、优点及特点各不相同。这些变化形式通常称作 <emphasis>RAID 级别</emphasis>。
 </para>

 <para>
  常用的 RAID 级别如下：
 </para>

 <variablelist>
  <varlistentry>
   <term>RAID 0</term>
   <listitem>
    <para>
     此级别通过将每个文件按块分放到多个磁盘驱动器上，提高了数据访问性能。这实际上并不是真正的 RAID，因为它未提供数据备份，但 <emphasis>RAID 0</emphasis> 已成为此类系统的常用名称。使用 RAID 0，可以将两块或多块硬盘组合在一起。这样性能固然可以提高，但如果有任何一块硬盘出现故障，都将损坏 RAID 系统并丢失数据。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 1</term>
   <listitem>
    <para>
     此级别为数据提供了充分的安全性，因为它将数据按 1:1 复制到另一块硬盘上。这种方法称为<emphasis>硬盘镜像</emphasis>。如果一个磁盘损坏，则可以使用另一块磁盘上的内容副本。在所有这些硬盘中，只要有一个硬盘没有损坏，您的数据就不会丢失。但是，如果未检测到损坏，则损坏的数据可能会镜像到未损坏磁盘中。这可能导致同样的数据丢失。与使用单磁盘访问相比，它的写访问性能会受复制过程影响（低 10 至 20 %），但与任一普通物理磁盘相比，读访问速度会显著提高。原因在于可以并行扫描重复数据。一般来讲，使用级别 1 的读传输速率几乎是使用单个磁盘时的两倍，而写传输速率与使用单个磁盘时相差无几。
    </para>
   </listitem>
  </varlistentry>

  <varlistentry>
   <term>RAID 5</term>
   <listitem>
    <para>
     RAID 5 是级别 0 和级别 1 在性能和冗余方面经优化后的折衷方案。硬盘空间等于使用的磁盘数减 1。数据使用与 RAID 0 相同的方式分布到硬盘中。<emphasis>奇偶校验块</emphasis>用于确保数据安全，在其中一个分区上创建。这些块通过 XOR 互相链接，并在系统出现故障时，通过启用相应的校验块重构建内容。对于 RAID 5，在同一时间只能有一块硬盘出现故障。如果一块硬盘出现故障，则必须尽快将其更换，以防止丢失数据。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 6</term>
   <listitem>
    <para>
     要进一步增强 RAID 系统的可靠性，可以使用 RAID 6。在此级别，即使有两个磁盘发生故障，也可以重构造阵列。使用 RAID 6，至少需要 4 个硬盘来运行阵列。请注意，以软件 RAID 运行时，此配置需占用大量的 CPU 时间和内存。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 10 (RAID 1+0)</term>
   <listitem>
    <para>
     此 RAID 实施兼具 RAID 0 和 RAID 1 的特点：数据先镜像到单独磁盘阵列，这些阵列会插入到新的 RAID 0 类型阵列。在每个 RAID 1 子阵列中，一个磁盘的故障不会对数据造成任何损坏。要运行 RAID 10，至少需要四个磁盘，并且磁盘数目必须是偶数。这种类型的 RAID 适用于预计负载极大的数据库应用程序。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>其他 RAID 级别</term>
   <listitem>
    <para>
     其他多种 RAID 级别也已开发出（RAID 2、RAID 3、RAID 4、RAIDn、RAID 10、RAID 0+1、RAID 30 和 RAID 50 等），其中某些级别属于硬件供应商创建的专有实施方法。由于这些级别并不是很普及，因此在此不再赘述。
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <sect2 id="sec.yast2.system.raid.conf">
  <title>使用 YaST 配置软 RAID</title>
  <para>
   YaST <guimenu>RAID</guimenu> 配置可以通过 YaST 专家分区程序完成，如<xref linkend="sec.yast2.i_y2_part_expert"/>中所述。此分区工具用于编辑和删除现有分区并创建要用于软 RAID 的新分区：
  </para>
  <procedure>
   <step performance="required">
    <para>
     从<guimenu>硬盘</guimenu>中选择一个硬盘。
    </para>
   </step>
   <step performance="required">
    <para>
     更改到<guimenu>分区</guimenu>选项卡。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>添加</guimenu>并输入此磁盘上需要的 raid 分区大小。
    </para>
   </step>
   <step performance="required">
    <para>
     使用<guimenu>不格式化分区</guimenu>并将<guimenu>文件系统 ID</guimenu> 更改为 <guimenu>0xFD Linux RAID</guimenu>。不要装入该分区。
    </para>
   </step>
   <step performance="required">
    <para>
     重复此过程，直到您在可用磁盘上定义了所有所需物理卷。
    </para>
   </step>
  </procedure>
  <para>
   对于 RAID 0 和 RAID 1，至少需要两个分区，而对于 RAID 1，通常只需要两个分区。如果使用 RAID 5，则至少需要三个分区；RAID 6 和 RAID 10 至少需要四个分区。建议仅使用大小相同的分区。RAID 分区应位于不同硬盘上，以降低由于某块硬盘（RAID 1 和 5）出现问题而导致数据丢失的风险，同时还可以优化 RAID 0 的性能。创建用于 RAID 的所有分区之后，单击 <menuchoice><guimenu>RAID</guimenu><guimenu>添加 RAID</guimenu></menuchoice> 以启动 RAID 配置。
  </para>
  <para>
   在下一个对话框中选择 RAID 级别 0、1、5、6 和 10。然后，选择应由 RAID 系统使用的，类型为 <quote>Linux RAID</quote> 或 <quote>Linux native</quote> 的所有分区。未显示交换分区或 DOS 分区。
  </para>
  <tip>
   <para>
    针对所添加磁盘的顺序所牵涉到的 RAID 类型，您可以使用 A 到 E 中的任何一个字母来标记每个磁盘。单击<guimenu>分类</guimenu>按钮，选择该磁盘，并单击其中一个<guimenu>类 X</guimenu> 按钮（X 表示您想指派给该磁盘的字母）。以这种方式指派所有可用的 RAID 磁盘，然后单击<guimenu>确定</guimenu>进行确认。您可以使用<guimenu>排序</guimenu>或<guimenu>交错</guimenu>按钮轻松地对已分类的磁盘进行排序，或者使用<guimenu>模式文件</guimenu>从某个文本文件中添加排序模式。
   </para>
  </tip>
  <figure id="fig.yast2.system.raid.conf">
   <title>RAID 分区</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   要将以前未指派的分区添加到所选的 RAID 卷中，请先单击该分区，然后单击<guimenu>添加</guimenu>。指派所有为 RAID 保留的分区。否则，分区中的空间仍处于未使用状态。指派所有分区之后，单击<guimenu>下一步</guimenu>选择可用的 <guimenu>RAID 选项</guimenu>。
  </para>
  <para>
   在最后一步中，设置所用的文件系统，以及 RAID 卷的加密方法和安装点。单击<guimenu>完成</guimenu>完成配置后，请查看 <filename>/dev/md0</filename> 设备和专家分区工具中指示为 <emphasis>RAID</emphasis> 的其他设备。
  </para>
 </sect2>

 <sect2 id="sec.yast2.system.raid.trouble">
  <title>查错</title>
  <para>
   查看文件 <filename>/proc/mdstat</filename> 以确定 RAID 分区是否受损。如果系统出现故障，请关闭 Linux 系统并用以同样方式分区的新硬盘替换出现问题的硬盘。然后重启动您的系统并输入命令 <command>mdadm /dev/mdX --add /dev/sdX</command>。将“X”替换为您的特定设备标识符。此命令会自动将该硬盘集成到 RAID 系统并进行完全重构建。
  </para>
  <para>
   请注意，尽管可以在重构建期间访问所有数据，但在 RAID 完全重构建之前，仍然可能遇到一些性能问题。
  </para>
 </sect2>

 <sect2 id="sec.yast2.system.raid.information">
  <title>更多信息</title>
  <para>
   位于下列位置的 HOWTO 文档提供了软 RAID 的配置说明和详细信息：
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <filename>/usr/share/doc/packages/mdadm/Software-RAID.HOWTO.html</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <ulink url="http://raid.wiki.kernel.org"/>
    </para>
   </listitem>
  </itemizedlist>
  <para>
   此外还提供有 Linux RAID 邮件列表，例如 <ulink url="http://marc.info/?l=linux-raid"/>。
  </para>
 </sect2>
</sect1>
