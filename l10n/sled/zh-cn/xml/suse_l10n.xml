<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="suse_l10n.xml" version="5.0" xml:id="sec-suse-l10n">
 <title>语言和国家/地区特定的设置</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  该系统在很大程度上实现了国际化，可修改以满足本地需要。国际化 (<emphasis>I18N</emphasis>) 允许特定的本地化 (<emphasis>L10N</emphasis>)。I18N 和 L10N 这两个缩写词使用原单词的第一个和最后一个字母，中间的数字表示省略的字母数。
 </para>

 <para>
  通过文件 <filename>/etc/sysconfig/language</filename> 中定义的 <systemitem>LC_</systemitem> 变量来进行这些设置。这不仅指<emphasis>本地语言支持</emphasis>，还指<emphasis>消息</emphasis>（语言）、<emphasis>字符集</emphasis>、<emphasis>排序顺序</emphasis>、<emphasis>时间和日期</emphasis>、<emphasis>数字</emphasis>和<emphasis>货币</emphasis>等类别。这些类别中的每一种都可以使用自己的变量直接定义，或使用 <filename>language</filename> 文件中的主变量间接定义（请参见 <command>locale</command> 手册页）。
 </para>

 <variablelist xml:id="vl-suse-l10n-variables">
  <title>变量列表</title>
  <varlistentry>
   <term><systemitem>RC_LC_MESSAGES</systemitem>, <systemitem>RC_LC_CTYPE</systemitem>, <systemitem>RC_LC_COLLATE</systemitem>, <systemitem>RC_LC_TIME</systemitem>, <systemitem>RC_LC_NUMERIC</systemitem>, <systemitem>RC_LC_MONETARY</systemitem>
   </term>
   <listitem>
    <para>
     这些变量将不带 <systemitem>RC_</systemitem> 前缀传递到外壳，代表所列的类别。下面列出了相关外壳配置文件。可以使用命令 <command>locale</command> 显示当前设置。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term><systemitem>RC_LC_ALL</systemitem>
   </term>
   <listitem>
    <para>
     此变量（如果设置）将覆盖上述变量的值。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term><systemitem>RC_LANG</systemitem>
   </term>
   <listitem>
    <para>
     如果未设置上述的任何变量，则这是后备变量。默认只会设置 <systemitem>RC_LANG</systemitem>。这便于用户输入他们自己的值。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term><systemitem>ROOT_USES_LANG</systemitem>
   </term>
   <listitem>
    <para>
     此变量可设置为 <literal>yes</literal> 或 <literal>ctype</literal>（默认值）。如果设置为 <literal>yes</literal>，<systemitem class="username">root</systemitem> 将使用特定于语言和国家/地区的设置，否则系统管理员始终在 POSIX 环境中操作。
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <para>
  这些变量可通过 YaST sysconfig 编辑器进行设置。此类变量的值包含语言代码、国家/地区代码、编码和修饰符。各个组成部分之间通过特殊字符联接：
 </para>

<screen>LANG=&lt;language&gt;[[_&lt;COUNTRY&gt;].&lt;Encoding&gt;[@&lt;Modifier&gt;]]</screen>

 <sect2 xml:id="sec-suse-l10n-settings">
  <title>系统范围的区域设置</title>
  <para>
   <systemitem class="daemon">systemd</systemitem> 会在早期引导时读取 <filename>/etc/locale.conf</filename>。除非存在单独的设置，否则此文件中配置的区域设置将由每个服务或用户继承。
  </para>
  <note>
   <title><phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 下旧配置文件的行为</title>
   <para>
    早期版本的 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 会从 <filename>/etc/sysconfig/language</filename>、<filename>/etc/sysconfig/keyboard</filename> 和 <filename>/etc/sysconfig/console</filename> 读取区域设置。从 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>
    <phrase os="sles;sled">15 GA</phrase> 开始，这些文件被视为已过时。<systemitem class="daemon">systemd</systemitem> 不再从这些文件读取设置。<systemitem class="daemon">systemd</systemitem> 改为从 <filename>/etc/locale.conf</filename> 读取设置。
   </para>
   <para>
    不过，仍将会使用 <filename>/etc/sysconfig/language</filename> 中定义的变量。这些变量会覆盖系统范围的区域设置，并可用于定义用户外壳的不同区域设置（请参见<xref linkend="sec-suse-l10n-examples"/>）。
   </para>
  </note>

  <para>要设置系统范围的区域设置，您可以采用以下其中一种方式：</para>
  <itemizedlist>
   <listitem>
    <para>
     在 <filename>/etc/locale.conf</filename> 中写入您的设置。每行指派一个环境类变量（有关变量列表，请参见 <command>man 5 locale.conf</command>）：
    </para>
    <screen>LANG=de_DE.UTF-8</screen>
    <para>
     要微调设置，可以添加更多的变量（每行一个变量）。
    </para>
   </listitem>
   <listitem>
    <para>
     使用命令 <command>localectl</command>：
    </para>
<screen><prompt role="root"># </prompt><command>localectl</command> set-locale LANG=de_DE.UTF-8</screen>
    <para>同样，您也可以在 <command>localectl set-locale</command> 命令后面指定更多的变量。</para>
   </listitem>
  </itemizedlist>

  <para>
   在更新 systemd 软件包期间为了与旧系统保持向后兼容，上述所有变量都将从 sysconfig 迁移到其最终目标（如果尚未在这些目标中定义这些变量）。
  </para>
 </sect2>

 <sect2 xml:id="sec-suse-l10n-examples">
  <title>一些示例</title>
  <remark>toms 2019-05-21: This section should be restructured as
  it not completely deals with generating locales.
  Postponed to a later point.
  </remark>
  <para>
   语言和国家/地区代码始终应该一起设置。语言设置遵循 ISO  639 标准（可从 <link xlink:href="http://www.evertype.com/standards/iso639/iso639-en.html"/> 和 <link xlink:href="http://www.loc.gov/standards/iso639-2/"/> 上获取）。国家/地区代码在 ISO 3166（参见 <link xlink:href="http://en.wikipedia.org/wiki/ISO_3166"/>）中列出。
  </para>
  <para>
   只有设置可以在 <filename>/usr/lib/locale</filename> 中找到其可用描述文件的值才有意义。可以在 <filename>/usr/share/i18n</filename> 中的文件中使用命令 <command>localedef</command> 创建其他说明文件。说明文件是 <systemitem>glibc-i18ndata</systemitem> 软件包的一部分。可以使用以下命令创建 <literal>en_US.UTF-8</literal>（用于英国英语和美国英语）的描述文件：
  </para>

  <remark role="trans">Change the description file in the previous para and the
   following screen to something appropriate for your language.</remark>
<screen>localedef -i en_US -f UTF-8 en_US.UTF-8</screen>
  <variablelist>
   <varlistentry>
    <term>
<systemitem>LANG=en_US.UTF-8</systemitem>
    </term>
    <listitem>
     <para>
      如果在安装过程中选择的是美国英语，则这是默认设置。如果选择了其他语言，则将支持该语言，但仍使用 UTF-8 作为字符编码。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>
<systemitem>LANG=en_US.ISO-8859-1</systemitem>
    </term>
    <listitem>
     <para>
      这会将语言设置为英语，将国家/地区设置为美国，将字符集设置为 <literal>ISO-8859-1</literal>。此字符集不支持欧元符号，但它有时可用于尚未进行更新以支持 <literal>UTF-8</literal> 的程序。随后，Emacs 等程序将对定义字符集的字符串（在本例中为 <literal>ISO-8859-1</literal>）进行求值。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term><systemitem>LANG=en_IE@euro</systemitem>
    </term>
    <listitem>
     <para>
      上例将欧元符号显式包含在语言设置中。此设置现已过时，因为 UTF-8 也可涵盖欧元符号。仅当应用程序支持 ISO-8859-15 而不是 UTF-8 时，它才有用。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   对 <filename>/etc/sysconfig/language</filename> 所做的更改将通过以下过程链来激活：
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     对于 Bash：<filename>/etc/profile</filename> 读取 <filename>/etc/profile.d/lang.sh</filename>，后者则分析 <filename>/etc/sysconfig/language</filename>。
    </para>
   </listitem>
   <listitem>
    <para>
     对于 tcsh：<filename>/etc/csh.login</filename> 在登录时读取 <filename>/etc/profile.d/lang.csh</filename>，后者则分析 <filename>/etc/sysconfig/language</filename>。
    </para>
   </listitem>
  </itemizedlist>
  <para>
   这确保了对 <filename>/etc/sysconfig/language</filename> 所做的任何更改在下次登录到相应外壳时均可用，而无需手动将其激活。
  </para>
  <para>
   用户可以通过相应地编译他们的 <filename>~/.bashrc</filename> 覆盖系统默认值。例如，如果不想对程序消息使用系统范围的 <literal>en_US</literal>，请加入 <systemitem>LC_MESSAGES=es_ES</systemitem>，这样消息将以西班牙语显示。
  </para>
 </sect2>

 <sect2 xml:id="sec-suse-l10n-dot-i18n">
  <title><filename>~/.i18n </filename>中的区域设置</title>
  <para>
   如果您对系统默认的区域设置不满意，请根据 Bash 脚本编写语法更改 <filename>~/.i18n</filename> 中的设置。<filename>~/.i18n </filename>中的项覆盖来自 <filename>/etc/sysconfig/language</filename> 中的系统默认值。使用相同的变量名称，但不使用 <literal>RC_</literal> 名称空间前缀。例如，使用 <literal>LANG</literal> 而非 <literal>RC_LANG</literal>：
  </para>
<screen>LANG=cs_CZ.UTF-8
LC_COLLATE=C</screen>
 </sect2>

 <sect2 xml:id="sec-suse-l10n-fallback">
  <title>语言支持的设置</title>
  <para>
   <emphasis>消息</emphasis>类别中的文件通常只储存在对应的语言目录（例如<filename> en</filename>）中以保留后备。如果将 <systemitem>LANG</systemitem> 设置为 <literal>en_US</literal> 并且 <filename>/usr/share/locale/en_US/LC_MESSAGES</filename> 中的消息文件不存在，则它将使用 <filename>/usr/share/locale/en/LC_MESSAGES</filename>。
  </para>
  <para>
   还可以定义后备语言，例如，将布列塔尼语作为法语的后备语言，将加利西亚语作为葡萄牙语的后备语言。
  </para>
  <para>
   <systemitem>LANGUAGE="br_FR:fr_FR"</systemitem>
  </para>
  <para>
   <systemitem>LANGUAGE="gl_ES:es_ES:pt_PT"</systemitem>
  </para>
  <para>
   如果需要，可改用挪威语变体 Nynorsk 和 Bokmal（将其它后备语言设置为 <literal>no</literal>）：
  </para>
  <para>
   <systemitem>LANG="nn_NO"</systemitem>
  </para>
  <para>
   <systemitem>LANGUAGE="nn_NO:nb_NO:no"</systemitem>
  </para>
  <para>
   或
  </para>
  <para>
   <systemitem>LANG="nb_NO"</systemitem>
  </para>
  <para>
   <systemitem>LANGUAGE="nb_NO:nn_NO:no"</systemitem>
  </para>
  <para>
   请注意，在挪威语中，<systemitem>LC_TIME</systemitem> 的处理方式也有所不同。
  </para>
  <remark>The following example does not make sense  for 'en'; that's why I
   use 'de' as an example here. -ke- </remark>

  <para>
   可能会出现一个问题，那就是无法正确识别用于分隔成组数位的分隔符。如果 <systemitem>LANG</systemitem> 设置为仅两个字母的语言代码（如 <literal>de</literal>），但使用的定义文件 glibc 位于 <filename>/usr/share/lib/de_DE/LC_NUMERIC</filename>，则将出现此问题。因此必须将 <systemitem>LC_NUMERIC</systemitem> 设置为 <literal>de_DE</literal> 以使系统能够识别出分隔符定义。
  </para>
 </sect2>

 <sect2 xml:id="sec-suse-l10n-info">
  <title>更多信息</title>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     《<emphasis>GNU C 库参考手册</emphasis>》中的<quote>区域设置和国际化</quote>一章。它包含在软件包 <package>glibc-info</package>.
    </para>
   </listitem>
   <listitem>
    <para>
     Markus Kuhn 编写的 <emphasis>Unix/Linux 的 UTF-8 和 Unicode 常见问题解答</emphasis>，当前位于 <link xlink:href="https://www.cl.cam.ac.uk/~mgk25/unicode.html"/>。
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>
