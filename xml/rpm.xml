<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="rpm.xml" version="5.0" xml:id="sec.rpm">
 <title>RPM - der Paket-Manager</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>Ja</dm:translation>
  </dm:docmanager>
 </info><indexterm xml:id="idx.RPM" class="startofrange">

 <primary>RPM</primary></indexterm><indexterm>

 <primary>Pakete</primary>

 <secondary>RPMs</secondary></indexterm><indexterm>

 <primary>Pakete</primary>

 <secondary>Paket-Manager</secondary></indexterm><indexterm>

 <primary>Befehle</primary>

 <secondary>rpm</secondary></indexterm>

 <para>
  RPM (RPM Package Manager) wird für die Verwaltung von Softwarepaketen verwendet. Seine Hauptbefehle lauten <command>rpm</command> und <command>rpmbuild</command>. In der leistungsstarken RPM-Datenbank können Benutzer, Systemadministratoren und Paketersteller ausführliche Informationen zur installierten Software abfragen.
 </para><indexterm>

 <primary>rpmbuild</primary></indexterm><indexterm>

 <primary>Befehle</primary>

 <secondary>rpmbuild</secondary></indexterm>

 <para>
  Im Wesentlichen hat <command>rpm</command> fünf Modi: Installieren/Deinstallieren (oder Aktualisieren) von Software-Paketen, Neuaufbauen der RPM-Datenbank, Abfragen der RPM-Basis oder individuellen RPM-Archive, Integritätsprüfung der Pakete und Signieren von Paketen. <command>rpmbuild</command> ermöglicht das Aufbauen installierbarer Pakete von Pristine-Quellen.
 </para>

 <para>
  Installierbare RPM-Archive sind in einem speziellen binären Format gepackt. Diese Archive bestehen aus den zu installierenden Programmdateien und aus verschiedenen Metadaten, die bei der Installation von <command>rpm</command> benutzt werden, um das jeweilige Softwarepaket zu konfigurieren, oder die zu Dokumentationszwecken in der RPM-Datenbank gespeichert werden. RPM-Archive haben für gewöhnlich die Dateinamenserweiterung <filename>.rpm</filename>.
 </para><indexterm>

 <primary>Pakete</primary>

 <secondary>LSB</secondary></indexterm><indexterm>

 <primary>LSB</primary>

 <secondary>Installieren von Paketen</secondary></indexterm>

 <tip>
  <title>Pakete zur Software-Entwicklung</title>
  <para>
   Für mehrere Pakete wurden die erforderlichen Komponenten für die Software-Entwicklung (Bibliotheken, Header, Include-Dateien usw.) in separate Pakete verpackt. Diese Entwicklungspakete werden nur benötigt, wenn Sie Software selbst kompilieren möchten (beispielsweise die neuesten GNOME-Pakete). Solche Pakete sind am Namenszusatz <literal>-</literal> zu erkennen, z. B. die Pakete <systemitem class="resource">alsa-devel</systemitem> und <systemitem class="resource">gimp-devel</systemitem>.
  </para>
 </tip>

 <sect2 xml:id="sec.rpm.package_auth">
  <title>Prüfen der Authentizität eines Pakets</title><indexterm>
  <primary>RPM</primary>
  <secondary>Prüfen</secondary></indexterm><indexterm>
  <primary>Pakete</primary>
  <secondary>Prüfen</secondary></indexterm>
  <para>
   RPM-Pakete sind mit GPG signiert. Verwenden Sie zum Verifizieren der Signatur eines RPM-Pakets das Kommando <command>rpm --checksig </command>
   <replaceable>package</replaceable>-1.2.3.rpm. So können Sie feststellen, ob das Paket von SUSE oder einer anderen verbürgten Einrichtung stammt. Dies ist insbesondere bei Update-Paketen aus dem Internet zu empfehlen.
  </para>

  <para os="sles;sled">
   Zum Beheben von Problemen im Betriebssystem müssen Sie ggf. einen PTF (Problem Temporary Fix, temporäre Fehlerbehebung) in einem Produktionssystem installieren. Die Pakete von SUSE sind mit einem besonderen PTF-Schlüssel signiert. Im Gegensatz zu SUSE Linux Enterprise 11 wird dieser Schlüssel jedoch nicht standardmäßig von SUSE Linux Enterprise 12-Systemen importiert. Importieren Sie den Schlüssel mit dem folgenden Befehl:
  </para>
<screen os="sles;sled">rpm --import /usr/share/doc/packages/suse-build-key/suse_ptf_key.asc</screen>
  <para os="sles;sled">
   Nach dem Importieren des Schlüssels können Sie PTF-Pakete auf dem System installieren.
  </para>
 </sect2>

 <sect2 xml:id="sec.rpm.packages_manage">
  <title>Verwalten von Paketen: Installieren, Aktualisieren und Deinstallieren</title><indexterm>
  <primary>Installieren</primary>
  <secondary>Pakete</secondary></indexterm><indexterm>
  <primary>Pakete</primary>
  <secondary>Installieren</secondary></indexterm><indexterm>
  <primary>Pakete</primary>
  <secondary>Deinstallieren</secondary></indexterm><indexterm>
  <primary>RPM</primary>
  <secondary>rpmorig</secondary></indexterm><indexterm>
  <primary>RPM</primary>
  <secondary>rpmsave</secondary></indexterm><indexterm>
  <primary>RPM</primary>
  <secondary>rpmnew</secondary></indexterm>
  <para>
   In der Regel kann ein RPM-Archiv einfach installiert werden: <command>rpm -i </command> <replaceable>package</replaceable>.rpm. Mit diesem Kommando wird das Paket aber nur dann installiert, wenn seine Abhängigkeiten erfüllt sind und keine Konflikte mit anderen Paketen bestehen. <command>rpm</command>fordert per Fehlermeldung die Pakete an, die zum Erfüllen der Abhängigkeiten installiert werden müssen. Im Hintergrund wacht die RPM-Datenbank darüber, dass keine Konflikte entstehen: Eine spezifische Datei darf nur zu einem Paket gehören. Durch die Wahl anderer Optionen können Sie <command>rpm</command> zwingen, diese Standards zu ignorieren, jedoch ist dies nur für Spezialisten gedacht. Andernfalls wird damit die Integrität des Systems gefährdet und möglicherweise die Update-Fähigkeit aufs Spiel gesetzt.
  </para><indexterm>
  <primary> RPM</primary>
  <secondary> Abhängigkeiten</secondary></indexterm>
  <para>
   Die Optionen <option>-U</option> oder <option>--upgrade</option> und <option>-F</option> oder <option>--freshen</option> können für das Update eines Pakets benutzt werden (z. B.: <command>rpm -F </command>
   <replaceable>paket</replaceable>.rpm). Dieser Befehl entfernt die Dateien der alten Version und installiert sofort die neuen Dateien. Der Unterschied zwischen den beiden Versionen besteht darin, dass mit <option>-U</option> auch Pakete installiert werden, die vorher nicht im System vorhanden waren, wohingegen mit <option>-F</option> nur zuvor installierte Pakete aktualisiert werden. Bei einem Update verwendet <command>rpm</command> zur sorgfältigen Aktualisierung der Konfigurationsdateien die folgende Strategie:
  </para><indexterm>
  <primary> RPM</primary>
  <secondary> Aktualisieren</secondary></indexterm>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Falls eine Konfigurationsdatei vom Systemadministrator nicht geändert wurde, installiert <command>rpm</command> die neue Version der entsprechenden Datei. Es sind keine Eingriffe seitens des Administrators nötig.
    </para>
   </listitem>
   <listitem>
    <para>
     Falls eine Konfigurationsdatei vom Systemadministrator vor dem Update geändert wurde, speichert <command>rpm</command> die geänderte Datei mit der Erweiterung <filename>.rpmorig</filename> oder <filename>.rpmsave</filename> (Sicherungsdatei) und installiert nur dann die Version aus dem neuen Paket, wenn sich die ursprünglich installierte Datei und die neue Version unterscheiden. Vergleichen Sie in diesem Fall die Sicherungsdatei (<filename>.rpmorig</filename> oder <filename>.rpmsave</filename>) mit der neu installierten Datei und nehmen Sie Ihre Änderungen erneut in der neuen Datei vor. Löschen Sie anschließend unbedingt alle <filename>.rpmorig</filename>- und <filename>.rpmsave</filename>-Dateien, um Probleme mit zukünftigen Updates zu vermeiden.
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>.rpmnew</filename>-Dateien erscheinen immer dann, wenn die Konfigurationsdatei bereits existiert <emphasis>und</emphasis> wenn die Kennung <option>noreplace</option> mit der <filename>.spec</filename>-Datei angegeben wurde.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Im Anschluss an ein Update sollten alle <filename>.rpmsave</filename>- und <filename>.rpmnew</filename>-Dateien nach einem Abgleich entfernt werden, damit sie bei zukünftigen Updates nicht stören. Die Erweiterung <filename>.rpmorig</filename> wird zugewiesen, wenn die Datei zuvor nicht von der RPM-Datenbank erkannt wurde.
  </para>
  <para>
   Andernfalls wird <filename>.rpmsave</filename> verwendet. Mit anderen Worten: <filename>.rpmorig</filename> entsteht bei einem Update von einem Fremdformat auf RPM. <filename>.rpmsave</filename> entsteht bei einem Update aus einem älteren RPM auf einen neueren RPM. <filename>.rpmnew </filename> informiert nicht darüber, ob der Systemadministrator die Konfigurationsdatei geändert hat. Eine Liste all dieser Dateien ist in <filename>/var/adm/rpmconfigcheck</filename> verfügbar. Einige Konfigurationsdateien (wie <filename>/etc/httpd/httpd.conf</filename>) werden nicht überschrieben, um den weiteren Betrieb zu ermöglichen.
  </para>
  <para>
   Der Schalter <option>-U</option> ist <emphasis>nicht</emphasis> einfach gleichbedeutend mit der Deinstallation mit der Option <option>-e</option> und der Installation mit der Option <option>-i</option>. Verwenden Sie <option>-U</option>, wann immer möglich.
  </para>
  <para>
   Zum Entfernen eines Pakets geben Sie <command>rpm -e</command>
   <replaceable> Paket</replaceable> ein. Dieses Kommando löscht das Paket nur, wenn keine ungelösten Abhängigkeiten vorhanden sind. Theoretisch ist es unmöglich, beispielsweise Tcl/Tk zu löschen, solange eine andere Anwendung Tcl/Tk noch benötigt. Auch in diesem Fall nutzt RPM die Datenbank zur Unterstützung. Falls in einem Ausnahmefall ein solcher Löschvorgang nicht möglich ist (selbst wenn <emphasis>keine</emphasis> Abhängigkeiten mehr bestehen), kann es nützlich sein, die RPM-Datenbank mit der Option <option>--rebuilddb</option> neu aufzubauen.
  </para><indexterm>
  <primary>RPM</primary>
  <secondary>Deinstallieren</secondary></indexterm><indexterm>
  <primary>RPM</primary>
  <secondary>Datenbank</secondary>
  <tertiary>Neu aufbauen</tertiary></indexterm>
 </sect2>

 <sect2 xml:id="sec.rpm.delta">
  <title>Delta-RPM-Pakete</title><indexterm>
  <primary>RPM</primary>
  <secondary>deltarpm</secondary></indexterm><indexterm>
  <primary>deltarpm</primary></indexterm>
  <para>
   Delta-RPM-Pakete enthalten die Unterschiede zwischen einer alten und einer neuen Version eines RPM-Pakets. Wenn Sie ein Delta-RPM auf ein altes RPM anwenden, ergibt dies ein ganz neues RPM. Es ist nicht erforderlich, dass eine Kopie des alten RPM vorhanden ist, da ein Delta-RPM auch mit einem installierten RPM arbeiten kann. Die Delta-RPM-Pakete sind sogar kleiner als Patch-RPMs, was beim Übertragen von Update-Paketen über das Internet von Vorteil ist. Der Nachteil ist, dass Update-Vorgänge mit Delta-RPMs erheblich mehr CPU-Zyklen beanspruchen als normale oder Patch-RPMs.
  </para>
  <para>
   Die Binärdateien <command>makedeltarpm</command> und <command>applydelta</command> sind Teil der Delta-RPM-Suite (Paket <systemitem>deltarpm</systemitem>) und helfen Ihnen beim Erstellen und Anwenden von Delta-RPM-Paketen. Mit den folgenden Befehlen erstellen Sie ein Delta-RPM mit dem Namen <filename>new.delta.rpm</filename>. Der folgende Befehl setzt voraus, dass <filename>old.rpm</filename> und <filename>new.rpm</filename> vorhanden sind:
  </para>
<screen>makedeltarpm old.rpm new.rpm new.delta.rpm</screen>
  <para>
   Mit <command>applydeltarpm</command> können Sie den neuen RPM aus dem Dateisystem rekonstruieren, wenn das alte Paket bereits installiert ist:
  </para>
<screen>applydeltarpm new.delta.rpm new.rpm</screen>
  <para>
   Um es aus dem alten RPM abzuleiten, ohne auf das Dateisystem zuzugreifen, verwenden Sie die Option <option>-r</option>:
  </para>
<screen>applydeltarpm -r old.rpm new.delta.rpm new.rpm</screen>
  <para>
   Technische Details finden Sie in <filename>/usr/share/doc/packages/deltarpm/README</filename>.
  </para>
 </sect2>

 <sect2 xml:id="sec.rpm.query">
  <title> RPM Abfragen </title><indexterm>
  <primary> RPM</primary>
  <secondary> Abfragen</secondary></indexterm>
  <para>
   Mit der Option <option>-q</option> initiiert <command>rpm</command> Abfragen und ermöglicht es, ein RPM-Archiv zu prüfen (durch Hinzufügen der Option <option>-p</option>) und die RPM-Datenbank nach installierten Paketen abzufragen. Zur Angabe der benötigten Informationsart stehen mehrere Schalter zur Verfügung. Weitere Informationen hierzu finden Sie unter <xref linkend="tab.rpm.query"/>.
  </para>
  <table xml:id="tab.rpm.query">
   <title>Die wichtigsten RPM-Abfrageoptionen</title>
   <tgroup cols="2">
    <tbody>
     <row>
      <entry>
       <para>
        <option>-i</option>
       </para>
      </entry>
      <entry>
       <para>
        Paketinformation
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-l</option>
       </para>
      </entry>
      <entry>
       <para>
        Dateiliste
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-f FILE</option>
       </para>
      </entry>
      <entry>
       <para>
        Abfrage nach Paket, das die Datei <replaceable>FILE</replaceable> enthält. (<replaceable>FILE</replaceable> muss mit dem vollständigen Pfad angegeben werden.)
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-s</option>
       </para>
      </entry>
      <entry>
       <para>
        Dateiliste mit Statusinformation (impliziert <option>-l</option>)
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-d</option>
       </para>
      </entry>
      <entry>
       <para>
        Nur Dokumentationsdateien auflisten (impliziert <literal>-l</literal>)
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-c</option>
       </para>
      </entry>
      <entry>
       <para>
        Nur Konfigurationsdateien auflisten (impliziert <option>-l</option>)
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>--dump</option>
       </para>
      </entry>
      <entry>
       <para>
        Dateiliste mit vollständigen Details (mit <option>-l</option>, <option>-c</option> oder <option>-d</option> benutzen)
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>--provides</option>
       </para>
      </entry>
      <entry>
       <para>
        Funktionen des Pakets auflisten, die ein anderes Paket mit <option>--requires</option> anfordern kann
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>--requires</option>, <option>-R</option>
       </para>
      </entry>
      <entry>
       <para>
        Fähigkeiten, die das Paket benötigt
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>--Skripten</option>
       </para>
      </entry>
      <entry>
       <para>
        Installationsskripten (preinstall, postinstall, uninstall)
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>
  <para>
   Beispielsweise gibt der Befehl <command>rpm -q -i wget</command> die in <xref linkend="aus.update.rpm-i"/> gezeigte Information aus.
  </para>
  <example xml:id="aus.update.rpm-i">
   <title><command>rpm -q -i wget</command></title>
<screen>Name        : wget
Version     : 1.14
Release     : 10.3
Architecture: x86_64
Install Date: Fr 14 Jul 2017 16:09:58 CEST
Group       : Productivity/Networking/Web/Utilities
Size        : 2046452
License     : GPL-3.0+
Signature   : RSA/SHA256, Mi 10 Mai 2017 02:40:21 CEST, Key ID b88b2fd43dbdc284
Source RPM  : wget-1.14-10.3.src.rpm
Build Date  : Mi 10 Mai 2017 02:40:12 CEST
Build Host  : lamb55
Relocations : (not relocatable)
Packager    : http://bugs.opensuse.org
Vendor      : openSUSE
URL         : http://www.gnu.org/software/wget/
Summary     : A Tool for Mirroring FTP and HTTP Servers
Description :
Wget enables you to retrieve WWW documents or FTP files from a server.
This can be done in script files or via the command line.
Distribution: openSUSE Leap 42.3</screen>
  </example>
  <para>
   Die Option <option>-f</option> funktioniert nur, wenn Sie den kompletten Dateinamen mit dem vollständigen Pfad angeben. Sie können beliebig viele Dateinamen angeben. Beispielsweise führt der folgende Befehl
  </para>
<screen>rpm -q -f /bin/rpm /usr/bin/wget</screen>
  <para>
   zum Ergebnis:
  </para>
<screen>rpm-4.11.2-13.7.x86_64
wget-1.14-10.3.x86_64</screen>
  <para>
   Wenn nur ein Teil des Dateinamens bekannt ist, verwenden Sie ein Shell-Skript, wie in <xref linkend="dat.rpm.search"/> gezeigt. Übergeben Sie den partiellen Dateinamen als Parameter beim Aufruf des Skripts.
  </para>
  <example xml:id="dat.rpm.search">
   <title>Skript für die Suche nach Paketen</title>
<screen>#! /bin/sh
for i in $(rpm -q -a -l | grep $1); do
    echo "\"$i\" is in package:"
    rpm -q -f $i
    echo ""
done</screen>
  </example>
  <para>
   Der Befehl <command>rpm -q --changelog</command>
   <replaceable> Paket</replaceable> zeigt eine detaillierte Liste der Änderungsinformationen zu einem bestimmten Paket nach Datum sortiert.
  </para>
  <para>
   Mit der installierten RPM-Datenbank sind Überprüfungen möglich. Initiieren Sie sie mit <option>-V</option> oder <option>--verify</option>. Mit dieser Option zeigt <command>rpm</command> alle Dateien in einem Paket an, die seit der Installation geändert wurden. <command>rpm</command> verwendet acht verschiedene Zeichen als Hinweis auf die folgenden Änderungen:
  </para><indexterm>
  <primary> RPM</primary>
  <secondary> überprüfen</secondary></indexterm>
  <table xml:id="tab.rpm.verify">
   <title>RPM-Überprüfungsoptionen</title>
   <tgroup cols="2">
    <tbody>
     <row>
      <entry>
       <para>
        <option>5</option>
       </para>
      </entry>
      <entry>
       <para>
        MD5-Prüfsumme
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>S</option>
       </para>
      </entry>
      <entry>
       <para>
        Dateigröße
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>L</option>
       </para>
      </entry>
      <entry>
       <para>
        Symbolischer Link
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>T</option>
       </para>
      </entry>
      <entry>
       <para>
        Änderungszeit
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>D</option>
       </para>
      </entry>
      <entry>
       <para>
        Major- und Minor-Gerätenummern
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>U</option>
       </para>
      </entry>
      <entry>
       <para>
        Eigentümer
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>G</option>
       </para>
      </entry>
      <entry>
       <para>
        Gruppe
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>M</option>
       </para>
      </entry>
      <entry>
       <para>
        Modus (Berechtigungen und Dateityp)
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>
  <para>
   Bei Konfigurationsdateien wird der Buchstabe <option>c</option> ausgegeben. Beispielsweise für Änderungen an <filename>/etc/wgetrc</filename> (<systemitem class="resource">wget</systemitem>-Paket):
  </para>
<screen>rpm -V wget
S.5....T c /etc/wgetrc</screen>
  <para>
   Die Dateien der RPM-Datenbank werden in <filename>/var/lib/rpm</filename> abgelegt. Wenn die Partition <filename>/usr</filename> eine Größe von 1 GB aufweist, kann diese Datenbank beinahe 30 MB belegen, insbesondere nach einem kompletten Update. Wenn die Datenbank viel größer ist als erwartet, kann es nützlich sein, die Datenbank mit der Option <option>--rebuilddb</option> neu zu erstellen. Legen Sie zuvor eine Sicherungskopie der alten Datenbank an. Das <command>cron</command>-Skript <command>cron.daily</command> legt täglich (mit gzip gepackte) Kopien der Datenbank an und speichert diese unter <filename>/var/adm/backup/rpmdb</filename>. Die Anzahl der Kopien wird durch die Variable <systemitem>MAX_RPMDB_BACKUPS</systemitem> (Standard: <option>5</option>) in <filename>/etc/sysconfig/backup</filename> gesteuert. Die Größe einer einzelnen Sicherungskopie beträgt ungefähr 1 MB für 1 GB in <filename>/usr</filename>.
  </para><indexterm>
  <primary> RPM</primary>
  <secondary> Datembank</secondary>
  <tertiary> Neu erstellen</tertiary></indexterm>
 </sect2>

 <sect2 xml:id="sec.rpm.sources">
  <title>Installieren und Kompilieren von Quellpaketen</title>
  <para>
   Alle Quellpakete haben die Erweiterung <filename>.src.rpm</filename> (Source-RPM).
  </para>
  <note>
   <title>Installierte Quellpakete</title>
   <para>
    Quellpakete können vom Installationsmedium auf die Festplatte kopiert und mit YaST entpackt werden. Sie werden im Paket-Manager jedoch nicht als installiert (<literal>[i]</literal>) gekennzeichnet. Das liegt daran, dass die Quellpakete nicht in der RPM-Datenbank eingetragen sind. Nur <emphasis>installierte</emphasis> Betriebssystemsoftware wird in der RPM-Datenbank aufgeführt. Wenn Sie ein Quellpaket <quote>installieren</quote>, wird dem System nur der Quellcode hinzugefügt.
   </para>
  </note>
  <para>
   Die folgenden Verzeichnisse müssen für <command>rpm</command> und <command>rpmbuild</command> in <filename>/usr/src/packages</filename> vorhanden sein (es sei denn, Sie haben spezielle Einstellungen in einer Datei, wie <filename>/etc/rpmrc</filename>, festgelegt):
  </para>
  <variablelist>
   <varlistentry>
    <term><filename>SOURCES</filename>
    </term>
    <listitem>
     <para>
      für die originalen Quellen (<filename>.tar.bz2</filename> oder <filename>.tar.gz</filename> files, etc.) und für die distributionsspezifischen Anpassungen (meistens <filename>.diff</filename>- oder <filename>.patch</filename>-Dateien)
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>SPECS</filename>
    </term>
    <listitem>
     <para>
      für die <filename>.spec</filename>-Dateien, die ähnlich wie Meta-Makefiles den <emphasis>build</emphasis>-Prozess steuern
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>BUILD</filename>
    </term>
    <listitem>
     <para>
      Alle Quellen in diesem Verzeichnis werden entpackt, gepatcht und kompiliert.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>RPMS</filename>
    </term>
    <listitem>
     <para>
      Speicherort der fertigen Binärpakete
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>SRPMS</filename>
    </term>
    <listitem><indexterm>
     <primary>  RPM</primary>
     <secondary> SRPMS</secondary></indexterm>
     <para>
      Speicherort der Quell-RPMs
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Wenn Sie ein Quellpaket mit YaST installieren, werden alle erforderlichen Komponenten in <filename>/usr/src/packages</filename> installiert: die Quellen und Anpassungen in <filename>SOURCES</filename> und die relevante <filename>.spec</filename>-Datei in <filename>SPECS</filename>.
  </para>
  <warning>
   <title>Systemintegrität</title>
   <para>
    Experimentieren Sie nicht mit Systemkomponenten (<systemitem class="resource">glibc</systemitem>, <systemitem class="resource">rpm</systemitem> usw.), da Sie damit die Stabilität Ihres Systems riskieren.
   </para>
  </warning>
  <para>
   Das folgende Beispiel verwendet das <filename>wget.src.rpm</filename>-Paket. Nach der Installation des Quellpakets sollten Dateien wie in der folgenden Liste vorhanden sein:
  </para>
<screen>/usr/src/packages/SOURCES/wget-1.14.tar.bz2
/usr/src/packages/SOURCES/wgetrc.patch
/usr/src/packages/SPECS/wget.spec</screen>
  <para>
   Mit <command>rpmbuild</command> <option> -b<replaceable>X</replaceable></option>
   <filename> /usr/src/packages/SPECS/wget.spec</filename> wird die Kompilierung gestartet. <replaceable>X</replaceable> ist ein Platzhalter für verschiedene Stufen des build-Prozesses (Einzelheiten siehe in <option>--help</option> oder der RPM-Dokumentation). Nachfolgend wird nur eine kurze Erläuterung gegeben:
  </para>
  <variablelist>
   <varlistentry>
    <term><option>-bp</option>
    </term>
    <listitem>
     <para>
      Bereiten Sie Quellen in <filename>/usr/src/packages/BUILD</filename> vor: entpacken und patchen.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-bc</option>
    </term>
    <listitem>
     <para>
      Wie <option>-bp</option>, jedoch zusätzlich kompilieren.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-bi</option>
    </term>
    <listitem>
     <para>
      Wie <option>-bp</option>, jedoch zusätzlich die erstellte Software installieren. Vorsicht: Wenn das Paket die Funktion BuildRoot nicht unterstützt, ist es möglich, dass Konfigurationsdateien überschrieben werden.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-bb</option>
    </term>
    <listitem>
     <para>
      Wie <option>-bi</option>, jedoch zusätzlich das Binärpaket erstellen. Nach erfolgreicher Kompilierung sollte das Binärpaket in <filename>/usr/src/packages/RPMS</filename> sein.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-ba</option>
    </term>
    <listitem>
     <para>
      Wie <option>-bb</option>, jedoch zusätzlich den Quell-RPM erstellen. Nach erfolgreicher Kompilierung sollte dieses in <filename>/usr/src/packages/RPMS</filename> liegen.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--short-circuit</option>
    </term>
    <listitem>
     <para>
      Einige Schritte überspringen.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Der erstellte Binär-RPM kann nun mit <command>rpm </command>
   <option>-i</option> oder vorzugsweise mit <command>rpm </command>
   <option>-U</option> erstellt werden. Durch die Installation mit <command>rpm</command> wird er in die RPM-Datenbank aufgenommen.
  </para>
  <para>
   Beachten Sie, dass die Direktive <literal>BuildRoot</literal> in der
   Spezifikationsdatei ab &productname; 42.1 veraltet ist. Benötigen Sie die Funktion weiterhin, verwenden Sie die Option <option>--buildroot</option> als Alternative.
  </para>
 </sect2>

 <sect2 xml:id="sec.rpm.build">
  <title>Kompilieren von RPM-Pakten mit „build“</title><indexterm>
  <primary> Pakete</primary>
  <secondary> Kompilieren mit build</secondary></indexterm>
  <para>
   Bei vielen Paketen besteht die Gefahr, dass während der Erstellung ungewollt Dateien in das laufende System kopiert werden. Um dies zu vermeiden, können Sie <systemitem>build</systemitem> verwenden, das eine definierte Umgebung herstellt, in der das Paket erstellt wird. Zum Aufbau dieser chroot-Umgebung muss dem <command>build</command>-Skript ein kompletter Paketbaum zur Verfügung stehen. Dieser kann auf Festplatte, über NFS oder auch von DVD bereitgestellt werden. Legen Sie die Position mit <command>build --rpms </command>
   <replaceable>verzeichnis fest</replaceable>. Im Unterschied zu <command>rpm</command> sucht das Kommando <command>build</command> die <filename>-spec</filename>-Datei im Quellverzeichnis. Wenn Sie, wie im obigen Beispiel, <filename>wget</filename> neu erstellen möchten und die DVD unter <filename>/media/dvd</filename> im System eingehängt ist, verwenden Sie als Benutzer <systemitem class="username">root</systemitem> folgende Kommandos:
  </para>
<screen>cd /usr/src/packages/SOURCES/
mv ../SPECS/wget.spec .
build --rpms /media/dvd/suse/ wget.spec</screen>
  <para>
   Anschließend wird in <filename>/var/tmp/build-root</filename> eine minimale Umgebung eingerichtet. Das Paket wird in dieser Umgebung erstellt. Danach befinden sich die resultierenden Pakete in <filename>/var/tmp/build-root/usr/src/packages/RPMS</filename>.
  </para>
  <para>
   Das Skript <command>build</command> bietet mehrere zusätzliche Optionen. Beispielsweise können Sie das Skript veranlassen, Ihre eigenen RPMs bevorzugt zu verwenden, die Initialisierung der build-Umgebung auszulassen oder das Kommando <command>rpm</command> auf eine der oben erwähnten Stufen zu beschränken. Weitere Informationen erhalten Sie über <command>build</command> <option>--help</option> oder die man-Seite <command>build</command>.
  </para>
 </sect2>

 <sect2 xml:id="sec.rpm.tools">
  <title>Werkzeuge für RPM-Archive und die RPM-Datenbank</title><indexterm>
  <primary>RPM</primary>
  <secondary>Werkzeuge</secondary></indexterm>
  <para>
   Midnight Commander (<command>mc</command>) kann den Inhalt von RPM-Archiven anzeigen und Teile daraus kopieren. Archive werden als virtuelle Dateisysteme dargestellt und bieten alle üblichen Menüoptionen von Midnight Commander. Zeigen Sie den <filename>HEADER</filename> mit <keycap>F3</keycap> an. Zeigen Sie die Archivstruktur mit den Cursortasten und der <keycap function="enter"/> an. Kopieren Sie Archivkomponenten mit <keycap>F5</keycap>.
  </para>
  <para>
   Ein Paket-Manager mit allen Funktionen ist als YaST-Modul verfügbar. Weitere Informationen finden Sie unter <xref linkend="cha.y2.sw"/>.
  </para><indexterm class="endofrange" startref="idx.RPM"/>

 </sect2>
</sect1>
