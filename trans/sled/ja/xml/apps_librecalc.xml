<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="apps_librecalc.xml" id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <para>
  Calcは、LibreOfficeのスプレッドシートおよびデータプロットモジュールです。スプレッドシートは、テキスト、数値、数式などの要素を入力できるセルを含むシートから構成されます。式を使用すれば、他のセルからのデータを操作して、式を挿入したセルの値を生成できます。Calcでは、データの範囲を指定したり、データにフィルタを適用してソートしたり、データからチャートを作成してグラフィカルに表現することができます。DataPilotsを使用することにより、より大量のデータの組み合わせ、分析、比較を行うことができます。
 </para>
 <para>
  LibreOfficeスイート全体の場合と同じように、Calcはさまざまなプラットフォームで使用できます。多数の交換フォーマット(PDF文書に対するエクスポートを含む)を提供しており、Microsoft Excelフォーマットでのファイルの読み取り、保存を行うことができます。その相互運用性は常に強化されています。
 </para>
 <para>
  この章では、非常に基本的なCalc機能のみを紹介します。詳細について、および全手順については、LibreOfficeのヘルプ、または<xref linkend="sec.oo.oview.help"/>の資料を参照してください。
 </para>
 <note>
  <title>VBAマクロ</title>
  <para>
   また、Calcでは、Excelドキュメントの多数のVBAマクロを処理することができます。ただし、すべてのVBAマクロをサポートしている訳ではありません。マクロを多用するExcelスプレッドシートを開くとき、一部のマクロが機能しないことがあります。
  </para>
 </note>
 <sect1 id="sec.oo.calc.createnew">
  <title>新しい文書の作成</title>

  <para>
   新しいCalc文書を作成するには、次の2種類の方法があります。
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>最初から</title>
     <para>
      最初からドキュメントを作成するには、<menuchoice><guimenu>ファイル</guimenu><guimenu>新規</guimenu><guimenu>スプレッドシート</guimenu></menuchoice>の順にクリックし、新しい空のCalc文書が作成されます。
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>テンプレート</title>
     <para>
      テンプレートを使用するには、<menuchoice><guimenu>ファイル</guimenu><guimenu>新規</guimenu><guimenu>テンプレートと文書</guimenu></menuchoice>の順にクリックし、<guimenu>ファイナンス</guimenu>を開きます。スプレッドシートテンプレートのリストが表示されます。ニーズに合ったテンプレートを選択すると、選択したテンプレートのスタイルに基づいて新しい文書が作成されます。
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   ウィンドウ下部の対応するタブをクリックすることにより、個別のシートにアクセスします。
  </para>

  <para>
   必要に応じてセルにデータを入力します。外観を調整するには、<guimenu>の説明に従って、［</guimenu>書式設定<guimenu>］ツールバーまたは［</guimenu>書式<xref linkend="sec.oo.calc.styles"/>］メニューを使用してスタイルを定義します。<guimenu>ファイル</guimenu>メニューまたはツールバーの該当するボタンを使用して、文書を印刷または保存します。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.styles">
  <title>Calcでの書式設定とスタイルの使用</title>

  <para>
   Calcには、スプレッドシートやレポートの外観を変更するセルやページ用スタイルがいくつか用意されています。通常はこれらのスタイルでも十分ですが、必要に応じて独自のスタイルを作成することもできます。
  </para>

  <procedure id="pro.oo.calc.createstyle">
   <title>スタイルの作成</title>
   <step performance="required">
    <para>
     <menuchoice><guimenu>書式</guimenu><guimenu>スタイルと書式</guimenu></menuchoice>の順にクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>スタイルと書式</guimenu>ウィンドウの上部から、<guimenu>セルスタイル</guimenu>または<guimenu>ページスタイル</guimenu>のいずれかのアイコンをクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>スタイルと書式</guimenu>ウィンドウを右クリックし、<guimenu>新規</guimenu>をクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     スタイルの名前を入力し、さまざまなタブを使用して希望どおり書式設定オプションをセットします。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>OK</guimenu>をクリックします。
    </para>
   </step>
  </procedure>

  <procedure>
   <title>スタイルの変更</title>
   <step performance="required">
    <para>
     <menuchoice><guimenu>書式</guimenu><guimenu>スタイルと書式</guimenu></menuchoice>の順にクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>スタイルと書式</guimenu>ウィンドウで、<guimenu>Cell Styles</guimenu>または、<guimenu>Page Styles</guimenu>アイコンをクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     変更したいスタイルの名前を右クリックし、<guimenu>変更</guimenu>をクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     選択した書式設定オプションを変更します。
    </para>
   </step>
   <step performance="required">
    <para>
     ［OK］をクリックします。
    </para>
   </step>
  </procedure>

  <para>
   スタイルを特定のセルに適用するには、書式設定するセルを選択します。続いて、<guimenu>スタイルと書式設定</guimenu>ウィンドウで適用するスタイルをダブルクリックします。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.sheets">
  <title>シートでの作業</title>

  <para>
   シートは計算をまとめるには最適な方法です。たとえば、月ごとにシートを作成した場合、ビジネスの経理がより明確になります。
  </para>

  <para>
   スプレッドシートに新しいシートを挿入するには、次の手順に従います。
  </para>

  <procedure>
   <title>新しいシートの挿入</title>
   <step performance="required">
    <para>
     メインメニューから<menuchoice><guimenu>挿入</guimenu><guimenu>シート</guimenu></menuchoice>の順に選択します。ダイアログボックスが開きます。
    </para>
   </step>
   <step performance="required">
    <para>
     新しいシートを選択したシートの前に置くか後ろに置くかを指定します。
    </para>
   </step>
   <step performance="required">
    <para>
     新しいシートを作成する場合、必ず<guimenu>新規のシート</guimenu>ラジオボタンが有効になっていることを確認してください。シート数とシート名を入力します。次の手順をスキップします。
    </para>
   </step>
   <step performance="required">
    <para>
     別のファイルからシートをインポートする場合は、次の手順に従ってください。それ以外の場合は、この手順をスキップします。
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       <guimenu>ファイルから</guimenu>を選択し、<guimenu>参照</guimenu>をクリックします。
      </para>
     </step>
     <step performance="required">
      <para>
       ファイル名を選択し、<guimenu>OK</guimenu>を押して確認します。これですべてのシート名がリストに表示されます。
      </para>
     </step>
     <step performance="required">
      <para>
       <keycap function="shift"/>キーを押しながら、インポートするシート名を選択します。
      </para>
     </step>
     <step performance="required">
      <para>
       <guimenu>OK</guimenu>を押して確認すると、選択したシート名がインポートされます。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   シートの名前を変更するには、シートのシートタブを右クリックし、<guimenu>シート名を変更</guimenu>を選択します。
  </para>

  <para>
   現在のシートを削除するには、<menuchoice><guimenu>編集</guimenu><guimenu>シート</guimenu><guimenu>削除</guimenu></menuchoice>の順に選択し、<guimenu>シートの削除</guimenu>を押して確認します。&lt;<keycap function="shift"/>&gt;キーを押しながら、シートタブで削除するシートを選択すると複数のシートを削除できます。右クリックし、<guimenu>シートの削除</guimenu>を選択すると、同じダイアログが表示されます。<guimenu>シートの削除</guimenu>を押して確認します。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.condformat">
  <title>条件付き書式設定</title>

  <para>
   条件付き書式設定は、スプレッドシートで特定の値を強調表示する役立つ機能です。たとえば、条件を定義し、その条件が真の場合、スタイルはこの条件を満たすそれぞれのセルに適用されます。
  </para>

  <note>
   <title>自動計算の有効化</title>
   <para>
    条件付き書式設定を適用する前に、<menuchoice><guimenu>ツール</guimenu><guimenu>セルの内容</guimenu><guimenu>自動計算</guimenu></menuchoice>の順に選択します。<guimenu>自動計算</guimenu>の前のチェックマークを確認してください。
   </para>
  </note>

  <para>
   次の手順に従います。
  </para>

  <procedure id="pro.oo.calc.condformat">
   <title>条件付き書式設定の使用</title>
   <step performance="required">
    <para>
     最初にスタイルを定義します。このスタイルは、条件が真の場合に各セルに適用されます。<menuchoice><guimenu>書式</guimenu><guimenu>スタイルと書式設定</guimenu></menuchoice>を使用するか、<keycap>F11</keycap>を押します。詳細については、<xref linkend="pro.oo.calc.createstyle"/>を参照してください。<guimenu>OK</guimenu>をクリックして、確定します。
    </para>
   </step>
   <step performance="required">
    <para>
     条件を適用するセル範囲を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     メインメニューから<menuchoice><guimenu>書式</guimenu><guimenu>条件付き書式設定</guimenu><guimenu>条件付き書式設定</guimenu></menuchoice>の順に選択します。ダイアログが開きます。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>追加</guimenu>をクリックして、条件を決定します。最高3つまで条件を定義できます。3つの条件はそれぞれ個別に有効または無効にできます。条件は、<quote>セルモード</quote>または<quote>式モード</quote>で機能します。
    </para>
    <variablelist>
     <varlistentry>
      <term>セルモード</term>
      <listitem>
       <para>
        条件は、特定のセル値に一致するかどうかについて調べられます。最初のプルダウンメニューの横で、等号、より小さい、より大きいなどの演算子を選択できます。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>式モード</term>
      <listitem>
       <para>
        条件は、特定の式が真を返すかどうかについて調べられます。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step performance="required">
    <para>
     モードに応じて、次のように入力します。
    </para>
    <substeps performance="required">
     <step performance="required">
      <formalpara>
       <title>セルモード</title>
       <para>
        演算子とセルの値を選択します。
       </para>
      </formalpara>
     </step>
     <step performance="required">
      <formalpara>
       <title>式モード</title>
       <para>
        調べる関数を選択します。
       </para>
      </formalpara>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     この条件が真の場合に適用するスタイルを選択するか、<guimenu>新しいスタイル</guimenu>をクリックして新しい外観を定義します。
    </para>
   </step>
   <step performance="required">
    <para>
     追加の条件が必要な場合は、前の手順を繰り返します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>OK</guimenu>をクリックして、確定します。
    </para>
   </step>
  </procedure>

  <para>
   これでセルのスタイルが変更されました。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.grouping">
  <title>セルのグループ化とグループ化解除</title>

  <para>
   セル範囲をグループ化すると、スプレッドシートをパーツに折り畳むことができます。これにより、スプレッドシートが見やすくなり、現在必要なパーツだけを表示できます。行または列をグループ化したり、グループを他のグループの入れ子にすることができます。
  </para>

  <para>
   範囲をグループ化するには、次の手順に従います。
  </para>

  <procedure>
   <title>選択したセル範囲のグループ化</title>
   <step performance="required">
    <para>
     スプレッドシートでセル範囲を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     <menuchoice><guimenu>データ</guimenu><guimenu>グループとアウトライン</guimenu><guimenu>グループ化</guimenu></menuchoice>の順に選択します。ダイアログボックスが表示されます。
    </para>
   </step>
   <step performance="required">
    <para>
     選択した範囲を行としてグループ化するか、列としてグループ化するかを指定します。<guimenu>OK</guimenu>をクリックして、確定します。
    </para>
   </step>
  </procedure>

  <para>
   選択したセルをグループ化した後、グループ化したセル範囲を示す線が、左上の余白に表示されます。<guimenu>+</guimenu>と<guimenu>-</guimenu>のアイコンを使用して、セル範囲を折り畳んだり、展開します。余白の数値はグループの深さを示し、クリックすることもできます。
  </para>

  <para>
   セル範囲をグループ化解除するには、グループに含まれるセルをクリックして、<menuchoice><guimenu>データ</guimenu><guimenu>グループとアウトライン</guimenu><guimenu>グループ化解除</guimenu></menuchoice>の順に選択します。余白内の線が消えます。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.freezing">
  <title>ヘッダとする行または列の固定</title>

  <para>
   多数のデータを含むスプレッドシートがある場合、通常、スクロールするとヘッダが消えてしまいます。LibreOfficeは、行または列、あるいはその両方をロックして、スクロールしたときでもそれらが表示されたままにします。
  </para>

  <para>
   単一の行または単一の列を固定するには、次の手順に従います。
  </para>

  <procedure>
   <title>単一の行または列の固定</title>
   <step performance="required">
    <para>
     行を固定するには、左の帯で行のヘッダをクリックします。
    </para>
    <para>
     列を固定するには、列のヘッダをクリックします。列のヘッダは、アイコンバーの下にある、A、B、およびCなどのラベルが付いた帯です。
    </para>
   </step>
   <step performance="required">
    <para>
     <menuchoice><guimenu>ウィンドウ</guimenu><guimenu>位置を固定</guimenu></menuchoice>の順に選択します。濃い色の線が表示され、行または列が存続していることを示します。
    </para>
   </step>
  </procedure>

  <para>
   また、行と列の両方を固定することもできます。次の手順に従います。
  </para>

  <procedure>
   <title>行と列の固定</title>
   <step performance="required">
    <para>
     固定する列の右側と行の下にあるセルをクリックします。たとえば、ヘッダがA1からB3の範囲を占める場合、セルC4をクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     <menuchoice><guimenu>ウィンドウ</guimenu><guimenu>位置を固定</guimenu></menuchoice>の順に選択します。濃い色の線が表示され、行または列が存続していることを示します。
    </para>
   </step>
  </procedure>

  <para>
   固定を元に戻す場合は、<menuchoice><guimenu>ウィンドウ</guimenu><guimenu>位置を固定</guimenu></menuchoice>の順に選択すると、チェックマークが消えます。
  </para>
 </sect1>
 <sect1 id="sec.oo.calc.moreinfo">
  <title>詳細情報</title>

  <para>
   <ulink url="http://www.libreoffice.org/get-help/documentation/"/>
  </para>
 </sect1>
</chapter>
