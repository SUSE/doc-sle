<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_selfinstall_procedure.xml" version="5.0" xml:id="cha-selfinstal-procedure">
 <title>セルフインストールイメージの展開</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
   <para>
    この章では、セルフインストールの事前構築済みISOイメージからのSLE Microの展開について説明します。
   </para>
  </abstract>
 </info>
 <para>
  <phrase role="productname"><phrase os="slemicro">SUSE Linux Enterprise Micro</phrase></phrase>は、SLE Microをマシン(仮想マシンまたはベアメタル)に展開し、初回の起動時にシステムを設定できるようにするセルフインストールISOイメージを提供します。
 </para>
 <para>
  セットアップを準備するには、次のものが必要です。
 </para>
 <itemizedlist>
  <listitem>
   <para>
    SLE Microが実行されるディスク(物理または仮想)
   </para>
  </listitem>
  <listitem>
   <para>
    セルフインストールISOを備えた起動可能なデバイス(USBディスクなど)
   </para>
  </listitem>
  <listitem>
   <para>
    (オプション)設定メディアとして機能するデバイス。設定デバイスを準備するには、<xref linkend="pro-selfinstall-configuration-device"/>の手順に従ってください
   </para>
  </listitem>
 </itemizedlist>
 <para>
  インストール中に設定デバイスを接続しない場合は、初回起動時に「JeOSjeos-firstboot」が開始されます。<emphasis></emphasis>このツールを使用すると、SLE Microの最小限の設定を実行できます。手順については、<xref linkend="sec-jeos-firstboot-selfinstall"/>を参照してください。より複雑な設定が必要な場合は、設定メディアが必要です。
 </para>
 <para>
  SLE Microをインストールするには、<xref linkend="proc-selfinstall-installation"/>の説明に従って進めます。
 </para>
 <important>
  <title>設定デバイスは、初回の起動時に接続する必要があります。</title>
  <para>
   設定デバイスは、初回の起動時に設定プロセス全体を通して接続する必要があることに注意してください。インストールプロセスを開始する前に、デバイスを接続することをお勧めします。ただし、ファームウェアが起動時に2つ以上のUSBディスクを接続することをサポートしていない場合は、設定プロセスを開始する前にUSBデバイスを交換できます。
  </para>
 </important>
 <note>
    <title>自己インストールISOイメージを使用してインストールしても、ブートEFIエントリは作成されません。</title>
    <para>
     自己インストールISOの展開中に、システムのイメージが選択したディスクにコピーされます。したがって、EFIブートエントリは作成されません(システムがインストーラを使用して展開されている場合と同様)。SLE Microブートローダを選択して、EFIシェルを使用してシステムを手動で起動する必要がある場合があります。最初の起動後、<command>efibootmgr</command>を使用してブートエントリを作成できます。<command>efibootmgr</command>は、デフォルトでは展開されたイメージで使用できます。
    </para>
   </note>
 <procedure xml:id="proc-selfinstall-installation">
  <title>SLE Microのインストール</title>
  <step>
   <para>
    必要に応じて、<xref linkend="pro-selfinstall-configuration-device"/>の説明に従って、設定メディアを準備します。
   </para>
  </step>
  <step>
   <para>
    セルフインストールISOを接続してマシンを起動します。
   </para>
  </step>
  <step>
   <para>
    <guimenu>Install SUSE Linux Enterprise Micro (SUSE Linux Enterprise Microのインストール)</guimenu>を選択して、インストールプロセスを開始します。
   </para>
  </step>
  <step>
   <para>
    SLE Microをインストールするディスクを選択し、ディスク上のデータを削除することを確認します。次にその後、SLE Microイメージがディスクにコピーされます。
   </para>
  </step>
  <step>
   <para>
    <command>kexec</command>を使用すると、システムが再起動し、設定プロセスの準備が整います。
   </para>
  </step>
  <step>
   <para>
    <guimenu>SUSE Linux Enterprise Micro</guimenu>を選択して、設定プロセスを開始します。SLE Microを設定デバイスに記載されている指示に従って設定するか、<emphasis>jeos-firstboot</emphasis>を開始します。
   </para>
  </step>
  <step>
   <para>
    (オプション)<xref linkend="sec-jeos-firstboot-selfinstall"/>の説明に従って、<emphasis>jeos-firstboot</emphasis>を使用してシステムを設定します。
   </para>
  </step>
   <step>
   <para>
    最初のブート後、<command>transactional-update</command>コマンドを使用してSLE Microインスタンスを登録できます。詳細については、<xref linkend="sec-images-registration"/>を参照してください。
   </para>
   <para>
    SLE Microでは拡張機能を利用できます。これらの拡張機能の一部を使用するには、インストール済みシステムからサブスクリプションに拡張機能を追加する必要があります。詳細については、<xref linkend="sec-adding-extension"/>を参照してください。
   </para>
  </step>
 </procedure>
 <section xml:id="sec-selfinstall-conf-device">
  <title>設定デバイスの準備</title>
  <para>
   次の手順では、設定デバイスを準備する方法について説明します。
  </para>
  <procedure xml:id="pro-selfinstall-configuration-device">
  <title>設定デバイスの準備</title>
  <step>
   <para>
    SLE Microでサポートされている任意のファイルシステム(Ext3、Ext4など)にディスクをフォーマットします。
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkfs.ext4 /dev/sd<replaceable>Y</replaceable>
</screen>
  </step>
  <step>
   <para>
    デバイスのラベルを、<literal>ignition</literal> (Ignitionまたはのいずれかが使用されている場合)または<literal>combustion</literal>combustion (Combustionのみが使用されている場合)に設定します。Ext4ファイルシステムの場合は、次のように設定します。
   </para>
<screen><prompt>&gt; </prompt>sudo e2label /dev/sd<replaceable>Y</replaceable> ignition</screen>
   <para>
    仮想化システムまたはハードウェアがサポートしている任意のタイプの設定ストレージメディアを使用できます(ISOイメージ、USBメモリなど)。
   </para>
  </step>
  <step>
   <para>
    デバイスをマウントします。
   </para>
<screen>
<prompt>&gt; </prompt>sudo mount /dev/sdY /mnt
</screen>
  </step>
  <step>
   <para>
    使用する設定ツールに応じて、<xref linkend="cha-images-ignition"/>または<xref linkend="cha-images-combustion"/>に示すようにディレクトリ構造を作成します。
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkdir -p /mnt/ignition/
</screen>
   <para>
    あるいは、
   </para>
<screen>
<prompt>&gt; </prompt>sudo mkdir -p /mnt/combustion/
</screen>
  </step>
  <step>
   <para>
    初めて起動する前に、<xref linkend="cha-images-ignition" xrefstyle="template:Ignition"/>または<xref linkend="cha-images-combustion" xrefstyle="template:Combustion"/>で使用される設定のすべての要素を準備します。システムにログインするには、<systemitem class="username">root</systemitem>用のパスワードを指定するか、パスワードのない認証を設定する必要があります。そうしない場合、初回の起動後にシステムにアクセスできなくなります。
   </para>
  </step>
</procedure>
 </section>
 <section xml:id="sec-jeos-firstboot-selfinstall">
  <title>最小限の初期設定</title>
  <para>
   設定メディアを接続しない場合は、「jeos-firstboot」が起動し、以下のようにシステムの最小限の設定を実行できます。<emphasis></emphasis>
  </para>
  <procedure>
   <title>「jeos-firstboot」を使用したシステムの設定<emphasis></emphasis></title>
   <step>
    <para>
     設定を確認します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_start.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_start.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>jeos first boot</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     キーボードレイアウトを選択して、選択内容を確認します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_keyboard.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_keyboard.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>jeos keyboard selection</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     ライセンス契約を読んで、同意します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_eula.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_eula.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>jeos EULA</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     タイムゾーンを選択します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_timezone.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_timezone.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>jeos time zone selection</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     <systemitem class="username">root</systemitem>のパスワードを入力します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_password.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_password.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>root password</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     <systemitem class="username">root</systemitem>パスワードを確認します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_password_confirm.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_password_confirm.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>root password confirmation</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
   <step>
    <para>
     SLE Micro登録に関するステートメントに同意します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="slemicro_jeos_statement.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="slemicro_jeos_statement.png" width="100%"/>
      </imageobject>
      <textobject role="description"><phrase>root password</phrase>
      </textobject>
     </mediaobject>
    </informalfigure>
   </step>
  </procedure>
 </section>
</chapter>
