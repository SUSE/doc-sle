<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apps_librecalc.xml" version="5.0" xml:id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>Ja</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  Calc ist das LibreOffice-Modul für die Tabellenkalkulation. Tabellenkalkulationen umfassen eine Reihe von Arbeitsblättern, die Zellen enthalten, die beispielsweise mit Text, Zahlen oder Formeln gefüllt werden können. Eine Formel kann Daten aus anderen Zellen verarbeiten und so einen Wert für die Zelle generieren, in der die Formel eingegeben wurde. Mit Calc können Sie zudem Bereiche definieren, Daten filtern und sortieren sowie anhand der Daten Diagramme erstellen und sie so in grafischer Form darstellen. Mithilfe von Pivottabellen können Sie größere Datenmengen kombinieren, analysieren oder vergleichen.
 </para>
 <para>
  In diesem Kapitel kann nur auf einige sehr grundlegende Funktionen von Calc eingegangen werden. Weitere Informationen und eine vollständige Anleitung finden Sie in der Anwendungshilfe zu LibreOffice und in den in <xref linkend="sec.oo.oview.help"/> aufgeführten Informationsquellen.
 </para>
 <note>
  <title>VBA-Makros</title>
  <para>
   Mit Calc können zahlreiche VBA-Makros in Excel-Dokumenten verarbeitet werden. Die Unterstützung für VBA-Makros funktioniert jedoch nicht vollständig. Wenn Sie eine Excel-Datei öffnen, in der in großem Umfang Makros verwendet werden, stellen Sie unter Umständen fest, dass einige Makros nicht funktionieren.
  </para>
 </note>
 <sect1 xml:id="sec.oo.calc.createnew">
  <title>Erstellen von neuen Dokumenten</title>

  <para>
   Neue Calc-Dokumente können auf zweierlei verschiedene Weise erstellt werden:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>Vollständig neu</title>
     <para>
      Zum Erstellen eines neuen, leeren Dokuments klicken Sie auf <menuchoice>
      <guimenu>Datei</guimenu> <guimenu>Neu</guimenu>
      <guimenu>Tabellenkalkulation</guimenu> </menuchoice>.
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>Mit einer Vorlage</title>
     <para>
      Klicken Sie zur Verwendung einer Vorlage auf <menuchoice> <guimenu>Datei</guimenu> <guimenu>Neu</guimenu>
      <guimenu>Vorlagen</guimenu> </menuchoice>  und öffnen Sie beispielsweise <guimenu>Finances</guimenu> (Finanzen). Wählen Sie in der Liste der Vorlagen für Tabellenkalkulationen eine aus, die Ihren Anforderungen entspricht.
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   Auf die einzelnen Tabellen können Sie durch Klicken auf die entsprechenden Karteireiter unten im Fenster zugreifen.
  </para>

  <para>
   Geben Sie Ihre Daten nach Wunsch in den Zellen ein. Das Erscheinungsbild passen Sie entweder auf der Symbolleiste <guimenu>Formatting</guimenu> (Formatierung), im entsprechenden Bereich des Navigationsbereichs oder im Menü <guimenu>Format</guimenu> an – oder Sie definieren Formatvorlagen, wie in <xref linkend="sec.oo.calc.styles"/> beschrieben. Nutzen Sie das Menü <guimenu>Datei</guimenu> oder die entsprechenden Schaltflächen in der Symbolleiste zum Drucken oder Speichern Ihres Dokuments.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.styles">
  <title>Verwenden von Formatierungen und Vorlagen in Calc</title>

  <para>
   Im Lieferumfang von Calc sind bereits einige Vorlagen für Zellen und Seiten enthalten, mit denen Sie das Erscheinungsbild Ihrer Tabellen und Berichte optimieren können. Obwohl diese integrierten Vorlagen für viele Zwecke geeignet sind, möchten Sie wahrscheinlich Vorlagen für Ihre eigenen häufig verwendeten Formatierungseinstellungen verwenden.
  </para>

  <procedure xml:id="pro.oo.calc.createstyle">
   <title>Erstellen von Vorlagen</title>
   <step>
    <para>
     Klicken Sie auf <menuchoice> <guimenu>Format</guimenu> <guimenu>Styles (Vorlagen)</guimenu>
     <guimenu>Styles and Formatting (Formatvorlagen)</guimenu> </menuchoice>  oder drücken Sie <keycap>F11</keycap>.
    </para>
   </step>
   <step>
    <para>
     Klicken Sie oben im Bereich <guimenu>Styles and Formatting</guimenu> (Formatvorlagen) entweder auf <guimenu>Cell Styles</guimenu> (Zellvorlagen, grüne Zelle) oder auf <guimenu>Page Styles</guimenu> (Seitenvorlagen, Dokument).
    </para>
   </step>
   <step>
    <para>
     Klicken Sie mit der rechten Maustaste im Fenster <guimenu>Styles and Formatting</guimenu> (Formatvorlagen) auf eine beliebige Stelle. Klicken Sie dann auf <guimenu>OK</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Geben Sie einen Namen für die Formatvorlage an und legen Sie die gewünschten Formatierungsoptionen auf den verschiedenen Karteireitern fest.
    </para>
   </step>
   <step>
    <para>
     Klicken Sie abschließend auf <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <procedure>
   <title>Ändern von Vorlagen</title>
   <step>
    <para>
     Klicken Sie auf <menuchoice> <guimenu>Format</guimenu> <guimenu>Styles (Vorlagen)</guimenu>
     <guimenu>Styles and Formatting (Formatvorlagen)</guimenu> </menuchoice>.
    </para>
   </step>
   <step>
    <para>
     Klicken Sie oben im Bereich <guimenu>Styles and Formatting</guimenu> (Formatvorlagen) entweder auf <guimenu>Cell Styles</guimenu> (Zellvorlagen, grüne Zelle) oder auf <guimenu>Page Styles</guimenu> (Seitenvorlagen, Dokument).
    </para>
   </step>
   <step>
    <para>
     Klicken Sie mit der rechten Maustaste auf die Vorlage, die Sie ändern möchten, und klicken Sie dann auf <guimenu>Ändern</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Ändern Sie die Formatierungsoptionen nach Wunsch.
    </para>
   </step>
   <step>
    <para>
     Klicken Sie abschließend auf <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <para>
   Wählen Sie zum Anwenden einer Vorlage auf bestimmte Zellen die Zellen aus, die formatiert werden sollen. Doppelklicken Sie anschließend im Fenster <guimenu>Formatvorlagen</guimenu> auf die Vorlage, die angewendet werden soll.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.sheets">
  <title>Arbeiten mit Tabellen</title>

  <para>
   Tabellen sind eine gute Methode, um Kalkulationen zu strukturieren. Die Buchhaltung Ihres Unternehmens wird beispielsweise viel übersichtlicher, wenn Sie für jeden Monat eine eigene Tabelle erstellen.
  </para>

  <para>
   Wenn Sie nach der letzten Tabelle eine neue Tabelle einfügen möchten, klicken Sie auf die Schaltfläche <guimenu>+</guimenu> neben den Karteireitern der Tabellen.
  </para>

  <para>
   Um eine oder mehrere neue Tabellen gleichzeitig aus einer Datei oder an einer bestimmten Position einzufügen, gehen Sie wie folgt vor:
  </para>

  <procedure xml:id="pro.oo.insert.sheet">
   <title>Einfügen neuer Tabellen</title>
   <step>
    <para>
     Klicken Sie mit der rechten Maustaste auf den Karteireiter einer Tabelle und wählen Sie <guimenu>Insert Sheet</guimenu> (Tabelle einfügen). Es wird daraufhin ein Dialogfeld geöffnet.
    </para>
   </step>
   <step>
    <para>
     Entscheiden Sie, ob die neue Tabelle vor oder nach der ausgewählten Tabelle eingefügt werden soll.
    </para>
   </step>
   <step>
    <para>
     Wenn eine neue Tabelle erstellt werden soll, muss das Optionsfeld <guimenu>New Sheet</guimenu>  (Neue Tabelle) aktiviert sein. Geben Sie die Anzahl der Tabellen und den Namen der Tabelle ein. Überspringen Sie den Rest dieses Schritts.
    </para>
    <para>
     Sie können auch eine Tabelle aus einer anderen Datei importieren. Dazu gehen Sie wie folgt vor:
    </para>
    <substeps performance="optional">
     <step>
      <para>
       Wählen Sie <guimenu>Aus Datei</guimenu>, und klicken Sie auf <guimenu>Durchsuchen</guimenu>..
      </para>
     </step>
     <step>
      <para>
       Wählen Sie den Dateinamen aus, und bestätigen Sie Ihre Auswahl mit <guimenu>OK</guimenu>. Alle Tabellennamen werden nun in der Liste angezeigt.
      </para>
     </step>
     <step>
      <para>
       Wählen Sie die Namen der Tabellen aus, die importiert werden sollen, indem Sie die Taste <keycap function="shift"/> gedrückt halten und auf die Namen klicken.
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     Zum Hinzufügen der Tabellen bestätigen Sie den Vorgang mit <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <para>
   Wenn Sie eine Tabelle umbenennen möchten, klicken Sie mit der rechten Maustaste auf den zugehörigen Karteireiter und wählen Sie <guimenu>Rename Sheet</guimenu> (Tabelle umbenennen) aus. Sie können auch auf den Karteireiter der Tabelle doppelklicken.
  </para>

  <para>
   Zum Löschen einer oder mehrerer Tabellen gehen Sie folgendermaßen vor: Wählen Sie die zu löschende Tabelle aus. Mehrere Tabellen wählen Sie aus, indem Sie <keycap function="shift"/> gedrückt halten. Klicken Sie dann mit der rechten Maustaste auf den Karteireiter der Tabelle, wählen Sie <guimenu>Delete Sheet</guimenu> (Tabelle löschen) und bestätigen Sie mit <guimenu>Ja</guimenu>.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.condformat">
  <title>Bedingte Formatierung</title>

  <para>
   Die bedingte Formatierung ist eine nützliche Funktion, um bestimmte Werte in der Tabellenkalkulation hervorzuheben. Wenn Sie beispielsweise eine Bedingung definieren und die Bedingung <literal>WAHR</literal> ist, wird auf jede Zelle, die diese Bedingung erfüllt, eine Formatvorlage angewendet.
  </para>

  <note>
   <title>Automatische Kalkulation aktivieren</title>
   <para>
    Wählen Sie <menuchoice>
    <guimenu>Extras</guimenu> <guimenu>Zelleninhalte</guimenu>
    <guimenu>Automatische Kalkulation</guimenu> </menuchoice>, bevor Sie die bedingte Formatierung anwenden. Es sollte nun ein Häkchen vor <guimenu>Automatische Kalkulation</guimenu> angezeigt werden.
   </para>
  </note>

  <procedure xml:id="pro.oo.calc.condformat">
   <title>Verwenden der bedingten Formatierung</title>
   <step>
    <para>
     Definieren Sie zunächst eine Stilvorlage. Diese Formatvorlage wird auf jede Zelle angewendet, wenn die Bedingung <literal>WAHR</literal> ist. Verwenden Sie <menuchoice>
     <guimenu>Format</guimenu><guimenu>Formatvorlagen</guimenu>
     </menuchoice>, oder drücken Sie <keycap>F11</keycap>. Weitere Informationen finden Sie unter <xref linkend="pro.oo.calc.createstyle"/>. Bestätigen Sie Ihre Auswahl mit <guimenu>OK</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie den Zellenbereich aus, auf den Ihre Bedingung angewendet werden soll.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie im Menü <menuchoice> <guimenu>Format</guimenu> <guimenu>Conditional Formatting (Bedingte Formatierung)</guimenu> <guimenu>Condition (Bedingung)</guimenu> </menuchoice>. Es wird daraufhin ein Dialogfeld geöffnet.
    </para>
   </step>
   <step>
    <para>
     Sie sehen eine Vorlage für eine neue Bedingung. Für die Bedingungen stehen mehrere Modi zur Auswahl:
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>Zellwert ist</guimenu>
      </term>
      <listitem>
       <para>
        Die Bedingung prüft, ob eine Zelle mit einem bestimmten Wert übereinstimmt. Wählen Sie neben dem ersten Dropdown-Feld einen Operator wie <guimenu>equal to</guimenu> (gleich), <guimenu>less than</guimenu> (kleiner als) oder <guimenu>greater than</guimenu> (größer als) aus.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Formel ist</guimenu>
      </term>
      <listitem>
       <para>
        Die Bedingung prüft, ob eine bestimmte Formel den Wert <literal>WAHR</literal> zurückgibt.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Datum ist</guimenu>
      </term>
      <listitem>
       <para>
        Die Bedingung prüft, ob ein bestimmter Datumswert erreicht ist.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>Alle Zellen</guimenu>
      </term>
      <listitem>
       <para>
        In diesem Modus können Datenvisualisierungen erstellt werden, die vom Wert einer Zelle abhängen, ähnlich wie bei <guimenu>Cell value is</guimenu> (Zellwert ist). Bei <guimenu>All Cells</guimenu> (Alle Zellen) können Sie jedoch nur eine Bedingung verwenden, um einen ganzen Bereich von Formatvorlagen anzuwenden.
       </para>
       <para>
        Zu den Formatvorlagetypen, die verwendet werden können, zählen Farbskalen (Hintergrundfarbe der Zellen), Datenbalken (Balken mit variierender Breite in der Zelle) und Symbolsätze (Symbol in einer Zelle).
       </para>
       <para>
        Mithilfe einer Farbskala können Sie beispielsweise <literal>0</literal> einen schwarzen Hintergrund und <literal>100</literal> einen grünen Hintergrund zuweisen. Alle Werte dazwischen werden automatisch berechnet. <literal>50</literal> erhält beispielsweise einen dunkelgrünen Hintergrund.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     In diesem Beispiel behalten Sie die Standardeinstellung <guimenu>Zellwert ist</guimenu> bei.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie einen Operator aus und geben Sie den gewünschten Zellwert an.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie die Formatvorlage aus, die angewendet werden soll, wenn diese Bedingung <literal>WAHR</literal> ist, oder klicken Sie auf <guimenu>New Style</guimenu> (Neue Formatvorlage), um eine neue Darstellung zu definieren.
    </para>
   </step>
   <step>
    <para>
     Wenn Sie weitere Bedingungen definieren möchten, klicken Sie auf <guimenu>Hinzufügen</guimenu>. Wiederholen Sie dann die obigen Schritte.
    </para>
   </step>
   <step>
    <para>
     Bestätigen Sie Ihre Auswahl mit <guimenu>OK</guimenu>. Nun hat sich das Format Ihrer Zellen verändert.
    </para>
   </step>
  </procedure>

  <remark>
   We might also want a procedure showing how to use the Manage dialog to remove
   conditions. -- sknorr, 2015-09-17
  </remark>
 </sect1>
 <sect1 xml:id="sec.oo.calc.grouping">
  <title>Gruppieren von Zellen und deren Aufhebung</title>

  <para>
   Indem Sie einen Zellenbereich gruppieren, können Sie Teile einer Tabellenkalkulation ausblenden. So werden Tabellenkalkulationen übersichtlicher, da die Teile ausgeblendet werden können, die Sie derzeit nicht benötigen. Sie können auch Zeilen oder Spalten gruppieren und Gruppen in andere Gruppen einordnen.
  </para>

  <para>
   Gehen Sie folgendermaßen vor, um einen Bereich zu gruppieren:
  </para>

  <procedure>
   <title>Gruppieren eines ausgewählten Zellenbereichs</title>
   <step>
    <para>
     Wählen Sie in Ihrer Tabellenkalkulation einen bestimmten Zellenbereich aus.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie <menuchoice> <guimenu>Daten</guimenu> <guimenu>Gruppieren und mit Kontur versehen</guimenu> <guimenu>Gruppieren</guimenu> </menuchoice>. Ein Dialogfeld wird geöffnet.
    </para>
   </step>
   <step>
    <para>
     Legen Sie fest, ob der ausgewählte Bereich nach Zeilen oder nach Spalten gruppiert werden soll. Bestätigen Sie Ihre Auswahl mit <guimenu>OK</guimenu>.
    </para>
   </step>
  </procedure>

  <para>
   Nach dem Gruppieren der ausgewählten Zellen erscheint am oberen linken Rand eine Linie, die den gruppierten Zellenbereich angibt. Falten oder entfalten Sie den Zellenbereich mithilfe der Symbole <guimenu>+</guimenu> und <guimenu>–</guimenu>. Die Zahlen oben links an den Rändern zeigen die Tiefe der Gruppen an und können ebenfalls angeklickt werden.
  </para>

  <para>
   Klicken Sie zum Aufheben der Gruppierung eines Zellenbereichs in eine Zelle, die zu dieser Gruppe gehört, und wählen Sie <menuchoice> <guimenu>Daten</guimenu> <guimenu>Gruppieren und mit Kontur versehen</guimenu> <guimenu>Gruppierung aufheben</guimenu> </menuchoice>. Die Linie am Rand verschwindet. Die innerste Gruppe wird stets zuerst gelöscht.
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.freezing">
  <title>Einfrieren von Zeilen oder Spalten als Überschriften</title>

  <para>
   Bei Tabellenkalkulationen mit vielen Daten verschwindet beim Scrollen in der Regel die Überschrift. LibreOffice kann Zeilen und/oder Spalten sperren, sodass diese ständig sichtbar bleiben, auch wenn Sie in der Tabelle scrollen.
  </para>

  <para>
   Gehen Sie folgendermaßen vor, um eine einzelne Zeile oder Spalte einzufrieren:
  </para>

  <procedure>
   <title>Einfrieren einer einzelnen Zeile oder Spalte</title>
   <step>
    <para>
     Zum Erstellen eines fixierten Bereichs vor einer Zeile klicken Sie auf den Zeilenkopf (<literal>1</literal>, <literal>2</literal>, <literal>3</literal> usw.).
    </para>
    <para>
     Alternativ klicken Sie zum Erstellen eines fixierten Bereichs oberhalb einer Spalte auf den Spaltenkopf (<literal>A</literal>, <literal>B</literal>, <literal>C</literal> usw.).
    </para>
   </step>
   <step>
    <para>
     Wählen Sie <menuchoice> <guimenu>Ansicht</guimenu>
     <guimenu>Freeze Rows and Columns (Zeilen und Spalten fixieren)</guimenu> </menuchoice>. Eine dunkle Linie wird eingeblendet, die den fixierten Bereich kennzeichnet.
    </para>
   </step>
  </procedure>

  <para>
   Sie können auch Zeilen und Spalten gleichzeitig fixieren:
  </para>

  <procedure>
   <title>Einfrieren von Zeilen und Spalten</title>
   <step>
    <para>
     Klicken Sie auf die Zelle rechts neben der Spalte und unterhalb der Zeile, die eingefroren werden sollen. Wenn die Überschrift beispielsweise von A1 bis B3 reicht, klicken Sie in die Zelle C4.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie <menuchoice> <guimenu>Ansicht</guimenu>
     <guimenu>Freeze Rows and Columns (Zeilen und Spalten fixieren)</guimenu></menuchoice>. Eine dunkle Linie wird eingeblendet und kennzeichnet den fixierten Bereich.
    </para>
   </step>
  </procedure>

  <para>
   Wählen Sie zum Aufheben der Fixierung <menuchoice><guimenu>Ansicht</guimenu>
   <guimenu>Freeze Rows and Columns (Zeilen und Spalten fixieren)</guimenu></menuchoice>. Das Häkchen vor dem Menüelement wird entfernt.
  </para>
 </sect1>
</chapter>
