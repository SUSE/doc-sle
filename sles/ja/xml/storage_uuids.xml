<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="storage_uuids.xml" version="5.0" xml:id="cha.uuid" xml:lang="ja">
 <title>UUIDによるデバイスのマウント</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  本項では、デバイス名(<filename>/dev/sda1</filename>など)の代わりにUUID (Universally Unique Identifier)を使用してファイルシステムデバイスを識別する方法について説明します。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 12から、ブートローダファイルと<filename>/etc/fstab</filename>ファイルではデフォルトでUUIDが使用されています。
 </para>
 <sect1 xml:id="sec.uuid.udev">
  <title>udevによる永続的なデバイス名</title>

  <para>
   カーネル2.6以降、<command>udev</command>によって、永続的なデバイス名を使用した動的な<filename>/dev</filename>ディレクトリのユーザスペースソリューションが提供されます。システムに対してデバイスを追加または削除する場合は、ホットプラグシステムの一部として<command>udev</command>が実行されます。
  </para>

  <para>
   ルールのリストが特定デバイス属性との比較に使用されます。<command>udev</command>ルールのインフラストラクチャ(<filename>/etc/udev/rules.d</filename>ディレクトリで定義)は、すべてのディスクデバイスに、それらの認識順序や当該デバイスに使用される接続に関わらず、安定した名前を提供します。<command>udev</command>ツールは、カーネルが作成するすべての該当ブロックデバイスを調べ、一定のバス、ドライブタイプ、またはファイルシステムに基づいて、ネーミングルールを適用します。<command>udev</command>用の独自ルールを定義する方法については、「<link xlink:href="http://reactivated.net/writing_udev_rules.html"><citetitle>Writing udev Rules</citetitle></link>」を参照してください。
  </para>

  <para>
   動的なカーネル提供のデバイスノード名に加えて、<command>udev</command>は、<filename>/dev/disk</filename>ディレクトリ内のデバイスをポイントする永続的なシンボリックリンクのクラスを保持します。このディレクトリは、さらに、<filename>by-id</filename>、<filename>by-label</filename>、<filename>by-path</filename>、および<filename>by-uuid</filename>の各サブディレクトリに分類されます。
  </para>

  <note>
   <title>UUIDジェネレータ</title>
   <para>
    <command>udev</command>以外のプログラム(LVMや<command>md</command>など)も、UUIDを生成することがありますが、それらのUUIDは<filename>/dev/disk</filename>にリストされません。
   </para>
  </note>
 </sect1>
 <sect1 xml:id="sec.uuid.understanduuid">
  <title>UUIDの理解</title>

  <para>
   UUID (Universally Unique Identifier)は、ファイルシステムの128ビットの番号であり、ローカルシステムと他のシステム全体に渡る固有な識別子です。UUIDは、システムハードウェア情報とタイムスタンプをそのシードの一部として、ランダムに生成されます。UUIDは、通常、デバイスに固有なタグを付けるために使用されます。
  </para>

  <para>
   非永続的な<quote>従来の</quote>デバイス名(<filename>/dev/sda1</filename>など)を使用すると、ストレージを追加したときに、システムがブートできなくなる可能性があります。たとえば、root (<filename>/</filename>)が<filename>/dev/sda1</filename>に割り当てられている場合、SANを接続した後またはシステムにハードディスクを追加した後に、<filename>/dev/sdg1</filename>に再割り当てされる可能性があります。この場合、ブートローダ設定と<filename>/etc/fstab</filename>ファイルを調整する必要があり、そうしないとシステムは起動できなくなります。
  </para>

  <para>
   この問題を回避する1つの方法は、ブートデバイスのブートローダファイルと<filename>/etc/fstab</filename>ファイルでUUIDを使用することです。SUSE Linux Enterpriseのバージョン12以降は、これがデフォルトです。UUIDは、ファイルシステムのプロパティであり、ドライブを再フォーマットすれば変更できます。デバイス名のUUIDを使用することの代替案として、IDまたはラベルでデバイスを識別する方法があります。
  </para>

  <para>
   UUIDは、ソフトウェアRAIDデバイスのアセンブルと起動の基準としても使用できます。RAIDが作成されると、<command>md</command>ドライバは、デバイスのUUIDを生成し、その値を<filename>md</filename>スーパーブロックに保存します。
  </para>

  <para>
   どのブロックデバイスのUUIDも、<filename>/dev/disk/by-uuid</filename>ディレクトリ内で見つけることができます。たとえば、UUIDエントリは次のようになります。
  </para>

<screen><prompt>tux &gt; </prompt>ls -og /dev/disk/by-uuid/
lrwxrwxrwx 1 10 Dec  5 07:48 e014e482-1c2d-4d09-84ec-61b3aefde77a -&gt; ../../sda1</screen>
 </sect1>
 <sect1 xml:id="sec.uuid.moreinfo">
  <title>追加情報</title>

  <para>
   <systemitem>udev</systemitem>によるデバイス管理の詳細については、<xref linkend="cha.udev"/>を参照してください。
  </para>

  <para>
   <systemitem>udev</systemitem>コマンドの詳細については、<command>man 7 udev</command>を参照してください。
  </para>
 </sect1>
</chapter>
