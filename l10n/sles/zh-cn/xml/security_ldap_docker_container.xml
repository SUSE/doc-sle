<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="security_ldap_docker_container.xml" version="5.0" xml:id="sec-security-ldap-docker-container">
  <info>
    <title>为 389 Directory Server 创建和管理 Docker 容器</title>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
  </info>

  <note>
    <para>
      本节为<emphasis>选读</emphasis>内容；如果您使用 389 Directory Server 实例作为 Docker 容器，请参考本节。有关 389 Directory Server 实例的常规用法，请参见其余小节。
    </para>
  </note>

  <para>
    要创建 389 Directory Server 实例并将其作为 Docker 容器进行管理，请参见以下示例：
  </para>

  <variablelist>
    <varlistentry>
      <term>提取最新的 389 Directory Server 映像</term>
      <listitem>
        <para>
          要从容器注册表中提取最新的 389 Directory Server 映像，请运行以下命令：
        </para>
<screen><prompt>&gt; </prompt> <command>docker pull 389ds/dirsrv:latest</command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>创建新卷</term>
      <listitem>
        <para>
          要为容器创建新卷，请运行以下示例命令：
        </para>
<screen><prompt>&gt; </prompt> <command>docker volume create <replaceable>VOLUME</replaceable></command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>使用基本配置创建容器</term>
      <listitem>
        <para>
          要使用基本配置创建容器，请运行以下示例命令：
        </para>
<screen><?dbfo keep-together="always"?>
<prompt>&gt; </prompt> <command>docker create \
 -u <replaceable>USERNAME</replaceable> \
 -e SUFFIX_NAME="dc=example,dc=com" \
 -e DS_DM_PASSWORD=<replaceable>PASSWORD</replaceable> \
 -m 1024M \
 -p 3389:3389 -p 3636:3636 \
 -v <replaceable>VOLUME</replaceable>:/data \
 --name <replaceable>INSTANCE</replaceable> \
 389ds/dirsrv:latest
</command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>启动 389 Directory Server 的 Docker 容器</term>
      <listitem>
        <para>
          要启动 Docker 容器，请运行以下示例命令：
        </para>
<screen><prompt>&gt; </prompt> <command>docker start <replaceable>INSTANCE</replaceable></command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>在正在运行的 389 Directory Server 容器中执行命令</term>
      <listitem>
        <para>
          如果容器 (<literal>PID
          1</literal>) 的主进程正在运行，您可以使用以下语法在正在运行的 389 Directory Server 容器中运行命令：
        </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>docker exec -u <replaceable>USERNAME</replaceable> -i -t <replaceable>INSTANCE</replaceable> <replaceable>COMMAND</replaceable></command></screen>
        <note>
          <title><replaceable>COMMAND</replaceable> 必须可执行</title>
          <para>
            要运行链式命令或括在引号中的命令，应先在容器中运行外壳会话。例如，您可以在附加到容器的 <literal>sh</literal> 外壳中运行命令：
          </para>
<screen><prompt>&gt; </prompt><command>sudo</command> <command>docker exec -u <replaceable>USERNAME</replaceable> -i -t <replaceable>INSTANCE</replaceable> sh -c <replaceable>"COMMAND"</replaceable></command></screen>
        </note>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>停止 389 Directory Server 的 Docker 容器</term>
      <listitem>
        <para>
          要停止正在运行的 Docker 容器，请运行以下示例命令：
        </para>
<screen><prompt>&gt; </prompt> <command>docker stop <replaceable>INSTANCE</replaceable></command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>去除 389 Directory Server 的 Docker 容器</term>
      <listitem>
        <para>
          要去除 Docker 容器，请运行以下示例命令：
        </para>
<screen><prompt>&gt; </prompt> <command>docker rm <replaceable>INSTANCE</replaceable></command></screen>
      </listitem>
    </varlistentry>
  </variablelist>
</sect1>
