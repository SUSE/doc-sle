<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="adm_support.xml" version="5.0" xml:id="cha.adm.support">


 <title>Reunindo informações do sistema para suporte</title>
 <info>
  <abstract>
   <para>
    Para uma rápida visão geral de todas as informações de sistema relevantes de uma máquina, o <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> oferece o pacote <systemitem class="systemname">hostinfo</systemitem>. Ele também ajuda os administradores do sistema a verificarem se há kernels contaminados (que não são suportados) ou quaisquer pacotes de terceiros instalados na máquina.
   </para>

   <para>
    Em caso de problemas, é possível criar um relatório detalhado do sistema com a ferramenta de linha de comando <command>supportconfig</command> ou o módulo de <guimenu>Suporte</guimenu> do YaST. Os dois coletam informações sobre o sistema, como a versão atual do Kernel, o hardware, os pacotes instalados, a configuração da partição, etc. O resultado é um armazenamento de arquivos TAR. Após abrir uma Solicitação de Serviço (SS), você poderá fazer upload do armazenamento TAR para o Suporte Técnico Global. Ele ajuda a localizar o problema que você relatou e a orientá-lo para uma solução.
   </para>

   <para>
    Você também pode verificar se há problemas conhecidos na saída do <command>supportconfig</command> para ajudar a resolvê-los mais rapidamente. Para esta finalidade, o <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> oferece uma aplicação e uma ferramenta de linha de comando para <literal>Supportconfig Analysis</literal> (SCA).
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes (sim)</dm:translation>
  </dm:docmanager>
 </info>
<indexterm> <primary>suporte</primary> </indexterm> <indexterm> <primary>informações do sistema</primary> </indexterm>
 <sect1 xml:id="sec.admsupport.hostinfo">
  <title>Exibindo informações atuais do sistema</title>



  <para>
   Para uma visão geral rápida e fácil de todas as informações do sistema relevantes, use o pacote <systemitem class="systemname">hostinfo</systemitem> ao efetuar login no servidor. Após ser instalado na máquina, o console exibirá as seguintes informações para qualquer usuário <systemitem class="username">root</systemitem> que efetuar login nessa máquina:
  </para>

  <example xml:id="ex.support.hostinfo">
   <title>Saída de <command>hostinfo</command> ao efetuar login como <systemitem class="username">root</systemitem></title>
<screen>Hostname:                 earth
Current As Of:            Wed 12 Mar 2014 03:57:05 PM CET
Distribution:             SUSE Linux Enterprise Server 12
 -Service Pack:           0
Architecture:             x86_64
Kernel Version:           3.12.12-3-default
 -Installed:              Mon 10 Mar 2014 03:15:05 PM CET
 -Status:                 Not Tainted
Last Updated Package:     Wed 12 Mar 2014 03:56:43 PM CET
 -Patches Needed:         0
 -Security:               0
 -3rd Party Packages:     0
IPv4 Address:             ens3 192.168.1.1
Total/Free/+Cache Memory: 983/95/383 MB (38% Free)
Hard Disk:                /dev/sda 10 GB</screen>
  </example>

  <para>
   Caso a saída apresente o kernel com status <literal>tainted</literal> (contaminado), consulte a <xref linkend="sec.admsupport.kernel"/> para ver mais detalhes.
  </para>
 </sect1>
 <sect1 xml:id="sec.admsupport.supportconfig">
  <title>Coletando informações do sistema com o supportconfig</title>

  <para>
   Para criar um armazenamento TAR com informações detalhadas do sistema que você possa enviar ao Suporte Técnico Global, use a ferramenta de linha de comando <command>supportconfig</command> diretamente ou o módulo de <guimenu>Suporte</guimenu> do YaST. A ferramenta de linha de comando está incluída no pacote <systemitem>supportutils</systemitem>, que é instalado por padrão. O módulo de <guimenu>Suporte</guimenu> do YaST também é baseado na ferramenta de linha de comando.
  </para>

  <sect2 xml:id="sec.admsupport.supportconfig.sr">
   <title>Criando um número de solicitação de serviço</title>
   <para>
    É possível gerar armazenamentos do supportconfig a qualquer momento. No entanto, para enviar os dados do supportconfig ao Suporte Técnico Global, é necessário gerar primeiro um número de solicitação de serviço. Você precisa dele para fazer upload do armazenamento para o suporte.
   </para>
   <para>
    Para criar uma solicitação de serviço, acesse <link xlink:href="http://www.novell.com/center/eservice"/> e siga as instruções na tela. Anote o seu número de solicitação de serviço de 11 dígitos.
   </para>
   <note>
    <title>Declaração de Privacidade</title>
    <para>
     A SUSE e a Novell tratam os relatórios do sistema como dados confidenciais. Para ver detalhes do nosso compromisso de privacidade, acesse <link xlink:href="http://www.novell.com/company/legal/privacy/"/>.
    </para>
   </note>
  </sect2>

  <sect2 xml:id="sec.admsupport.supportconfig.upload">
   <title>Destinos de upload</title>
   <para>
    Após criar um número de solicitação de serviço, você poderá fazer upload dos armazenamentos supportconfig para o Suporte Técnico Global, conforme descrito no <xref linkend="pro.admsupport.submit.yast"/> ou no <xref linkend="pro.admsupport.submit.cli"/>. Use um dos seguintes destinos de upload:
   </para>


   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Clientes nos EUA: <link xlink:href="ftp://ftp.novell.com/incoming"/>
     </para>
    </listitem>
    <listitem>
     <para>
      EMEA, Europa, Oriente Médio e África: <link xlink:href="ftp://support-ftp.suse.com/in"/>
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Você também pode anexar o armazenamento TAR manualmente à sua solicitação de serviço usando o URL da solicitação de serviço: <link xlink:href="http://www.novell.com/center/eservice"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec.admsupport.yast">
   <title>Criando um armazenamento supportconfig com o YaST</title>
   <para>
    Para usar o YaST para coletar informações do sistema, faça o seguinte: <remark>2008-11-20 toms: YaST asks the user to open a URL as
     root(!). This happens when the users clicks on "Open" (Open
     Support Center/ This will start a browser with
     Support Center Portal). I do not think we should describe this
     and only *use* the above URL as a normal user for security
     reasons.</remark>
   </para>
   <procedure>
    <step>
     <para>
      Inicie o YaST e abra o módulo de <guimenu>Suporte</guimenu>.
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2-support-main.png" width="70%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2-support-main.png" width="60%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step>
     <para>
      Clique em <guimenu>Criar relatório em arquivo tarball</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Na janela seguinte, selecione uma das opções de supportconfig na lista de botões de opção. Por padrão, a opção <guimenu>Usar Configurações (Técnicas) Personalizadas</guimenu> está pré-selecionada. Para testar primeiro a função de relatório, use <guimenu>Reunir apenas uma quantidade mínima de informações</guimenu>. Para obter algumas informações básicas sobre outras opções, consulte a página de manual de <command>supportconfig</command>.
     </para>
     <para>
      Continue com <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step xml:id="step.supportconfig.contact">
     <para>
      Digite suas informações de contato. Elas são gravadas em um arquivo chamado <filename>basic-environment.txt</filename> e incluídas no armazenamento que será criado.
     </para>
    </step>
    <step xml:id="step.supportconfig.upload.target">
     <para>
      Para submeter o armazenamento ao Suporte Técnico Global no fim do processo de coleta de informações, a opção <guimenu>Informações de Upload</guimenu> é obrigatória. O YaST propõe um servidor de upload automaticamente. Para modificá-lo, consulte a <xref linkend="sec.admsupport.supportconfig.upload"/> para saber os detalhes de quais servidores de upload estão disponíveis.
     </para>
     <para>
      Para submeter o armazenamento mais tarde, deixe a opção <guimenu>Informações de Upload</guimenu> vazia por enquanto.
     </para>
    </step>
    <step>
     <para>
      Continue com <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step>
     <para>
      A coleta de informações é iniciada.
     </para>
     <informalfigure>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="yast2-support-conf.png" width="90%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="yast2-support-conf.png" width="80%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <para>
      Quando o processo for concluído, continue com <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Revise a coleta de dados: Selecione o <guimenu>Nome do Arquivo</guimenu> de um registro para ver seu conteúdo no YaST. Para remover arquivos do armazenamento TAR antes de submetê-lo ao suporte, use <guimenu>Remover dos Dados</guimenu>. Continue com <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Grave o armazenamento TAR. Se você iniciar o módulo do YaST como usuário <systemitem class="username">root</systemitem>, por padrão, o YaST vai propor gravar o armazenamento em <filename>/var/log</filename> (ou em seu diretório pessoal). O formato do nome de arquivo é <filename>nts_<replaceable>HOST</replaceable>_<replaceable>DATA</replaceable>_<replaceable>HORÁRIO</replaceable>.tbz</filename>.
     </para>
    </step>
    <step>
     <para>
      Para fazer upload do armazenamento diretamente para o suporte, verifique se a opção <guimenu>Fazer upload do tarball com arquivos de registro para o URL</guimenu> está ativada. O <guimenu>Destino do Upload</guimenu> mostrado aqui é aquele proposto pelo YaST no <xref linkend="step.supportconfig.upload.target"/>. Para modificar o destino do upload, encontre as informações detalhadas sobre quais servidores de upload estão disponíveis na <xref linkend="sec.admsupport.supportconfig.upload"/>.
     </para>
    </step>
    <step>
     <para>
      Para ignorar o upload, desative a opção <guimenu>Fazer upload do tarball com arquivos de registro para o URL</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Confirme as mudanças para fechar o módulo do YaST.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.admsupport.cli">
   <title>Criando um armazenamento supportconfig da linha de comando</title>
   <para>
    O seguinte procedimento mostra como criar um armazenamento supportconfig, mas sem o submeter diretamente ao suporte. Para fazer seu upload, é necessário executar o comando com algumas opções, conforme descrito no <xref linkend="pro.admsupport.submit.cli"/>.
   </para>
   <procedure>
    <step>
     <para>
      Abra um shell e torne-se <systemitem class="username">root</systemitem>.
     </para>
    </step>
    <step>
     <para>
      Execute <command>supportconfig</command> sem nenhuma opção. Isso reúne as informações padrão do sistema.
     </para>
    </step>
    <step>
     <para>
      Aguarde a ferramenta concluir a operação.
     </para>
    </step>
    <step>
     <para>
      O local padrão do armazenamento é <filename>/var/log</filename>, com o formato de nome de arquivo <filename>nts_<replaceable>HOST</replaceable>_<replaceable>DATA</replaceable>_<replaceable>HORÁRIO</replaceable>.tbz</filename>
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.admsupport.options">
   <title>Opções comuns do supportconfig</title>
   <para>
    O utilitário <command>supportconfig</command> é geralmente chamado sem nenhuma opção. Exiba uma lista de todas as opções com <command>supportconfig</command> <option>-h</option> ou consulte a página de manual. A seguinte lista apresenta uma breve visão geral de alguns casos de uso comuns:
   </para>
   <variablelist>
    <varlistentry>
     <term>Reduzindo o tamanho das informações coletadas</term>
     <listitem>
      <para>
       Usar a opção mínima (<option>-m</option>):
      </para>
<screen>supportconfig -m</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Limitando as informações a determinado tópico</term>
     <listitem>
      <para>
       Se você já localizou um problema com a saída padrão do <command>supportconfig</command> e descobriu que ele está relacionado apenas à determinada área ou conjunto de recursos, convém limitar as informações coletadas à área específica na próxima execução do <command>supportconfig</command>. Por exemplo, se você detectar problemas com o LVM e quiser testar uma recente mudança feita na configuração do LVM, convém coletar o mínimo de informações do supportconfig apenas sobre o LVM:
      </para>
<screen>supportconfig -i LVM</screen>
      <para>
       Para ver a lista completa de palavras-chave de recursos que você pode usar para limitar as informações coletadas a determinada área, execute
      </para>
<screen>supportconfig -F</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Incluindo informações de contato adicionais na saída</term>
     <listitem>
<screen>supportconfig -E tux@example.org -N "Tux Penguin" -O "Penguin Inc." ...</screen>
      <para>
       (tudo em uma linha)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Coletando arquivos de registro já rotacionados</term>
     <listitem>
<screen>supportconfig -l</screen>
      <para>
       Isso é útil principalmente em ambientes de alto registro ou após uma falha do kernel quando o syslog gira os arquivos de registro após uma reinicialização.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.admsupport.submit">
  <title>Submetendo informações ao suporte técnico global</title>

  <para>
   Use o módulo de <guimenu>Suporte</guimenu> do YaST ou o utilitário de linha de comando <command>supportconfig</command> para submeter as informações do sistema ao Suporte Técnico Global. Se você tiver um problema com o servidor e quiser a ajuda do suporte, precisará abrir primeiro uma solicitação de serviço. Para obter os detalhes, consulte a <xref linkend="sec.admsupport.supportconfig.sr"/>.
  </para>

  <para>
   Os seguintes exemplos usam <replaceable>12345678901</replaceable> como marcador para o número da sua solicitação de serviço. Substitua <replaceable>12345678901</replaceable> pelo número da solicitação de serviço que você criou na <xref linkend="sec.admsupport.supportconfig.sr"/>.
  </para>

  <procedure xml:id="pro.admsupport.submit.yast">
   <title>Submetendo informações ao suporte com o YaST</title>
   <para>
    O seguinte procedimento considera que você já tenha criado um armazenamento supportconfig, mas ainda não tenha feito upload dele. Verifique se você incluiu suas informações de contato no armazenamento, conforme descrito na <xref linkend="sec.admsupport.yast"/>, <xref linkend="step.supportconfig.contact" xrefstyle="select:label nopage"/>. Para ver instruções de como gerar e submeter de uma só vez um armazenamento supportconfig, consulte a <xref linkend="sec.admsupport.yast"/>.
   </para>
   <step>
    <para>
     Inicie o YaST e abra o módulo de <guimenu>Suporte</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Clique em <guimenu>Fazer Upload</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Em <guimenu>Pacote com arquivos de registro</guimenu>, especifique o caminho para o armazenamento supportconfig existente ou use <guimenu>Pesquisar</guimenu>.
    </para>
   </step>
   <step xml:id="step.supportcfg.submit.upltarget">
    <para>
     O YaST propõe um servidor de upload automaticamente. Para modificá-lo, consulte a <xref linkend="sec.admsupport.supportconfig.upload"/> para saber os detalhes de quais servidores de upload estão disponíveis.
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="yast2-support-conf-upload.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="yast2-support-conf-upload.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <para>
     <remark>taroth 2014-04-11: this does not make sense to me - why does the
      YaST module *not* ask for the SR number now? and lets you continue after
      specifying an upload target (but no RC or customer info)? I would
      expect it to *check* if an SR has been entered and otherwise show an error
      message - filed http://bugzilla.suse.com/show_bug.cgi?id=880943 for this, unfortunately it
      was rejected for technical reasons</remark> Continue com <guimenu>Avançar</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Clique em <guimenu>Concluir</guimenu>.
    </para>
   </step>
  </procedure>

  <procedure xml:id="pro.admsupport.submit.cli">
   <title>Submetendo informações ao suporte por linha de comando</title>
   <para>
    O seguinte procedimento considera que você já tenha criado um armazenamento supportconfig, mas ainda não tenha feito upload dele. Para ver instruções de como gerar e submeter de uma só vez um armazenamento supportconfig, consulte a <xref linkend="sec.admsupport.yast"/>.
   </para>
   <step>
    <para>
     Servidores com conectividade à Internet:
    </para>
    <substeps performance="required">
     <step>
      <para>
       Para usar o destino de upload padrão, execute:
      </para>
<screen>supportconfig -ur <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       Para o destino de upload seguro, use o seguinte:
      </para>

<screen>supportconfig -ar <replaceable>12345678901</replaceable></screen>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     Servidores <emphasis>sem</emphasis> conectividade à Internet
    </para>
    <substeps performance="required">
     <step>
      <para>
       Execute o seguinte:
      </para>
<screen>supportconfig -r <replaceable>12345678901</replaceable></screen>
     </step>
     <step>
      <para>
       Faça upload do armazenamento <filename>/var/log/nts_<replaceable>SR12345678901</replaceable>*tbz</filename> manualmente para um de nossos servidores FTP. O servidor que deverá ser usado depende da sua localização global. Para uma visão geral, consulte a <xref linkend="sec.admsupport.supportconfig.upload"/>.
      </para>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     Depois que o armazenamento TAR estiver no diretório de entrada do nosso servidor FTP, ele será automaticamente anexado à sua solicitação de serviço.
    </para>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec.admsupport.sca">
  <title>Analisando informações do sistema</title>

  <para>
   É possível analisar os relatórios do sistema criados com o <command>supportconfig</command> para ver se há problemas conhecidos e agilizar sua solução. Para esta finalidade, o <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> oferece uma aplicação e uma ferramenta de linha de comando para <literal>Supportconfig Analysis</literal> (SCA). A aplicação SCA é uma ferramenta não interativa executada no servidor. A ferramenta SCA (<command>scatool</command>) é executada no cliente por linha de comando. As duas ferramentas analisam os armazenamentos supportconfig dos servidores afetados. A análise inicial do servidor ocorre na aplicação SCA ou na estação de trabalho em que a scatool é executada. Nenhum ciclo de análise é realizado no servidor de produção.
  </para>

  <para>
   Tanto a aplicação quanto a ferramenta de linha de comando também precisam de padrões específicos do produto, que as permitem analisar a saída do supportconfig dos produtos associados. Cada padrão é um script que analisa e avalia um armazenamento supportconfig referente a um problema conhecido. Os padrões estão disponíveis como pacotes RPM.
  </para>

  <para>
   Por exemplo, para analisar armazenamentos supportconfig que foram gerados em uma máquina com o SUSE Linux Enterprise 11, é necessário instalar o pacote <systemitem class="resource">sca-patterns-sle11</systemitem> juntamente com a ferramenta SCA (ou na máquina que deseja usar como servidor da aplicação SCA). Para analisar armazenamentos supportconfig gerados em uma máquina com o SUSE Linux Enterprise 10, o pacote <systemitem class="resource">sca-patterns-sle10</systemitem> é necessário.
  </para>

  <para>
   É possível também desenvolver seus próprios padrões, conforme descrito resumidamente na <xref linkend="sec.admsupport.sca.patterns"/>.
  </para>

  <sect2 xml:id="sec.admsupport.sca.tool">
   <title>Ferramenta de linha de comando SCA</title>
   <para>
    A ferramenta de linha de comando SCA permite analisar uma máquina local usando o <command>supportconfig</command> e os padrões de análise referentes ao produto específico que está instalado na máquina local. A ferramenta cria um relatório HTML que mostra os resultados da análise. Para obter um exemplo, consulte a <xref linkend="fig.scatool.html"/>.
   </para>
   <figure xml:id="fig.scatool.html">
    <title>Relatório HTML gerado pela ferramenta SCA</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="sca_tool_report_html.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    O comando <command>scatool</command> está incluído no pacote <systemitem class="resource">sca-server-report</systemitem>. Ele não é instalado por padrão. Você também precisa do pacote <systemitem class="resource">sca-patterns-base</systemitem> e de qualquer um dos pacotes <systemitem class="resource">sca-patterns-*</systemitem> específicos do produto correspondentes ao produto instalado na máquina em que deseja executar o comando <command>scatool</command>.
   </para>
   <para>
    Execute o comando <command>scatool</command> como usuário <systemitem class="username">root</systemitem> ou com <command>sudo</command>. Ao chamar a ferramenta SCA, é possível analisar um armazenamento TAR <command>supportconfig</command> existente ou deixar que ela gere e analise um novo armazenamento de uma vez. A ferramenta também oferece um console interativo (com preenchimento de tabulação) e a possibilidade de executar o <command>supportconfig</command> em uma máquina externa e de executar as análises subsequentes na máquina local.
   </para>
   <para>
    Veja a seguir alguns exemplos de comandos:
   </para>
   <variablelist>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option>
     </term>
     <listitem>
      <para>
       Chama o <command>supportconfig</command> e gera um novo armazenamento supportconfig na máquina local. Analisa o armazenamento para ver se há problemas conhecidos aplicando os padrões de análise da SCA correspondentes ao produto instalado. Exibe o caminho para o relatório HTML que é gerado com base nos resultados da análise. Normalmente, ele é gravado no mesmo diretório do armazenamento supportconfig.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-s</option> <option>-o</option> <replaceable>/opt/sca/reports/</replaceable> 
     </term>
     <listitem>
      <para>
       Igual ao <command>sudo scatool </command><option>-s</option>, só que o relatório HTML é gravado no caminho especificado com <option>-o</option>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>CAMINHO_PARA_TARBALL_OU_DIR</replaceable> 
     </term>
     <listitem>
      <para>
       Analisa o arquivo de armazenamento supportconfig especificado (ou o diretório indicado no qual o armazenamento supportconfig foi extraído). O relatório HTML gerado é gravado no mesmo local do armazenamento ou diretório do supportconfig.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-a</option> <replaceable>servidor_sles.empresa.com</replaceable> 
     </term>
     <listitem>
      <para>
       Estabelece uma conexão SSH com o servidor externo <replaceable>servidor_sles.empresa.com</replaceable> e executa o <command>supportconfig</command> no servidor. Em seguida, o armazenamento supportconfig é copiado novamente na máquina local e analisado nela. O relatório HTML gerado é gravado no diretório padrão <filename>/var/log</filename>. (Apenas o armazenamento supportconfig é criado em <replaceable>servidor_sles.empresa.com</replaceable>).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>sudo scatool </command><option>-c</option>
     </term>
     <listitem>
      <para>
       Inicia o console interativo da <command>scatool</command>. Pressione <keycap function="tab"/> duas vezes para ver os comandos disponíveis.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Para mais opções e informações, execute <command>sudo scatool -h</command> ou consulte a página de manual de <command>scatool</command>.
   </para>
  </sect2>

  <sect2 xml:id="sec.admsupport.sca.appliance">
   <title>Aplicação SCA</title>
   <para>
    Se você usar a aplicação SCA para analisar armazenamentos supportconfig, precisará configurar um servidor dedicado (ou máquina virtual) como servidor da aplicação SCA. Depois disso, o servidor da aplicação SCA poderá ser usado para analisar armazenamentos supportconfig em todas as máquinas da sua empresa que tenham o SUSE Linux Enterprise Server ou o SUSE Linux Enterprise Desktop. Basta fazer upload dos armazenamentos supportconfig para o servidor da aplicação para análise. Não é necessária nenhuma interação. Em um banco de dados MariaDB, a aplicação SCA monitora todos os armazenamentos supportconfig que foram analisados. É possível ler os relatórios da SCA diretamente da interface da Web da aplicação. Se você preferir, a aplicação poderá enviar o relatório HTML por e-mail para qualquer usuário administrativo. Para obter os detalhes, consulte a <xref linkend="sec.admsupport.sca.appliance.config.mail"/>.
   </para>
   <sect3 xml:id="sec.admsupport.sca.appliance.installquick">
    <title>Inicialização Rápida da Instalação</title>
    <para>
     Para instalar e configurar rapidamente a aplicação SCA por linha de comando, siga as instruções neste documento. O procedimento é voltado para especialistas e está centrado na instalação limpa e nos comandos de configuração. Para obter mais informações, consulte a descrição mais detalhada da <xref linkend="sec.admsupport.sca.appliance.pre"/> até a <xref linkend="sec.admsupport.sca.appliance.install"/>.
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <title>Pré-requisitos</title>
     <listitem>
      <para>
       Padrão da Web e LAMP
      </para>
     </listitem>
     <listitem>
      <para>
       Módulo da Web e de Criação de Scripts (você deve registrar a máquina para selecionar esse módulo).
      </para>
     </listitem>
    </itemizedlist>
    <note>
     <title>Privilégios de <systemitem class="username">root</systemitem> necessários</title>
     <para>
      Todos os comandos do procedimento a seguir devem ser executados como <systemitem class="username">root</systemitem>.
     </para>
    </note>
    <procedure>
     <title>Instalação usando FTP anônimo para upload</title>
     <para>
      Depois que a aplicação estiver funcionando, não será necessária mais nenhuma interação manual. Portanto, esta forma de configurar a aplicação é ideal ao usar tarefas cron para criar e fazer upload de armazenamentos supportconfig.
     </para>
     <step>
      <para>
       Na máquina de instalação da aplicação, efetue login no console e execute os seguintes comandos:
      </para>
<screen>zypper install sca-appliance-* sca-patterns-* vsftpd
systemctl enable apache2
systemctl start apache2
systemctl enable vsftpd
systemctl start vsftpd
yast ftp-server</screen>
     </step>
     <step>
      <para>
       No Servidor FTP do YaST, selecione <menuchoice> <guimenu>Autenticação</guimenu> <guimenu>Habilitar Upload</guimenu> <guimenu>Anônimo Pode Fazer Upload</guimenu> <guimenu>Concluir</guimenu> <guimenu>Sim</guimenu> </menuchoice> para <guimenu>Criar /srv/ftp/upload</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Execute os seguintes comandos:
      </para>
<screen>systemctl enable mysql
systemctl start mysql
mysql_secure_installation
setup-sca -f</screen>
      <para>
       A mysql_secure_installation cria uma senha de <systemitem class="username">root</systemitem> do MariaDB.
      </para>
     </step>
    </procedure>
    <procedure>
     <title>Instalação usando SCP/tmp para upload</title>
     <para>
      Esta forma de configurar a aplicação requer interação manual para digitar a senha SSH.
     </para>
     <step>
      <para>
       Na máquina de instalação da aplicação, efetue login no console.
      </para>
     </step>
     <step>
      <para>
       Execute os seguintes comandos:
      </para>
<screen>zypper install sca-appliance-* sca-patterns-*
systemctl enable apache2
systemctl start apache2
sudo systemctl enable mysql
systemctl start mysql
mysql_secure_installation
setup-sca</screen>
     </step>
    </procedure>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.pre">
    <title>Pré-requisitos</title>
    <para>
     Para executar um servidor da aplicação SCA, são necessários os seguintes pré-requisitos:
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       Todos os pacotes <systemitem>sca-appliance-*</systemitem>.
      </para>
     </listitem>
     <listitem>
      <para>
       O pacote <systemitem class="resource">sca-patterns-base</systemitem>. Adicionalmente, qualquer um dos <systemitem class="resource">sca-patterns-*</systemitem> específicos do produto, de acordo com o tipo de armazenamento supportconfig que você deseja analisar com a aplicação.
      </para>
     </listitem>
     <listitem>
      <para>
       Apache
      </para>
     </listitem>
     <listitem>
      <para>
       PHP
      </para>
     </listitem>
     <listitem>
      <para>
       MariaDB
      </para>
     </listitem>
     <listitem>
      <para>
       Servidor FTP anônimo (opcional)
      </para>
     </listitem>
    </itemizedlist>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.install">
    <title>Instalação e configuração básica</title>
    <para>
     Conforme listado na <xref linkend="sec.admsupport.sca.appliance.pre"/>, a aplicação SCA possui várias dependências em outros pacotes. Portanto, você precisa fazer algumas preparações antes de instalar e configurar o servidor da aplicação SCA:
    </para>
    <procedure>
     <step>
      <para>
       No Apache e no MariaDB, instale os padrões de instalação da <systemitem>Web</systemitem> e <systemitem>LAMP</systemitem>.
      </para>
     </step>
     <step>
      <para>
       Configure o Apache, o MariaDB e, opcionalmente, um servidor FTP anônimo.
       
      </para>
     </step>
     <step>
      <para>
       Configure o Apache e o MariaDB para iniciarem no momento da inicialização:
      </para>
<screen>sudo systemctl enable apache2 mysql</screen>
     </step>
     <step>
      <para>
       Inicie os dois serviços:
      </para>
<screen>sudo systemctl start apache2 mysql</screen>
     </step>
    </procedure>
    <para>
     Agora você pode instalar a aplicação SCA e configurá-la conforme descrito no <xref linkend="pro.sca.appl.install"/>.
    </para>
    <procedure xml:id="pro.sca.appl.install">
     <title>Instalando e configurando a aplicação SCA</title>
     <para>
      Após instalar os pacotes, use o script <command>setup-sca</command> para a configuração básica do banco de dados de administração e relatório MariaDB, que é usado pela aplicação SCA.
     </para>
     <para>
      Ele pode ser usado para configurar as seguintes opções disponíveis para fazer upload dos armazenamentos supportconfig de suas máquinas para a aplicação SCA:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <command>scp</command>
       </para>
      </listitem>
      <listitem>
       <para>
        servidor FTP anônimo
       </para>
      </listitem>
     </itemizedlist>
     <step>
      <para>
       Instale a aplicação e a biblioteca de padrões com base na SCA:
      </para>
<screen>sudo zypper install sca-appliance-* sca-patterns-base</screen>
     </step>
     <step>
      <para>
       Instale também os pacotes de padrões de acordo com os tipos de armazenamentos supportconfig que você deseja analisar. Por exemplo, se você tem servidores SUSE Linux Enterprise Server 11 e SUSE Linux Enterprise Server 12 em seu ambiente, instale os dois pacotes <systemitem>sca-patterns-sle11</systemitem> e <systemitem>sca-patterns-sle12</systemitem>.
      </para>
      <para>
       Para instalar todos os padrões disponíveis:
      </para>
<screen>zypper install sca-patterns-*</screen>
     </step>
     <step>
      <para>
       Para a configuração básica da aplicação SCA, use o script <command>setup-sca</command>. O modo como ele é chamado depende de como você deseja fazer upload dos armazenamentos supportconfig para o servidor da aplicação SCA:
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         Se você configurar um servidor FTP anônimo que usa o diretório <filename>/srv/ftp/upload</filename>, execute o script de configuração com a opção <option>-f</option> e siga as instruções na tela:
        </para>
<screen>setup-sca -f</screen>
        <note>
         <title>Servidor FTP que usa outro diretório</title>
         <para>
          Se o seu servidor FTP usa um diretório diferente do <filename>/srv/ftp/upload</filename>, ajuste os seguintes arquivos de configuração para apontarem para o diretório correto: <filename>/etc/sca/sdagent.conf</filename> e <filename>/etc/sca/sdbroker.conf</filename> .
         </para>
        </note>
       </listitem>
       <listitem>
        <para>
         Para fazer upload dos arquivos supportconfig para o diretório <filename>/tmp</filename> do servidor da aplicação SCA usando o comando <command>scp</command>, chame o script de configuração sem nenhum parâmetro e siga as instruções na tela:
        </para>
<screen>setup-sca</screen>
       </listitem>
      </itemizedlist>
      <para>
       O script de configuração executa algumas verificações referentes a seus requisitos e configura os componentes necessários. Ele pede duas senhas: a senha de <systemitem class="username">root</systemitem> MySQL do MariaDB que você configurou e uma senha de usuário da Web usada para efetuar login na interface da Web da aplicação SCA.
      </para>
     </step>
     <step>
      <para>
       Digite a senha de <systemitem class="username">root</systemitem> existente do MariaDB. Isso permite que a aplicação SCA se conecte com o MariaDB.
      </para>
     </step>
     <step>
      <para>
       Defina uma senha para o usuário da Web. Ela será gravada em <filename>/srv/www/htdocs/sca/web-config.php</filename> e definida como a senha do usuário <systemitem class="username">scdiag</systemitem>. Tanto o nome de usuário quanto a senha podem ser mudados a qualquer momento. Consulte a <xref linkend="sec.admsupport.sca.appliance.config.passwd"/>.
      </para>

     </step>
    </procedure>
    <para>
     Após a instalação e configuração bem-sucedidas, a aplicação SCA estará pronta para uso. Consulte a <xref linkend="sec.admsupport.sca.appliance.use"/>. No entanto, você deve modificar algumas opções, como mudar a senha da interface da Web, mudar a fonte das atualizações dos padrões da SCA, habilitar o modo de arquivamento ou configurar notificações por e-mail. Para ver os detalhes sobre isso, consulte a <xref linkend="sec.admsupport.sca.appliance.config"/>.
    </para>
    <warning>
     <title>Proteção de Dados</title>
     <para>
      Como os relatórios no servidor da aplicação SCA incluem informações relacionadas à segurança sobre as máquinas em que os armazenamentos supportconfig foram analisados, proteja os dados do servidor da aplicação SCA contra acesso não autorizado.
     </para>
    </warning>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.use">
    <title>Usando a aplicação SCA</title>
    <para>
     É possível fazer upload dos armazenamentos supportconfig existentes para a aplicação SCA manualmente ou criar novos armazenamentos supportconfig e fazer upload deles para a aplicação SCA em uma etapa. O upload pode ser feito por FTP ou SCP. Nos dois, é necessário saber o URL para acessar a aplicação SCA. Para upload por FTP, um servidor FTP precisa ser configurado para a aplicação SCA. Consulte o <xref linkend="pro.sca.appl.install"/>.
    </para>
    <sect4 xml:id="sec.admsupport.sca.appliance.use.upload">
     <title>Fazendo upload de armazenamentos supportconfig para a aplicação SCA</title>
     <para/>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Para criar um armazenamento supportconfig e fazer seu upload por FTP (anônimo):
       </para>
<screen>sudo supportconfig -U “ftp://<replaceable>sca-appliance.company.com</replaceable>/upload”</screen>
      </listitem>
      <listitem>
       <para>
        Para criar um armazenamento supportconfig e fazer seu upload por SCP:
       </para>
<screen>sudo supportconfig -U “scp://<replaceable>sca-appliance.company.com</replaceable>/tmp”</screen>
       <para>
        Você deverá informar a senha de usuário <systemitem class="username">root</systemitem> do servidor que executa a aplicação SCA.
       </para>
      </listitem>
      <listitem>
       <para>
        Para fazer upload de um ou vários armazenamentos manualmente, copie os arquivos de armazenamento existentes (normalmente em <filename>/var/log/nts_*.tbz</filename>) para a aplicação SCA. Como destino, use o diretório <filename>/tmp</filename> do servidor da aplicação ou o diretório <filename>/srv/ftp/upload</filename> (se FTP estiver configurado para o servidor da aplicação SCA).
       </para>
      </listitem>
     </itemizedlist>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.use.view">
     <title>Vendo relatórios da SCA</title>
     <para>
      É possível ver os relatórios da SCA de qualquer máquina que tenha um browser instalado e acesso à página de índice de relatórios da aplicação SCA.
     </para>
     <procedure>
      <step>
       <para>
        Inicie o browser da Web e verifique se o JavaScript e os cookies estão habilitados.
       </para>
      </step>
      <step>
       <para>
        Como URL, insira a página de índice de relatórios da aplicação SCA.
       </para>
<screen>https://sca-appliance.company.com/sca</screen>
       <para>
        Se estiver em dúvida, pergunte ao administrador do sistema.
       </para>
      </step>
      <step>
       <para>
        Você deverá informar o nome de usuário e a senha para efetuar login.
       </para>
       <figure xml:id="fig.sca.appl.html">
        <title>Relatório HTML gerado pela aplicação SCA</title>
        <mediaobject>
         <imageobject role="fo">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
         <imageobject role="html">
          <imagedata fileref="sca_appl_report_html.png" width="100%"/>
         </imageobject>
        </mediaobject>
       </figure>
      </step>
      <step>
       <para>
        Após o login, clique na data do relatório que deseja ler.
       </para>
      </step>
      <step>
       <para>
        Clique primeiro na categoria <guimenu>Basic Health</guimenu> (Saúde Básica) para expandi-la.
       </para>
      </step>
      <step>
       <para>
        Na coluna <guimenu>Message</guimenu> (Mensagem), clique em uma entrada. O artigo correspondente é aberto no SUSE Knowledgebase. Leia a solução proposta e siga as instruções.
       </para>
      </step>
      <step>
       <para>
        Se a coluna <guimenu>Solutions</guimenu> (Soluções) do <guimenu>Relatório da Supportconfig Analysis</guimenu> mostrar qualquer outra entrada, clique nela. Leia a solução proposta e siga as instruções.
       </para>
      </step>
      <step>
       <para>
        Consulte o SUSE Knowledgebase (<link xlink:href="http://www.suse.com/support/kb/"/>) para ver resultados diretamente relacionados ao problema identificado pela SCA. Resolva o problema.
       </para>
      </step>
      <step>
       <para>
        Procure resultados que possam ser usados proativamente para evitar futuros problemas.
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.config">
    <title>Personalizando a aplicação SCA</title>
    <para>
     As seguintes seções mostram como mudar a senha da interface da Web, como mudar a fonte das atualizações dos padrões da SCA, como habilitar o modo de arquivamento e como configurar notificações por e-mail.
    </para>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.passwd">
     <title>Senha da interface da Web</title>
     <para>
      A interface da Web da aplicação SCA requer nome de usuário e senha para login. O nome de usuário padrão é <literal>scdiag</literal> e a senha padrão é <literal>linux</literal> (caso não tenham sido especificados de outra forma. Consulte o <xref linkend="pro.sca.appl.install"/>). Mude a senha padrão para uma senha segura na primeira oportunidade. É possível também modificar o nome de usuário.
     </para>
     <procedure xml:id="pro.sca.passwd.change">
      <title>Mudando nome de usuário ou senha da interface da Web</title>
      <step>
       <para>
        Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor da aplicação SCA.
       </para>
      </step>
      <step>
       <para>
        Abra o <filename>/srv/www/htdocs/sca/web-config.php</filename> em um editor.
       </para>
      </step>
      <step>
       <para>
        Mude os valores de <literal>$username</literal> e <literal>$password</literal> conforme desejado.
       </para>
      </step>
      <step>
       <para>
        Grave o arquivo e saia.
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.upd">
     <title>Atualizações dos padrões da SCA</title>
     <para>
      Por padrão, todos os pacotes <systemitem class="resource">sca-patterns-*</systemitem> são atualizados regularmente por uma tarefa cron <systemitem class="username">root</systemitem> que executa o script <filename>sdagent-patterns</filename> durante a noite, que, por sua vez, executa <command>zypper update sca-patterns-*</command>. Uma atualização regular de sistema atualiza todos os pacotes de padrões e da aplicação SCA. Para atualizar a aplicação SCA e os padrões manualmente, execute:
     </para>
<screen>sudo zypper update sca-*</screen>
     <para>
      Por padrão, as atualizações são instaladas do repositório de atualização do SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP3</phrase></phrase>. Você poderá mudar a fonte das atualizações para um servidor SMT, se desejado. Quando <filename>sdagent-patterns</filename> executa <command>zypper update sca-patterns-*</command>, ele acessa as atualizações do canal de atualização configurado no momento. Se esse canal estiver em um servidor SMT, os pacotes serão acessados de lá.
     </para>
     <procedure>
      <title>Desabilitando atualizações automáticas de padrões da SCA</title>
      <step>
       <para>
        Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor da aplicação SCA.
       </para>
      </step>
      <step>
       <para>

        Abra o <filename>/etc/sca/sdagent-patterns.conf</filename> em um editor.
       </para>
      </step>
      <step>
       <para>
        Mudar a entrada
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=1</screen>
       <para>
        to
       </para>
<screen>UPDATE_FROM_PATTERN_REPO=0</screen>
      </step>
      <step>
       <para>
        Grave o arquivo e saia. Não é necessário reiniciar a máquina para aplicar a mudança.
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.archive">
     <title>Modo de arquivamento</title>
     <para>
      Todos os armazenamentos supportconfig serão apagados da aplicação SCA depois de serem analisados e de seus resultados serem armazenados no banco de dados MariaDB. Para fins de solução de problemas, no entanto, convém manter cópias dos armazenamentos supportconfig da máquina. Por padrão, o modo de arquivamento está desabilitado.
     </para>
     <procedure>
      <title>Habilitando o modo de arquivamento na aplicação SCA</title>
      <step>
       <para>
        Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor da aplicação SCA.
       </para>
      </step>
      <step>
       <para>
        Abra o <filename>/etc/sca/sdagent.conf</filename> em um editor.
       </para>
      </step>
      <step>
       <para>
        Mudar a entrada
       </para>
<screen>ARCHIVE_MODE=0</screen>
       <para>
        to
       </para>
<screen>ARCHIVE_MODE=1</screen>
      </step>
      <step>
       <para>
        Grave o arquivo e saia. Não é necessário reiniciar a máquina para aplicar a mudança.
       </para>
      </step>
     </procedure>
     <para>
      Após habilitar o modo de arquivamento, a aplicação SCA gravará os arquivos supportconfig no diretório <filename>/var/log/archives/saved</filename>, em vez de apagá-los.
     </para>
    </sect4>
    <sect4 xml:id="sec.admsupport.sca.appliance.config.mail">
     <title>Enviando relatórios da SCA por e-mail</title>
     <para>
      A aplicação SCA pode enviar um arquivo HTML de relatório por e-mail referente a cada supportconfig analisado. Por padrão, este recurso está desabilitado. Ao habilitá-lo, é possível definir uma lista de endereços de e-mail para os quais enviar os relatórios e especificar um nível de mensagens de status que aciona o envio dos relatórios (<literal>STATUS_NOTIFY_LEVEL</literal>).
     </para>
     <variablelist xml:id="vl.sca.mails.notify.level">
      <title>Valores possíveis para <literal>STATUS_NOTIFY_LEVEL</literal></title>
      <varlistentry>
       <term>$STATUS_OFF</term>
       <listitem>
        <para>
         Desativar o envio de relatórios HTML.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_CRITICAL</term>
       <listitem>
        <para>
         Enviar apenas relatórios da SCA que incluam CRITICAL (Crítico).
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_WARNING </term>
       <listitem>
        <para>
         Enviar apenas relatórios da SCA que incluam WARNING (Aviso) ou CRITICAL.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_RECOMMEND</term>
       <listitem>
        <para>
         Enviar apenas relatórios da SCA que incluam RECOMMEND (Recomendado), WARNING ou CRITICAL.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>$STATUS_SUCCESS</term>
       <listitem>
        <para>
         Enviar relatórios da SCA que incluam SUCCESS (Êxito), RECOMMEND, WARNING ou CRITICAL.
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <procedure>
      <title>Configurando notificações por e-mail para relatórios da SCA</title>
      <step>
       <para>
        Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor da aplicação SCA.
       </para>
      </step>
      <step>
       <para>
        Abra o <filename>/etc/sca/sdagent.conf</filename> em um editor.
       </para>
      </step>
      <step>
       <para>
        Pesquise a entrada <systemitem>STATUS_NOTIFY_LEVEL</systemitem>. Por padrão, ela está definida como <literal>$STATUS_OFF</literal> (notificações por e-mail desabilitadas).
       </para>
      </step>
      <step>
       <para>
        Para habilitar as notificações por e-mail, mude <literal>$STATUS_OFF</literal> para o nível de mensagens de status para o qual deseja gerar relatórios por e-mail, por exemplo:
       </para>
<screen>STATUS_NOTIFY_LEVEL=$STATUS_SUCCESS</screen>
       <para>
        Para obter os detalhes, consulte a <xref linkend="vl.sca.mails.notify.level"/>.
       </para>
      </step>
      <step>
       <para>
        Para definir a lista de destinatários que devem receber os relatórios:
       </para>
       <substeps performance="required">
        <step>
         <para>
          Pesquise a entrada <literal>EMAIL_REPORT='root'</literal>.
         </para>
        </step>
        <step>
         <para>
          Substitua <literal>root</literal> pela lista de endereços de e-mail aos quais enviar os relatórios da SCA. Os endereços de e-mail devem ser separados por espaços. Por exemplo:
         </para>
<screen>EMAIL_REPORT='tux@my.company.com wilber@your.company.com'</screen>
        </step>
       </substeps>
      </step>
      <step>
       <para>
        Grave o arquivo e saia. Não é necessário reiniciar a máquina para aplicar as mudanças. Todos os relatórios futuros da SCA serão enviados por e-mail aos endereços especificados.
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 xml:id="sec.admsupport.sca.appliance.backup">
    <title>Fazendo backup e restaurando o banco de dados</title>
    <para>
     Para fazer backup e restaurar o banco de dados MariaDB que armazena os relatórios da SCA, use o comando <command>scadb</command>, conforme descrito a seguir.
    </para>
    <procedure>
     <title>Fazendo backup do banco de dados</title>
     <step>
      <para>
       Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor que executa a aplicação SCA.
      </para>
     </step>
     <step>
      <para>
       Coloque a aplicação no modo de manutenção executando:
      </para>
<screen>scadb maint</screen>
     </step>
     <step>
      <para>
       Inicie o backup com:
      </para>
<screen>scadb backup</screen>
      <para>
       Os dados são gravados em um armazenamento TAR: <filename>sca-backup-*sql.gz</filename>.
      </para>
     </step>
     <step>
      <para>
       Se você usa o banco de dados de criação de padrões para desenvolver seus próprios padrões (consulte a <xref linkend="sec.admsupport.sca.patterns"/>), faça backup também destes dados:
      </para>
<screen>sdpdb backup</screen>
      <para>
       Os dados são gravados em um armazenamento TAR: <filename>sdp-backup-*sql.gz</filename>.
      </para>
     </step>
     <step>
      <para>
       Copie os seguintes dados para outra máquina ou para um meio de armazenamento externo:
      </para>
      <itemizedlist mark="bullet" spacing="normal">
       <listitem>
        <para>
         <filename>sca-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>sdp-backup-*sql.gz</filename>
        </para>
       </listitem>
       <listitem>
        <para>
         <filename>/usr/lib/sca/patterns/local</filename> (necessário apenas se você criar padrões personalizados)
        </para>
       </listitem>
      </itemizedlist>
     </step>
     <step>
      <para>
       Ative novamente a aplicação SCA com:
      </para>
<screen>scadb reset agents</screen>
     </step>
    </procedure>
    <procedure>
     <title>Restaurando o banco de dados</title>
     <para>
      Para restaurar o banco de dados do backup, faça o seguinte:
     </para>
     <step>
      <para>
       Efetue login como usuário <systemitem class="username">root</systemitem> no console do sistema do servidor que executa a aplicação SCA.
      </para>
     </step>
     <step>
      <para>
       Copie os armazenamentos TAR <filename>sca-backup-*sql.gz</filename> e <filename>sdp-backup-*sql.gz</filename> mais recentes para o servidor da aplicação SCA.
      </para>
     </step>
     <step>
      <para>
       Para descompactar os arquivos, execute:
      </para>
<screen>gzip -d *-backup-*sql.gz</screen>
     </step>
     <step>
      <para>
       Para importar os dados para o banco de dados, execute:
      </para>
<screen>scadb import sca-backup-*sql</screen>
     </step>
     <step>
      <para>
       Se você usa o banco de dados de criação de padrões para criar seus próprios padrões, importe também os seguintes dados com:
      </para>
<screen>sdpdb import sdp-backup-*sql</screen>
     </step>
     <step>
      <para>
       Se você usa padrões personalizados, restaure também <filename>/usr/lib/sca/patterns/local</filename> dos dados do backup.
      </para>
     </step>
     <step>
      <para>
       Ative novamente a aplicação SCA com:
      </para>
<screen>scadb reset agents</screen>
     </step>
     <step>
      <para>
       Atualize os módulos de padrão no banco de dados com:
      </para>
<screen>sdagent-patterns -u</screen>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 xml:id="sec.admsupport.sca.patterns">
   <title>Desenvolvendo padrões de análise personalizados</title>
   <para>
    A aplicação SCA vem com um ambiente completo de desenvolvimento de padrões (o Banco de Dados de Padrões da SCA), que permite desenvolver padrões personalizados. Os padrões podem ser desenvolvidos em qualquer linguagem de programação. Para disponibilizá-los para o processo de análise do supportconfig, eles devem ser gravados em <filename>/usr/lib/sca/patterns/local</filename> e ser executáveis. Tanto a aplicação quanto a ferramenta SCA executam os padrões personalizados nos novos armazenamentos supportconfig como parte do relatório de análise. Para obter instruções detalhadas sobre como criar (e testar) seus próprios padrões, visite <link xlink:href="http://www.suse.com/communities/conversations/sca-pattern-development/"/>.
   </para>
  </sect2>
 </sect1>

 <sect1 xml:id="sec.admsupport.install">
  <title>Coletando informações durante a instalação</title>
  <para>
   Durante a instalação, o <command>supportconfig</command> não está disponível. No entanto, você pode coletar arquivos de registro do YaST usando <command>save_y2logs</command>. Esse comando criará um arquivo <filename>.tar.xz</filename> no diretório <filename>/tmp</filename>.
  </para>
  
  <para>
   Se aparecerem problemas muito no começo da instalação, talvez seja possível coletar informações do arquivo de registro criado por <command>linuxrc</command>. <command>linuxrc</command> é um comando pequeno que é executado antes de o YaST ser iniciado. Esse arquivo de registro está disponível em <filename>/var/log/linuxrc.log</filename>.
  </para>
  <important>
   <title>Arquivos de registro de instalação não disponíveis no sistema instalado</title>
   <para>
    Os arquivos de registro disponíveis durante a instalação não estão mais disponíveis no sistema instalado. Grave apropriadamente os arquivos de registro de instalação enquanto o instalador ainda está em execução.
   </para>
  </important>
 </sect1>

 <sect1 xml:id="sec.admsupport.kernel">
  <title>Suporte aos módulos do Kernel</title>

  <para>
   Um requisito importante para todo sistema operacional empresarial é o nível de suporte que você recebe do ambiente. Os módulos do Kernel são o conector mais relevante entre o hardware (<quote>controladoras</quote>) e o sistema operacional. Cada módulo do kernel no SUSE Linux Enterprise possui um flag <literal>supported</literal> (suportado) que pode ter três valores:
  </para>

  <itemizedlist mark="bullet" spacing="normal">

   <listitem>
    <para>
     <quote>yes</quote>, portanto, <literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote>external</quote> (externo), portanto, <literal>supported</literal>
    </para>
   </listitem>
   <listitem>
    <para>
     <quote/> (vazio, não definido), portanto <literal>unsupported</literal> (não suportado)
    </para>
   </listitem>
  </itemizedlist>

  <para>
   As seguintes regras são válidas:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Por padrão, todos os módulos de um kernel autorrecompilado são marcados como não suportados.
    </para>
   </listitem>
   <listitem>
    <para>
     Os módulos do Kernel suportados pelos parceiros do SUSE e distribuídos pelo <literal>SUSE SolidDriver Program</literal> são marcados como <quote>externos</quote>.
    </para>
   </listitem>
   <listitem>
    <para>
     Se o flag <literal>supported</literal> não estiver definido, o carregamento do módulo contaminará o kernel. Kernels contaminados não são suportados. Os módulos do Kernel não suportados estão incluídos em um pacote RPM extra (<systemitem>kernel-<replaceable>TIPO</replaceable>-extra</systemitem>) que está disponível apenas para o SUSE Linux Enterprise Desktop e a SUSE Linux Enterprise Workstation Extension. Por padrão, esses kernels não são carregados (<replaceable>TIPO</replaceable>=<literal>default</literal>|<literal>xen</literal>|...). Esses módulos não suportados também não estão disponíveis no instalador, e o pacote <systemitem class="resource">kernel-<replaceable>TIPO</replaceable>-extra</systemitem> não faz parte da mídia do SUSE Linux Enterprise.
    </para>
   </listitem>
   <listitem>
    <para>
     Os módulos do kernel não incluídos em uma licença compatível com a licença do kernel do Linux também contaminarão o kernel. Para obter detalhes, consulte <filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename> e o estado de <filename>/proc/sys/kernel/tainted</filename>.
    </para>
   </listitem>
  </itemizedlist>

  <sect2 xml:id="sec.admsupport.kernel.background">
   <title>Informações técnicas</title>
   <para/>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Kernel do Linux: O valor de <filename>/proc/sys/kernel/unsupported</filename> usa o padrão <literal>2</literal> no SUSE Linux Enterprise <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP3</phrase></phrase> (<literal>do not warn in syslog when loading unsupported modules</literal>). Esse padrão é usado no instalador e no sistema instalado. Consulte <filename>/usr/src/linux/Documentation/sysctl/kernel.txt</filename> para obter mais informações.
     </para>
    </listitem>
    <listitem>
     <para>
      <command>modprobe</command>: O utilitário <command>modprobe</command> de verificação de dependências de módulos e carregamento dos módulos apropriados confirma se o valor do flag é <literal>supported</literal> (suportado). Se o valor for <quote>sim</quote> ou <quote>externo</quote>, o módulo será carregado, do contrário, não. Para obter informações sobre como anular este comportamento, consulte a <xref linkend="sec.admsupport.kernel.unsupported"/>.
     </para>
     <note>
      <title>Suporte</title>
      <para>
       Em geral, o SUSE não suporta a remoção de módulos de armazenamento por <command>modprobe -r</command>.
      </para>
     </note>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 xml:id="sec.admsupport.kernel.unsupported">
   <title>Trabalhando com módulos não suportados</title>
   <para>
    Embora a capacidade de suporte geral seja importante, algumas situações podem exigir o carregamento de um módulo não suportado (por exemplo, para fins de teste ou depuração, ou se o fornecedor de hardware disponibilizar um hotfix).
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Para anular o padrão, edite <filename>/etc/modprobe.d/10-unsupported-modules.conf</filename> e mude o valor da variável <varname>allow_unsupported_modules</varname> para <literal>1</literal>. Se for necessário um módulo não suportado no initrd, lembre-se de executar <command>dracut </command><option>-f</option> para atualizar o initrd.
     </para>
     <para>
      Para apenas tentar carregar um módulo uma vez, é possível usar a opção <option>--allow-unsupported-modules</option> com <command>modprobe</command>. Para obter mais informações, consulte a página de manual de <command>modprobe</command>.
     </para>
    </listitem>
    <listitem>
     <para>
      Durante a instalação, módulos não suportados podem ser adicionados por meio de discos de atualização de driver, e eles serão carregados. Para impor o carregamento de módulos não suportados durante a inicialização e posteriormente, use a opção de linha de comando do kernel <option>oem-modules</option>. Durante a instalação e inicialização do pacote <systemitem class="resource">suse-module-tools</systemitem>, o flag do kernel <literal>TAINT_NO_SUPPORT</literal> (<filename>/proc/sys/kernel/tainted</filename>) será avaliado. Se o kernel já foi contaminado, <literal>allow_unsupported_modules</literal> será habilitado. Isso impede que módulos não suportados acessem o sistema que está sendo instalado. Se não houver nenhum módulo não suportado durante a instalação e não for usada a outra opção de linha de comando especial do kernel (<option>oem-modules=1</option>), o padrão ainda será de não permitir módulos não suportados.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Lembre-se de que carregar e executar módulos não suportados tornam o kernel e todo o sistema não suportados pelo SUSE.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.admsupport.moreinfo">
  <title>Para obter mais informações</title>

  <para/>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <command>man supportconfig</command>: A página de manual de <command>supportconfig</command>.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man supportconfig.conf</command>: A página de manual do arquivo de configuração supportconfig.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scatool</command>: A página de manual de <command>scatool</command>.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man scadb</command>: A página de manual de <command>scadb</command>.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>man setup-sca</command>: A página de manual de <command>setup-sca</command>.
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://mariadb.com/kb/en/"/>: A documentação do MariaDB.
    </para>
   </listitem>
   
   
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/sca-pattern-development/"/>: Instruções sobre como criar (e testar) seus próprios padrões da SCA.
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/basic-server-health-check-supportconfig/"/>: Uma verificação da saúde básica do servidor com o supportconfig.
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="https://www.novell.com/communities/coolsolutions/cool_tools/create-your-own-supportconfig-plugin/"/>: Criar seu próprio plug-in Supportconfig.
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://www.suse.com/communities/conversations/creating-a-central-supportconfig-repository/"/>: Criar um repositório central do Supportconfig.
    </para>
    <para>
     <remark>taroth 2014-04-25: jrecord, should we still refer to the three articles above? </remark>
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
</chapter>
