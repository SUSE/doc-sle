<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="zypper.xml" version="5.0" xml:id="sec.zypper">
 <title>使用 Zypper</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  Zypper 是用於安裝、更新和移除套件以及管理儲存庫的指令行套件管理員。這部分內容對於執行遠端軟體管理任務或透過外圍程序程序檔管理軟體非常有用。
 </para>

 <sect2 xml:id="sec.zypper.usage">
  <title>一般使用情形</title>
  <para>
   Zypper 的一般語法為︰
  </para>
<screen>zypper <option>[--global-options]</option> <replaceable>COMMAND</replaceable> <option> [--command-options]</option> <option>[arguments]</option></screen>

  <para>
   括號中的部分為非必需。如需一般選項和所有指令的清單，請參閱 <command>zypper help</command>。若要取得特定指令的說明，請輸入 <command>zypper help </command>
   <replaceable>指令</replaceable>。
  </para>
  <variablelist>
   <varlistentry>
    <term>Zypper 指令</term>
    <listitem>
     <para>
      執行 Zypper 最簡單的方法就是輸入其名稱，後面跟著指令。例如，若要將所有需要的修補程式套用至系統，請使用：
     </para>
<screen>sudo zypper patch</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>全域選項</term>
    <listitem>
     <para>
      此外，您還可以選擇使用一或多個全域選項，只需在指令前面輸入它們即可：
     </para>
<screen>sudo zypper --non-interactive patch</screen>
     <para>
      在上述範例中，選項 <option>--non-interactive</option> 表示在不要求輸入任何內容的情況下執行指令 (自動套用預設回答)。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>特定於指令的選項</term>
    <listitem>
     <para>
      若要使用特定於特殊指令的選項，請緊接在指令後面輸入這些選項：
     </para>
<screen>sudo zypper patch --auto-agree-with-licenses</screen>
     <para>
      在上述範例中，<option>--auto-agree-with-licenses</option> 用於將所有需要的修補程式套用至系統，您不需要確認任何授權條款，而會自動接受授權條款。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>引數</term>
    <listitem>
     <para>
      某些指令需要一或多個引數︰例如，使用 <command>install</command> 指令時，需要指定您想要<emphasis>安裝</emphasis>的一或多個套件：
     </para>
<screen>sudo zypper install mplayer</screen>
     <para>
      某些選項還需要單個引數。以下指令會列出所有已知模式︰
     </para>
<screen>zypper search -t pattern</screen>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   您可以將上述所有指令組合使用。例如，以下指令將以詳細模式安裝 
   <package>aspell-de</package>
    和 
   <package>aspell-fr</package>
   套件 (來自 <literal>factory</literal> 儲存庫)：
  </para>
<screen>sudo zypper -v install --from factory aspell-de aspell-fr</screen>
  <para>
   <option>--from</option> 選項可確保所有儲存庫均處於啟用狀態 (以解決相依性問題)，並且始終從指定的儲存庫要求套件。
  </para>
  <para>
   大部分 Zypper 指令都有一個 <literal>dry-run</literal> 選項，對指定的指令進行模擬。它可以用於測試。
  </para>
<screen>sudo zypper remove --dry-run MozillaFirefox</screen>
  <para>
   Zypper 支援 <option>--userdata <replaceable>字串</replaceable></option>全域選項。您可以使用此選項指定一個將會寫入 Zypper 的記錄檔案和外掛程式 (例如 Btrfs 外掛程式) 的字串。它可以用來標示和識別記錄檔案中的異動。
  </para>
<screen>sudo zypper --userdata <replaceable>STRING</replaceable> patch</screen>
 </sect2>

 <sect2 xml:id="sec.zypper.softman">
  <title>使用 Zypper 安裝和移除軟體</title>
  <para>
   若要安裝或移除套件，請使用以下指令：
  </para>
<screen>sudo zypper install <replaceable>PACKAGE_NAME</replaceable>
sudo zypper remove <replaceable>PACKAGE_NAME</replaceable></screen>

  <warning>
   <title>不要移除必要的系統套件</title>
   <para>
    不要移除必要的系統套件，例如 
    <package>glibc</package>
    、
    <package>zypper</package>
    、
    <package>kernel</package>
    。如果移除這些套件，系統可能會變得不穩定，甚至完全停止運作。
   </para>
  </warning>
  <sect3 xml:id="sec.zypper.selectpackage">
   <title>選取要安裝或移除的套件</title>
   <para>
    可以使用 <command>zypper install</command> 和 <command>zypper remove</command> 指令，以多種方法來找到套件。
   </para>
   <variablelist>
    <varlistentry>
     <term>依確切的套件名稱</term>
     <listitem>
<screen>sudo zypper install MozillaFirefox</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依確切的套件名稱和版本號碼</term>
     <listitem>
<screen>sudo zypper install MozillaFirefox-3.5.3</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依儲存庫別名和套件名稱</term>
     <listitem>
<screen>sudo zypper install mozilla:MozillaFirefox</screen>
      <para>
       <literal>mozilla</literal> 是要安裝套件所在之儲存庫的別名。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依含萬用字元的套件名稱</term>
     <listitem>
      <para>
       您可以選取名稱以特定字串開頭或結尾的所有套件。使用萬用字元時請務必小心，特別是在移除套件時。以下指令將安裝名稱以<quote>Moz</quote>開頭的所有套件：
      </para>
<screen>sudo zypper install 'Moz*'</screen>
      <tip>
       <title>移除所有 <filename>-debuginfo</filename> 套件</title>
       <para>
        在給問題除錯時，您有時需要暫時安裝大量 <filename>-debuginfo</filename> 套件，以取得關於執行中程序的詳細資訊。在完成除錯工作階段後，如果您要清理環境，請執行以下指令：
       </para>
<screen>sudo zypper remove '*-debuginfo'</screen>
      </tip>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依功能</term>
     <listitem>
      <para>
       例如，您要安裝一個 Perl 模組，但不知道套件的名稱，用功能指定便會幫上忙︰
      </para>
<screen>sudo zypper install firefox</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依功能、硬體架構或版本</term>
     <listitem>
      <para>
       可以結合功能指定硬體架構和版本：
      </para>
      <itemizedlist>
       <listitem>
        <para>
         所需硬體架構的名稱需附加在功能的後面，兩者以句點分隔。例如，若要指定 AMD64/Intel 64 架構 (在 Zypper 中命名為 <literal>x86_64</literal>)，請使用︰
        </para>
<screen>sudo zypper install 'firefox.x86_64'</screen>
       </listitem>
       <listitem>
        <para>
         版本必須附加在字串的末尾，並且前面必須使用運算子︰<literal>&lt;</literal> (小於)、<literal>&lt;=</literal> (小於等於)、<literal>=</literal> (等於)、<literal>&gt;=</literal> (大於等於)、<literal>&gt;</literal> (大於)。
        </para>
<screen>sudo zypper install 'firefox&gt;=3.5.3'</screen>
       </listitem>
       <listitem>
        <para>
         也可以同時指定硬體架構與版本：
        </para>
<screen>sudo zypper install 'firefox.x86_64&gt;=3.5.3'</screen>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依 RPM 檔案的路徑</term>
     <listitem>
      <para>
       您也可以指定套件的本地或遠端路徑︰
      </para>
<screen>sudo zypper install /tmp/install/MozillaFirefox.rpm
sudo zypper install http://download.opensuse.org/repositories/mozilla/SLE_12/x86_64/MozillaFirefox-45.0.2-1.1.x86_64.rpm</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="sec.zypper.combineinstall">
   <title>同時安裝並移除套件</title>
   <para>
    若要同時安裝並移除套件，請使用 <literal>+/-</literal> 輔助按鍵。若要安裝 
    <package>emacs</package>
     同時移除 
    <package>vim</package>
    ，請使用：
   </para>
<screen>sudo zypper install emacs -vim</screen>
   <para>
    若要移除
    <package>emacs</package>
    同時安裝
    <package>vim</package>
    ，請使用：
   </para>
<screen>sudo zypper remove emacs +vim</screen>
   <para>
    為了防止將名稱以 <literal>-</literal> 開頭的套件解譯為指令選項，請一律將此類名稱用做第二個引數。如果行不通，則在前面加上 <literal>--</literal>︰
   </para>
<screen>sudo zypper install -emacs +vim       # Wrong
sudo zypper install vim -emacs        # Correct
sudo zypper install -- -emacs +vim    # same as above
sudo zypper remove emacs +vim         # same as above</screen>
  </sect3>
  <sect3 xml:id="sec.zypper.clean">
   <title>清理已移除套件的相依性</title>
   <para>
    如果想讓系統在移除某套件後自動移除由於此操作而導致不再需要的所有套件，請使用 <option>--clean-deps</option> 選項︰
   </para>
<screen>sudo zypper rm <replaceable>PACKAGE_NAME</replaceable> --clean-deps</screen>
  </sect3>
  <sect3 xml:id="sec.zypper.script">
   <title>在程序檔中使用 Zypper</title>
   <para>
    依預設，Zypper 會在安裝或移除所選套件前或出現問題時要求您確認。使用 <option>--non-interactive</option> 選項可覆寫此行為。此選項必須放在實際指令 (<command>install</command>、<command>remove</command> 和 <command>patch</command>) 的前面，如下所示︰
   </para>
<screen>sudo zypper <option>--non-interactive</option> install <replaceable>PACKAGE_NAME</replaceable></screen>
   <para>
    此選項允許在程序檔與 cron 工作中使用 Zypper。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.softman.sources">
   <title>安裝或下載來源套件</title>
   <para>
    若要安裝某套件所對應的來源套件，請使用︰
   </para>
<screen>zypper source-install <replaceable>PACKAGE_NAME</replaceable></screen>
   <para>
    以 <systemitem class="username">root</systemitem> 身分執行時，來源套件的預設安裝位置為 <filename>/usr/src/packages/</filename>；以使用者身分執行時，預設安裝位置為 <filename>~/rpmbuild</filename>。可以在本地 <command>rpm</command> 組態中變更這些值。
   </para>
   <para>
    使用此指令還會安裝指定套件的建構相依性。如果不想如此，請新增參數 <literal>-D</literal>。若想單獨安裝建構相依套件，請使用 <literal>-d</literal>。
   </para>
<screen>sudo zypper source-install -D <replaceable>PACKAGE_NAME</replaceable> # source package only
sudo zypper source-install -d <replaceable>PACKAGE_NAME</replaceable> # build dependencies only</screen>
   <para>
    當然，您必須在儲存庫清單中啟用含來源套件的儲存庫 (預設會新增，但不會啟用)，此指令才有效。如需有關儲存庫管理的詳細資料，請參閱<xref linkend="sec.zypper.instrepo"/>。
   </para>
   <para>
    儲存庫中所有可用來源套件的清單可透過以下指令獲得︰
   </para>
<screen>zypper search -t srcpackage</screen>
   <para>
    您還可以將所有已安裝套件的來源套件下載到本地目錄。若要下載來源套件，請使用：
   </para>
<screen>zypper source-download</screen>
   <para>
    預設下載目錄為 <filename>/var/cache/zypper/source-download</filename>。您可以使用 <option>--directory</option> 選項變更該目錄。若只想顯示遺失或多餘的套件而不進行任何下載或刪除操作，請使用 <option>--status</option> 選項。若要刪除多餘的來源套件，請使用 <option>--delete</option> 選項。若要停用刪除操作，請使用 <option>--no-delete</option> 選項。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.softman.pluscontent">
   <title>從已停用的儲存庫安裝套件</title>
   <para>
    通常，您只能安裝或重新整理來自啟用的儲存庫的套件。<option>--plus-content <replaceable>標記</replaceable></option>選項可協助您指定要重新整理的、要在目前 Zypper 工作階段期間暫時啟用的，以及要在工作階段完成後停用的儲存庫。
   </para>
   <para>
    例如，若要啟用可以提供其他 <filename>-debuginfo</filename> 或 <filename>-debugsource</filename> 套件的儲存庫，請使用 <option>--plus-content debug</option>。可以多次指定此選項。
   </para>
   <para>
    若要暫時啟用此類「除錯」儲存庫以安裝特定的 <filename>-debuginfo</filename> 套件，請依如下所示使用該選項：
   </para>
<screen>sudo zypper --plus-content debug install "debuginfo(build-id)=eb844a5c20c70a59fc693cd1061f851fb7d046f4"</screen>
   <para>
    對於缺失的 debuginfo 套件，<command>gdb</command> 會報告 <literal>build-id</literal> 字串。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.softman.util">
   <title>公用程式</title>
   <para>
    若要驗證是否仍滿足所有相依條件並執行未滿足的相依條件，請使用︰
   </para>
<screen>zypper verify</screen>
   <para>
    除了必須滿足的相依條件之外，一些套件還會<quote>推薦</quote>其他套件。這些推薦的套件只有在確實可用並可安裝時才會進行安裝。如果所推薦的套件在推薦方套件安裝之後 (透過新增其他套件或硬體) 才可用，請使用以下指令︰
   </para>
<screen>sudo zypper install-new-recommends</screen>
   <para>
    此指令在接入網路攝影機或 Wi-Fi 裝置後非常有用。它將安裝裝置的驅動程式及相關軟體 (如果有)。驅動程式及相關軟體只有在符合了某些硬體相依性條件後才可安裝。
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.zypper.softup">
  <title>使用 Zypper 更新軟體</title>
  <para>
   Zypper 有三種方法更新軟體︰安裝修補程式、安裝新版本的套件或更新整個套裝作業系統。最後一種方法可藉由 <command>zypper dist-upgrade</command> 來實現。<phrase role="productname"><phrase os="sled">中介紹了如何升級 </phrase></phrase>SUSE Linux Enterprise Desktop<phrase os="sles;sled"><xref linkend="cha.update.sle"/></phrase>。
  </para>
  <sect3 xml:id="sec.zypper.softup.patch">
   <title>安裝全部所需的修補程式</title>
   <para>
    若要安裝所有正式發佈且適用於您系統的修補程式，請執行︰
   </para>
<screen>sudo zypper patch</screen>
   <para>
    系統會檢查您電腦上設定的，來自儲存庫的所有修補程式是否與您的安裝相關。如果相關 (未分類為<literal>選擇性</literal>或<literal>功能</literal>)，則立即安裝這些修補程式。<phrase os="sles;sled">請注意，正式的更新儲存庫僅在註冊 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 安裝之後才可用。</phrase>
   </para>
   <para>
    如果要安裝的修補程式所包含的變更需要將系統重新開機才能生效，您事先會收到警告。
   </para>
   <para>
    單純使用 <command>zypper patch</command> 指令不會套用來自協力廠商儲存庫的套件。若要同時更新協力廠商儲存庫，請使用 <literal>with-update</literal> 指令選項，如下所示︰
   </para>
<screen>sudo zypper patch --with update</screen>

   <para>
    若要額外安裝選擇性修補程式，請使用：
   </para>
<screen>sudo zypper patch --with-optional</screen>
   <remark>
    The structure here is a bit unfortunate: We explain how to use the
    --cve/--bugzilla options in more detail below ("Listing Patches").
    However, the first bit people get is the very brief intro immediately below.
    Not sure whether to replicate all the information from "Listing Patches"
    here.
    - sknorr, 2016-04-25
   </remark>
   <para>
    若要安裝與特定 Bugzilla 問題相關的所有修補程式，請使用：
   </para>
<screen>sudo zypper patch --bugzilla=<replaceable>NUMBER</replaceable></screen>
   <para>
    若要安裝與特定 CVE 資料庫項目相關的所有修補程式，請使用：
   </para>
<screen>sudo zypper patch --cve=<replaceable>NUMBER</replaceable></screen>
   <para>
    例外，若要安裝 CVE 編號為 <literal>CVE-2010-2713</literal> 的安全性修補程式，請執行︰
   </para>
<screen>sudo zypper patch --cve=CVE-2010-2713</screen>
   <para>
    若您只想安裝影響 Zypper 和套件管理本身的修補程式，請使用：
   </para>
<screen>sudo zypper patch --updatestack-only</screen>
   <para>
    請記住，如果您使用 <literal>updatestack-only</literal> 指令選項，則會丟棄原本還會更新其他儲存庫的其他指令選項。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.softup.listpatch">
   <title>列出修補程式</title>
   <para>
    為了讓您確定修補程式是否可用，Zypper 允許您檢視以下資訊：
   </para>
   <variablelist>
    <varlistentry>
     <term>所需修補程式的數量</term>
     <listitem>
      <para>
       若要列出所需修補程式的數量 (適用於您系統但尚未安裝的修補程式)，請使用 <command>patch-check</command>：
      </para>
<screen>zypper patch-check
Loading repository data...
Reading installed packages...
5 patches needed (1 security patch)</screen>
      <para>
       可以結合 <option>--updatestack-only</option> 選項使用此指令，以便僅列出影響 Zypper 和套件管理本身的修補程式。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>所需修補程式的清單</term>
     <listitem>
      <para>
       若要列出全部所需的修補程式 (適用於您系統但尚未安裝的修補程式)，請使用 <command>list-patches</command>：
      </para>
<screen><?dbsuse-fo font-size="0.70em"?>

<prompt>tux &gt; </prompt>zypper list-patches
Loading repository data...
Reading installed packages...

Repository     | Name        | Version | Category | Status  | Summary
---------------+-------------+---------+----------+---------+---------
SLES12-Updates | SUSE-2014-8 | 1       | security | needed  | openssl: Update for OpenSSL
</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>所有修補程式的清單</term>
     <listitem>
      <para>
       若要列出可用於 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 的所有修補程式，而不論它們是否已安裝或是否適用於您的安裝，請使用 <command>zypper patches</command>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    還會列出與特定問題相關的修補程式並加以安裝。若要列出特定的修補程式，請使用 <command>zypper list-patches</command> 指令及以下選項︰
   </para>
   <variablelist>
    <varlistentry>
     <term>依 Bugzilla 問題</term>
     <listitem>
      <para>
       若要列出與 Bugzilla 問題相關的全部所需修補程式，請使用 <option>--bugzilla</option> 選項。
      </para>
      <para>
       若要列出針對特定錯誤的修補程式，您也可以指定錯誤編號︰<option>--bugzilla=<replaceable>編號</replaceable></option>。若要搜尋與多個 Bugzilla 問題相關的修補程式，請在錯誤號碼之間插入逗號，例如：
      </para>
<screen>zypper list-patches --bugzilla=972197,956917</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>依 CVE 號碼</term>
     <listitem>
      <para>
       若要列出與 CVE (通用弱點與揭露) 資料庫中某個項目相關的全部所需修補程式，請使用 <option>--cve</option> 選項。
      </para>
      <para>
       若要列出針對特定 CVE 資料庫項目的修補程式，您也可以指定 CVE 編號︰<option>--cve=<replaceable>編號</replaceable></option>。若要搜尋與多個 CVE 資料庫項目相關的修補程式，請在 CVE 號碼之間插入逗號，例如：
      </para>
<screen>zypper list-patches --bugzilla=CVE-2016-2315,CVE-2016-2324</screen>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    若要列出所有修補程式而不論是否需要安裝它們，請額外使用 <option>--all</option> 選項。例如，若要列出指定有 CVE 號碼的所有修補程式，請使用：
   </para>
<screen><?dbsuse-fo font-size="0.70em"?>

<prompt>tux &gt; </prompt>zypper list-patches --all --cve
Issue | No.           | Patch             | Category    | Severity  | Status
------+---------------+-------------------+-------------+-----------+----------
cve   | CVE-2015-0287 | SUSE-SLE-Module.. | recommended | moderate  | needed
cve   | CVE-2014-3566 | SUSE-SLE-SERVER.. | recommended | moderate  | not needed
[...]</screen>
  </sect3>
  <sect3 xml:id="sec.zypper.softup.update">
   <title>安裝新的套件版本</title>
   <para>
    如果儲存庫中只含有新套件，但未提供修補程式，則 <command>zypper patch</command> 不起任何作用。若要使用可用的較新版本更新所有安裝的套件 (同時維持系統完整性)，請使用︰
   </para>
<screen>sudo zypper update</screen>
   <para>
    若要更新個別套件，請在更新或安裝指令中指定套件︰
   </para>
<screen>sudo zypper update <replaceable>PACKAGE_NAME</replaceable>
sudo zypper install <replaceable>PACKAGE_NAME</replaceable></screen>
   <para>
    所有可安裝的新套件的清單可透過以下指令獲得︰
   </para>
<screen>zypper list-updates</screen>
   <para>
    請注意，此指令只會列出符合以下準則的套件︰
   </para>
   <itemizedlist>
    <listitem>
     <para>
      與已安裝套件具有相同的廠商，
     </para>
    </listitem>
    <listitem>
     <para>
      提供套件的儲存庫相較於已安裝套件，擁有更高或相同的優先程度，
     </para>
    </listitem>
    <listitem>
     <para>
      可安裝 (符合所有相依性條件)。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    <emphasis>所有</emphasis>新可用套件 (無論是否可安裝) 的清單可透過以下指令獲得︰
   </para>
<screen>sudo zypper list-updates --all</screen>
   <para>
    若要找出新套件無法安裝的原因，請依上文所述使用 <command>zypper install</command> 或 <command>zypper update</command> 指令。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.softup.orphaned">
   <title>識別孤立的套件</title>
   <para>
    每當您從 Zypper 中移除某個儲存庫或者升級系統時，某些套件可能會進入<quote>孤立</quote>狀態。這些<emphasis>孤立的</emphasis>套件不再屬於任何使用中的儲存庫。以下指令可以列出這些套件︰
   </para>
<screen>sudo zypper packages --orphaned</screen>
   <para>
    有了這份清單，您可以確定是否仍然需要某個套件，或者是否可以安全移除某個套件。
   </para>
  </sect3>

 </sect2>

 <sect2 xml:id="sec.zypper.ps">
  <title>識別使用已刪除檔案的程序和服務</title>
  <para>
   在修補、更新或移除套件時，系統上可能有一些執行中的程序仍在使用更新或移除過後已刪除的檔案。執行 <command>zypper ps</command> 可以列出使用已刪除檔案的程序。如果此類程序屬於某個已知的服務，則會列出服務名稱，方便您重新啟動該服務。<command>zypper ps</command> 預設會顯示一個表格：
  </para>
<screen><?dbsuse-fo font-size="0.70em"
?>

<prompt>tux &gt; </prompt>zypper ps
PID   | PPID | UID | User  | Command      | Service      | Files
------+------+-----+-------+--------------+--------------+-------------------
814   | 1    | 481 | avahi | avahi-daemon | avahi-daemon | /lib64/ld-2.19.s-&gt;
      |      |     |       |              |              | /lib64/libdl-2.1-&gt;
      |      |     |       |              |              | /lib64/libpthrea-&gt;
      |      |     |       |              |              | /lib64/libc-2.19-&gt;
[...]</screen>
  <simplelist>
   <member><emphasis role="bold">PID</emphasis>：程序的 ID</member>
   <member><emphasis role="bold"> PPID</emphasis>：父程序的 ID</member>
   <member><emphasis role="bold"> UID</emphasis>：執行程序之使用者的 ID</member>
   <member><emphasis role="bold"> Login</emphasis>：執行程序之使用者的登入名稱</member>
   <member><emphasis role="bold"> Command</emphasis>：用於執行程序的指令</member>
   <member><emphasis role="bold"> Service</emphasis>：服務名稱 (僅當指令與系統服務關聯時才顯示) </member>
   <member><emphasis role="bold"> Files</emphasis>：已刪除的檔案清單</member>
  </simplelist>
  <para>
   可依如下所示控制 <command>zypper ps</command> 的輸出格式：
  </para>
  <variablelist>
   <varlistentry>
    <term><command>zypper ps</command><option>-s</option>
    </term>
    <listitem>
     <para>
      建立一份簡短表格，其中不會顯示已刪除的檔案。
     </para>
<screen><?dbsuse-fo font-size="0.70em"
?>

<prompt>tux &gt; </prompt>zypper ps -s
PID   | PPID | UID  | User    | Command      | Service
------+------+------+---------+--------------+--------------
814   | 1    | 481  | avahi   | avahi-daemon | avahi-daemon
817   | 1    | 0    | root    | irqbalance   | irqbalance
1567  | 1    | 0    | root    | sshd         | sshd
1761  | 1    | 0    | root    | master       | postfix
1764  | 1761 | 51   | postfix | pickup       | postfix
1765  | 1761 | 51   | postfix | qmgr         | postfix
2031  | 2027 | 1000 | tux     | bash         |</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>zypper ps</command><option>-ss</option>
    </term>
    <listitem>
     <para>
      僅顯示與系統服務關聯的程序。
     </para>
<screen>PID   | PPID | UID  | User    | Command      | Service
------+------+------+---------+--------------+--------------
814   | 1    | 481  | avahi   | avahi-daemon | avahi-daemon
817   | 1    | 0    | root    | irqbalance   | irqbalance
1567  | 1    | 0    | root    | sshd         | sshd
1761  | 1    | 0    | root    | master       | postfix
1764  | 1761 | 51   | postfix | pickup       | postfix
1765  | 1761 | 51   | postfix | qmgr         | postfix</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>zypper ps</command><option>-sss</option>
    </term>
    <listitem>
     <para>
      僅顯示使用已刪除檔案的系統服務。
     </para>
<screen>avahi-daemon
irqbalance
postfix
sshd</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><command>zypper ps</command><option>--print "systemctl status %s"</option>
    </term>
    <listitem>
     <para>
      顯示用於取回可能需要重新啟動的服務之狀態的指令。
     </para>
<screen>systemctl status avahi-daemon
systemctl status irqbalance
systemctl status postfix
systemctl status sshd</screen>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   如需服務處理的詳細資訊，請參閱<xref linkend="cha.systemd"/>。
  </para>
 </sect2>





 <sect2 xml:id="sec.zypper.instrepo">
  <title>使用 Zypper 管理儲存庫</title>
  <para>
   Zypper 的所有安裝或修補指令均依賴於一系列已知的儲存庫。若要列出系統可識別的所有儲存庫，請使用指令︰
  </para>
<screen>zypper repos</screen>
  <para>
   結果類似於以下輸出︰
  </para>
  <example xml:id="ex.zypper.repos">
   <title>Zypper — 已知儲存庫的清單</title>
<screen><?dbsuse-fo font-size="0.60em"
?>

<prompt>tux &gt; </prompt>zypper repos
# | Alias        | Name          | Enabled | Refresh
--+--------------+---------------+---------+--------
1 | SLEHA-12-GEO | SLEHA-12-GEO  | Yes     | No
2 | SLEHA-12     | SLEHA-12      | Yes     | No
3 | SLES12       | SLES12        | Yes     | No
  </screen>
  </example>
  <para>
   在各種指令中指定儲存庫時，可以使用 <command>zypper repos</command> 指令輸出的別名、URI 或儲存庫編號。儲存庫別名是儲存庫名稱的縮寫形式，用於儲存庫處理指令。請注意，修改儲存庫清單後，儲存庫的編號可能會發生變更。但別名永遠不會自行變更。
  </para>
  <para>
   依預設，不會顯示儲存庫的詳細資料 (如 URI 或優先程度)。若要列出所有詳細資料，可以使用以下指令︰
  </para>
<screen>zypper repos -d</screen>
  <sect3 xml:id="sec.zypper.instrepo.add">
   <title>新增儲存庫</title>
   <para>
    若要新增儲存庫，請執行
   </para>
<screen>sudo zypper addrepo <replaceable>URI</replaceable> <replaceable>ALIAS</replaceable></screen>
   <para>
    <replaceable>URI</replaceable> 可以是網際網路儲存庫、網路資源、目錄，也可以是 CD 或 DVD (如需詳細資料，請造訪 <link xlink:href="http://en.opensuse.org/openSUSE:Libzypp_URIs"/>)。<replaceable>ALIAS</replaceable> 是儲存庫的唯一縮寫識別碼。您可以隨意選擇，前提是它必須是唯一的。如果指定了已使用的別名，Zypper 會發出警告。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.instrepo.refresh">
   <title>重新整理儲存庫</title>
   <para>
    <command>zypper</command> 可讓您從設定的儲存庫中擷取套件中的變更。若要擷取變更，請執行︰
   </para>
<screen>sudo zypper refresh</screen>
   <note>
    <title><command>zypper</command> 的預設行為</title>
    <para>
     依預設，一些指令會自動執行 <command>refresh</command>，因此您不需要明確執行該指令。
    </para>
   </note>
   <para>
    配合 <literal>--plus-content</literal> 選項使用 <command>refresh</command>，您還可檢視停用儲存庫中的變更︰
   </para>
<screen>sudo zypper --plus-content refresh</screen>
   <para>
    該選項會擷取儲存庫中的變更，但會使停用儲存庫的狀態保持不變，即仍為停用。
   </para>
  </sect3>
  <sect3 xml:id="sec.zypper.instrepo.rm">
   <title>移除儲存庫</title>
   <para>
    若要從清單中移除儲存庫，請使用 <command>zypper removerepo</command> 指令，加上要刪除的儲存庫別名或編號。例如，若要從<xref linkend="ex.zypper.repos"/>中移除儲存庫 <literal>SLEHA-12-GEO</literal>，請使用下列其中一個指令：
   </para>
<screen>sudo zypper removerepo 1
sudo zypper removerepo "SLEHA-12-GEO"</screen>
  </sect3>
  <sect3 xml:id="sec.zypper.instrepo.mofify">
   <title>修改儲存庫</title>
   <para>
    <command>zypper modifyrepo</command> 可以啟用或停用儲存庫。您也可以使用此指令變更儲存庫的內容 (如重新整理行為、名稱或優先程度)。以下指令將啟用名為 <literal>updates</literal> 的儲存庫，開啟自動重新整理功能，並將優先程度設為 20︰
   </para>
<screen>sudo zypper modifyrepo -er -p 20 'updates'</screen>
   <para>
    修改儲存庫並不局限於單個儲存庫，您也可以對群組執行該操作︰
   </para>
   <simplelist>
    <member><option>-a</option>︰所有儲存庫</member>
    <member><option> -l</option>︰本地儲存庫</member>
    <member><option> -t</option>︰遠端儲存庫</member>
    <member><option> -m <replaceable>類型</replaceable></option>︰某種類型的儲存庫 (其中<replaceable>類型</replaceable>可以是以下其中一種︰<literal>http</literal>、<literal>https</literal>、<literal>ftp</literal>、<literal>cd</literal>、<literal>dvd</literal>、<literal>dir</literal>、<literal>file</literal>、<literal>cifs</literal>、<literal>smb</literal>、<literal>nfs</literal>、<literal>hd</literal>、<literal>iso</literal>) </member>
   </simplelist>
   <para>
    若要重新命名儲存庫別名，請使用 <literal>renamerepo</literal> 指令。以下範例會將別名 <literal>Mozilla Firefox</literal> 變更為 <literal>firefox</literal>︰
   </para>
<screen>sudo zypper renamerepo 'Mozilla Firefox' firefox</screen>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.zypper.query">
  <title>使用 Zypper 查詢儲存庫和套件</title>
  <para>
   Zypper 提供多種方法來查詢儲存庫或套件。若要獲得所有可用產品、模式、套件或修補程式的清單，請使用以下指令︰
  </para>
<screen>zypper products
zypper patterns
zypper packages
zypper patches</screen>
  <para>
   若要在所有儲存庫中查詢某些套件，請使用 <literal>search</literal>。若要獲得有關特定套件的資訊，請使用 <literal>info</literal> 指令。
  </para>
  <sect3 xml:id="zypper.search.usage">
   <title><command>zypper search</command> 用法</title>
   <para>
    <command>zypper search</command> 指令可以對套件名稱或 (視情況) 對套件摘要及描述進行搜尋。以 <literal>/</literal> 括住的字串會解譯為正規表示式。依預設，搜尋不區分大小寫。
   </para>
   <variablelist>
    <varlistentry>
     <term>執行簡單搜尋以尋找包含 <literal>fire</literal> 的套件名稱
     </term>
     <listitem>
<screen>zypper search "fire"</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>執行簡單搜尋以尋找確切的套件 <literal>MozillaFirefox</literal>
     </term>
     <listitem>
<screen>zypper search --match-exact "MozillaFirefox"</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>同時在套件描述和摘要中搜尋</term>
     <listitem>
<screen>zypper search -d fire</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>僅顯示尚未安裝的套件</term>
     <listitem>
<screen>zypper search -u fire</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>顯示包含字串 <literal>fir</literal> 且該字串後面不是 <literal>e</literal> 的套件
     </term>
     <listitem>
<screen>zypper se "/fir[^e]/"</screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect3>
  <sect3 xml:id="zypper.what-provides.usage">
   <title><command>zypper what-provides</command> 用法</title>
   <para>
    若要搜尋提供特殊功能的套件，請使用指令 <literal>what-provides</literal>。例如，如果您想瞭解哪個套件提供 Perl 模組 <literal>SVN::Core</literal>，請使用以下指令︰
   </para>
<screen>zypper what-provides 'perl(SVN::Core)'</screen>
   <para>
    <literal>what-provides <replaceable>套件名稱</replaceable></literal>與 <command>rpm -q --whatprovides</command>
    <replaceable>套件名稱</replaceable>類似，不過，RPM 只能查詢 RPM 資料庫 (即所有已安裝套件的資料庫)。另外，Zypper 會告知您任何儲存庫功能的提供者，而不是只有已安裝的儲存庫。
   </para>
  </sect3>
  <sect3 xml:id="zypper.info.usage">
   <title><command>zypper info</command> 用法</title>
   <para>
    若要查詢單個套件，請在 <command>info</command> 指令中使用準確的套件名稱做為引數。它會顯示套件的詳細資訊。如果套件名稱與儲存庫中的所有套件名稱都不相符，該指令會輸出非套件相符項目的詳細資訊。如果您要求特定類型 (透過使用 <literal>-t</literal> 選項)，但該類型不存在，該指令會輸出其他可用的相符項目，但不提供詳細資訊。
   </para>
   <para>
    如果您指定來源套件，該指令會顯示基於該來源套件建立的二進位套件。如果指定二進位套件，該指令會輸出用來建立該二進位套件的來源套件。
   </para>
   <para>
    如果還想顯示套件所需/推薦的項目，請使用選項 <option>--requires</option> 和 <option>--recommends</option>︰
   </para>
<screen>zypper info --requires MozillaFirefox</screen>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.zypper.configure">
  <title>設定 Zypper</title>
  <para>
   Zypper 現隨附一個組態檔案，透過該檔案可永久變更 Zypper 的行為 (整個系統範圍或僅針對特定使用者)。對於系統範圍的變更，請編輯 <filename>/etc/zypp/zypper.conf</filename>。對於特定使用者的變更，請編輯 <filename>~/.zypper.conf</filename>。如果 <filename>~/.zypper.conf</filename> 尚不存在，您可以使用 <filename>/etc/zypp/zypper.conf</filename> 做為樣板︰將其複製到 <filename>~/.zypper.conf</filename> 並根據喜好進行調整。如需有關可用選項的說明，請參閱檔案中的備註。
  </para>
 </sect2>

 <sect2 xml:id="sec.zypper.trouble">
  <title>疑難排解</title>
  <para>
   如果您在存取所設定儲存庫中的套件時遇到問題 (例如，儘管您知道某個套件在某個儲存庫中，但 Zypper 找不到該套件)，則可使用以下指令重新整理儲存庫︰
  </para>
<screen>sudo zypper refresh</screen>
  <para>
   如果不起作用，請嘗試
  </para>
<screen>sudo zypper refresh -fdb</screen>
  <para>
   此指令會強制執行全面的重新整理和資料庫重建，包括強制下載原始中繼資料。
  </para>
 </sect2>

 <sect2 xml:id="sec.zypper.rollback">
  <title>Btrfs 檔案系統上的 Zypper 復原功能</title>
  <para>
   如果根分割區上使用的是 Btrfs 檔案且系統中安裝了 <command>snapper</command>，當 Zypper 提交對檔案系統的變更以建立相應的檔案系統快照時，會自動呼叫 <command>snapper</command> (透過 <command>snapper</command> 所安裝的程序檔)。這些快照可用於回復 Zypper 所做的任何變更。如需相關資訊，請參閱<xref linkend="cha.snapper"/>。
  </para>
 </sect2>

 <sect2 xml:id="sec.zypper.more">
  <title>更多資訊</title>
  <para>
   如需透過指令行管理軟體的詳細資訊，請輸入 <command>zypper help</command>、<command>zypper help </command>
   <replaceable>指令</replaceable>，或參閱 <command>zypper(8)</command> 手冊頁。如需完整詳細的指令參考 (包括有最重要指令的<literal>彙總表</literal>) 以及有關如何在程序檔和應用程式中使用 Zypper 的資訊，請參閱 <link xlink:href="http://en.opensuse.org/SDB:Zypper_usage"/>。最新 <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> 版本的軟體變更清單可在 <link xlink:href="http://en.opensuse.org/openSUSE:Zypper versions"/> 中找到。
  </para>
 </sect2>
</sect1>
