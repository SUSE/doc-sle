<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_upgrading.xml" version="5.0" xml:id="cha.update.sle">
 <title>Upgrade di SUSE Linux Enterprise</title>
 <info>
  <abstract>
   <para>
    SUSE® Linux Enterprise (SLE) consente di aggiornare un sistema esistente alla nuova versione, ad esempio per passare da SLE 11 SP4 a SLE 12. Non è necessaria una nuova installazione. I dati esistenti, quali home directory, directory dei dati e configurazione di sistema, restano invariati. È possibile eseguire l'aggiornamento da un'unità CD o DVD locale o da un'origine dell'installazione di rete centrale.
   </para>

   <para>
    In questo capitolo viene illustrato come eseguire l'upgrade manuale del sistema SUSE Linux Enterprise mediante DVD, la rete, un processo automatico o SUSE Manager.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>sì</dm:translation>
  </dm:docmanager>
 </info>
 <sect1 xml:id="sec.update.prep">
  <title>Preparazione generale</title>

  <para>
   Prima di iniziare la procedura di aggiornamento, assicurarsi che il sistema sia preparato correttamente. Tra le varie operazioni, la preparazione prevede il backup dei dati e il controllo delle note di rilascio.
  </para>

  <sect2 xml:id="sec.update.prep.multiversion">
   <title>Disabilitare temporaneamente il supporto di più versioni del kernel</title>
   <para>
    <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> consente di installare più versioni del kernel, abilitando le impostazioni corrispondenti in <filename>/etc/zypp/zypp.conf</filename>. Per aggiornare un Service Pack, il supporto di tale funzione deve essere temporaneamente disabilitato e può essere nuovamente abilitato al termine dell'aggiornamento. Per disabilitare il supporto di più versioni, trasformare in commento le righe corrispondenti in <filename>/etc/zypp/zypp.conf</filename>. Il risultato deve essere simile al seguente:
   </para>
<screen>#multiversion = provides:multiversion(kernel)
#multiversion.kernels = latest,running</screen>
   <para>
    Per riattivare la funzione al termine dell'aggiornamento, rimuovere i segni di commento. Per ulteriori informazioni sul supporto di più versioni, vedere <xref linkend="cha.tuning.multikernel.enable"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec.update.prep.relnotes">
   <title>Controllo delle note di rilascio</title>
   <para>
    Nelle note di rilascio è possibile trovare informazioni aggiuntive sulle modifiche apportate rispetto alla release precedente di SUSE Linux Enterprise. Verificare se l'hardware o la configurazione in uso richiede considerazioni specifiche, quali sono i pacchetti software preferiti che hanno subito modifiche significative e quali precauzioni è opportuno adottare, oltre ai consigli generali indicati in questa sezione. Le note di rilascio contengono inoltre informazioni dell'ultimo minuto e problemi noti che non si è fatto in tempo a riportare nel manuale.
   </para>
   <para>
    La versione attuale delle note di rilascio contenenti le informazioni più recenti su <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sono disponibili online alla pagina <link xlink:href="http://www.suse.com/documentation/"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec.update.prep.backup">
   <title>Esecuzione del backup</title>
   <para>
    Prima di eseguire l'aggiornamento, copiare i file di configurazione esistenti su un supporto separato (ad esempio un dispositivo a nastro, un disco rigido rimovibile e così via) per eseguire il backup dei dati. Questo vale soprattutto per i file memorizzati in <filename>/etc</filename> e per alcuni file e directory in <filename>/var</filename> e <filename>/opt</filename>. Può anche essere opportuno salvare i dati dell'utente contenuti <filename>/home</filename> (ovvero le directory <envar>HOME</envar>) su un supporto di backup. Eseguire il backup di questi dati come <systemitem class="username">root</systemitem>. Infatti solo gli utenti <systemitem class="username">root</systemitem> dispongono delle autorizzazioni di lettura per tutti i file locali.
   </para>
   <para>
    Se in YaST si è selezionata la modalità di installazione <guimenu>Aggiornamento di un sistema esistente</guimenu>, è possibile scegliere di eseguire un backup (del sistema) in un momento successivo. È possibile includere tutti i file modificati e i file della directory <filename>/etc/sysconfig</filename>. Si tratta tuttavia di un backup parziale in quanto mancano tutte le altre directory importanti indicate sopra. Trovare il backup nella directory <filename>/var/adm/backup</filename>.
   </para>
  </sect2>

  <sect2 xml:id="sec.update.prep.mariadb">
   <title>Migrazione del database MySQL</title>
   <remark>toms 2015-09-03: already reviewed by Ondrej and Kristýna.</remark>
   <para>
    A partire da SUSE Linux Enterprise 12, SUSE è passato da MySQL a MariaDB. Prima di iniziare un upgrade, si consiglia vivamente di eseguire il backup del database.
   </para>

   <para>
    Per eseguire la migrazione del database, procedere come segue:
   </para>
   <procedure>
    <step>
     <para>
      Eseguire il login al computer con SUSE Linux Enterprise 11.
     </para>
    </step>
    <step>
     <para>
      Creare un file di dump:
     </para>
<screen><prompt>root # </prompt><command>mysqldump</command> -u root -p --all-databases &gt; mysql_backup.sql</screen>
     <para>
      Per default, <command>mysqldump</command> non effettua il dump del database <literal>INFORMATION_SCHEMA</literal> o <literal>performance_schema</literal>. Per ulteriori informazioni, fare riferimento a <link xlink:href="https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html"/>.
     </para>
    </step>
    <step>
     <para>
      Memorizzare in un luogo sicuro il file di dump, il file di configurazione <filename>/etc/my.cnf</filename> e la directory <filename>/etc/mysql/</filename> per analizzarli in seguito (<emphasis>NON</emphasis> per l'installazione!).
     </para>
    </step>
    <step>
     <para>
      Eseguire l'upgrade. Dopo l'upgrade, il file di configurazione precedente <filename>/etc/my.cnf</filename> resta inalterato. È possibile trovare la nuova configurazione nel file <filename>/etc/my.cnf.rpmnew</filename>.
     </para>
    </step>
    <step>
     <para>
      Configurare il database MariaDB in base alle proprie esigenze. <emphasis>NON</emphasis> utilizzare il file di configurazione e la directory precedenti se non come promemoria da adeguare alla situazione specifica.
     </para>
    </step>
    <step>
     <para>
      Avviare il server MariaDB:
     </para>
<screen><prompt>root # </prompt><command>systemctl</command> start mysql</screen>
     <para>
      Se si desidera avviare il server MariaDB a ogni avvio, attivare il servizio:
     </para>
<screen><prompt>root # </prompt><command>systemctl</command> enable mysql</screen>

    </step>
    <step>
     <para>
      Verificare che MariaDB sia in esecuzione connettendolo al database:
     </para>
<screen><prompt>root # </prompt><command>mysql</command> -u root -p</screen>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.update.prep.postgresql">
   <title>Migrazione del database PostgreSQL</title>
   <remark>toms 2015-09-09: FATE#319049</remark>
   <remark>Already reviewd by Reinhard</remark>
   <para>
    Per SLE11 SP3 e SLE12 GA è prevista una versione più recente del database PostgreSQL come aggiornamento di manutenzione. A causa del lavoro richiesto per la migrazione del database, non è disponibile alcun processo di upgrade automatico. Il passaggio da una versione all'altra deve essere pertanto effettuato manualmente.
   </para>
   <para>
    Il processo di migrazione viene eseguito mediante il comando <command>pg_upgrade</command>, un metodo alternativo al classico dump e ricaricamento. Rispetto al metodo <quote>dump e ricaricamento</quote>, <command>pg_upgrade</command>, rende più rapida la migrazione.
   </para>
   <para>
    Ogni versione di PostgreSQL memorizza i file in directory specifiche della versione. Dopo l'aggiornamento, le directory cambiano in:
   </para>
   <variablelist>
    <varlistentry>
     <term>SLE11 SP3/SP4</term>
     <listitem>
      <para>
       Da <filename>/usr/lib/postgresql91/</filename> a <filename>/usr/lib/postgresql94/</filename>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>SLE12 GA</term>
     <listitem>
      <para>
       Da <filename>/usr/lib/postgresql93/</filename> a <filename>/usr/lib/postgresql94/</filename>
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Per eseguire la migrazione del database, procedere come segue:
   </para>
   <procedure>
    <step>
     <para>
      Verificare che siano soddisfatte le seguenti condizioni preliminari:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        Eseguire l'upgrade di tutti i pacchetti della versione precedente di PostgreSQL all'ultima release mediante un aggiornamento di manutenzione.
       </para>
      </listitem>
      <listitem>
       <para>
        Creare una copia di backup del database esistente.
       </para>
      </listitem>
      <listitem>
       <para>
        Installare i pacchetti della nuova versione principale di PostgreSQL. Per SLE12 questo prevede l'installazione di
        <package>postgresql94-server</package>
        e di tutti i pacchetti da cui dipende.
       </para>
      </listitem>
      <listitem>
       <para>
        Installare il pacchetto
        <package>postgresql94-contrib</package>
        contenente il comando <command>pg_upgrade</command>.
       </para>
      </listitem>
      <listitem>
       <para>
        Verificare che sia disponibile spazio sufficiente nell'area dati di PostgreSQL, che per default è <filename>/var/lib/pgsql/data</filename>. Se lo spazio è limitato, provare a ridurre le dimensioni con il comando SQL seguente su ciascun database. Questa operazione può richiedere molto tempo:
       </para>
<screen>VACUUM FULL</screen>
      </listitem>
     </itemizedlist>
    </step>
    <step>
     <para>
      Arrestare il server PostgreSQL:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> stop</screen>
    </step>
    <step>
     <para>
      Ridenominare la directory dei dati precedente:
     </para>
<screen><prompt>root # </prompt><command>mv</command> /var/lib/pgsql/data /var/lib/pgsql/data.old</screen>
    </step>
    <step>
     <para>
      Creare una nuova directory dei dati:
     </para>
<screen><prompt>root # </prompt><command>mkdir</command> -p /var/lib/pgsql/data</screen>
    </step>
    <step>
     <para>
      Se i file di configurazione sono stati modificati nella versione precedente, copiare i file <filename>postgresql.conf</filename> <filename>pg_hba.conf</filename> nella nuova directory <filename>data</filename>:
     </para>
<screen><prompt>root # </prompt><command>cp</command> /var/lib/pgsql/data.old/*.conf \
     /var/lib/pgsql/data</screen>
    </step>
    <step>
     <para>
      Inizializzare la nuova istanza di database manualmente con il comando <command>initdb</command> o in modo automatico avviando e arrestando il server PostgreSQL:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> start
<prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> stop</screen>
    </step>
    <step>
     <para>
      Avviare il processo di migrazione e sostituire il segnaposto <replaceable>OLD</replaceable> con la versione precedente:
     </para>
<screen><prompt>root # </prompt><command>pg_upgrade</command> \
   --old-datadir "/var/lib/pgsql/data.old" \
   --new-datadir "/var/lib/pgsql/data" \
   --old-bindir "/usr/lib/postgresql<replaceable>OLD</replaceable>/bin/" \
   --new-bindir "/usr/lib/postgresql94/bin/"</screen>
    </step>
    <step>
     <para>
      Avviare la nuova istanza di database:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> start</screen>
    </step>
    <step>
     <para>
      Controllare che la migrazione sia stata eseguita correttamente. Non esiste uno strumento generico che possa automatizzare questo passaggio. Lo strumento da utilizzare dipende dal caso d'uso, dal tipo e dalla quantità di funzioni che si intende testare.
     </para>
    </step>
    <step>
     <para>
      Rimuovere tutti i pacchetti di PostgreSQL e la directory dei dati precedenti:
     </para>
<screen><prompt>root # </prompt><command>zypper</command> search -s postgresql<replaceable>OLD</replaceable> | xargs zypper rm -u
<prompt>root # </prompt><command>rm</command> -rf /var/lib/pgsql/data.old</screen>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.update.prep.ssl">
   <title>Creare certificati server non MD5 per applicazioni Java</title>
   <remark>toms 2016-07-27: from bsc#970153, c#24</remark>
   <para>
    Durante l'aggiornamento da SP1 a SP2, i certificati basati su MD5 sono stati disabilitati all'interno di una correzione di sicurezza. Se sono presenti certificati creati come MD5, ricrearli seguendo la procedura indicata:
   </para>
   
   <procedure>
    <step>
     <para>
      Aprire un terminale ed eseguire il login come <systemitem class="username">root</systemitem>.
     </para>
    </step>
    <step>
     <para>
      Creare una chiave privata:
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> genrsa -out server.key 1024</screen>
     <para>
      Se si desidera una chiave più forte, scambiare <literal>1024</literal> con un numero più alto, ad esempio, <literal>4096</literal>.
     </para>
    </step>
    <step>
     <para>
      Creare una richiesta di firma del certificato (CSR):
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> req -new -key server.key -out server.csr</screen>
    </step>
    <step>
     <para>
      Firmare il certificato:
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</screen>
    </step>
    <step>
     <para>
      Creare il file PEM:
     </para>
     <screen><prompt>root # </prompt><command>cat</command> server.key server.crt &gt; server.pem</screen>
    </step>
    <step>
     <para>Spostare i file <filename>server.crt</filename>, <filename>server.csr</filename>, <filename>server.key</filename> e <filename>server.pem</filename> nelle directory rispettive dove si trovano le chiavi. Per Tomcat, ad esempio, la directory è <filename>/etc/tomcat/ssl/</filename>.
     </para>
    </step>
   </procedure>
  </sect2>
  
  <sect2 xml:id="sec.update.prep.vms">
   <title>Chiusura dei guest delle macchine virtuali</title>
   <para>
    Se il computer funge da server host per macchine virtuali per KVM o Xen, assicurarsi di spegnere correttamente tutti i guest delle macchine virtuali prima dell'aggiornamento. altrimenti l'accesso ai guest dopo l'aggiornamento potrebbe risultare impossibile.
   </para>
  </sect2>

  <sect2 xml:id="sec.update.prep.smt">
   <title>Verifica dello script <command>clientSetup4SMT.sh</command> sui client SMT</title>
   <para>
    Se si migra il SO registrato a fronte di un server SMT, è necessario verificare che la versione dello script <command>clientSetup4SMT.sh</command> sull'host sia aggiornata. <command>clientSetup4SMT.sh</command> dalle versioni precedenti di SMT non è in grado di gestire i client SMT 12. Se si applicano regolarmente patch software sul server SMT, è sempre possibile trovare la versione più recente di <command>clientSetup4SMT.sh</command> in <filename>&lt;SMT_HOSTNAME&gt;/repo/tools/clientSetup4SMT.sh</filename>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.update.disk">
  <title>Spazio su disco</title>

  <para>
   I programmi tendono a <quote>crescere</quote> da una versione all'altra. Quindi, prima di effettuare un aggiornamento, controllare lo spazio disponibile nella partizione. Se si teme di esaurire lo spazio, proteggere i dati prima di incrementare lo spazio disponibile, ad esempio ridimensionando le partizioni. Non esiste una regola generale in merito allo spazio che deve essere disponibile in ogni partizione. I requisiti di spazio dipendono dal particolare profilo di partizionamento e dal software selezionato.
  </para>

  <note>
   <title>Verifica automatica della disponibilità di spazio sufficiente in YaST</title>
   <para>
    Durante la procedura di aggiornamento YaST controlla lo spazio disponibile su disco e visualizza un avviso se l'installazione potrebbe superare tale valore. In questo caso, l'aggiornamento potrebbe <emphasis>rendere inutilizzabile il sistema</emphasis>. È possibile ignorare l'avviso e continuare con l'aggiornamento solo se si sa esattamente cosa si sta facendo (sulla base dei test eseguiti in precedenza).
   </para>
  </note>

  <sect2 xml:id="sec.update.disk.space">
   <title>Verifica dello spazio su disco nei file system diversi da Btrfs</title>
   <para>
    Per visualizzare lo spazio disponibile su disco, utilizzare il comando <command>df</command>. Ad esempio, in <xref linkend="aus.update.df"/>, la partizione radice è <filename>/dev/sda3</filename> (montata come <filename>/</filename>).
   </para>
   <example xml:id="aus.update.df">
    <title>Visualizzare l'elenco con il comando <command>df -h</command></title>

<screen os="sles">Filesystem     Size  Used Avail Use% Mounted on
/dev/sda3       74G   22G   53G  29% /
tmpfs          506M     0  506M   0% /dev/shm
/dev/sda5      116G  5.8G  111G   5% /home
/dev/sda1       44G    4G   40G   9% /data</screen>
   </example>
  </sect2>

  <sect2 xml:id="sec.update.disk.btrfs-on-root">
   <title>Verifica dello spazio su disco nei file system Btrfs</title>
   <para>
    Se si utilizza Btrfs come file system radice nel computer in uso, assicurarsi di disporre di spazio sufficiente. È possibile ottenere spazio su disco con i due comandi seguenti:
   </para>
<screen><prompt>root # </prompt><command>btrfs</command> filesystem df /
<prompt>root # </prompt><command>df</command> /</screen>
   <para>
    I risultati dei due comandi mostrano valori simili per la quantità di spazio su disco utilizzato. Tuttavia il problema con Btrfs e lo spazio disponibile è che non è noto a cosa fa riferimento uno snapshot e non è possibile calcolare quanto spazio su disco richiede una modifica.
   </para>
   <para>
    Nel caso peggiore, per un upgrade è necessaria la stessa quantità di spazio su disco del file system radice corrente (senza <filename>/.snapshot</filename>). Oltre che nei file system Btrfs, verificare che ci sia spazio disponibile anche in altri file system. Di seguito sono riportate indicazioni la cui validità è dimostrata:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Per tutti i file system, incluso Btrfs, è necessario spazio su disco sufficiente a effettuare il download e installare RPM di grandi dimensioni. Lo spazio degli RPM precedenti viene liberato solo dopo l'installazione di nuovi RPM.
     </para>
    </listitem>
    <listitem>
     <para>
      Per il file system Btrfs con snapshot, è necessaria almeno la stessa quantità di spazio su disco richiesta per l'installazione corrente. È consigliabile avere a disposizione il doppio dello spazio occupato dall'installazione corrente.
     </para>
     <para>
      Se lo spazio disponibile non è sufficiente, provare a eliminare gli snapshot precedenti con il comando <command>snapper</command>, come indicato di seguito:
     </para>
<screen><prompt>root # </prompt><command>snapper</command> list
<prompt>root # </prompt><command>snapper</command> delete NUMBER</screen>
     <para>
      Questa soluzione tuttavia potrebbe non funzionare in tutti i casi. Prima della migrazione, la maggior parte degli snapshot occupa una quantità ridotta di spazio.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.update.proc.prep.paths">
  <title>Percorsi di upgrade supportati per SLE</title>

  <important>
   <title>Gli upgrade tra architetture non sono supportati</title>
   <para>
    Gli upgrade tra architetture, come l'upgrade da una versione a 32 bit di <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> a una versione a 64 bit, oppure l'upgrade da un big endian a un little endian <emphasis>non</emphasis> sono supportati.
   </para>
   <para>
    Nello specifico, <emphasis>non</emphasis> è supportato l'upgrade da SLE 11 su POWER (big endian) a SLE 12 SP1 su POWER (nuovo: little endian).
   </para>
   <para>
    Inoltre, poiché SUSE Linux Enterprise 12 è disponibile solo nella versione a 64 bit, gli upgrade da qualsiasi sistema SUSE Linux Enterprise 11 a 32 bit a SUSE Linux Enterprise 12 e versioni successive <emphasis>non</emphasis> sono supportati.
   </para>
  </important>

  <para>
   Prima di eseguire la migrazione, leggere la <xref linkend="sec.update.prep"/>.
  </para>

  <variablelist>
   <varlistentry>
    <term>Upgrade da SUSE Linux Enterprise 10 (qualsiasi Service Pack)</term>
    <listitem>
     <para>
      Non esistono percorsi di migrazione diretta a SUSE Linux Enterprise 12 supportati. Si consiglia invece di optare per una nuova installazione.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upgrade da SUSE Linux Enterprise 11 GA, SP1 o SP2</term>
    <listitem>
     <para>
      Non esistono percorsi di migrazione diretta a SUSE Linux Enterprise 12 supportati. Per poter passare a SLE 12, è necessario almeno SLE 11 SP3.
     </para>
     <para>
      Se non è possibile procedere con una nuova installazione, è necessario prima effettuare l'aggiornamento da SLE 11 GA a SP1, quindi da SLE 11 SP1 a SP2, infine da SLE 11 SP2 a SP3. Questi passaggi sono descritti nella <link xlink:href="https://www.suse.com/documentation/sles11/">SUSE Linux Enterprise 11 Deployment Guide</link> (in lingua inglese) 
     </para>
     <para>
      Quindi procedere con la <xref linkend="sec.update.sle12"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upgrade da SUSE Linux Enterprise 11 SP3 o SP4</term>
    <listitem>
     <para>
      Per ulteriori dettagli, vedere <xref linkend="sec.update.sle12"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upgrade da SUSE Linux Enterprise 12 a SP1</term>
    <listitem>
     <para>
      Per ulteriori dettagli, vedere <xref linkend="cha.update.spmigration"/>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="sec.update.sle12">
  <title>Metodi supportati per l'upgrade di SUSE Linux Enterprise</title>

  <remark>toms 2014-02-11: See FATEs #315969 and #313189</remark>

  <para>
   L'upgrade da SUSE Linux Enterprise 11 SP3 a SUSE Linux Enterprise 12, da SUSE Linux Enterprise 11 SP3 a SUSE Linux Enterprise 12 SP1 o da SUSE Linux Enterprise 11 SP4 a SUSE Linux Enterprise 12 SP1 è supportato grazie all'uso di uno dei metodi seguenti:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <xref linkend="sec.update.sle12.manual" xrefstyle="HeadingOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec.update.sle12.automated" xrefstyle="HeadingOnPage"/>
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sec.update.sle12.manual">
  <title>Upgrade manuale da SLE 11 SP3 a SLE 12 SP1 mediante un'origine di installazione</title>

  <para>
   Prima di eseguire l'upgrade del sistema, leggere la <xref linkend="sec.update.prep"/>.
  </para>

  <para>
   Per eseguire l'upgrade del sistema in questo modo, è necessario eseguire l'avvio da un'origine di installazione, come si farebbe per una nuova installazione. Tuttavia quando viene visualizzata la schermata di avvio, è necessario selezionare <guimenu>Esegui l'upgrade</guimenu> (anziché <guimenu>Installazione</guimenu>). L'origine di installazione da cui eseguire l'avvio può essere una di quelle riportate di seguito:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Un supporto di installazione locale, ad esempio un DVD o un'immagine ISO in un dispositivo di memorizzazione di massa USB. Per istruzioni dettagliate, vedere la <xref linkend="sec.update.sle12.manual.dvd"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Un'origine di installazione di rete. È possibile eseguire l'avvio dal supporto locale, quindi selezionare il rispettivo tipo di installazione di rete, oppure è possibile eseguire l'avvio via PXE. Per istruzioni dettagliate, vedere la <xref linkend="sec.update.sle12.manual.network"/>.
    </para>
   </listitem>
  </itemizedlist>

  <sect2 xml:id="sec.update.sle12.manual.dvd">
   <title>Upgrade da un supporto di installazione</title>
   <para>
    La procedura riportata di seguito descrive l'esempio di avvio da un DVD, ma è possibile utilizzare anche un altro supporto di installazione locale come un'immagine ISO in un dispositivo di memorizzazione di massa USB. Il modo in cui si seleziona il metodo di avvio e si avvia il sistema dal supporto dipende dall'architettura di sistema e dalla presenza nel computer di un BIOS tradizionale o di uno UEFI. Per informazioni dettagliate, vedere i collegamenti di seguito.
   </para>
   <procedure xml:id="pro.update.sle12.manual.dvd">
    <title>Upgrade manuale da SLE 11 SP3 a SLE 12 SP1 mediante un DVD</title>
    <step>
     <para>
      Inserire il DVD 1 del supporto di installazione di SUSE Linux Enterprise 12 SP1 e avviare il computer. Viene visualizzata la schermata <guimenu>Benvenuti</guimenu>, seguita dalla schermata di avvio.
     </para>
    </step>
    <step>
     <para>
      Selezionare il metodo di avvio corrispondente per avviare il sistema dal supporto (vedere la <xref linkend="sec.i.yast2.method"/>).
     </para>
    </step>
    <step>
     <para>
      Avviare il sistema dal supporto (vedere la <xref linkend="sec.i.yast2.startup"/>).
     </para>
    </step>
    <step>
     <para>
      Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec.update.sle12.manual.network">
   <title>Upgrade da un'origine di installazione di rete</title>
   <para>
    Se si desidera avviare un upgrade da un'origine di installazione di rete, verificare che siano soddisfatti i seguenti requisiti:
   </para>
   <variablelist>
    <title>Requisiti per l'upgrade da un'origine di installazione di rete</title>
    <varlistentry>
     <term>Origine di installazione di rete</term>
     <listitem>
      <para>
       L'impostazione dell'origine dell'installazione di rete è configurata in base alla <xref linkend="cha.deployment.instserver"/>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Connessione e servizi di rete</term>
     <listitem>
      <para>
       Sia il server di installazione che il computer di destinazione sono dotati di una connessione di rete funzionante. La rete deve fornire i seguenti servizi: un servizio dei nomi, DHCP (facoltativo ma necessario per l'avvio via PXE) e OpenSLP (facoltativo).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Installazione</term>
     <listitem>
      <para>
       Tenere a portata di mano un DVD 1 di SUSE Linux Enterprise (o un'immagine ISO locale) per avviare il sistema di destinazione <emphasis>o</emphasis> un sistema di destinazione configurato per l'avvio via PXE in base alla <xref linkend="sec.deployment.prep_boot.pxeprep" xrefstyle="HeadingOnPage"/>. Per informazioni più approfondite sull'avvio dell'upgrade da un server remoto, fare riferimento al <xref linkend="cha.deployment.remoteinst"/>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Quando si effettua l'upgrade dall'origine di installazione di rete, è possibile eseguire l'avvio dal supporto locale, quindi selezionare il rispettivo tipo di installazione di rete, oppure è possibile eseguire l'avvio via PXE. Selezionare il metodo e procedere come descritto nella <xref linkend="pro.update.sle12.manual.network.boot-from-dvd" xrefstyle="select:label"/> o nella <xref linkend="pro.update.sle12.manual.network.pxe-boot" xrefstyle="select:label"/>.
   </para>
   <procedure xml:id="pro.update.sle12.manual.network.boot-from-dvd">
    <title>Upgrade manuale da SLE 11 SP3 o SP4 a SLE 12 SP1 tramite origine di installazione di rete - avvio da DVD</title>
    <para>
     Questa procedura descrive l'esempio di avvio da un DVD, ma è possibile utilizzare anche un altro supporto di installazione locale come un'immagine ISO in un dispositivo di memorizzazione di massa USB. Il modo in cui si seleziona il metodo di avvio e si avvia il sistema dal supporto dipende dall'architettura di sistema e dalla presenza nel computer di un BIOS tradizionale o di uno UEFI. Per informazioni dettagliate, vedere i collegamenti di seguito.
    </para>
    <step>
     <para>
      Inserire il DVD 1 del supporto di installazione di SUSE Linux Enterprise 12 SP1 e avviare il computer. Viene visualizzata la schermata <guimenu>Benvenuti</guimenu>, seguita dalla schermata di avvio.
     </para>
    </step>
    <step>
     <para>
      Selezionare il tipo di origine di installazione di rete che si desidera utilizzare (FTP, HTTP, NFS, SMB o SLP). Generalmente è possibile effettuare questa scelta premendo <keycap>F4</keycap> ma, se il computer è dotato di UEFI anziché di un BIOS tradizionale, potrebbe essere necessario modificare i parametri di avvio manualmente. Per informazioni dettagliate, vedere <xref linkend="sec.i.yast2.source.net"/> nel <xref linkend="cha.inst"/>.
     </para>
    </step>
    <step>
     <para>
      Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
     </para>
    </step>
   </procedure>
   <procedure xml:id="pro.update.sle12.manual.network.pxe-boot">
    <title>Upgrade manuale da SLE 11 SP3 o SP4 a SLE 12 SP1 tramite origine di installazione di rete - avvio via PXE</title>
    <para>
     Per effettuare un upgrade da un'origine di installazione di rete utilizzando Avvio PXE, procedere come descritto di seguito:
    </para>
    <step>
     <para>
      Modificare la configurazione del server DHCP per fornire le informazioni sull'indirizzo necessarie per l'avvio via PXE. Per informazioni, vedere la <xref linkend="sec.deployment.prep_boot.pxeprep"/>.
     </para>
    </step>
    <step>
     <para>
      Impostare il server TFTP in modo che conservi l'immagine di avvio necessaria per l'avvio via PXE. Utilizzare il DVD 1 del supporto di installazione di SUSE Linux Enterprise 12 SP1 o seguire le istruzioni riportate nella <xref linkend="sec.deployment.prep_boot.tftp"/>.
     </para>
    </step>
    <step>
     <para>
      Preparare l'avvio PXE e Wake-on-LAN nel computer di destinazione.
     </para>
    </step>
    <step>
     <para>
      Iniziare l'avvio del sistema di destinazione e utilizzare VNC per la connessione remota alla routine di installazione in esecuzione sul computer. Per ulteriori informazioni, vedere la <xref linkend="sec.deployment.remoteinst.monitor.vnc"/>.
     </para>
    </step>
    <step>
     <para>
      Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="sec.update.sle12.automated">
  <title>Migrazione automatica da SLE 11 SP3 o SP4 a SLE 12 SP1</title>

  <para>
   Prima di eseguire l'upgrade del sistema, leggere la <xref linkend="sec.update.prep"/>. Per eseguire una migrazione automatica, procedere come indicato di seguito:
  </para>

  <procedure xml:id="pro.update.sle12.automated">
   <title>Migrazione automatica da SUSE Linux Enterprise 11 SP3 a SUSE Linux Enterprise 12 SP1</title>
   <remark>toms 2014-03-19: See FATE#315037</remark>
   <remark role="future">toms 2014-03-20: From SLE12 SP1 on, we should probably base
    this example on GRUB2, but not for GA.</remark>
   <remark>jsrain 2015-09-02: This is still the old system; at some point
       of time we should switch to GRUB2, but as long as amjority of
       customers still runs SLE11, I would stay with legacy GRUB. Anyway, we
       could include both op6tions, that would be probably best solution</remark>
   <step>
    <para>
     Copiare il kernel di installazione <filename>linux</filename> e il file <filename>initrd</filename> dalla directory <filename>/boot/x86_64/loader/</filename> del primo DVD di installazione nella directory <filename>/boot</filename> del sistema:
    </para>
<screen><command>cp</command> -vi <replaceable>DVDROOT</replaceable>/boot/x86_64/loader/linux /boot/linux.upgrade
<command>cp</command> -vi <replaceable>DVDROOT</replaceable>/boot/x86_64/loader/initrd /boot/initrd.upgrade</screen>
    <para>
     <replaceable>DVDROOT</replaceable> indica il percorso in cui il DVD viene montato dal sistema DVD, di norma è <filename>/run/media/$USER/$DVDNAME</filename>.
    </para>
   </step>
   <step>
    <para>
     Aprire il file di configurazione GRUB esistente <filename>/boot/grub/menu.lst</filename> e aggiungere un'altra sezione. Per altri boot loader, modificare i rispettivi file di configurazione. Modificare i nomi dei dispositivi e il parametro <parameter>root</parameter> in modo appropriato Ad esempio:
    </para>
<screen>title Linux Upgrade Kernel
kernel (hd0,0)/boot/linux.upgrade root=/dev/sda1 upgrade=1 <replaceable>OPTIONAL_PARAMETERS</replaceable>
initrd (hd0,0)/boot/initrd.upgrade</screen>
    <para>
     <replaceable>OPTIONAL_PARAMETERS</replaceable> indicano i parametri di avvio aggiuntivi che potrebbero essere necessari per avviare il sistema ed eseguire l'upgrade. Potrebbe trattarsi di parametri del kernel necessari al sistema. Verificare se è necessario rivedere e copiare tali parametri da una voce GRUB esistente. Potrebbe trattarsi anche di parametri SUSE <link xlink:href="http://en.opensuse.org/Linuxrc">linuxrc, documentati online</link>.
    </para>
   </step>
   <step>
    <para>

     Se è necessario eseguire l'upgrade automatico, aggiungere <option>autoupgrade=1</option> alla fine della riga <literal>kernel</literal> nella configurazione di GRUB.
    </para>
   </step>
   <step>
    <para>
     Riavviare il computer e selezionare la sezione appena aggiunta dal menu di avvio (qui: <emphasis>Upgrade kernel di Linux</emphasis>). È possibile utilizzare il comando <command>grubonce</command> per preselezionare la voce GRUB appena creata per un riavvio automatico nella voce appena creata. È inoltre possibile utilizzare <command>reboot</command> per iniziare il riavvio dalla riga di comando.
    </para>
   </step>
   <step>
    <para>
     Continuare con il regolare processo di upgrade, come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
    </para>
   </step>
   <step>
    <para>
     Una volta completato il processo di upgrade, rimuovere i file del kernel di installazione e initrd (<filename>/boot/linux.upgrade</filename> e <filename>/boot/initrd.upgrade</filename>). Non sono più necessari.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec.update.sle12.start.upgr.after.boot">
  <title>Avvio del processo di upgrade dopo l'avvio</title>

  <para>
   <remark>taroth 2014-11-13: argh, the following is terminology hell regarding
     the software strings: "upgrade"/"update" are used intermittently and
     without clear differentiation...</remark>
  </para>

  <procedure>
   <step>
    <para>
     Dopo avere avviato (da un supporto di installazione o dalla rete), selezionare la voce <guimenu>Upgrade</guimenu> nella schermata di avvio.
    </para>
    <warning>
     <title>Una scelta sbagliata può comportare una perdita di dati</title>
     <para>
      Se si seleziona <guimenu>Installazione</guimenu> anziché <guimenu>Upgrade</guimenu>, successivamente i dati potrebbero andare persi. È necessario prestare particolare attenzione a non eliminare le partizioni dati durante una nuova installazione. Effettuando il ripartizionamento dei dischi si rischia ad esempio di distruggere le partizioni esistenti, mentre riformattando le partizioni dati si cancellano tutti i dati contenuti.
     </para>
     <para>
      Selezionare <guimenu>Upgrade</guimenu> in questa fase.
     </para>
    </warning>
    <para>
     YaST avvia il sistema di installazione.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Benvenuti</guimenu> scegliere <guimenu>Lingua</guimenu> e <guimenu>Tastiera</guimenu> e accettare il contratto di licenza. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
    <para>
     YaST controlla le partizioni per i sistemi SUSE Linux Enterprise già installati.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Seleziona per l'aggiornamento</guimenu> selezionare la partizione di cui eseguire l'upgrade e fare clic su <guimenu>Avanti</guimenu>.
    </para>
    <para>
     YaST monta la partizione selezionata e visualizza tutti gli archivi rilevati nella partizione di cui si desidera eseguire l'upgrade.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Archivi utilizzati in precedenza</guimenu> modificare lo stato degli archivi: abilitare quelli da includere nel processo di upgrade e disabilitare quelli che non sono più necessari. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Registrazione</guimenu> specificare se si desidera registrare il sistema sottoposto ad upgrade ora immettendo i dati di registrazione e facendo clic su <guimenu>Avanti</guimenu> oppure scegliere <guimenu>Ignora registrazione</guimenu>. Per informazioni dettagliate sulla registrazione del sistema, vedere la <xref linkend="sec.update.registersystem"/>.
    </para>
   </step>
   <step>
    <para>
     Rivedere le <guimenu>Impostazioni dell'installazione</guimenu> per l'upgrade prestando particolare attenzione alle <guimenu>Opzioni di aggiornamento</guimenu>. Scegliere una delle seguenti opzioni:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <guimenu>Aggiorna solo pacchetti installati</guimenu>. In questo caso si rischia di perdere le nuove funzioni fornite con la versione più recente di SUSE Linux Enterprise.
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>Aggiornamento con installazione di nuovo software e nuove funzioni</guimenu>. Fare clic su <guimenu>Seleziona modelli</guimenu> per abilitare o disabilitare modelli e pacchetti in base alle esigenze specifiche.
      </para>
     </listitem>
    </itemizedlist>

    <note>
     <title>scelta del desktop</title>
     <para>
      Se prima dell'upgrade a SUSE Linux Enterprise 12 è stato utilizzato KDE (<varname>DEFAULT_WM</varname> in <filename>/etc/sysconfig/windowmanager</filename> era impostato su <literal>kde*</literal>), l'ambiente desktop verrà sostituito automaticamente da GNOME dopo l'upgrade. Per default, il display manager KDM verrà sostituito da GDM.
     </para>
     <para>
      Per cambiare la scelta dell'ambiente desktop o il gestore delle finestre, modificare la selezione software facendo clic su <guimenu>Seleziona modelli</guimenu>.
     </para>
    </note>
   </step>
   <step>
    <para>
     Se le impostazioni sono quelle desiderate, avviare la procedura di installazione e rimozione facendo clic su <guimenu>Aggiorna</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Terminato il processo di upgrade verificare la presenza di eventuali <quote>pacchetti orfani</quote>. I pacchetti orfani sono pacchetti che non appartengono più ad alcun archivio attivo. Per visualizzarli, è possibile utilizzare il comando seguente:
    </para>
<screen>zypper packages --orphaned</screen>
    <para>
     Tale elenco consente di stabilire se un determinato pacchetto è ancora necessario o se può essere disinstallato senza problemi.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec.update.sle12.manager">
  <title>Aggiornamento tramite SUSE Manager</title>

  <para>
   SUSE Manager è una soluzione server che fornisce aggiornamenti, patch e correzioni per la sicurezza dei client SUSE Linux Enterprise. Viene fornito in dotazione con un set di strumenti e un'interfaccia utente basata su Web per i task di gestione. Per ulteriori informazioni, vedere <link xlink:href="https://www.suse.com/products/suse-manager/"/>.
  </para>
 </sect1>
 <sect1 xml:id="sec.update.reg.status.after.rollback">
  <title>Aggiornamento dello stato della registrazione dopo il rollback</title>

  <para>
   Quando si esegue la migrazione di un Service Pack, è necessario modificare la configurazione nel server di registrazione per consentire l'accesso ai nuovi archivi. Se il processo di migrazione viene interrotto o annullato (tramite il ripristino da un backup o da un'istantanea), le informazioni sul server di registrazione sono incoerenti con lo stato del sistema. Questo potrebbe impedire l'accesso agli archivi di aggiornamenti o comportare l'uso di archivi scorretti nel client.
  </para>

  <para>
   Quando si esegue un rollback tramite Snapper, il sistema invia una notifica al server di registrazione per garantire che durante il processo di avvio venga configurato l'accesso agli archivi corretti. Se il sistema era stato ripristinato con qualsiasi altro metodo, oppure la comunicazione con il server di registrazione non è riuscita per qualsiasi motivo (ad esempio perché il server non era accessibile per problemi di rete), attivare manualmente il rollback nel client chiamando:
  </para>

<screen><command>snapper</command> rollback</screen>

  <para>
   È consigliabile verificare sempre che nel sistema siano configurati gli archivi corretti, soprattutto dopo un aggiornamento del servizio tramite
  </para>

<screen><command>zypper</command> ref -s</screen>

  <para>
   Questa funzionalità è disponibile nel pacchetto
   <package>rollback-helper</package>
   .
  </para>
 </sect1>
 <sect1 xml:id="sec.update.registersystem">


  <title>Registrazione del sistema</title>

  <para>
   Se durante l'installazione è stato ignorato il passaggio di registrazione, è possibile registrare il sistema in qualsiasi momento utilizzando il modulo <guimenu>Registrazione prodotto</guimenu> in YaST.
  </para>

  <para>
   La registrazione dei sistemi comporta i seguenti vantaggi:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Supporto
    </para>
   </listitem>
   <listitem>
    <para>
     Aggiornamenti di sicurezza e correzione dei bug
    </para>
   </listitem>
   <listitem>
    <para>
     Accesso al SUSE Customer Center
    </para>
   </listitem>
  </itemizedlist>

  <procedure>
   <step>
    <para>
     Avviare YaST e selezionare <menuchoice> <guimenu>Software</guimenu> <guimenu>Registrazione prodotto</guimenu> </menuchoice> per aprire la finestra di dialogo <guimenu>Registrazione</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Specificare l'indirizzo <guimenu>E-mail</guimenu> associato all'account SUSE in uso o utilizzato dalla propria organizzazione per gestire le sottoscrizioni. Se non si dispone ancora di un account SUSE, andare alla home page del SUSE Customer Center (<link xlink:show="new" xlink:href="https://scc.suse.com/"/>) per crearne uno.
    </para>
   </step>
   <step>
    <para>
     Immettere il <guimenu>Codice di registrazione</guimenu> ricevuto con la copia di <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
    </para>
   </step>
   <step xml:id="step.y2.register.final">
    <para>
     Continuare premendo <guimenu>Avanti</guimenu> per avviare il processo di registrazione. Se nella rete sono disponibili uno o più server di registrazione locali, è possibile sceglierne uno da un elenco. In alternativa, scegliere <guimenu>Annulla</guimenu> per ignorare i server di registrazione locale ed effettuare la registrazione al server di registrazione SUSE di default.
    </para>
    <para>
     Durante la registrazione gli archivi di aggiornamenti online vengono aggiunti all'installazione dell'upgrade. Al termine, è possibile scegliere se installare le ultime versioni dei pacchetti disponibili dagli archivi di aggiornamenti. In questo modo si ottiene un percorso di upgrade pulito per tutti i pacchetti e si ha la certezza che a <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> verranno applicati gli ultimi aggiornamenti di sicurezza disponibili. Se si sceglie <guimenu>No</guimenu>, tutti i pacchetti vengono installati dai supporti di installazione. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
    <para>
     Al termine della registrazione, YaST mostra un elenco di estensioni, componenti aggiuntivi e moduli disponibili per il sistema. Per selezionarli e installarli, passare alla <xref linkend="sec.add-ons.extensions"/>.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec.update.sle12.multiversion">
  <title>Conservazione dei pacchetti Kernel</title>

  <remark>toms 2015-08-26: bsc#753809</remark> <remark>toms 2015-08-26: some parts are taken ("stolen") from the
      wiki at https://en.opensuse.org/SDB:Keep_multiple_kernel_versions
      and adapted
    </remark> <indexterm> <primary>kernel multiversione</primary> </indexterm>

  <para>
   Quando si installa un nuovo kernel con YaST o Zypper, SUSE Linux Enterprise conserva gli ultimi due kernel e quello in esecuzione. In genere questo è sufficiente.
  </para>

  <para>
   Possono tuttavia verificarsi situazioni in cui è necessario conservare più versioni del kernel, ad esempio a scopo di verifica. Per consentire questa operazione, SUSE Linux Enterprise supporta la <emphasis>funzione kernel multiversione</emphasis>. Abilitando e configurando questa funzione, è possibile modificare e configurare anche il comportamento di default:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     eliminare un kernel precedente solo dopo che il sistema è stato riavviato correttamente con il nuovo kernel
    </para>
   </listitem>
   <listitem>
    <para>
     conservare come fallback un numero specificato di kernel precedenti
    </para>
   </listitem>
   <listitem>
    <para>
     conservare una versione di kernel specifica
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Dopo il riavvio, uno script confronterà l'elenco di kernel installati con le impostazioni specificate in <filename>/etc/zypp/zypp.conf</filename> ed eliminerà i kernel non più necessari.
  </para>

  <sect2 xml:id="sec.update.sle12.multiversion.enable">
   <title>Abilitazione della funzione Kernel multiversione</title>
   <para>
    Il comportamento di default è definito nel file di configurazione <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen><prompt>root # </prompt><command>grep</command> ^multiversion /etc/zypp/zypp.conf
multiversion = provides:multiversion(kernel)
multiversion.kernels = latest,latest-1,running</screen>
   <para>
    Rimuovere eventuali simboli di cancelletto (#) prima della riga <literal>multiversion</literal> per abilitare questa funzione (che dovrebbe essere già abilitata). La seconda riga viene utilizzata per specificare <emphasis>quali</emphasis> kernel devono essere conservati. È necessario abilitarli entrambi, in caso contrario il sistema conserverà <emphasis>tutti</emphasis> i kernel occupando l'intero spazio del disco rigido.
   </para>
   <para>
    La riga <literal>multiversion.kernels</literal> può contenere diverse parole chiave, ordinate e combinate tra loro in vari modi:
   </para>
   <variablelist>
    <varlistentry>
     <term><option>latest</option>
     </term>
     <listitem>
      <para>
       Conserva il kernel con il numero di versione più alto
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>latest-<replaceable>N</replaceable></option>
     </term>
     <listitem>
      <para>
       Conserva il kernel con l'<replaceable>N</replaceable>simo numero di versione più alto, dove <replaceable>N</replaceable> è un numero a partire da 1
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>running</option>
     </term>
     <listitem>
      <para>
       Conserva il kernel in esecuzione
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>oldest</option>
     </term>
     <listitem>
      <para>
       Conserva il kernel con il numero di versione più basso (il kernel del prodotto rilasciato)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>oldest-<replaceable>N</replaceable></option>
     </term>
     <listitem>
      <para>
       Conserva il kernel con l'<replaceable>N</replaceable>simo numero di versione più basso
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>3.12.28-4.6</option>
     </term>
     <listitem>
      <para>
       Conserva esattamente questa versione del kernel
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="sec.update.sle12.multiversion.deleteoldkernel">
   <title>Caso d'uso: eliminazione di un kernel precedente solo dopo il riavvio</title>
   <para>
    Si supponga di voler essere sicuri che il kernel precedente venga eliminato solo dopo che è stato riavviato il nuovo kernel.
   </para>
   <para>
    Modificare la riga che segue in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,running</screen>
   <para>
    I parametri precedenti indicano al sistema di conservare il kernel più recente e quello in esecuzione solo se sono diversi tra loro.
   </para>
  </sect2>

  <sect2 xml:id="sec.update.sle12.multiversion.fallback">
   <title>Caso d'uso: conservazione dei kernel precedenti come fallback</title>
   <para>
    Si supponga di voler conservare una o più versioni di kernel per avere uno o più kernel <quote>di ricambio</quote>.
   </para>
   <para>
    Questo caso d'uso può risultare utile quando servono kernel per eseguire dei test. In caso di problemi, ad esempio se il computer non si avvia, è comunque possibile utilizzare una o più versioni di kernel notoriamente valide.
   </para>
   <para>
    Modificare la riga che segue in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,latest-1,latest-2,running</screen>
   <para>
    Quando si riavvia il sistema dopo l'installazione di un nuovo kernel, il sistema conserva tre kernel: il kernel nuovo in esecuzione (configurato come <literal>latest,running</literal>), il kernel della versione precedente (configurato come <literal>latest-1</literal>) e quello anteriore al kernel della versione precedente (configurato come <literal>latest-2</literal>).
   </para>
  </sect2>

  <sect2 xml:id="sec.update.sle12.multiversion.specificversion">
   <title>Caso d'uso: conservare una versione specifica del kernel</title>
   <para>
    L'utente effettua regolarmente aggiornamenti di sistema e installa nuove versioni di kernel. Tuttavia l'utente compila anche una versione personalizzata del kernel per vari motivi e vuole essere sicuro che il sistema la conservi.
   </para>
   <para>
    Modificare la riga che segue in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,3.12.28-4.20,running</screen>
   <para>
    Quando si riavvia il sistema dopo l'installazione di un nuovo kernel, il sistema conserverà due kernel: quello nuovo in esecuzione (configurato come <literal>latest,running</literal>) e quello autocompilato (configurato come <literal>3.12.28-4.20</literal>).
   </para>
  </sect2>
 </sect1>
</chapter>
